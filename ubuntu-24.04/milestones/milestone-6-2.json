{
  "milestone": "6.2",
  "title": "System Auditing",
  "description": "CIS Ubuntu Linux 24.04 LTS Benchmark - Section 6.2: System Auditing",
  "version": "1.0.0",
  "controls": [
    {
      "id": "6.2.1.1",
      "title": "Ensure auditd packages are installed",
      "section": "6.2.1.1 Configure auditd Service",
      "profile": "Level2",
      "automated": true,
      "type": "MultiPackage",
      "package_names": [
        "auditd",
        "audispd-plugins"
      ],
      "should_be_installed": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.1.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.1.2",
      "title": "Ensure auditd service is enabled and active",
      "section": "6.2.1.2 Configure auditd Service",
      "profile": "Level2",
      "automated": true,
      "type": "Service",
      "service_name": "auditd",
      "expected_status": "enabled",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.1.2",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.1.3",
      "title": "Ensure auditing for processes that start prior to auditd is enabled",
      "section": "6.2.1.3 Configure auditd Service",
      "profile": "Level2",
      "automated": true,
      "type": "BootParameter",
      "parameters": [
        "audit=1"
      ],
      "config_file": "/etc/default/grub",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.1.3",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.1.4",
      "title": "Ensure audit_backlog_limit is sufficient",
      "section": "6.2.1.4 Configure auditd Service",
      "profile": "Level2",
      "automated": true,
      "type": "BootParameter",
      "parameters": [
        "audit_backlog_limit=8192"
      ],
      "config_file": "/etc/default/grub",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.1.4",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.2.1",
      "title": "Ensure audit log storage size is configured",
      "section": "6.2.2.1 Configure Data Retention",
      "profile": "Level2",
      "automated": true,
      "type": "AuditdConfig",
      "config_file": "/etc/audit/auditd.conf",
      "parameter": "max_log_file",
      "check_configured": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.2.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.2.2",
      "title": "Ensure audit logs are not automatically deleted",
      "section": "6.2.2.2 Configure Data Retention",
      "profile": "Level2",
      "automated": true,
      "type": "AuditdConfig",
      "config_file": "/etc/audit/auditd.conf",
      "parameter": "max_log_file_action",
      "expected_value": "keep_logs",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.2.2",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.3.1",
      "title": "Ensure changes to system administration scope (sudoers) is collected",
      "section": "6.2.3.1 Configure auditd Rules",
      "profile": "Level2",
      "automated": true,
      "type": "AuditRule",
      "rule_file": "/etc/audit/rules.d/50-scope.rules",
      "expected_rules": [
        "-w /etc/sudoers -p wa -k scope",
        "-w /etc/sudoers.d/ -p wa -k scope"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.3.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.3.4",
      "title": "Ensure events that modify date and time information are collected",
      "section": "6.2.3.4 Configure auditd Rules",
      "profile": "Level2",
      "automated": true,
      "type": "AuditRule",
      "rule_file": "/etc/audit/rules.d/50-time-change.rules",
      "expected_rules": [
        "-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change",
        "-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k time-change",
        "-a always,exit -F arch=b64 -S clock_settime -k time-change",
        "-a always,exit -F arch=b32 -S clock_settime -k time-change",
        "-w /etc/localtime -p wa -k time-change"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.3.4",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.3.20",
      "title": "Ensure the audit configuration is immutable",
      "section": "6.2.3.20 Configure auditd Rules",
      "profile": "Level2",
      "automated": true,
      "type": "AuditRule",
      "rule_file": "/etc/audit/rules.d/99-finalize.rules",
      "expected_rules": [
        "-e 2"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.3.20",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.4.1",
      "title": "Ensure audit log files mode is configured",
      "section": "6.2.4.1 Configure auditd File Access",
      "profile": "Level2",
      "automated": true,
      "type": "AuditLogPermissions",
      "log_directory": "/var/log/audit",
      "expected_file_mode": "600",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.4.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    }
  ]
}