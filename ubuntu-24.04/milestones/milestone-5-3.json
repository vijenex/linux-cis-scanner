{
  "milestone": "5.3 Pluggable Authentication Modules",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 5.3 Pluggable Authentication Modules",
  "controls": [
    {
      "id": "5.3.1.1",
      "title": "Ensure latest version of pam is installed",
      "section": "Access Control",
      "description": "PAM (Pluggable Authentication Modules) is a suite of libraries that allows a Linux system administrator to configure methods to authenticate users.",
      "rationale": "Ensuring the latest version of PAM is installed provides the latest security fixes and features.",
      "impact": "None.",
      "remediation": "Run the following command to install/update pam: apt install libpam0g",
      "profile": "Level1",
      "type": "Package",
      "package_name": "libpam0g",
      "should_be_installed": true
    },
    {
      "id": "5.3.1.2",
      "title": "Ensure latest version of libpam-modules is installed",
      "section": "Access Control",
      "description": "The libpam-modules package contains the standard set of PAM modules.",
      "rationale": "Ensuring the latest version provides security fixes and proper authentication functionality.",
      "impact": "None.",
      "remediation": "Run the following command: apt install libpam-modules",
      "profile": "Level1",
      "type": "Package",
      "package_name": "libpam-modules",
      "should_be_installed": true
    },
    {
      "id": "5.3.1.3",
      "title": "Ensure latest version of libpam-pwquality is installed",
      "section": "Access Control",
      "description": "The libpam-pwquality package provides password quality checking for PAM.",
      "rationale": "Password quality checking helps ensure strong passwords are used.",
      "impact": "None.",
      "remediation": "Run the following command: apt install libpam-pwquality",
      "profile": "Level1",
      "type": "Package",
      "package_name": "libpam-pwquality",
      "should_be_installed": true
    },
    {
      "id": "5.3.2.1",
      "title": "Ensure pam_unix module is enabled",
      "section": "Access Control",
      "description": "The pam_unix module provides standard Unix authentication.",
      "rationale": "The pam_unix module is essential for standard Unix password authentication.",
      "impact": "None.",
      "remediation": "Ensure pam_unix is enabled in PAM configuration files.",
      "profile": "Level1",
      "type": "PAMConfig",
      "config_file": "/etc/pam.d/common-auth",
      "required_setting": "pam_unix.so"
    },
    {
      "id": "5.3.2.2",
      "title": "Ensure pam_faillock module is enabled",
      "section": "Access Control",
      "description": "The pam_faillock module provides account lockout functionality.",
      "rationale": "Account lockout helps prevent brute force attacks.",
      "impact": "Users may be locked out after failed login attempts.",
      "remediation": "Configure pam_faillock in PAM configuration files.",
      "profile": "Level1",
      "type": "PAMConfig",
      "config_file": "/etc/pam.d/common-auth",
      "required_setting": "pam_faillock.so"
    },
    {
      "id": "5.3.2.3",
      "title": "Ensure pam_pwquality module is enabled",
      "section": "Access Control",
      "description": "The pam_pwquality module provides password quality checking.",
      "rationale": "Password quality checking ensures strong passwords are used.",
      "impact": "Users must meet password complexity requirements.",
      "remediation": "Configure pam_pwquality in PAM configuration files.",
      "profile": "Level1",
      "type": "PAMConfig",
      "config_file": "/etc/pam.d/common-password",
      "required_setting": "pam_pwquality.so"
    },
    {
      "id": "5.3.2.4",
      "title": "Ensure pam_pwhistory module is enabled",
      "section": "Access Control",
      "description": "The pam_pwhistory module provides password history functionality.",
      "rationale": "Password history prevents users from reusing recent passwords.",
      "impact": "Users cannot reuse recent passwords.",
      "remediation": "Configure pam_pwhistory in PAM configuration files.",
      "profile": "Level1",
      "type": "PAMConfig",
      "config_file": "/etc/pam.d/common-password",
      "required_setting": "pam_pwhistory.so"
    },
    {
      "id": "5.3.3.1.1",
      "title": "Ensure password failed attempts lockout is configured",
      "section": "Access Control",
      "description": "Lock out users after a number of incorrect password attempts.",
      "rationale": "Locking out user IDs after n unsuccessful consecutive login attempts mitigates brute force password attacks against your systems.",
      "impact": "Users will be locked out after failed attempts.",
      "remediation": "Configure pam_faillock with deny parameter in /etc/security/faillock.conf",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/security/faillock.conf",
      "pattern": "deny\\s*=\\s*[1-5]",
      "expected_match": true
    },
    {
      "id": "5.3.3.1.2",
      "title": "Ensure password unlock time is configured",
      "section": "Access Control",
      "description": "Configure the time period for which the account remains locked.",
      "rationale": "Setting unlock time ensures accounts don't remain locked indefinitely.",
      "impact": "Accounts will automatically unlock after the specified time.",
      "remediation": "Configure unlock_time parameter in /etc/security/faillock.conf",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/security/faillock.conf",
      "pattern": "unlock_time\\s*=\\s*[0-9]+",
      "expected_match": true
    },
    {
      "id": "5.3.3.2.1",
      "title": "Ensure password number of changed characters is configured",
      "section": "Access Control",
      "description": "Configure the minimum number of characters that must be different from the old password.",
      "rationale": "Requiring a minimum number of different characters makes password attacks more difficult.",
      "impact": "Users must change a minimum number of characters when changing passwords.",
      "remediation": "Configure difok parameter in /etc/security/pwquality.conf",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/security/pwquality.conf",
      "pattern": "difok\\s*=\\s*[2-9]",
      "expected_match": true
    },
    {
      "id": "5.3.3.2.2",
      "title": "Ensure minimum password length is configured",
      "section": "Access Control",
      "description": "Configure the minimum acceptable size for the new password.",
      "rationale": "Setting a minimum password length increases password strength.",
      "impact": "Users must create passwords of minimum specified length.",
      "remediation": "Configure minlen parameter in /etc/security/pwquality.conf",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/security/pwquality.conf",
      "pattern": "minlen\\s*=\\s*(1[4-9]|[2-9][0-9])",
      "expected_match": true
    },
    {
      "id": "5.3.3.2.6",
      "title": "Ensure password dictionary check is enabled",
      "section": "Access Control",
      "description": "Enable dictionary checking for passwords.",
      "rationale": "Dictionary checking prevents users from using common dictionary words as passwords.",
      "impact": "Users cannot use dictionary words as passwords.",
      "remediation": "Configure dictcheck parameter in /etc/security/pwquality.conf",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/security/pwquality.conf",
      "pattern": "dictcheck\\s*=\\s*1",
      "expected_match": true
    },
    {
      "id": "5.3.3.3.1",
      "title": "Ensure password history remember is configured",
      "section": "Access Control",
      "description": "Configure the number of previous passwords to remember.",
      "rationale": "Forcing users to use new passwords reduces the risk of password reuse attacks.",
      "impact": "Users cannot reuse recent passwords.",
      "remediation": "Configure remember parameter in /etc/security/pwhistory.conf",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/security/pwhistory.conf",
      "pattern": "remember\\s*=\\s*([5-9]|[1-9][0-9])",
      "expected_match": true
    }
  ]
}