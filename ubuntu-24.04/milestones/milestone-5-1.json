{
  "milestone": "5.1",
  "title": "Configure SSH Server",
  "description": "CIS Ubuntu Linux 24.04 LTS Benchmark - Section 5.1: Configure SSH Server",
  "version": "1.0.0",
  "controls": [
    {
      "id": "5.1.1",
      "title": "Ensure permissions on /etc/ssh/sshd_config are configured",
      "section": "5.1 Configure SSH Server",
      "description": "The /etc/ssh/sshd_config file contains configuration specifications for sshd.",
      "impact": "If the /etc/ssh/sshd_config file is writable by a group or the world the risk of its compromise is increased.",
      "remediation": "Run the following commands to set ownership and permissions on /etc/ssh/sshd_config: chown root:root /etc/ssh/sshd_config && chmod og-rwx /etc/ssh/sshd_config",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermission",
      "file_path": "/etc/ssh/sshd_config",
      "expected_mode": "600",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "5.1.2",
      "title": "Ensure permissions on SSH private host key files are configured",
      "section": "5.1 Configure SSH Server",
      "description": "An SSH private key is one of two files used in SSH public key authentication.",
      "impact": "If an SSH private key is read by an unauthorized user, the authorized user's account may be compromised.",
      "remediation": "Run the following commands to set permissions and ownership on the SSH host private keys: find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chown root:root {} \\; && find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chmod 0600 {} \\;",
      "profile": "Level1",
      "automated": true,
      "type": "SSHPrivateKeys",
      "key_pattern": "/etc/ssh/ssh_host_*_key",
      "expected_mode": "600",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "5.1.3",
      "title": "Ensure permissions on SSH public host key files are configured",
      "section": "5.1 Configure SSH Server",
      "description": "An SSH public key is one of two files used in SSH public key authentication.",
      "impact": "If a public host key file is modified by an unauthorized user, the SSH service may be compromised.",
      "remediation": "Run the following commands to set permissions and ownership on the SSH host public keys: find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chmod 0644 {} \\; && find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chown root:root {} \\;",
      "profile": "Level1",
      "automated": true,
      "type": "SSHPublicKeys",
      "key_pattern": "/etc/ssh/ssh_host_*_key.pub",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "5.1.4",
      "title": "Ensure sshd access is configured",
      "section": "5.1 Configure SSH Server",
      "description": "There are several options available to limit which users and group can access the system via SSH.",
      "impact": "Restricting which users can remotely access the system via SSH will help ensure that only authorized users access the system.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set one or more of the parameter as follows: AllowUsers <userlist>, AllowGroups <grouplist>, DenyUsers <userlist>, DenyGroups <grouplist>",
      "profile": "Level1",
      "automated": true,
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": ["AllowUsers", "AllowGroups", "DenyUsers", "DenyGroups"],
      "require_one_of": true
    },
    {
      "id": "5.1.5",
      "title": "Ensure sshd Banner is configured",
      "section": "5.1 Configure SSH Server",
      "description": "The Banner parameter specifies a file whose contents are sent to the remote user before authentication is allowed.",
      "impact": "Banners are used to warn connecting users of the particular site's policy regarding connection.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: Banner /etc/issue.net",
      "profile": "Level1",
      "automated": true,
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": ["Banner"],
      "expected_values": {"Banner": "/etc/issue.net"}
    },
    {
      "id": "5.1.6",
      "title": "Ensure sshd Ciphers are configured",
      "section": "5.1 Configure SSH Server",
      "description": "This variable limits the ciphers that SSH can use during communication.",
      "impact": "Weak ciphers that are used for authentication to the cryptographic module cannot be relied upon to provide confidentiality or integrity, and system information may be compromised.",
      "remediation": "Edit the /etc/ssh/sshd_config file add/modify the Ciphers line to contain a comma separated list of the site approved ciphers",
      "profile": "Level1",
      "automated": true,
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": ["Ciphers"],
      "validate_crypto": true
    },
    {
      "id": "5.1.7",
      "title": "Ensure sshd ClientAliveInterval and ClientAliveCountMax are configured",
      "section": "5.1 Configure SSH Server",
      "description": "The two options ClientAliveInterval and ClientAliveCountMax control the timeout of ssh sessions.",
      "impact": "Having no timeout value associated with a connection could allow an unauthorized user access to another user's ssh session.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameters according to site policy: ClientAliveInterval 15, ClientAliveCountMax 3",
      "profile": "Level1",
      "automated": true,
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": ["ClientAliveInterval", "ClientAliveCountMax"],
      "expected_values": {"ClientAliveInterval": "15", "ClientAliveCountMax": "3"}
    },
    {
      "id": "5.1.8",
      "title": "Ensure sshd DisableForwarding is enabled",
      "section": "5.1 Configure SSH Server",
      "description": "SSH port forwarding is a mechanism in SSH for tunneling application ports from the client to the server, or servers to clients.",
      "impact": "Leaving port forwarding enabled can expose the organization to security risks and back-doors.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: DisableForwarding yes",
      "profile": "Level2",
      "automated": true,
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": ["DisableForwarding"],
      "expected_values": {"DisableForwarding": "yes"}
    },
    {
      "id": "5.1.20",
      "title": "Ensure sshd PermitRootLogin is disabled",
      "section": "5.1 Configure SSH Server",
      "description": "The PermitRootLogin parameter specifies if the root user can log in using ssh.",
      "impact": "Disallowing root logins over SSH requires system admins to authenticate using their own individual account, then escalating to root via sudo or su.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: PermitRootLogin no",
      "profile": "Level1",
      "automated": true,
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": ["PermitRootLogin"],
      "expected_values": {"PermitRootLogin": "no"}
    },
    {
      "id": "5.1.19",
      "title": "Ensure sshd PermitEmptyPasswords is disabled",
      "section": "5.1 Configure SSH Server",
      "description": "The PermitEmptyPasswords parameter specifies if the SSH server allows login to accounts with empty password strings.",
      "impact": "Disallowing remote shell access to accounts that have an empty password reduces the probability of unauthorized access to the system.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: PermitEmptyPasswords no",
      "profile": "Level1",
      "automated": true,
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": ["PermitEmptyPasswords"],
      "expected_values": {"PermitEmptyPasswords": "no"}
    },
    {
      "id": "5.1.22",
      "title": "Ensure sshd UsePAM is enabled",
      "section": "5.1 Configure SSH Server",
      "description": "UsePAM Enables the Pluggable Authentication Module interface.",
      "impact": "When usePAM is set to yes, PAM runs through account and session types properly. This is important if you want to restrict access to services based off of IP, time or other factors of the account.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: UsePAM yes",
      "profile": "Level1",
      "automated": true,
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": ["UsePAM"],
      "expected_values": {"UsePAM": "yes"}
    }
  ]
}