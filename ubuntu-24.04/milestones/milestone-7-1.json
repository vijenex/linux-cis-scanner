{
  "milestone": "7.1",
  "title": "System File Permissions",
  "description": "CIS Ubuntu Linux 24.04 LTS Benchmark - Section 7.1: System File Permissions",
  "version": "1.0.0",
  "controls": [
    {
      "id": "7.1.1",
      "title": "Ensure permissions on /etc/passwd are configured",
      "section": "7.1 System File Permissions",
      "description": "The /etc/passwd file contains user account information that is used by many system utilities and therefore must be readable for these utilities to operate.",
      "impact": "It is critical to ensure that the /etc/passwd file is protected from unauthorized write access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "remediation": "Run the following command to set permissions on /etc/passwd: chmod 644 /etc/passwd",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermission",
      "file_path": "/etc/passwd",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "7.1.2",
      "title": "Ensure permissions on /etc/passwd- are configured",
      "section": "7.1 System File Permissions",
      "description": "The /etc/passwd- file contains backup user account information.",
      "impact": "It is critical to ensure that the /etc/passwd- file is protected from unauthorized access.",
      "remediation": "Run the following command to set permissions on /etc/passwd-: chmod 644 /etc/passwd-",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermission",
      "file_path": "/etc/passwd-",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "7.1.3",
      "title": "Ensure permissions on /etc/group are configured",
      "section": "7.1 System File Permissions",
      "description": "The /etc/group file contains a list of all the valid groups defined in the system.",
      "impact": "The /etc/group file needs to be protected from unauthorized changes by non-privileged users, but needs to be readable as many command utilities use it to map a GID to the group name.",
      "remediation": "Run the following command to set permissions on /etc/group: chmod 644 /etc/group",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermission",
      "file_path": "/etc/group",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "7.1.4",
      "title": "Ensure permissions on /etc/group- are configured",
      "section": "7.1 System File Permissions",
      "description": "The /etc/group- file contains backup group account information.",
      "impact": "It is critical to ensure that the /etc/group- file is protected from unauthorized access.",
      "remediation": "Run the following command to set permissions on /etc/group-: chmod 644 /etc/group-",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermission",
      "file_path": "/etc/group-",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "7.1.5",
      "title": "Ensure permissions on /etc/shadow are configured",
      "section": "7.1 System File Permissions",
      "description": "The /etc/shadow file is used to store the information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.",
      "impact": "If attackers can gain read access to the /etc/shadow file, they can easily run a password cracking program against the hashed password to break it.",
      "remediation": "Run the following command to set permissions on /etc/shadow: chmod 640 /etc/shadow",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermission",
      "file_path": "/etc/shadow",
      "expected_mode": "640",
      "expected_owner": "root",
      "expected_group": "shadow"
    },
    {
      "id": "7.1.6",
      "title": "Ensure permissions on /etc/shadow- are configured",
      "section": "7.1 System File Permissions",
      "description": "The /etc/shadow- file contains backup user password information.",
      "impact": "It is critical to ensure that the /etc/shadow- file is protected from unauthorized access.",
      "remediation": "Run the following command to set permissions on /etc/shadow-: chmod 640 /etc/shadow-",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermission",
      "file_path": "/etc/shadow-",
      "expected_mode": "640",
      "expected_owner": "root",
      "expected_group": "shadow"
    },
    {
      "id": "7.1.7",
      "title": "Ensure permissions on /etc/gshadow are configured",
      "section": "7.1 System File Permissions",
      "description": "The /etc/gshadow file is used to store the information about groups that is critical to the security of those accounts, such as the hashed password and other security information.",
      "impact": "If attackers can gain read access to the /etc/gshadow file, they can easily run a password cracking program against the hashed password to break it.",
      "remediation": "Run the following command to set permissions on /etc/gshadow: chmod 640 /etc/gshadow",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermission",
      "file_path": "/etc/gshadow",
      "expected_mode": "640",
      "expected_owner": "root",
      "expected_group": "shadow"
    },
    {
      "id": "7.1.8",
      "title": "Ensure permissions on /etc/gshadow- are configured",
      "section": "7.1 System File Permissions",
      "description": "The /etc/gshadow- file contains backup group password information.",
      "impact": "It is critical to ensure that the /etc/gshadow- file is protected from unauthorized access.",
      "remediation": "Run the following command to set permissions on /etc/gshadow-: chmod 640 /etc/gshadow-",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermission",
      "file_path": "/etc/gshadow-",
      "expected_mode": "640",
      "expected_owner": "root",
      "expected_group": "shadow"
    },
    {
      "id": "7.1.9",
      "title": "Ensure permissions on /etc/shells are configured",
      "section": "7.1 System File Permissions",
      "description": "The /etc/shells file contains the list of valid login shells for users on the system.",
      "impact": "Setting the permissions to read/write for root only prevents non-privileged users from modifying the file.",
      "remediation": "Run the following command to set permissions on /etc/shells: chmod 644 /etc/shells",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermission",
      "file_path": "/etc/shells",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "7.1.10",
      "title": "Ensure permissions on /etc/security/opasswd are configured",
      "section": "7.1 System File Permissions",
      "description": "The /etc/security/opasswd file stores the users' old passwords and can be checked to ensure that users are not recycling recent passwords.",
      "impact": "The /etc/security/opasswd file contains user password history. Setting the permissions to read/write for root only prevents non-privileged users from accessing the file.",
      "remediation": "Run the following command to set permissions on /etc/security/opasswd: chmod 600 /etc/security/opasswd",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermission",
      "file_path": "/etc/security/opasswd",
      "expected_mode": "600",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "7.1.11",
      "title": "Ensure world writable files and directories are secured",
      "section": "7.1 System File Permissions",
      "description": "Unix-based systems support variable settings to control access to files. World writable files are the least secure.",
      "impact": "Data in world-writable files can be read, modified, and potentially compromised by any user on the system.",
      "remediation": "Removing write access for the \"other\" category (chmod o-w <filename>) is advisable, but always first check what function the file serves before making the change.",
      "profile": "Level1",
      "automated": true,
      "type": "WorldWritableFiles",
      "search_paths": ["/", "/home", "/tmp", "/var"],
      "exclude_paths": ["/proc", "/sys", "/dev"]
    },
    {
      "id": "7.1.12",
      "title": "Ensure no files or directories without an owner and a group exist",
      "section": "7.1 System File Permissions",
      "description": "Sometimes when administrators delete users or groups from the system they neglect to remove all files owned by those users or groups.",
      "impact": "A new user who is assigned the deleted user's user ID or group ID may then end up \"owning\" these files, and thus have more access on the system than was intended.",
      "remediation": "Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate.",
      "profile": "Level1",
      "automated": true,
      "type": "OrphanedFiles",
      "search_paths": ["/", "/home", "/var"],
      "exclude_paths": ["/proc", "/sys", "/dev"]
    },
    {
      "id": "7.1.13",
      "title": "Ensure SUID and SGID files are reviewed",
      "section": "7.1 System File Permissions",
      "description": "The owner of a file can set the file's permissions to run with the owner's or group's permissions, even if the user running the program is not the owner or a member of the group.",
      "impact": "There are valid reasons for SUID and SGID programs, but it is important to identify and review such programs to ensure they are legitimate.",
      "remediation": "Ensure that no rogue SUID or SGID programs have been introduced into the system. Review the files returned by the action in the Audit section and confirm the integrity of these binaries.",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "expected": "SUID and SGID files reviewed and verified as legitimate"
    }
  ]
}