{
  "milestone": "4.3",
  "title": "Configure nftables",
  "description": "CIS Ubuntu Linux 24.04 LTS Benchmark - Section 4.3: Configure nftables",
  "version": "1.0.0",
  "controls": [
    {
      "id": "4.3.1",
      "title": "Ensure nftables is installed",
      "section": "4.3 Configure nftables",
      "profile": "Level1",
      "automated": true,
      "type": "Package",
      "package_name": "nftables",
      "should_be_installed": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.3.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.3.2",
      "title": "Ensure ufw is uninstalled or disabled with nftables",
      "section": "4.3 Configure nftables",
      "profile": "Level1",
      "automated": true,
      "type": "UFWWithNftables",
      "expected_status": "ufw_disabled_or_removed",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.3.2",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.3.3",
      "title": "Ensure iptables are flushed with nftables",
      "section": "4.3 Configure nftables",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "expected": "iptables rules flushed when using nftables",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.3.3",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.3.4",
      "title": "Ensure a nftables table exists",
      "section": "4.3 Configure nftables",
      "profile": "Level1",
      "automated": true,
      "type": "NftablesTable",
      "expected_families": [
        "inet",
        "ip",
        "ip6"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.3.4",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.3.5",
      "title": "Ensure nftables base chains exist",
      "section": "4.3 Configure nftables",
      "profile": "Level1",
      "automated": true,
      "type": "NftablesBaseChains",
      "required_hooks": [
        "input",
        "forward",
        "output"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.3.5",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.3.6",
      "title": "Ensure nftables loopback traffic is configured",
      "section": "4.3 Configure nftables",
      "profile": "Level1",
      "automated": true,
      "type": "NftablesLoopback",
      "expected_rules": [
        "iif lo accept",
        "ip saddr 127.0.0.0/8",
        "ip6 saddr ::1"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.3.6",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.3.7",
      "title": "Ensure nftables outbound and established connections are configured",
      "section": "4.3 Configure nftables",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "expected": "nftables outbound and established connections configured according to site policy",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.3.7",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.3.8",
      "title": "Ensure nftables default deny firewall policy",
      "section": "4.3 Configure nftables",
      "profile": "Level1",
      "automated": true,
      "type": "NftablesDefaultPolicy",
      "expected_policy": "drop",
      "required_chains": [
        "input",
        "forward",
        "output"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.3.8",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.3.9",
      "title": "Ensure nftables service is enabled",
      "section": "4.3 Configure nftables",
      "profile": "Level1",
      "automated": true,
      "type": "Service",
      "service_name": "nftables",
      "expected_status": "enabled",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.3.9",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.3.10",
      "title": "Ensure nftables rules are permanent",
      "section": "4.3 Configure nftables",
      "profile": "Level1",
      "automated": true,
      "type": "NftablesPersistent",
      "config_files": [
        "/etc/nftables.conf",
        "/etc/nftables/*.nft"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.3.10",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    }
  ]
}