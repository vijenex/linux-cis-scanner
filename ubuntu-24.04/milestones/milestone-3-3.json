{
  "milestone": "3.3",
  "title": "Configure Network Kernel Parameters",
  "description": "CIS Ubuntu Linux 24.04 LTS Benchmark - Section 3.3: Configure Network Kernel Parameters",
  "version": "1.0.0",
  "controls": [
    {
      "id": "3.3.1",
      "title": "Ensure ip forwarding is disabled",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "MultiKernelParameter",
      "parameters": [
        {
          "name": "net.ipv4.ip_forward",
          "expected_value": "0"
        },
        {
          "name": "net.ipv6.conf.all.forwarding",
          "expected_value": "0"
        }
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1",
      "description": "• server o The server directive specifies an NTP server which can be used as a time source. The client -server relationship is strictly hierarchical: a client might synchronize its system time to that of the server, but the server’s system time will never be influence d by that of a client.\no This directive can be used multiple times to specify multiple servers.\no The directive is immediately followed by either the name of the server, or its IP address.\n• pool o The syntax of this directive is similar to that for the server directive, except that it is used to specify a pool of NTP servers rather than a single NTP server. The pool name is expected to resolve to multiple addresses which might change over time.\no This directive can be used multiple times to specify multiple pools.\no All options valid in the server directive can be used in this directive too.",
      "remediation": "Edit /etc/chrony/chrony.conf or a file ending in .sources in /etc/chrony/sources.d/ and add or edit server or pool lines as appropriate according to local site policy:\nEdit the Chrony configuration and add or edit the server and/or pool lines returned by the Audit Procedure as appropriate according to local site policy <[server|pool]> <[remote -server|remote -pool]> Example script to add a drop -in configuration for the pool directive:\n#!/usr/bin/env bash [ ! -d \"/etc/chrony/sources.d/\" ] && mkdir /etc/chrony/sources.d/ printf '%s ' \"\" \"#The maxsources option is unique to the pool directive\" \\ \"pool time.nist.gov iburst maxsources 4\" >> /etc/chrony/sources.d/60 - sources.sourc es chronyc reload sources &>/dev/null Example script to add a drop -in configuration for the server directive:\n#!/usr/bin/env bash [ ! -d \"/etc/chrony/sources.d/\" ] && mkdir /etc/chrony/sources.d/ printf '%s ' \"\" \"server time -a-g.nist.gov iburst\" \"server 132.163.97.3 iburst\" \\ \"server time -d-b.nist.gov iburst\" >> /etc/chrony/sources.d/60 - sources.source s chronyc reload sources &>/dev/null\nRun the following command to reload the chronyd config:\n# systemctl reload -or-restart chronyd"
    },
    {
      "id": "3.3.2",
      "title": "Ensure packet redirect sending is disabled",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "MultiKernelParameter",
      "parameters": [
        {
          "name": "net.ipv4.conf.all.send_redirects",
          "expected_value": "0"
        },
        {
          "name": "net.ipv4.conf.default.send_redirects",
          "expected_value": "0"
        }
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.2",
      "description": "The chrony package is installed with a dedicated user account _chrony . This account is granted the access required by the chronyd service",
      "remediation": "Add or edit the user line to /etc/chrony/chrony.conf or a file ending in .conf in /etc/chrony/conf.d/ :\nuser _chrony - OR - If another time synchronization service is in use on the system, run the following command to remove chrony from the system:\n# apt purge chrony\n# apt autoremove chrony"
    },
    {
      "id": "3.3.3",
      "title": "Ensure bogus icmp responses are ignored",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "KernelParameter",
      "parameter": "net.ipv4.icmp_ignore_bogus_error_responses",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.3",
      "description": "chrony is a daemon for synchronizing the system clock across the network",
      "remediation": "- IF - chrony is in use on the system, run the following commands:\nRun the following command to unmask chrony.service :\n# systemctl unmask chrony.service\nRun the following command to enable and start chrony.service :\n# systemctl --now enable chrony.service - OR - If another time synchronization service is in use on the system, run the following command to remove chrony :\n# apt purge chrony\n# apt autoremove chrony"
    },
    {
      "id": "3.3.4",
      "title": "Ensure broadcast icmp requests are ignored",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "KernelParameter",
      "parameter": "net.ipv4.icmp_echo_ignore_broadcasts",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.4",
      "description": "Setting net.ipv4.icmp_echo_ignore_broadcasts to 1 will cause the system to ignore all ICMP echo and timestamp requests to broadcast and multicast addresses.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending in .conf :\n• net.ipv4.icmp_echo_ignore_broadcasts = 1 Example:\n# printf '%s ' \"net.ipv4.icmp_echo_ignore_broadcasts = 1\" >> /etc/sysctl.d/60 -netipv4_sysctl.conf\nRun the following script to set the active kernel parameters:\n#!/usr/bin/env bash sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1 sysctl -w net.ipv4.route.flush=1 Note: If these settings appear in a canonically later file, or later in the same file, these\nsettings will be overwritten"
    },
    {
      "id": "3.3.5",
      "title": "Ensure icmp redirects are not accepted",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "MultiKernelParameter",
      "parameters": [
        {
          "name": "net.ipv4.conf.all.accept_redirects",
          "expected_value": "0"
        },
        {
          "name": "net.ipv4.conf.default.accept_redirects",
          "expected_value": "0"
        },
        {
          "name": "net.ipv6.conf.all.accept_redirects",
          "expected_value": "0"
        },
        {
          "name": "net.ipv6.conf.default.accept_redirects",
          "expected_value": "0"
        }
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.5",
      "description": "ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables.",
      "remediation": "Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending in .conf :\n• net.ipv4.conf.all.accept_redirects = 0 • net.ipv4.conf.default.accept_redirects = 0 Example:\n# printf '%s ' \"net.ipv4.conf.all.accept_redirects = 0\" \"net.ipv4.conf.default.accept_redirects = 0\" >> /etc/sysctl.d/60 - netipv4_sysctl.conf\nRun the following script to set the active kernel parameters:\n#!/usr/bin/env bash sysctl -w net.ipv4.conf.all.accept_redirects=0 sysctl -w net.ipv4.conf.default.accept_redirects=0 sysctl -w net.ipv4.route.flush=1 - IF - IPv6 is enabled on the system:\nSet the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending in .conf :\n• net.ipv6.conf.all.accept_redirects = 0 • net.ipv6.conf.default.accept_redirects = 0 Example:\n# printf '%s ' \"net.ipv6.conf.all.accept_redirects = 0\" \"net.ipv6.conf.default.accept_redirects = 0\" >> /etc/sysctl.d/60 - netipv6_sysctl.conf\nRun the following script to set the active kernel parameters:\n#!/usr/bin/env bash sysctl -w net.ipv6.conf.all.accept_redirects=0 sysctl -w net.ipv6.conf.default.accept_redirects=0 sysctl -w net.ipv6.route.flush=1 Note: If these settings appear in a canonically later file, or later in the same file, these\nsettings will be overwritten"
    },
    {
      "id": "3.3.6",
      "title": "Ensure secure icmp redirects are not accepted",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "MultiKernelParameter",
      "parameters": [
        {
          "name": "net.ipv4.conf.all.secure_redirects",
          "expected_value": "0"
        },
        {
          "name": "net.ipv4.conf.default.secure_redirects",
          "expected_value": "0"
        }
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.6",
      "description": "Secure ICMP redirects are the same as ICMP redirects, except they come from gateways listed on the default gateway list. It is assumed that these gateways are known to your system, and that they are likely to be secure.",
      "remediation": "Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending in .conf :\n• net.ipv4.conf.all.secure_redirects = 0 • net.ipv4.conf.default.secure_redirects = 0 Example:\n# printf '%s ' \"net.ipv4.conf.all.secure_redirects = 0\" \"net.ipv4.conf.default.secure_redirects = 0\" >> /etc/sysctl.d/60 - netipv4_sysctl.conf\nRun the following script to set the active kernel parameters:\n#!/usr/bin/env bash sysctl -w net.ipv4.conf.all.secure_redirects=0 sysctl -w net.ipv4.conf.default.secure_redirects=0 sysctl -w net.ipv4.route.flush=1 Note: If these settings appear in a canonically later file, or later in the same file, these\nsettings will be overwritten"
    },
    {
      "id": "3.3.7",
      "title": "Ensure reverse path filtering is enabled",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "MultiKernelParameter",
      "parameters": [
        {
          "name": "net.ipv4.conf.all.rp_filter",
          "expected_value": "1"
        },
        {
          "name": "net.ipv4.conf.default.rp_filter",
          "expected_value": "1"
        }
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.7",
      "description": "Setting net.ipv4.conf.all.rp_filter and net.ipv4.conf.default.rp_filter to 1 forces the Linux kernel to utilize reverse path filtering on a received packet to determine if the packet was valid. Essentially, with reverse path filtering, if the return packet does not go out the same interface that the corresponding source packet cam e from, the packet is dropped (and logged if log_martians is set).",
      "remediation": "Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending in .conf :\n• net.ipv4.conf.all.rp_filter = 1 • net.ipv4.conf.default.rp_filter = 1 Example:\n# printf '%s ' \"net.ipv4.conf.all.rp_filter = 1\" \"net.ipv4.conf.default.rp_filter = 1\" >> /etc/sysctl.d/60 -netipv4_sysctl.conf\nRun the following script to set the active kernel parameters:\n#!/usr/bin/env bash sysctl -w net.ipv4.conf.all.rp_filter=1 sysctl -w net.ipv4.conf.default.rp_filter=1 sysctl -w net.ipv4.route.flush=1 Note: If these settings appear in a canonically later file, or later in the same file, these\nsettings will be overwritten"
    },
    {
      "id": "3.3.8",
      "title": "Ensure source routed packets are not accepted",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "MultiKernelParameter",
      "parameters": [
        {
          "name": "net.ipv4.conf.all.accept_source_route",
          "expected_value": "0"
        },
        {
          "name": "net.ipv4.conf.default.accept_source_route",
          "expected_value": "0"
        },
        {
          "name": "net.ipv6.conf.all.accept_source_route",
          "expected_value": "0"
        },
        {
          "name": "net.ipv6.conf.default.accept_source_route",
          "expected_value": "0"
        }
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.8",
      "description": "In networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non -source routed packets travel a path determined by routers in the network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.",
      "remediation": "Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending in .conf :\n• net.ipv4.conf.all.accept_source_route = 0 • net.ipv4.conf.default.accept_source_route = 0 Example:\n# printf '%s ' \"net.ipv4.conf.all.accept_source_route = 0\" \"net.ipv4.conf.default.accept_source_route = 0\" >> /etc/sysctl.d/60 - netipv4_sysctl.conf\nRun the following script to set the active kernel parameters:\n#!/usr/bin/env bash sysctl -w net.ipv4.conf.all.accept_source_route=0 sysctl -w net.ipv4.conf.default.accept_source_route=0 sysctl -w net.ipv4.route.flush=1 - IF - IPv6 is enabled on the system:\nSet the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending in .conf :\n• net.ipv6.conf.all.accept_source_route = 0 • net.ipv6.conf.default.accept_source_route = 0 Example:\n# printf '%s ' \"net.ipv6.conf.all.accept_source_route = 0\" \"net.ipv6.conf.default.accept_source_route = 0\" >> /etc/sysctl.d/60 - netipv6_sysctl.conf\nRun the following command to set the active kernel parameters:\n#!/usr/bin/env bash sysctl -w net.ipv6.conf.all.accept_source_route=0 sysctl -w net.ipv6.conf.default.accept_source_route=0 sysctl -w net.ipv6.route.flush=1 Note: If these settings appear in a canonically later file, or later in the same file, these\nsettings will be overwritten"
    },
    {
      "id": "3.3.9",
      "title": "Ensure suspicious packets are logged",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "MultiKernelParameter",
      "parameters": [
        {
          "name": "net.ipv4.conf.all.log_martians",
          "expected_value": "1"
        },
        {
          "name": "net.ipv4.conf.default.log_martians",
          "expected_value": "1"
        }
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.9",
      "description": "When enabled, this feature logs packets with un -routable source addresses to the kernel log.",
      "remediation": "Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending in .conf :\n• net.ipv4.conf.all.log_martians = 1 • net.ipv4.conf.default.log_martians = 1 Example:\n# printf '%s ' \"net.ipv4.conf.all.log_martians = 1\" \"net.ipv4.conf.default.log_martians = 1\" >> /etc/sysctl.d/60 - netipv4_sysctl.conf\nRun the following script to set the active kernel parameters:\n#!/usr/bin/env bash sysctl -w net.ipv4.conf.all.log_martians=1 sysctl -w net.ipv4.conf.default.log_martians=1 sysctl -w net.ipv4.route.flush=1 Note: If these settings appear in a canonically later file, or later in the same file, these\nsettings will be overwritten"
    },
    {
      "id": "3.3.10",
      "title": "Ensure tcp syn cookies is enabled",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "KernelParameter",
      "parameter": "net.ipv4.tcp_syncookies",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.10",
      "description": "When tcp_syncookies is set, the kernel will handle TCP SYN packets normally until the half -open connection queue is full, at which time, the SYN cookie functionality kicks in. SYN cookies work by not using the SYN queue at all. Instead, the kernel simply replies to the SYN w ith a SYN/ACK, but will include a specially crafted TCP sequence number that encodes the source and destination IP address and port number and the time the packet was sent. A legitimate connection would send the ACK packet of the three w ay handshake with the specially crafted sequence number. This allows the system to verify that it has received a valid response to a SYN cookie and allow the connection, even though there is no corresponding SYN in the queue.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending in .conf :\n• net.ipv4.tcp_syncookies = 1 Example:\n# printf '%s ' \"net.ipv4.tcp_syncookies = 1\" >> /etc/sysctl.d/60 - netipv4_sysctl.conf\nRun the following script to set the active kernel parameters:\n#!/usr/bin/env bash sysctl -w net.ipv4.tcp_syncookies=1 sysctl -w net.ipv4.route.flush=1 Note: If these settings appear in a canonically later file, or later in the same file, these\nsettings will be overwritten"
    },
    {
      "id": "3.3.11",
      "title": "Ensure ipv6 router advertisements are not accepted",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "MultiKernelParameter",
      "parameters": [
        {
          "name": "net.ipv6.conf.all.accept_ra",
          "expected_value": "0"
        },
        {
          "name": "net.ipv6.conf.default.accept_ra",
          "expected_value": "0"
        }
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.11",
      "description": "Routers periodically multicast Router Advertisement messages to announce their availability and convey information to neighboring nodes that enable them to be automatically configured on the network.\nnet.ipv6.conf.all.accept_ra and net.ipv6.conf.default.accept_ra determine the systems ability to accept these advertisements",
      "remediation": "- IF - IPv6 is enabled on the system:\nSet the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending in .conf :\n• net.ipv6.conf.all.accept_ra = 0 • net.ipv6.conf.default.accept_ra = 0 Example:\n# printf '%s ' \"net.ipv6.conf.all.accept_ra = 0\" \"net.ipv6.conf.default.accept_ra = 0\" >> /etc/sysctl.d/60 -netipv6_sysctl.conf\nRun the following script to set the active kernel parameters:\n#!/usr/bin/env bash sysctl -w net.ipv6.conf.all.accept_ra=0 sysctl -w net.ipv6.conf.default.accept_ra=0 sysctl -w net.ipv6.route.flush=1 Note: If these settings appear in a canonically later file, or later in the same file, these\nsettings will be overwritten"
    }
  ]
}