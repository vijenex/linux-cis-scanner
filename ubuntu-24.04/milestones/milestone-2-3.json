{
  "milestone": "2.3 Time Synchronization & 2.4 Job Schedulers",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Sections 2.3 Time Synchronization & 2.4 Job Schedulers",
  "controls": [
    {
      "id": "2.3.1.1",
      "title": "Ensure a single time synchronization daemon is in use",
      "section": "Services",
      "description": "System time should be synchronized between all systems in an environment. This is typically done by establishing an authoritative time server or set of servers and having all systems synchronize their clocks to them.",
      "rationale": "Time synchronization is important to support time sensitive security mechanisms like Kerberos and also ensures log files have consistent time records across the enterprise, which aids in forensic investigations.",
      "impact": "Only one time synchronization method should be used. If multiple time synchronization methods are used, it may lead to unexpected behavior.",
      "remediation": "Run one of the following commands to enable either systemd-timesyncd or chrony, but not both: systemctl --now enable systemd-timesyncd OR systemctl --now enable chrony",
      "profile": "Level1",
      "type": "SingleLoggingSystem",
      "logging_services": ["systemd-timesyncd", "chrony", "ntp"]
    },
    {
      "id": "2.3.2.1",
      "title": "Ensure systemd-timesyncd configured with authorized timeserver",
      "section": "Services",
      "description": "systemd-timesyncd is a daemon that has been added for time synchronization. The local clock is synchronized to a remote Network Time Protocol server.",
      "rationale": "Proper configuration is vital to ensuring time synchronization is working properly. Misconfigured time synchronization may result in inconsistent or unreliable time synchronization.",
      "impact": "Proper time synchronization is important for authentication services that use time sensitive authentication mechanisms such as Kerberos.",
      "remediation": "Edit /etc/systemd/timesyncd.conf and add/modify the following lines in the [Time] section: NTP=<space_separated_list_of_servers> FallbackNTP=<space_separated_list_of_fallback_servers>",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/systemd/timesyncd.conf",
      "pattern": "NTP=",
      "expected_match": true
    },
    {
      "id": "2.3.2.2",
      "title": "Ensure systemd-timesyncd is enabled and running",
      "section": "Services",
      "description": "systemd-timesyncd is a daemon that has been added for time synchronization.",
      "rationale": "Proper time synchronization is important for authentication services that use time sensitive authentication mechanisms such as Kerberos. systemd-timesyncd is the default time synchronization service and should be configured to run.",
      "impact": "The systemd-timesyncd service must be enabled and running for time synchronization to work.",
      "remediation": "Run the following command to enable and start systemd-timesyncd: systemctl --now enable systemd-timesyncd",
      "profile": "Level1",
      "type": "Service",
      "service_name": "systemd-timesyncd",
      "expected_status": "enabled"
    },
    {
      "id": "2.3.3.1",
      "title": "Ensure chrony is configured with authorized timeserver",
      "section": "Services",
      "description": "chrony is a daemon which implements the Network Time Protocol (NTP). It is designed to perform well in a wide range of conditions, including intermittent network connections, heavily congested networks, changing temperatures, and systems that do not run continuously, or run on a virtual machine.",
      "rationale": "If chrony is in use on the system proper configuration is vital to ensuring time synchronization is working properly.",
      "impact": "Proper time synchronization is important for authentication services that use time sensitive authentication mechanisms such as Kerberos.",
      "remediation": "Edit /etc/chrony/chrony.conf and add or edit server or pool lines as appropriate: server <remote-server>",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/chrony/chrony.conf",
      "pattern": "^(server|pool)",
      "expected_match": true
    },
    {
      "id": "2.3.3.2",
      "title": "Ensure chrony is running as user _chrony",
      "section": "Services",
      "description": "The chrony package is installed with a dedicated user account _chrony. This account is used to run the chronyd daemon.",
      "rationale": "Running chronyd as a non-privileged user helps to mitigate the impact of potential security vulnerabilities.",
      "impact": "None.",
      "remediation": "Edit /etc/chrony/chrony.conf and add or edit the user line: user _chrony",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/chrony/chrony.conf",
      "pattern": "user _chrony",
      "expected_match": true
    },
    {
      "id": "2.3.3.3",
      "title": "Ensure chrony is enabled and running",
      "section": "Services",
      "description": "chrony is a daemon which implements the Network Time Protocol (NTP).",
      "rationale": "If chrony is in use on the system, then chrony should be enabled and running to ensure time synchronization.",
      "impact": "The chrony service must be enabled and running for time synchronization to work.",
      "remediation": "Run the following command to enable and start chrony: systemctl --now enable chrony",
      "profile": "Level1",
      "type": "Service",
      "service_name": "chrony",
      "expected_status": "enabled"
    },
    {
      "id": "2.4.1.1",
      "title": "Ensure cron daemon is enabled and active",
      "section": "Services",
      "description": "The cron daemon is used to execute batch jobs on the system.",
      "rationale": "While there may not be user jobs that need to be run on the system, the system does have maintenance jobs that may include security monitoring that have to run, and cron is used to execute them.",
      "impact": "The cron service is required for time-based job scheduling.",
      "remediation": "Run the following command to enable and start cron: systemctl --now enable cron",
      "profile": "Level1",
      "type": "Service",
      "service_name": "cron",
      "expected_status": "enabled"
    },
    {
      "id": "2.4.1.2",
      "title": "Ensure access to /etc/crontab is configured",
      "section": "Services",
      "description": "The /etc/crontab file is used by cron to determine what cron jobs to run.",
      "rationale": "This file contains information on what system jobs are run by cron. Write access to these files could provide unprivileged users with the ability to elevate their privileges. Read access to these files could provide users with the ability to gain insight on system jobs that run on the system and could provide them a way to gain unauthorized privileged access.",
      "impact": "Setting strict permissions on the crontab file will prevent unauthorized users from viewing or modifying the system cron jobs.",
      "remediation": "Run the following commands to set ownership and permissions on /etc/crontab: chown root:root /etc/crontab, chmod og-rwx /etc/crontab",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/crontab",
      "expected_mode": "600",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "2.4.1.3",
      "title": "Ensure access to /etc/cron.hourly is configured",
      "section": "Services",
      "description": "This directory contains system cron jobs that need to run on an hourly basis.",
      "rationale": "Granting write access to this directory for non-privileged users could provide them the means to gain unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.",
      "impact": "Setting strict permissions on the cron.hourly directory will prevent unauthorized users from viewing or modifying hourly cron jobs.",
      "remediation": "Run the following commands to set ownership and permissions on /etc/cron.hourly: chown root:root /etc/cron.hourly, chmod og-rwx /etc/cron.hourly",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/cron.hourly",
      "expected_mode": "700",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "2.4.1.4",
      "title": "Ensure access to /etc/cron.daily is configured",
      "section": "Services",
      "description": "The /etc/cron.daily directory contains system cron jobs that need to run on a daily basis.",
      "rationale": "Granting write access to this directory for non-privileged users could provide them the means to gain unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.",
      "impact": "Setting strict permissions on the cron.daily directory will prevent unauthorized users from viewing or modifying daily cron jobs.",
      "remediation": "Run the following commands to set ownership and permissions on /etc/cron.daily: chown root:root /etc/cron.daily, chmod og-rwx /etc/cron.daily",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/cron.daily",
      "expected_mode": "700",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "2.4.1.5",
      "title": "Ensure access to /etc/cron.weekly is configured",
      "section": "Services",
      "description": "The /etc/cron.weekly directory contains system cron jobs that need to run on a weekly basis.",
      "rationale": "Granting write access to this directory for non-privileged users could provide them the means to gain unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.",
      "impact": "Setting strict permissions on the cron.weekly directory will prevent unauthorized users from viewing or modifying weekly cron jobs.",
      "remediation": "Run the following commands to set ownership and permissions on /etc/cron.weekly: chown root:root /etc/cron.weekly, chmod og-rwx /etc/cron.weekly",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/cron.weekly",
      "expected_mode": "700",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "2.4.1.6",
      "title": "Ensure access to /etc/cron.monthly is configured",
      "section": "Services",
      "description": "The /etc/cron.monthly directory contains system cron jobs that need to run on a monthly basis.",
      "rationale": "Granting write access to this directory for non-privileged users could provide them the means to gain unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.",
      "impact": "Setting strict permissions on the cron.monthly directory will prevent unauthorized users from viewing or modifying monthly cron jobs.",
      "remediation": "Run the following commands to set ownership and permissions on /etc/cron.monthly: chown root:root /etc/cron.monthly, chmod og-rwx /etc/cron.monthly",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/cron.monthly",
      "expected_mode": "700",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "2.4.1.7",
      "title": "Ensure access to /etc/cron.yearly is configured",
      "section": "Services",
      "description": "The /etc/cron.yearly directory contains system cron jobs that need to run on a yearly basis.",
      "rationale": "Granting write access to this directory for non-privileged users could provide them the means to gain unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.",
      "impact": "Setting strict permissions on the cron.yearly directory will prevent unauthorized users from viewing or modifying yearly cron jobs.",
      "remediation": "Run the following commands to set ownership and permissions on /etc/cron.yearly: chown root:root /etc/cron.yearly, chmod og-rwx /etc/cron.yearly",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/cron.yearly",
      "expected_mode": "700",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "2.4.1.8",
      "title": "Ensure access to /etc/cron.d is configured",
      "section": "Services",
      "description": "The /etc/cron.d directory contains system cron jobs that need to run in a similar manner to the hourly, daily weekly and monthly jobs from /etc/crontab, but require more granular control as to when they run.",
      "rationale": "Granting write access to this directory for non-privileged users could provide them the means to gain unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.",
      "impact": "Setting strict permissions on the cron.d directory will prevent unauthorized users from viewing or modifying cron jobs.",
      "remediation": "Run the following commands to set ownership and permissions on /etc/cron.d: chown root:root /etc/cron.d, chmod og-rwx /etc/cron.d",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/cron.d",
      "expected_mode": "700",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "2.4.1.9",
      "title": "Ensure access to crontab is configured",
      "section": "Services",
      "description": "Configure /etc/cron.allow and /etc/at.allow to allow specific users to use these services. If /etc/cron.allow or /etc/at.allow do not exist, then /etc/at.deny and /etc/cron.deny are checked. Any user not specifically defined in those files is allowed to use at and cron. By removing the files, only users in /etc/cron.allow and /etc/at.allow are allowed to use at and cron.",
      "rationale": "On many systems, only the system administrator is authorized to schedule cron jobs. Using the cron.allow file to control who can run cron jobs enforces this policy. It is easier to manage an allow list than a deny list. In a deny list, you could potentially add a user ID to the system and forget to add it to the deny files.",
      "impact": "All users except those listed in /etc/cron.allow will be prevented from using cron.",
      "remediation": "Run the following commands to remove /etc/cron.deny and /etc/at.deny and create and set permissions and ownership for /etc/cron.allow and /etc/at.allow: rm /etc/cron.deny, rm /etc/at.deny, touch /etc/cron.allow, touch /etc/at.allow, chmod og-rwx /etc/cron.allow, chmod og-rwx /etc/at.allow, chown root:root /etc/cron.allow, chown root:root /etc/at.allow",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "2.4.2.1",
      "title": "Ensure access to at is configured",
      "section": "Services",
      "description": "Configure /etc/cron.allow and /etc/at.allow to allow specific users to use these services. If /etc/cron.allow or /etc/at.allow do not exist, then /etc/at.deny and /etc/cron.deny are checked. Any user not specifically defined in those files is allowed to use at and cron. By removing the files, only users in /etc/cron.allow and /etc/at.allow are allowed to use at and cron.",
      "rationale": "On many systems, only the system administrator is authorized to schedule at jobs. Using the at.allow file to control who can run at jobs enforces this policy. It is easier to manage an allow list than a deny list. In a deny list, you could potentially add a user ID to the system and forget to add it to the deny files.",
      "impact": "All users except those listed in /etc/at.allow will be prevented from using at.",
      "remediation": "Run the following commands to remove /etc/at.deny and create and set permissions and ownership for /etc/at.allow: rm /etc/at.deny, touch /etc/at.allow, chmod og-rwx /etc/at.allow, chown root:root /etc/at.allow",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/at.allow",
      "expected_mode": "600",
      "expected_owner": "root",
      "expected_group": "root"
    }
  ]
}