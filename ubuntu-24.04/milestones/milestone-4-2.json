{
  "milestone": "4.2",
  "title": "Configure UncomplicatedFirewall",
  "description": "CIS Ubuntu Linux 24.04 LTS Benchmark - Section 4.2: Configure UncomplicatedFirewall",
  "version": "1.0.0",
  "controls": [
    {
      "id": "4.2.1",
      "title": "Ensure ufw is installed",
      "section": "4.2 Configure UncomplicatedFirewall",
      "profile": "Level1",
      "automated": true,
      "type": "Package",
      "package_name": "ufw",
      "should_be_installed": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.2.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.2.2",
      "title": "Ensure iptables-persistent is not installed with ufw",
      "section": "4.2 Configure UncomplicatedFirewall",
      "profile": "Level1",
      "automated": true,
      "type": "Package",
      "package_name": "iptables-persistent",
      "should_be_installed": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.2.2",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.2.3",
      "title": "Ensure ufw service is enabled",
      "section": "4.2 Configure UncomplicatedFirewall",
      "profile": "Level1",
      "automated": true,
      "type": "UFWStatus",
      "expected_status": "active",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.2.3",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.2.4",
      "title": "Ensure ufw loopback traffic is configured",
      "section": "4.2 Configure UncomplicatedFirewall",
      "profile": "Level1",
      "automated": true,
      "type": "UFWLoopback",
      "expected_rules": [
        "allow in on lo",
        "allow out on lo",
        "deny in from 127.0.0.0/8",
        "deny in from ::1"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.2.4",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.2.5",
      "title": "Ensure ufw outbound connections are configured",
      "section": "4.2 Configure UncomplicatedFirewall",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "expected": "UFW outbound connections configured according to site policy",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.2.5",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.2.6",
      "title": "Ensure ufw firewall rules exist for all open ports",
      "section": "4.2 Configure UncomplicatedFirewall",
      "profile": "Level1",
      "automated": true,
      "type": "UFWOpenPorts",
      "check_open_ports": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.2.6",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    },
    {
      "id": "4.2.7",
      "title": "Ensure ufw default deny firewall policy",
      "section": "4.2 Configure UncomplicatedFirewall",
      "profile": "Level1",
      "automated": true,
      "type": "UFWDefaultPolicy",
      "expected_policies": {
        "incoming": "deny",
        "outgoing": "deny",
        "routed": "deny"
      },
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.2.7",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 24.04 Benchmark document at the above URL."
    }
  ]
}