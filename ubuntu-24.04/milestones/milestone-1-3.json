{
  "milestone": "1.3",
  "title": "Mandatory Access Control",
  "description": "CIS Ubuntu Linux 24.04 LTS Benchmark - Section 1.3: Mandatory Access Control",
  "version": "1.0.0",
  "controls": [
    {
      "id": "1.3.1.1",
      "title": "Ensure AppArmor is installed",
      "section": "1.3.1 Configure AppArmor",
      "profile": "Level1",
      "automated": true,
      "type": "Package",
      "package_name": "apparmor",
      "should_be_installed": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.3.1.1",
      "description": "AppArmor provides Mandatory Access Controls.",
      "remediation": "Install AppArmor.\n# apt install apparmor apparmor -utils"
    },
    {
      "id": "1.3.1.2",
      "title": "Ensure AppArmor is enabled in the bootloader configuration",
      "section": "1.3.1 Configure AppArmor",
      "profile": "Level1",
      "automated": true,
      "type": "BootParameter",
      "parameters": [
        "apparmor=1",
        "security=apparmor"
      ],
      "config_file": "/etc/default/grub",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.3.1.2",
      "description": "Configure AppArmor to be enabled at boot time and verify that it has not been overwritten by the bootloader boot parameters.\nNote: This recommendation is designed around the grub bootloader, if LILO or another bootloader is in use in your environment enact equivalent settings.",
      "remediation": "Edit /etc/default/grub and add the apparmor=1 and security=apparmor parameters to the GRUB_CMDLINE_LINUX= line GRUB_CMDLINE_LINUX=\"apparmor=1 security=apparmor\"\nRun the following command to update the grub2 configuration:\n# update -grub"
    },
    {
      "id": "1.3.1.3",
      "title": "Ensure all AppArmor Profiles are in enforce or complain mode",
      "section": "1.3.1 Configure AppArmor",
      "profile": "Level1",
      "automated": true,
      "type": "AppArmorProfile",
      "expected_modes": [
        "enforce",
        "complain"
      ],
      "check_unconfined": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.3.1.3",
      "description": "AppArmor profiles define what resources applications are able to access.",
      "remediation": "Run the following command to set all profiles to enforce mode:\n# aa-enforce /etc/apparmor.d/* - OR -\nRun the following command to set all profiles to complain mode:\n# aa-complain /etc/apparmor.d/* Note: Any unconfined processes may need to have a profile created or activated for them and then be restarted."
    },
    {
      "id": "1.3.1.4",
      "title": "Ensure all AppArmor Profiles are enforcing",
      "section": "1.3.1 Configure AppArmor",
      "profile": "Level2",
      "automated": true,
      "type": "AppArmorProfile",
      "expected_modes": [
        "enforce"
      ],
      "check_unconfined": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.3.1.4",
      "description": "AppArmor profiles define what resources applications are able to access.",
      "remediation": "Run the following command to set all profiles to enforce mode:\n# aa-enforce /etc/apparmor.d/* Note: Any unconfined processes may need to have a profile created or activated for them and then be restarted"
    }
  ]
}