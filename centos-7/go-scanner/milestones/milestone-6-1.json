{
  "milestone": "6.1",
  "version": "1.0.0",
  "description": "CentOS Linux 7 CIS Benchmark v3.1.2 - Section 6.1",
  "controls": [
    {
      "id": "6.1.10",
      "title": "Ensure no world writable files exist",
      "section": "Section 6.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.1.10",
      "description": "Unix -based systems support variable settings to control access to files. World writable files are the least secure. See the chmod(2) man page for more information.",
      "rationale": "Data in world -writable files can be modified and compromised by any user on the system. World writable files may also indicate an incorrectly written script or program that could potentially be the cause of a larger compromise to the system's i ntegrity.",
      "remediation": ": Removing write access for the \"other\" category ( chmod o-w <filename> ) is advisable, but always consult relevant vendor documentation to avoid breaking any application dependencies on a given file. 561 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non-computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configuration s Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf v7 13 Data Protection Data Protection 562 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify no files are returned: # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type f -perm -0002 The command above only searches local filesystems, there may still be compromised items on network mounted partitions. Additionally the --local option to df is not universal to all versions, it can be omitted to search all filesystems on a system including network mounted filesystems or the following command can be run manually for eac h partition: # find <partition> -xdev -type f -perm -0002"
    },
    {
      "id": "6.1.11",
      "title": "Ensure no unowned files or directories exist",
      "section": "Section 6.1",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.1.11",
      "description": "Sometimes when administrators delete users from the password file they neglect to remove all files owned by those users from the system.",
      "rationale": "A new user who is assigned the deleted user's user ID or group ID may then end up \"owning\" these files, and thus have more access on the system than was intended.",
      "remediation": ": Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate. 563 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 13.2 Remove Sensitive Data or Systems Not Regularly Accessed by Organization Remove sensitive data or systems not regularly accessed by the organization from the network. These systems shall only be used as stand alone systems (disconnected from the network) by the business unit needing to occasionally use the system or completely virtualized and powered off until needed. \u25cf \u25cf \u25cf 564 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify no files are returned: # df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nouser The command above only searches local filesystems, there may still be compromised items on network mounted partitions. Additionally the --local option to df is not universal to all versions, it can be omitted to search all filesystems on a system including network mounted filesystems or the following command can be run manually for each partition: # find <partition> -xdev -nouser"
    },
    {
      "id": "6.1.12",
      "title": "Ensure no ungrouped files or directories exist",
      "section": "Section 6.1",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.1.12",
      "description": "Ensure no ungrouped files or directories exist",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "SUID executables (Manual) ................................ ................................ ............. 566 6.1.14 Audit SGID executables (Manual) ................................ ................................ ............. 568 6.2 User and Group Settings ................................ ................................ ................................ ............... 570 12 | P a g e"
    },
    {
      "id": "6.1.2",
      "title": "Ensure permissions on /etc/passwd are configured",
      "section": "Section 6.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.1.2",
      "description": "The /etc/passwd file contains user account information that is used by many system utilities and therefore must be readable for these utilities to operate.",
      "rationale": "It is critical to ensure that the /etc/passwd file is protected from unauthorized write access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "remediation": ": Run the following commands to set owner, group, and permissions on /etc/passwd : # chown root:root /etc/passwd # chmod u -x,g-wx,o-wx /etc/passwd 545 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their respon sibilities. \u25cf \u25cf \u25cf 546 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command a nd verify Uid and Gid are both 0/root and Access is 644 or more restrictive: # stat /etc/passwd Access: (0644/ -rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)",
      "file_path": "/etc/passwd"
    },
    {
      "id": "6.1.3",
      "title": "Ensure permissions on /etc/passwd - are configured",
      "section": "Section 6.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.1.3",
      "description": "The /etc/passwd - file contains backup user account information.",
      "rationale": "It is critical to ensure that the /etc/passwd - file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "remediation": ": Run the following commands to set owner, group, and permissions on /etc/passw d- : # chown root:root /etc/passwd - # chmod u -x,go-wx /etc/passwd - 547 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibiliti es. \u25cf \u25cf \u25cf 548 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and ve rify Uid and Gid are both 0/root and Access is 644 or more restrictive: # stat /etc/passwd - Access: (0644/ -rw-------) Uid: ( 0/ root) Gid: ( 0/ root)",
      "file_path": "/etc/passwd"
    },
    {
      "id": "6.1.4",
      "title": "Ensure permissions on /etc/shadow are configured",
      "section": "Section 6.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.1.4",
      "description": "The /etc/shadow file is used to store the information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.",
      "rationale": "If attackers can gain read access to the /etc/shadow file, they can easily run a password cracking program against the hashed password to break it. Other security information that is stored in the /etc/shadow file (such as expiration) could also be useful to subvert the user accounts.",
      "remediation": ": Run the following commands to set owner, group, and permissions on /etc/shadow : # chown root:root /etc/ shadow # chmod 0000 /etc/shadow 549 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. \u25cf \u25cf \u25cf 550 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify Uid and Gid are 0/root , and Access is 0000 : # stat /etc/shadow Access: (0000/ ---------- ) Uid: ( 0/ root) Gid: ( 0/ root)",
      "file_path": "/etc/shadow"
    },
    {
      "id": "6.1.5",
      "title": "Ensure permissi ons on /etc/shadow - are configured",
      "section": "Section 6.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.1.5",
      "description": "The /etc/shadow - file is used to store backup information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.",
      "rationale": "It is critical to ensure that the /etc/shadow - file is protected from u nauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "remediation": ": Run the following commands to set owner, group, and permissions on /etc/shadow - : # chown root:root /etc/shadow - # chmod 0000 /etc/shadow - 551 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. \u25cf \u25cf \u25cf 552 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify Uid is 0/root, Gid is 0/root and Access is 0000 : # stat /etc/shad ow- Access: (0000/ ---------- ) Uid: ( 0/ root) Gid: ( 0/ root)",
      "file_path": "/etc/shadow"
    },
    {
      "id": "6.1.6",
      "title": "Ensure permissions on /etc/gshadow - are configured",
      "section": "Section 6.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.1.6",
      "description": "The /etc/gshadow - file is used to store backup information about groups that is critical to the security of those accounts, such as the hashed password and other security information.",
      "rationale": "It is critical to ensure that the /etc/gshadow - file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "remediation": ": Run the following commands to set owner, group, and permissions on /etc/gshadow- : # chown root:root /etc/gshadow - # chmod 0000 /etc/gshadow - 553 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 16.4 Encrypt or Hash all Authentication Credentials Encrypt or hash with a salt all authentication credentials when stored. \u25cf \u25cf 554 | P a g e",
      "impact": "None",
      "audit_command": "Run the following co mmand and verify verify Uid is 0/root, Gid is 0/root and Access is 0000 : # stat /etc/gshadow - Access: (0000/ ---------- ) Uid: ( 0/ root) Gid: ( 0/ root)",
      "file_path": "/etc/gshadow"
    },
    {
      "id": "6.1.7",
      "title": "Ensure permissions on /etc/gshadow are configured",
      "section": "Section 6.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.1.7",
      "description": "The /etc/gshadow file is used to store the information about groups that is critical to the security of those accounts, such as the hashed password and other security information.",
      "rationale": "If attackers can gain read access to the /etc/gshadow file, they can easily run a password cracking program against the hashed password to break it. Other security information that is stored in the /etc/gshadow file (such as group administrators) could also be useful to subvert the group.",
      "remediation": ": Run the following commands to set owner, group, and permissions on /etc/gshadow : # chown root:root /e tc/gshadow # chmod 0000 /etc/gshadow 555 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. \u25cf \u25cf \u25cf 556 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify Uid is 0/root, Gid is 0/root and Access is 0000 : # stat /etc/gshadow Access: (0000/ ---------- ) Uid: ( 0/ root) Gid: ( 0/ root)",
      "file_path": "/etc/gshadow"
    },
    {
      "id": "6.1.8",
      "title": "Ensure permissi ons on /etc/group are configured",
      "section": "Section 6.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.1.8",
      "description": "The /etc/group file contains a list of all the valid groups defined in the system. The command below allows read/write access for root and read access for everyone else.",
      "rationale": "The /etc/group file needs to be protected from unauthorized changes by non -privileged users, but needs to be readable as this information is used with many non -privileged programs.",
      "remediation": ": Run the following commands to set owner, group, and permissions on /etc/group : # chown root:root /etc/group # chmod u -x,g-wx,o-wx /etc/group 557 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized indi viduals should have access to the information based on their need to access the information as a part of their responsibilities. \u25cf \u25cf \u25cf 558 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify Uid and Gid are both 0/root and Access is 644 or more restrictive: # stat /etc/group Access: (0644/ -rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)",
      "file_path": "/etc/group"
    },
    {
      "id": "6.1.9",
      "title": "Ensure permissions on /etc/group - are configured",
      "section": "Section 6.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.1.9",
      "description": "The /etc/group - file contains a backup list of all the valid groups defined in the system.",
      "rationale": "It is critical to ensure that the /etc/group - file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "remediation": ": Run the following commands to set owner, group, and permissions on /etc/group -: # chown root:root /etc/group - # chmod u -x,go-wx /etc/group - 559 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. \u25cf \u25cf \u25cf 560 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify Uid and Gid are both 0/root and Access is 644 or more restrictive: # stat /etc/group - Access: (0644/ -rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)",
      "file_path": "/etc/group"
    }
  ]
}