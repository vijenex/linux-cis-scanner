{
  "milestone": "6.2",
  "version": "1.0.0",
  "description": "CentOS Linux 7 CIS Benchmark v3.1.2 - Section 6.2",
  "controls": [
    {
      "id": "6.2.1",
      "title": "Ensure accounts in /etc/passwd use shadowed passwords",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.1",
      "description": "Local accounts can uses shadowed passwords. With shadowed passwords, The passwords are saved in shadow password file, /etc/shadow , encrypted by a salted one -way hash. Accounts with a shadowed passwor d have an x in the second field in /etc/passwd .",
      "rationale": "The /etc/passwd file also contains information like user ID's and group ID's that are used by many system programs. Therefore, the /etc/passwd file must remain world readable. In spite of encoding the password with a randomly -generated one -way hash function, an attacker could still break the system if they got access to the /etc/passwd file. This can be mitigated by using shadowed passwords, thus moving the passwords in the /etc/passwd file to /etc/shadow . The /etc/shadow file is set so only root will be able to read and write. This helps mitigate the risk of an attacker gaining access to the encoded passwords with which to perform a dictionary attack. Notes: \uf0b7 All accounts must have passwords or be lo cked to prevent the account from being used by an unauthorized user. \uf0b7 A user account with an empty second field in /etc/passwd allows the account to be logged into by providing only the username.",
      "remediation": ": If any accounts in the /etc/passwd file do not have a single x in the password field, run the following command to set these accounts to use s hadowed passwords: # sed -e 's/^\\([a-zA-Z0-9_]*\\):[^:]*:/ \\1:x:/' -i /etc/passwd Investigate to determine if the account is logged in and what it is being used for, to determine if it needs to be forced off. CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.11 Encrypt Sensitive Data at Rest Encrypt sensitive data at rest on servers, applications, and databases containing sensitive data. Storage -layer encryption, also known as server -side encryption, meets the minimum requirement of this Safeguard. Additional encryption methods may include application -layer encryption, also known as client -side encryption, where access to the data storage device(s) does not permit access to the plain -text data. \u25cf \u25cf v7 4.4 Use Unique Passwords Where multi -factor authentication is not supported (such as local administrator, root, or service accounts), accounts will use passwords that are unique to that system. \u25cf \u25cf 573 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify that no output is returned: # awk -F: '($2 != \"x\" ) { print $1 \" is not set to shadowed passwords \"}' /etc/passwd 572 | P a g e",
      "file_path": "/etc/passwd",
      "pattern": "password|authentication"
    },
    {
      "id": "6.2.10",
      "title": "Ensure root PATH Integrity",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.10",
      "description": "The root user can execute any command on the system and could be fooled into executing programs unintentionally if the PATH is not set correctly.",
      "rationale": "Including the current working directory (.) or other writable directory in root 's executable path makes it likely that an attacker can gain superuser access by forcing an administrator operating as root to execute a Trojan horse program.",
      "remediation": ": Correct or justify any items discovered in the Audit step. 589 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when sig nificant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 590 | P a g e",
      "impact": "None",
      "audit_command": "Run the following script and verify no results are returned: #!/bin/bash RPCV=\"$(sudo -Hiu root env | grep '^PATH' | cut -d= -f2)\" echo \"$RPCV\" | grep -q \"::\" && echo \"root's path contains a empty directory (::)\" echo \"$RPCV\" | grep -q \":$\" && echo \"root's path contains a trailing (:)\" for x in $(echo \"$RPCV\" | tr \":\" \" \"); do if [ -d \"$x\" ]; then ls -ldH \"$x\" | awk '$9 == \".\" {print \"PATH contains current working directory (.)\"} $3 != \"root\" {print $9, \"is not owned by root\"} substr($1,6,1) != \" -\" {print $9, \"is group writable\"} substr($1,9,1) != \" -\" {print $9, \"is world writable\"}' else echo \"$x is not a directory\" fi done"
    },
    {
      "id": "6.2.11",
      "title": "Ensure all users' home directories exist",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.11",
      "description": "Users can be defined in /etc/passwd without a home directory or with a home directory that does not actually exist.",
      "rationale": "If the user's home directory does not exist or is unassigned, the user will be placed in \"/\" and will not be able to write any files or have local environment variables set.",
      "remediation": ": If any users' home directories do not exist, create them and make sure the respective user owns the d irectory. Users without an assigned home directory should be removed or assigned a home directory as appropriate. The following script will create a home directory for users with an interactive shell whose home directory doesn't exist: #!/bin/bash awk -F: '($1!~/(halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\/usr)?\\/sbin\\/nologin( \\/)?$/ && $7!~/( \\/usr)?\\/bin\\/false(\\/)?$/) { print $1 \" \" $6 }' /etc/passwd | while read -r user dir; do if [ ! -d \"$dir\" ]; then mkdir \"$dir\" chmod g-w,o-wrx \"$dir\" chown \"$user\" \"$dir\" fi done CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 592 | P a g e",
      "impact": "None",
      "audit_command": "Run the following script and verify no results are returned: #!/bin/bash awk -F: '($1!~/(halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\/usr)?\\/sbin\\/nologin( \\/)?$/ && $7!~/( \\/usr)?\\/bin\\/false(\\/)?$/) { print $1 \" \" $6 }' /etc/passwd | while read -r user dir; do if [ ! -d \"$dir\" ]; then echo \"User: \\\"$user\\\" home directory: \\\"$dir\\\" does not exist.\" fi done Note: The audit script checks all users with interactive shells except halt, sync, shutdown, and nfsnobody. 591 | P a g e",
      "file_path": "/etc/passwd",
      "pattern": ".*"
    },
    {
      "id": "6.2.12",
      "title": "Ensure users own their home directories",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.12",
      "description": "The user home directory is space defined for the particular user to set local environment variables and to store personal files.",
      "rationale": "Since the user is accountable for files stored in the user home directory, the user must be the owner of the directory.",
      "remediation": ": Change the ownership of any home directories that are not owned by the defined user to the correct user. The following script will create missing home directories, set the owner, and set the permissions for interactive users' home directories: #!/bin/bash awk -F: '($1!~/(halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\/usr)?\\/sbin\\/nologin( \\/)?$/ && $7!~/( \\/usr)?\\/bin\\/false(\\/)?$/) { print $1 \" \" $6 }' /etc/passwd | while read -r user dir; do if [ ! -d \"$dir\" ]; then echo \"User: \\\"$user\\\" home directory: \\\"$dir\\\" does not exist, creating home directory\" mkdir \"$dir\" chmod g-w,o-rwx \"$dir\" chown \"$user\" \"$dir\" else owner=$(stat -L -c \"%U\" \"$dir\") if [ \"$owner\" != \"$user\" ]; then chmod g-w,o-rwx \"$dir\" chown \"$user\" \"$dir\" fi fi done CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the informati on based on their need to access the information as a part of their responsibilities. \u25cf \u25cf \u25cf 594 | P a g e",
      "impact": "None",
      "audit_command": "Run the following script and verify no results are returned: #!/bin/bash awk -F: '($1!~/(halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\/usr)?\\/sbin\\/nologin( \\/)?$/ && $7!~/( \\/usr)?\\/bin\\/false(\\/)?$/) { print $1 \" \" $6 }' /etc/passwd | while read -r user dir; do if [ ! -d \"$dir\" ]; then echo \"User: \\\"$user\\\" home directory: \\\"$dir\\\" does not exist.\" else owner=$(stat -L -c \"%U\" \"$dir\") if [ \"$owner\" != \"$user\" ]; then echo \"User: \\\"$user\\\" home directory: \\\"$dir\\\" is owned by \\\"$owner\\\"\" fi fi done 593 | P a g e"
    },
    {
      "id": "6.2.13",
      "title": "Ensure users' home directories permissions are 750 or more restrictive",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.13",
      "description": "Ensure users' home directories permissions are 750 or more restrictive",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "6.2.14",
      "title": "Ensure users' dot files are not group or world writable",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.14",
      "description": "Ensure users' dot files are not group or world writable",
      "rationale": "Group or world -writable user configuration files may enable malicious users to steal or modify other users' data or to gain another user's system privileges.",
      "remediation": ": Making global modifications to us ers' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user dot file permissions and determine the action to be taken in accordance w ith site policy. The following script will remove excessive permissions on dot files within interactive users' home directories. #!/bin/bash awk -F: '($1!~/(halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\/usr)?\\/sbin\\/nologin( \\/)?$/ && $7!~/( \\/usr)?\\/bin\\/false(\\/)?$/) { print $6 }' /etc/passwd | while read -r dir; do if [ -d \"$dir\" ]; then for file in \"$dir\"/.*; do if [ ! -h \"$file\" ] && [ -f \"$file\" ]; then fileperm=$(stat -L -c \"%A\" \"$file\") if [ \"$(echo \"$fileperm\" | cut -c6)\" != \" -\" ] || [ \"$(echo \"$fileperm\" | cut -c9)\" != \" -\" ]; then chmod go -w \"$file\" fi fi done fi done CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the informati on based on their need to access the information as a part of their responsibilities. \u25cf \u25cf \u25cf 598 | P a g e",
      "impact": "None",
      "audit_command": "Run the following script and verify no results are returned: #!/bin/bash awk -F: '($1!~/(halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\/usr)?\\/sbin\\/nologin( \\/)?$/ && $7!~/( \\/usr)?\\/bin\\/false(\\/)?$/) { print $1 \" \" $6 }' /etc/passwd | while read -r user dir; do if [ -d \"$dir\" ]; then for file in \"$dir\"/.*; do if [ ! -h \"$file\" ] && [ -f \"$file\" ]; then fileperm=$(stat -L -c \"%A\" \"$file\") if [ \"$(echo \"$fileperm\" | cut -c6)\" != \" -\" ] || [ \"$(echo \"$fileperm\" | cut -c9)\" != \" -\" ]; then echo \"User: \\\"$user\\\" file: \\\"$file\\\" has permissions: \\\"$fileperm \\\"\" fi fi done fi done 597 | P a g e"
    },
    {
      "id": "6.2.15",
      "title": "Ensure no users have .forward files",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.15",
      "description": "The .forward file specifies an email address to forward the user's mail to.",
      "rationale": "Use of the .forward file poses a security risk in that sensitive data may be inadvertently transferred outside the organization. The .forward file also poses a risk as it can be use d to execute commands that may perform unintended actions.",
      "remediation": ": Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .forward files and determi ne the action to be taken in accordance with site policy. The following script will remove .forward files from interactive users' home directories #!/bin/bash awk -F: '($1!~/(root|halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\/usr)?\\/sbin\\/nologin( \\/)?$/ && $7!~/(\\/usr)?\\/bin\\/false(\\/)?$/) { print $6 }' /etc/passwd | while read -r dir; do if [ -d \"$dir\" ]; then file=\"$dir/.forward\" [ ! -h \"$file\" ] && [ -f \"$file\" ] && rm -r \"$file\" fi done CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 600 | P a g e",
      "impact": "None",
      "audit_command": "Run the following script and verify no results are returned: #!/bin/bash awk -F: '($1!~/(root|halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\/usr)?\\/sbin\\/nologin( \\/)?$/ && $7!~/( \\/usr)?\\/bin\\/false(\\/)?$/) { print $1 \" \" $6 }' /etc/passwd | while read -r user dir; do if [ -d \"$dir\" ]; then file=\"$dir/.forward\" if [ ! -h \"$file\" ] && [ -f \"$file\" ]; then echo \"User: \\\"$user\\\" file: \\\"$file\\\" exists\" fi fi done 599 | P a g e"
    },
    {
      "id": "6.2.16",
      "title": "Ensure no users have .netrc files",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.16",
      "description": "The .netrc file contains data for logging into a remote host for file transfers via FTP. While the system administrator can establish secure permissions for users' .netrc files, the users can easily override these.",
      "rationale": "The .netrc file presents a significant s ecurity risk since it stores passwords in unencrypted form. Even if FTP is disabled, user accounts may have brought over .netrc files from other systems which could pose a risk to those systems. If a .netrc file is required, and follows local site policy, it should have permissions of 600 or more restrictive. 601 | P a g e",
      "remediation": ": Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .netrc files and determine the action to be taken in accordance with site policy. The following script will remove .netrc files from interactive users' home directories #!/bin/bash awk -F: '($1!~/(halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\/usr)?\\/sbin\\/nologin( \\/)?$/ && $7!~/( \\/usr)?\\/bin\\/false(\\/)?$/) { print $6 }' /etc/passwd | while read -r dir; do if [ -d \"$dir\" ]; then file=\"$dir/.netrc\" [ ! -h \"$file\" ] && [ -f \"$file\" ] && rm -f \"$file\" fi done Additional Information: While the complete removal of .netrc files is recommended, if any are required on the system secure permissions must be applied. CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.6 Securely Manage Enterprise Assets and Software Securely manage enterprise assets a nd software. Example implementations include managing configuration through version -controlled -infrastructure -as-code and accessing administrative interfaces over secure network protocols, such as Secure Shell (SSH) and Hypertext Transfer Protocol Secure ( HTTPS). Do not use insecure management protocols, such as Telnet (Teletype Network) and HTTP, unless operationally essential. \u25cf \u25cf \u25cf v7 16.4 Encrypt or Hash all Authentication Credentials Encrypt or hash with a salt all authentication credentials when stored. \u25cf \u25cf 603 | P a g e",
      "impact": "None",
      "audit_command": "Run the following script. This script will return: \uf0b7 FAILED: for any .netrc file with permissions less restrictive than 600 \uf0b7 WARNING: for any .netrc files that exist in interactive users' home di rectories. #!/bin/bash awk -F: '($1!~/(halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\/usr)?\\/sbin\\/nologin( \\/)?$/ && $7!~/( \\/usr)?\\/bin\\/false(\\/)?$/) { print $1 \" \" $6 }' /etc/passwd | while read -r user dir; do if [ -d \"$dir\" ]; then file=\"$dir/.ne trc\" if [ ! -h \"$file\" ] && [ -f \"$file\" ]; then if stat -L -c \"%A\" \"$file\" | cut -c4-10 | grep -Eq '[^-]+'; then echo \"FAILED: User: \\\"$user\\\" file: \\\"$file\\\" exists with permissions: \\\"$(stat -L -c \"%a\" \"$file\") \\\", remove file or excessive permissions\" else echo \"WARNING: User: \\\"$user\\\" file: \\\"$file\\\" exists with permissions: \\\"$(stat -L -c \"%a\" \"$file\") \\\", remove file unless required\" fi fi fi done Verify: \uf0b7 Any lines beginning with FAILED: - File should be removed unless deemed necessary, in accordance with local site policy, and permissions are updated to be 600 or more restrictive \uf0b7 Any lines beginning with WARNING: - File should be removed unless deemed necessary, and in accordance with local site policy 602 | P a g e"
    },
    {
      "id": "6.2.17",
      "title": "Ensure no users have .rhosts files",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.17",
      "description": "Ensure no users have .rhosts files",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "has b een performed. It is advisable to verify root users path integrity and the integrity of any programs being run prior to execution of commands and scripts included in this benchmark. To obtain the latest version of this guide, please visit http://workbench.cisecurity.org . If you have questions, comments, or have identified ways to improve this guide, please write us at feedback@cisecurity.org . Intended Audience This benchmark is intended for system and application administrators, security specialists,",
      "impact": "None",
      "audit_command": "ors, help desk, and platform deployment personnel who plan to develop, deploy, assess, or secure solutions that incorporate centOS Linux 7.x on x86 or x64 plat forms. Consensus Guidance This benchmark was created using a consensus review process comprised of subject matter experts. Consensus participants provide perspective from a diverse set of backgrounds including consulting, software development, audit and c ompliance, security research, operations, government, and legal. Each CIS benchmark undergoes two phases of consensus review. The first phase occurs during initial benchmark development. During this phase, subject matter experts convene to discuss, create , and test working drafts of the benchmark. This discussion occurs until consensus has been reached on benchmark recommendations. The second phase begins after the benchmark has been published. During this phase, all feedback provided by the Internet commu nity is reviewed by the consensus team for incorporation in the benchmark. If you are interested in participating in the consensus process, please visit https://workbench.cisecurity.org/ . 14 | P a g e Typographical Conventions The following typographical conventions are used throughout this guide: Convention Meaning Stylized Monospace font Used for blocks of code, command, and script examples. Text should be interpreted exactly as presented. Monospace font Used for inline code, commands, or examples. Text should be interpreted exactly as presented. <italic font in brackets> Italic texts set in angle brackets denote a variable requiring substitution for a real value. Italic font Used to denote the title of a book, article, or other publication. Note Additional information or caveats Assessment Status An assessment status is included for every recommendation. The assessment status indicates whether the given recommendation can be automated or requires manual steps to implement. Both statuses are equally important and are determined and supported as defined below: Automated Represents recommendations for which assessment of a technical control can be fully automated and validated to a pass/fail state. Recommendations will include the necessary information to implement automation. Manual Represents recommendations for which assessment of a technical control cannot be fully automated and requires all or some manual steps to validate that the configured state is set as expected. The expected state can vary depending on the environment. 15 | P a g e"
    },
    {
      "id": "6.2.2",
      "title": "Ensure /etc/shadow password fields are not empty",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.2",
      "description": "An account with an empty password field means that anybody may log in as that user without providing a password.",
      "rationale": "All accounts must have passwords or be locked to prevent the account from being used by an unauthorized user.",
      "remediation": ": If any accounts in the /etc/shadow file do not have a password, run the following command to lock the account until it can be determined why it does not have a password: # passwd -l <username> Also, check to see if the account is logged in and investigate what it is being used for to determine if it needs to be forced off. 574 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.2 Use Unique Passwords Use unique passwords for all enterprise assets. Best practice implementation includes, at a minimum, an 8 -character password for accounts using MFA and a 14 - character password for accounts not using MFA. \u25cf \u25cf \u25cf v7 4.4 Use Unique Passwords Where multi -factor authentication is not supported (such as local administrator, root, or service accounts), accounts will use passwords that are unique to that system. \u25cf \u25cf 575 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify that no output is returned: # awk -F: '($2 == \"\" ) { print $1 \" does not have a password \"}' /etc/shadow",
      "file_path": "/etc/shadow",
      "pattern": "password|authentication"
    },
    {
      "id": "6.2.3",
      "title": "Ensure all groups in /etc/passwd exist in /etc/group",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.3",
      "description": "Over time, system administration errors and changes can lead to groups being defined in /etc/passwd but not in /etc/group .",
      "rationale": "Groups defined in the /etc/passwd file but not in the /etc/group file pose a threat to system security since group permissions are not properly managed.",
      "remediation": ": Analyze the output of the Audit step above and perform the appropriate action to correct any discrepancies f ound. 576 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 16 Account Monitoring and Control Account Monitoring and Control 577 | P a g e",
      "impact": "None",
      "audit_command": "Run the following script and verify no results are returned: #!/bin/bash for i in $(cut -s -d: -f4 /etc/passwd | sort -u ); do grep -q -P \"^.*?:[^: ]*:$i:\" /etc/group if [ $? -ne 0 ]; then echo \"Group $i is referenced by /etc/passwd but does not exist in /etc/group\" fi done",
      "file_path": "/etc/passwd",
      "pattern": "-q"
    },
    {
      "id": "6.2.4",
      "title": "Ensure shadow group is empty",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.4",
      "description": "Ensure shadow group is empty",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "6.2.5",
      "title": "Ensure no duplicate user names exist",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.5",
      "description": "Although the useradd program will not let you create a duplicate user name, it is possible for an administrator to manually edit the /etc/passwd file and change the user name.",
      "rationale": "If a user is assigned a duplicate user name, it will create and have access to files with the first UID for that username in /etc/passwd . For example, if \"test4\" has a UID of 1000 and a subsequent \"test4\" entry h as a UID of 2000, logging in as \"test4\" will use UID 1000. Effectively, the UID is shared, which is a security problem.",
      "remediation": ": Based on the results of the audit script, establish unique user names for the users. File ownerships will automatically reflect the change as long as the users have unique UIDs. 580 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non-computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 16 Account Monitoring and Control Account Monitoring and Control 581 | P a g e",
      "impact": "None",
      "audit_command": "Run the following script and verify no results are returned: #!/bin/bash cut -d: -f1 /etc/passwd | sort | uniq -d | while read x ; do echo \"Duplicate login name ${x} in /etc/passwd\" done"
    },
    {
      "id": "6.2.6",
      "title": "Ensure no duplicate group names exist",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.6",
      "description": "Although the groupadd program will not let you create a duplicate group name, it is possible for an administrator to manually edit the /etc/group file and change the group name.",
      "rationale": "If a group is assigned a duplicate group name, it will create and have access to files w ith the first GID for that group in /etc/group . Effectively, the GID is shared, which is a security problem.",
      "remediation": ": Based on the results of the audit script, establish unique names for the user groups. File group ownerships will automatically reflect the change as long as the groups have unique GIDs. 582 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non-computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 16 Account Monitoring and Control Account Monitoring and Control 583 | P a g e",
      "impact": "None",
      "audit_command": "Run the following script and verify no results are returned: #!/bin/bash cut -d: -f1 /etc/group | sort | uniq -d | while read -r x; do echo \"Duplicate group name ${x} in /etc/group\" done"
    },
    {
      "id": "6.2.7",
      "title": "Ensure no duplicate UIDs exist",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.7",
      "description": "Although the useradd program will not let you create a duplicate User ID (UID), it is possible for an administrator to manually edit the /etc/passwd file and change the UID field.",
      "rationale": "Users must be assigned unique UIDs for accountability and to ensure appropriate acces s protections.",
      "remediation": ": Based on the results of the audit script, establish unique UIDs and review all files owned by the shared UIDs to determine which UID they are su pposed to belong to. 584 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 16 Account Monitoring and Control Account Monitoring and Control 585 | P a g e",
      "impact": "None",
      "audit_command": "Run the following script and verify no results are returned: #!/bin/bash cut -f3 -d\":\" /etc/passwd | sort -n | uniq -c | while read -r x; do [ -z \"$x\" ] && break set - \"$x\" if [ \"$1\" -gt 1 ]; then users=$(awk -F: '($3 == n) { print $1 }' n=\"$2\" /etc/passwd | xargs) echo \"Duplicate UID ($2): $users\" fi done",
      "file_path": "/etc/passwd",
      "pattern": ".*"
    },
    {
      "id": "6.2.8",
      "title": "Ensure no duplicate GIDs exist",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.8",
      "description": "Ensure no duplicate GIDs exist",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "6.2.9",
      "title": "Ensure root is the only UID 0 account",
      "section": "Section 6.2",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 6.2.9",
      "description": "Any account with UID 0 has superuser privileges on the system.",
      "rationale": "This access must be limited to only the default root account and only from the system console. Administrative access must be through an unprivileged account using an approved mechanism as noted in Item 5.6 Ensure access to the su command is restricted.",
      "remediation": ": Remove any users other than root with UID 0 or assign them a new UID if appropriate. CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review a nd update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 588 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify that only \" root\" is returned: # awk -F: '($3 == 0) { print $1 }' /etc/passwd root"
    }
  ]
}