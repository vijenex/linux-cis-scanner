{
  "milestone": "3.3",
  "version": "1.0.0",
  "description": "CentOS Linux 7 CIS Benchmark v3.1.2 - Section 3.3",
  "controls": [
    {
      "id": "3.3.1",
      "title": "Ensure source routed packets are not accepted",
      "section": "Section 3.3",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.3.1",
      "description": "In networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non -source routed packets travel a path determined by routers in t he network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.",
      "rationale": "Setting net.ipv4.conf.all.accept_source_route, net.ipv4.c onf.default.accept_source_route, net.ipv6.conf.all.accept_source_route and net.ipv6.conf.default.accept_source_route to 0 disables the system from accepting source routed packets. Assume this system was capable of routing packets to Internet routable addre sses on one interface and private addresses on another interface. Assume that the private addresses were not routable to the Internet routable addresses and vice versa. Under normal routing circumstances, an attacker from the Internet routable addresses co uld not use the system as a way to reach the private address systems. If, however, source routed packets were allowed, they could be used to gain access to the private address systems as the route could be specified, rather than rely on routing protocols t hat did not allow this routing. 228 | P a g e",
      "remediation": ": Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.conf.all.accept_source_route = 0 net.ipv4.conf.default.accept_source_route = 0 Run the following commands to set the active kernel parameters: # sysctl -w net.ipv4.conf.all.accept_source_route=0 # sysctl -w net.ipv4.conf.default.accept_source_route=0 # sysctl -w net.ipv4.route.flush=1 IF IPv6 is not disabled: Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv6.conf.all.accept_source_route = 0 net.ipv6.conf.default.accept_source_route = 0 Run the following commands to set the active kernel parameters: # sysctl -w net.ipv6.conf.all.accept_source_route=0 # sysctl -w net.ipv6.conf.default.accept_source_route=0 # sysctl -w net.ipv6.route.flush=1 230 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annuall y, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 231 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands and verify output matches: # sysctl net.ipv4.conf.all.accept_source_route net.ipv4.conf.all.accept_source_route = 0 # sysctl net.ipv4.conf.default.accept_source_route net.ipv4.conf.default.accept_source_route = 0 # grep \"net \\.ipv4\\.conf\\.all\\.accept_source_route\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv4.conf.all.accept_source_route= 0 # grep \"net \\.ipv4\\.conf\\.default \\.accept_source_route\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv4.conf.default.accept_source_route= 0 IF IPv6 is enabled: Run the following commands and verify output matches: # sysctl net.ipv6.conf.all.acc ept_source_route net.ipv6.conf.all.accept_source_route = 0 # sysctl net.ipv6.conf.default.accept_source_route net.ipv6.conf.default.accept_source_route = 0 # grep \"net \\.ipv6\\.conf\\.all\\.accept_source_route\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/ sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv4.conf.all.accept_source_route= 0 # grep \"net \\.ipv6\\.conf\\.default \\.accept_source_route\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv6.conf.default.accept_source_r oute= 0 OR Verify that IPv6 is disabled: Run the following script. Output will confirm if IPv6 is disabled on the system. 229 | P a g e #!/bin/bash [ -n \"$passing\" ] && passing=\"\" [ -z \"$(grep \"^ \\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\" true\" grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" /etc/sysctl.conf \\ /etc/sysctl.d/*.conf && grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" \\ /etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf .all.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" && \\ sysctl net.ipv6.conf.default.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" && passing=\"true\" if [ \"$passing\" = tru e ] ; then echo \"IPv6 is disabled on the system\" else echo \"IPv6 is enabled on the system\" fi",
      "parameter_name": "net.ipv4.conf.all.accept_source_route",
      "expected_value": "0"
    },
    {
      "id": "3.3.2",
      "title": "Ensure ICMP redirects are not accepted",
      "section": "Section 3.3",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.3.2",
      "description": "ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables. By setting net.ipv4.co nf.all.accept_redirects and net.ipv6.conf.all.accept_redirects to 0, the system will not accept any ICMP redirect messages, and therefore, won't allow outsiders to update the system's routing tables.",
      "rationale": "Attackers could use bogus ICMP redirect messa ges to maliciously alter the system routing tables and get them to send packets to incorrect networks and allow your system packets to be captured.",
      "remediation": ": Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.conf.all.accept_redirects = 0 net.ipv4.conf.default.accept_redirects = 0 Run the following commands to set the active kernel parameters: # sysctl -w net.ipv4.conf.all.accept_redirects=0 # sysctl -w net.ipv4.conf.default.accept_redirects=0 # sysctl -w net.ipv4.route.flush=1 IF IPv6 is not disabled Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv6.conf.all.accept_redirects = 0 net.ipv6.conf.default.accept_redirects = 0 Run the following commands to set the active ke rnel parameters: # sysctl -w net.ipv6.conf.all.accept_redirects=0 # sysctl -w net.ipv6.conf.default.accept_redirects=0 # sysctl -w net.ipv6.route.flush=1 CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and updat e documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 234 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands and verify output matches: # sysctl net.ipv4.conf.all.accept_redirects net.ipv4.conf.all.accept_redirects = 0 # sysctl net.ipv4.conf.default.accept_redirects net.ipv4.conf.default.accept_redirects = 0 # grep \"net \\.ipv4\\.conf\\.all\\.accept_redirects\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*. conf net.ipv4.conf.all.accept_redirects= 0 # grep \"net \\.ipv4\\.conf\\.default \\.accept_redirects\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv4.conf.default.accept_redirects= 0 IF IPv6 is not disabled: Run the following commands and verify output matches: 232 | P a g e # sysctl net.ipv6.conf.all.accept_redirects net.ipv6.conf.all.accept_redirects = 0 # sysctl net.ipv6.conf.default.accept_redirects net.ipv6.conf.default.accept_redirects = 0 # grep \"net \\.ipv6\\.conf\\.all\\.accept_redirects\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv6.conf.all.accept_redirects= 0 # grep \"net \\.ipv6\\.conf\\.default \\.accept_redirects\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run /sysctl.d/*.conf net.ipv6.conf.default.accept_redirects= 0 OR verify IPv6 is disabled: Run the following script. Output will confirm if IPv6 is disabled on the system. #!/bin/bash [ -n \"$passing\" ] && passing=\"\" [ -z \"$(grep \"^ \\s*linux\" /boot/grub2/grub. cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\" grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" /etc/sysctl.conf \\ /etc/sysctl.d/*.conf && grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" \\ /etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" && \\ sysctl net.ipv6.conf.default.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" && passing=\"true\" if [ \"$passing\" = true ] ; then echo \"IPv6 is disabled on the system\" else echo \"IPv6 is enabled on the system\" fi 233 | P a g e",
      "parameter_name": "net.ipv4.conf.all.accept_redirects",
      "expected_value": "0"
    },
    {
      "id": "3.3.3",
      "title": "Ensure secure ICMP redirects are not accepted",
      "section": "Section 3.3",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.3.3",
      "description": "Secure ICMP redirects are the same as ICMP redirects, except they come from gateways listed on the default gateway list. It is assumed that these gateways are known to your system, and that they are likely to be secure.",
      "rationale": "It is still possible for even known gateways to be compromised. Setting net.ipv4.conf.all.secure_redirects to 0 prote cts the system from routing table updates by possibly compromised known gateways.",
      "remediation": ": Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4 .conf.all.secure_redirects = 0 net.ipv4.conf.default.secure_redirects = 0 Run the following commands to set the active kernel parameters: # sysctl -w net.ipv4.conf.all.secure_redirects=0 # sysctl -w net.ipv4.conf.default.secure_redirects=0 # sysctl -w net.ipv4.route.flush=1 CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 236 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands and verify output matches: # sysctl net.ipv4.conf.all.secure_redirects net.ipv4.conf.all.secure_redirects = 0 # sysctl net.ipv4.conf.defaul t.secure_redirects net.ipv4.conf.default.secure_redirects = 0 # grep \"net \\.ipv4\\.conf\\.all\\.secure_redirects\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv4.conf.all.secure_redirects= 0 # grep \"net \\.ipv4\\.conf\\.default \\.secure_redirects\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv4.conf.default.secure_redirects= 0 235 | P a g e",
      "parameter_name": "net.ipv4.conf.all.secure_redirects",
      "expected_value": "0"
    },
    {
      "id": "3.3.4",
      "title": "Ensure suspicious packets are logged",
      "section": "Section 3.3",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.3.4",
      "description": "When enabled, this feature logs packets with un -routable source addresses to the kernel log.",
      "rationale": "Enabling this feature and logging these packets allows an administrator to investigate the possibility that an attacker is sending spoofed packets to their system.",
      "remediation": ": Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.conf.all.log_martians = 1 net.ipv4.conf.default.log_martia ns = 1 Run the following commands to set the active kernel parameters: # sysctl -w net.ipv4.conf.all.log_martians=1 # sysctl -w net.ipv4.conf.default.log_martians=1 # sysctl -w net.ipv4.route.flush=1 CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 8.5 Collect Detailed Audit Logs Configure detailed audit logging for enterprise assets containing sensitive data. Include event source, date, username, timestamp, source addresses, destination addresses, and other useful elements that could assist in a forensic investigation. \u25cf \u25cf v7 6.2 Activate audit logging Ensure that local logging has been enabled on all systems and networking devices. \u25cf \u25cf \u25cf v7 6.3 Enable Detailed Logging Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements. \u25cf \u25cf 238 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands and verify output matches: # sysctl net.ipv4.conf.all.log_martians net.ipv4.conf.all.log_martians = 1 # sysctl net.ipv4.conf.default.log_martians net.ipv4.conf.default .log_martians = 1 # grep \"net \\.ipv4\\.conf\\.all\\.log_martians\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv4.conf.all.log_martians = 1 # grep \"net \\.ipv4\\.conf\\.default \\.log_martians\" /etc/sysctl.conf /etc/sysc tl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv4.conf.default.log_martians = 1 237 | P a g e",
      "parameter_name": "net.ipv4.conf.all.log_martians",
      "expected_value": "1"
    },
    {
      "id": "3.3.5",
      "title": "Ensure broadcast ICMP requests are ignored",
      "section": "Section 3.3",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.3.5",
      "description": "Setting net.ipv4.icmp_echo_ignore_broadcasts to 1 will cause the system to ignore all ICMP echo and timestamp requests to broadcast and multicast addresses.",
      "rationale": "Accepting ICMP echo and timestamp requests with broadcast or multicast destinations for your net work could be used to trick your host into starting (or participating) in a Smurf attack. A Smurf attack relies on an attacker sending large amounts of ICMP broadcast messages with a spoofed source address. All hosts receiving this message and responding would send echo -reply messages back to the spoofed address, which is probably not routable. If many hosts respond to the packets, the amount of traffic on the network could be significantly multiplied.",
      "remediation": ": Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.icmp_echo_ignore_broadcasts = 1 Run the following commands to set the active kernel parameters: # sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1 # sysctl -w net.ipv4.route.flush=1 239 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 240 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands and verify output mat ches: # sysctl net.ipv4.icmp_echo_ignore_broadcasts net.ipv4.icmp_echo_ignore_broadcasts = 1 # grep \"net \\.ipv4\\.icmp_echo_ignore_broadcasts\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv4.icmp_echo_ignore_br oadcasts = 1",
      "parameter_name": "net.ipv4.icmp_echo_ignore_broadcasts",
      "expected_value": "1"
    },
    {
      "id": "3.3.6",
      "title": "Ensure bogus ICMP responses are ignored",
      "section": "Section 3.3",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.3.6",
      "description": "Setting icmp_ignore_bogus_error_responses to 1 prevents the kernel from logging bogus responses (RFC -1122 non -compliant) from broadcast reframes, keeping file systems from filling up with useless log messages.",
      "rationale": "Some routers (and some attackers) will send responses that violate RFC -1122 and attempt to fill up a log file system with many useless error messages.",
      "remediation": ": Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.icmp_ignore_bogus_error_responses = 1 Run the following commands to set the active kernel parameters: # sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1 # sysctl -w net.ipv4.route.flush=1 241 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating sys tems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 242 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands and verify output matches: # sysctl net.ipv4.icmp_ignore_bogus_error_responses net.ipv4.icmp_ignore_bogus_error_responses = 1 # grep \"net.ipv4.ic mp_ignore_bogus_error_responses\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv4.icmp_ignore_bogus_error_responses = 1",
      "parameter_name": "net.ipv4.icmp_ignore_bogus_error_responses",
      "expected_value": "1"
    },
    {
      "id": "3.3.7",
      "title": "Ensure Reverse Path Filtering is enabled",
      "section": "Section 3.3",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.3.7",
      "description": "Setting net.ipv4.conf.all.rp_filter and net.ipv4.conf.default.rp_filter to 1 forces the Linux kernel to utilize reverse path filtering on a received packet to determine if the packet was valid. Essentially, with reverse path filtering, if the return packet does not go out the same interface that the corresponding source packet came from, the packet is dropped (and logged if log_martians is set).",
      "rationale": "Setting these flags is a good way to deter attackers from sending your system bogus packets that cannot be responded to. One instance where th is feature breaks down is if asymmetrical routing is employed. This would occur when using dynamic routing protocols (bgp, ospf, etc) on your system. If you are using asymmetrical routing on your system, you will not be able to enable this feature without breaking the routing.",
      "remediation": ": Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.conf.all.rp_filter = 1 net.ipv4.conf.default.rp_filter = 1 Run the following commands to set the active kernel parameters: # sysctl -w net.ipv4.conf.all.rp_filter=1 # sysctl -w net.ipv4.conf.default.rp_filter=1 # sysctl -w net.ipv4.route.flush=1 CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annuall y, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 244 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands and verify output matches: # sysctl net.ipv4.conf.all.rp_filter net.ipv4.conf.all.rp_filter = 1 # sysctl net.ipv4.conf.default.rp_filter net.ipv4.conf.default.rp_filter = 1 # grep \"net \\.ipv4\\.conf\\.all\\.rp_filter\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv4.conf.all.rp_filter = 1 # grep \"net \\.ipv4\\.conf\\.default \\.rp_filter\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/* .conf net.ipv4.conf.default.rp_filter = 1 243 | P a g e",
      "parameter_name": "net.ipv4.conf.all.rp_filter",
      "expected_value": "1"
    },
    {
      "id": "3.3.8",
      "title": "Ensure TCP SYN Cookies is enabled",
      "section": "Section 3.3",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.3.8",
      "description": "When tcp_syncookies is set, the kernel will handle TCP SYN packets normally until the half-open connection queue is full, at which time, the SYN cookie functionality kicks in. SYN cookies work by not using the SYN queue at all. Instead, the kernel simply replies to the SYN w ith a SYN|ACK, but will include a specially crafted TCP sequence number that encodes the source and destination IP address and port number and the time the packet was sent. A legitimate connection would send the ACK packet of the three way handshake with t he specially crafted sequence number. This allows the system to verify that it has received a valid response to a SYN cookie and allow the connection, even though there is no corresponding SYN in the queue.",
      "rationale": "Attackers use SYN flood attacks to per form a denial of service attacked on a system by sending many SYN packets without completing the three way handshake. This will quickly use up slots in the kernel's half -open connection queue and prevent legitimate connections from succeeding. SYN cookies allow the system to keep accepting valid connections, even if under a denial of service attack.",
      "remediation": ": Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.tcp_syncookies = 1 Run the following command s to set the active kernel parameters: # sysctl -w net.ipv4.tcp_syncookies=1 # sysctl -w net.ipv4.route.flush=1 CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant en terprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 246 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands and verify output matches: # sysctl net.ipv4.tcp_syncookies net.ipv4.tcp_syncookies = 1 # grep \"net \\.ipv4\\.tcp_syncookies\" / etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf net.ipv4.tcp_syncookies = 1 245 | P a g e",
      "parameter_name": "net.ipv4.tcp_syncookies",
      "expected_value": "1"
    },
    {
      "id": "3.3.9",
      "title": "Ensure IPv6 router advertisements are not accepted",
      "section": "Section 3.3",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.3.9",
      "description": "Ensure IPv6 router advertisements are not accepted",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    }
  ]
}