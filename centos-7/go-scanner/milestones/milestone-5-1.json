{
  "milestone": "5.1",
  "version": "1.0.0",
  "description": "CentOS Linux 7 CIS Benchmark v3.1.2 - Section 5.1",
  "controls": [
    {
      "id": "5.1.1",
      "title": "Ensure cron daemon is enabled and running",
      "section": "Section 5.1",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.1.1",
      "description": "The cron daemon is used to execute batch jobs on the system.",
      "rationale": "While there may not be user jobs that need to be run on the system, the system does have maintenance jo bs that may include security monitoring that have to run. If another method for scheduling tasks is not being used, cron is used to execute them, and needs to be enabled and running.",
      "remediation": ": Run the following command to enable and start cron : # systemctl --now enable crond OR Run the following command to remove cron : # yum remove cronie 421 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 422 | P a g e",
      "impact": "None",
      "audit_command": "If cron is installed: Run the following commands to verify cron is enabled and running: # systemctl is -enabled crond enabled # systemctl status crond | grep 'Active: active (running) ' Active: active (running) since <Day Date Time>"
    },
    {
      "id": "5.1.2",
      "title": "Ensure permissions on /etc/crontab are configured",
      "section": "Section 5.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.1.2",
      "description": "The /etc/crontab file is used by cron to control its own jobs. The commands in this item make sure that root is the user and group owner of the file and that only the owner can access the file.",
      "rationale": "This file contains information on what system jobs are run by cron. Write access to thes e files could provide unprivileged users with the ability to elevate their privileges. Read access to these files could provide users with the ability to gain insight on system jobs that run on the system and could provide them a way to gain unauthorized p rivileged access.",
      "remediation": ": Run the following commands to set ownership and permissions on /etc/crontab : # chown root:root /etc/crontab # chmod u -x,og-rwx /etc/crontab OR Run the following command to remove cron : # yum remove cronie 423 | P a g e CIS Controls: Controls Versi on Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. \u25cf \u25cf \u25cf 424 | P a g e",
      "impact": "None",
      "audit_command": "If cron is installed: Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other : # stat /etc/crontab Access: (0600/ -rw-------) Uid: ( 0/ root) Gid: ( 0/ root)",
      "file_path": "/etc/crontab"
    },
    {
      "id": "5.1.3",
      "title": "Ensure permissions on /etc/cron.hourly are configured",
      "section": "Section 5.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.1.3",
      "description": "This directory contains system cron jobs that need to run on an hourly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.",
      "rationale": "Granting write access to this directory for non -privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls .",
      "remediation": ": Run the following commands to set ownership and permissions on the /etc/cron.hourly/ directory: # chown root:root /etc/cron.hourly/ # chmod og -rwx /etc/cron.hourly/ OR Run the following command to remove cron # yum remove cronie CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 426 | P a g e",
      "impact": "None",
      "audit_command": "If cron is installed: Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other : # stat /etc/cron.hourly/ Access: (0700/drwx ------) Uid: ( 0/ root) Gid: ( 0/ root) 425 | P a g e",
      "file_path": "/etc/cron.hourly"
    },
    {
      "id": "5.1.4",
      "title": "Ensure permissions on /etc/cron.daily are configured",
      "section": "Section 5.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.1.4",
      "description": "The /etc/cron.daily directory contains system cron jobs that need to run on a daily basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.",
      "rationale": "Granting write access to this directory for non -privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls .",
      "remediation": ": Run the following commands to set ownership and permissions on /etc/cron.daily directory: # chown root:root /etc/cron.daily # chmod og -rwx /etc/cron.daily OR Run the following command to remove cron : # yum remove cronie CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. \u25cf \u25cf \u25cf 428 | P a g e",
      "impact": "None",
      "audit_command": "If cron is installed: Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other : # stat /etc/cron.daily/ Access: (0700/drwx ------) Uid: ( 0/ root) Gid: ( 0/ root) 427 | P a g e",
      "file_path": "/etc/cron.daily"
    },
    {
      "id": "5.1.5",
      "title": "Ensure permissions on /etc/cron.weekly are configured",
      "section": "Section 5.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.1.5",
      "description": "The /etc/cron.weekly directory contains system cron jobs that need to run on a weekly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.",
      "rationale": "Granting write access to this directory for non -privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls .",
      "remediation": ": Run the following commands to set ownership and permissions on /etc/cron.weekly/ directory: # chown root:root /etc/cron.weekly/ # chmod og -rwx /etc/cron.weekly/ OR Run the following command to remove cron : # yum remove cronie CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. \u25cf \u25cf \u25cf 430 | P a g e",
      "impact": "None",
      "audit_command": "If cron is installed Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other : # stat /etc/cron.weekly Access: (0700/drwx ------) Uid: ( 0/ root) Gid: ( 0/ root) 429 | P a g e",
      "file_path": "/etc/cron.weekly"
    },
    {
      "id": "5.1.6",
      "title": "Ensure permissions on /etc/cron.monthly are configured",
      "section": "Section 5.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.1.6",
      "description": "The /etc/cron.monthly directory contains system cron jobs that need to run on a monthly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.",
      "rationale": "Granting write access to this directory for non -privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls .",
      "remediation": ": Run the following commands to set ownership and permissions on /etc/cron.monthly directory: # chown root:root /etc/cron.monthly # chmod og -rwx /etc/cron.monthly OR Run the following command to remove cron : # yum remove cronie CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. \u25cf \u25cf \u25cf 432 | P a g e",
      "impact": "None",
      "audit_command": "If cron is installed: Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other : # stat /etc/cron.monthly/ Access: (0700/drwx ------) Uid: ( 0/ root) Gid: ( 0/ root) 431 | P a g e",
      "file_path": "/etc/cron.monthly"
    },
    {
      "id": "5.1.7",
      "title": "Ensure permissions on /etc/cron.d are configured",
      "section": "Section 5.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.1.7",
      "description": "The /etc/cron.d/ directory contains system cron jobs that need to run in a similar manner to the hourly, daily weekly and monthly jobs from /etc/crontab , but require more granular control as to when they run. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search acces s to user and group root, preventing regular users from accessing this directory.",
      "rationale": "Granting write access to this directory for non -privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.",
      "remediation": ": Run the following commands to set ownership and permissions on /etc/cron.d directory: # chown root:root /etc/cron.d # chmod og-rwx /etc/cron.d OR Run the following command to remove cron : # yum remove cronie CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. \u25cf \u25cf \u25cf 434 | P a g e",
      "impact": "None",
      "audit_command": "If cron is installed: Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other : # stat /etc/cron.d Access: (0700/drwx ------) Uid: ( 0/ root) Gid: ( 0/ root) 433 | P a g e",
      "file_path": "/etc/cron.d"
    },
    {
      "id": "5.1.8",
      "title": "Ensure cron is restricted to authorized users",
      "section": "Section 5.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.1.8",
      "description": "If cron is installed in the system, configure /etc/cron.allow to allow specific users to use these services. If /etc/cron.allow does not exist, then /etc/cron.deny is checked. Any user not specifically defined in those files is allowed to use cron. By removing the file, only users in /etc/cron.allow are allowed to u se cron. Note: Even though a given user is not listed in cron.allow , cron jobs can still be run as that user. The cron.allow file only controls administrative access to the crontab command for scheduling and modifying cron jobs.",
      "rationale": "On many systems, only the system administrator is authorized to schedule cron jobs. Using the cron.allow file to control who can run cron jobs enforces this policy. It is easier to manage an allow list than a deny list. In a deny list, you could potentially add a user ID to the system and forget to add it to the deny files.",
      "remediation": ": Run the following command to remove /etc/cron.deny : # rm /etc/cron.deny Run the following command to create /etc/cron.allow # touch /etc/cron.allow Run the following commands to set the owner and permissions on /etc/cron.allow : # chown root:root /etc/cron.al low # chmod u -x,og-rwx /etc/cron.allow OR Run the following command to remove cron # yum remove cronie CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 16 Account Monitoring and Control Account Monitoring and Control 436 | P a g e",
      "impact": "None",
      "audit_command": "If cron is installed: Run the following command and verify /etc/cron.deny does not exist: # stat /etc/cron.deny stat: cannot stat `/etc/cron.deny': No such file or directory Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other for /etc/cron.allow : # stat /etc/cron.allow Access: (0600/ -rw-------) Uid: ( 0/ root) Gid: ( 0/ root) 435 | P a g e",
      "file_path": "/etc/cron.allow"
    },
    {
      "id": "5.1.9",
      "title": "Ensure at is restricte d to authorized users",
      "section": "Section 5.1",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.1.9",
      "description": "Ensure at is restricte d to authorized users",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    }
  ]
}