{
  "milestone": "5.5",
  "version": "1.0.0",
  "description": "CentOS Linux 7 CIS Benchmark v3.1.2 - Section 5.5",
  "controls": [
    {
      "id": "5.5.1.1",
      "title": "Ensure password expiration is 365 days or less",
      "section": "Section 5.5",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.5.1.1",
      "description": "The PASS_MAX_DAYS parameter in /etc/login.defs allows an administrator to force passwords to expire once they reach a defined age. It is recommended that the PASS_MAX_DAYS parameter be set to less than or equal to 365 days. Notes: \uf0b7 A value of -1 will disable password expira tion. \uf0b7 The password expiration must be greater than the minimum days between password changes or users will be unable to change their password.",
      "rationale": "The window of opportunity for an attacker to leverage compromised credentials via a brute force atta ck, using already compromised credentials, or gaining the credentials by other means, can be limited by the age of the password. Therefore, reducing the maximum age of a password can also reduce an attacker's window of opportunity. Requiring passwords to b e changed helps to mitigate the risk posed by the poor security practice of passwords being used for multiple accounts, and poorly implemented off - boarding and change of responsibility policies. This should not be considered a replacement for proper implem entation of these policies and practices. Note: If it is believed that a user's password may have been compromised, the user's account should be locked immediately. Local policy should be followed to ensure the secure update of their password. 515 | P a g e",
      "remediation": ": Set the PASS_MAX_DAYS parameter to conform to site policy in /etc/login.defs : PASS_MAX_DAYS 365 Modify user parameters for all users with a password set to match: # chage --maxdays 365 <user> CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occu r that could impact this Safeguard. \u25cf \u25cf \u25cf v7 4.4 Use Unique Passwords Where multi -factor authentication is not supported (such as local administrator, root, or service accounts), accounts will use passwords that are unique to that system. \u25cf \u25cf 516 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify PASS_MAX_DAYS conforms to site policy (no more than 365 days): # grep ^ \\s*PASS_MAX_DAYS /etc/login.defs PASS_MAX_DAYS 365 Run the following command and Review list of users and PASS_MAX_DAYS to verify that all users' PASS_MAX_DAYS conforms to site policy (no more than 365 days): # grep -E '^[^:]+:[^!*]' /etc/shadow | cut -d: -f1,5 <user>:<PASS_MAX_DAYS>"
    },
    {
      "id": "5.5.1.2",
      "title": "Ensure minimum days between password changes is configured",
      "section": "Section 5.5",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.5.1.2",
      "description": "Ensure minimum days between password changes is configured",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "5.5.1.3",
      "title": "Ensure password expiration warning days is 7 or more",
      "section": "Section 5.5",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.5.1.3",
      "description": "The PASS_WARN_AGE parameter in /etc/login.defs allows an administrator to notify users that their password will expire in a defined number of days. It is recommended that the PASS_WARN_AGE parameter be set to 7 or more days.",
      "rationale": ": Providing an advance warning that a password will be expiring gives users time to think of a secure password. Users caught unaware may choose a simple password or write it down where it may be discovered. Aud it: Run the following command and verify PASS_WARN_AGE conforms to site policy (No less than 7 days): # grep ^ \\s*PASS_WARN_AGE /etc/login.defs PASS_WARN_AGE 7 Verify all users with a password have their number of days of warning before password expires set to 7 or more: Run the following command and Review list of users and PASS_WARN_AGE to verify that all users' PASS_WARN_AGE conforms to site policy (No less than 7 days): # grep -E ^[^:]+:[^ \\!*] /etc/shadow | cut -d: -f1,6 <user>:<PASS_WARN_AGE> 519 | P a g e Reme diation: Set the PASS_WARN_AGE parameter to 7 in /etc/login.defs : PASS_WARN_AGE 7 Modify user parameters for all users with a password set to match: # chage --warndays 7 <user> CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications) . Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 4.4 Use Unique Passwords Where multi -factor authentication is not supported (such as local administrator, root, or service accounts), accounts will use passwords that are unique to that system. \u25cf \u25cf 520 | P a g e",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "5.5.1.4",
      "title": "Ensure inactive password lock is 30 days or less",
      "section": "Section 5.5",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.5.1.4",
      "description": "User accounts that have been inactive for over a given period of time can be automatically disabled. It is recommended that accounts that are inactive for 30 days after password expiration be disabled. Note: A value of -1 would disable this setting.",
      "rationale": "Inactive accounts p ose a threat to system security since the users are not logging in to notice failed login attempts or other anomalies.",
      "remediation": ": Run the following command to set the default password inactivity period to 30 days: # useradd -D -f 30 Modify user parameters for all users with a password set to match: # chage --inactive 30 <user> CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 16.9 Disable Dormant Accounts Automatically disable dormant accounts after a set period of inactivity. \u25cf \u25cf \u25cf 522 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify INACTIVE conforms to sire policy (no more than 30 days): # useradd -D | grep INACTIVE INACTIVE=30 Verify all users with a password have Password inactive no more than 30 days after password expires: Run the following command and Review list of users and INACTIVE to verify that all users' INACTIVE conforms to site policy (no more than 30 days): # grep -E ^[^:]+:[^ \\!*] /etc/shadow | cut -d: -f1,7 <user>:<INACTIVE> 521 | P a g e"
    },
    {
      "id": "5.5.1.5",
      "title": "Ensure all users last password change date is in the past",
      "section": "Section 5.5",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.5.1.5",
      "description": "All users should have a password change date in the past.",
      "rationale": "If a users recorded password change date is in the future then they could bypass any set password expiration.",
      "remediation": ": Investigate any users with a password change date in the future and correct them. Locking the account, expiring the password, or resetting the password manually may be appropriate. CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.2 Use Unique Passwords Use unique passwords for all enterprise assets. Best practice implementation includes, at a minimum, an 8 -character password for accounts using MFA and a 14 - character password for accounts not using MFA. \u25cf \u25cf \u25cf v7 4.4 Use Unique Passwords Where multi -factor authentication is not supported (such as local administrator, root, or service accounts), accounts will use passwords that are unique to that system. \u25cf \u25cf 523 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify nothing is returned # for usr in $(cut -d: -f1 /etc/shadow); do [[ $(chage --list $usr | grep '^Last password change' | cut -d: -f2) > $(date) ]] && echo \"$usr :$(chage -- list $usr | grep '^Last password change' | cut -d: -f2)\"; done"
    },
    {
      "id": "5.5.2",
      "title": "Ensure system accounts are secured",
      "section": "Section 5.5",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.5.2",
      "description": "There are a number of accounts provided with most distributions that are used to manage applications and are not intended to provide an interactive shell.",
      "rationale": "It is important to make sure that accounts that are not being used by regular users are prevented from being used to provide an interactive shell. By default, most distributions set the password field for these accounts to an invalid string, but it is also recommended that the shell field in the password file be set to the nologin shell. This prevents the account from potentially being used to run any commands. Note: The root , sync , shutdown , and halt users are exempted from requiring a non -login shell. Aud it: Run the following commands and verify no results are returned: awk -F: '($1!=\"root\" && $1!=\"sync\" && $1!=\"shutdown\" && $1!=\"halt\" && $1!~/^\\+/ && $3<'\"$(awk '/^ \\s*UID_MIN/{print $2}' /etc/login.defs)\"' && $7!=\"'\"$(which nologin)\"'\" && $7!=\"/bin/false\") {print}' /etc/passwd awk -F: '($1!=\"root\" && $1!~/^ \\+/ && $3<'\"$(awk '/^ \\s*UID_MIN/{print $2}' /etc/login.defs)\"') {print $1}' /etc/passwd | xargs -I '{}' passwd -S '{}' | awk '($2!=\"L\" && $2!=\"LK\") {print $1}' 524 | P a g e Remediation: Run the commands appropriate for your distribution: Set the shell for any accounts returned by the audit to nologin: # usermod -s $(which nologin) <user> Lock any non root accounts returned by the",
      "remediation": ": Run the commands appropriate for your distribution: Set the shell for any accounts returned by the audit to nologin: # usermod -s $(which nologin) <user> Lock any non root accounts returned by the audit: # usermod -L <user> The following command will set all system accounts to a non login shell: awk -F: '($1!=\"root\" && $1!=\"sync\" && $1!=\"shutdown\" && $1!=\"halt\" && $1!~/^\\+/ && $3<'\"$(awk '/^ \\s*UID_MIN/{print $2}' /etc/login.defs)\"' && $7!=\"'\"$(which nologin)\"'\" && $7!=\"/bin/false\" && $7!=\"/usr/bin/false\") {print $1}' /etc/passwd | whi le read -r user; do usermod -s \"$(which nologin)\" \"$user\"; done The following command will automatically lock not root system accounts: awk -F: '($1!=\"root\" && $1!~/^ \\+/ && $3<'\"$(awk '/^ \\s*UID_MIN/{print $2}' /etc/login.defs)\"') {print $1}' /etc/passwd | xargs -I '{}' passwd -S '{}' | awk '($2!=\"L\" && $2!=\"LK\") {print $1}' | while read -r user; do usermod -L \"$user\"; done CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 16 Account Monitoring and Control Account Monitoring and Control 525 | P a g e",
      "impact": "None",
      "audit_command": "to nologin: # usermod -s $(which nologin) <user> Lock any non root accounts returned by the audit: # usermod -L <user> The following command will set all system accounts to a non login shell: awk -F: '($1!=\"root\" && $1!=\"sync\" && $1!=\"shutdown\" && $1!=\"halt\" && $1!~/^\\+/ && $3<'\"$(awk '/^ \\s*UID_MIN/{print $2}' /etc/login.defs)\"' && $7!=\"'\"$(which nologin)\"'\" && $7!=\"/bin/false\" && $7!=\"/usr/bin/false\") {print $1}' /etc/passwd | whi le read -r user; do usermod -s \"$(which nologin)\" \"$user\"; done The following command will automatically lock not root system accounts: awk -F: '($1!=\"root\" && $1!~/^ \\+/ && $3<'\"$(awk '/^ \\s*UID_MIN/{print $2}' /etc/login.defs)\"') {print $1}' /etc/passwd | xargs -I '{}' passwd -S '{}' | awk '($2!=\"L\" && $2!=\"LK\") {print $1}' | while read -r user; do usermod -L \"$user\"; done CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 16 Account Monitoring and Control Account Monitoring and Control 525 | P a g e"
    },
    {
      "id": "5.5.3",
      "title": "Ensure default group for the root account is GID 0",
      "section": "Section 5.5",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.5.3",
      "description": "The usermod command can be used to specify which group the root user belongs to. This affects permissions of files that are created by the root user.",
      "rationale": "Using GID 0 for the root account helps prevent root -owned files from accidentally becoming accessible to non -privileged users.",
      "remediation": ": Run the following command to set the root user default group to GID 0 : # usermod -g 0 root 526 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 527 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify the result is 0 : # grep \"^root:\" /etc/pas swd | cut -f4 -d: 0"
    },
    {
      "id": "5.5.4",
      "title": "Ensure default user shell timeout is configured",
      "section": "Section 5.5",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.5.4",
      "description": "TMOUT is an environmental setting that determines the timeout of a shell in seconds. \uf0b7 TMOUT= n - Sets the shell timeout to n seconds. A setting of TMOUT=0 disables timeout. \uf0b7 readonly TMOUT - Sets the TMOUT environmental variable as readonly, preventing unwanted modification during run -time. \uf0b7 export TMOUT - exports the TMOUT variable System Wide Shell Configuration Files: \uf0b7 /etc/prof ile - used to set system wide environmental variables on users shells. The variables are sometimes the same ones that are in the .bash_profile , however this file is used to set an initial PATH or PS1 for all shell users of the system. is only executed for interactive login shells, or shells executed with the --login parameter. \uf0b7 /etc/profile.d - /etc/profile will execute the scripts within /etc/profile.d/*.sh . It is recommended to place your configuration in a shell script within /etc/profile.d to set your own system wide environmental variables. \uf0b7 /etc/bashrc - System wide version of .bashrc . In Fedora derived distributions, etc/bashrc also invokes /etc/profile.d/*.sh if non-login shell, but redirects output to /dev/null if non-interactive. Is on ly executed for interactive shells or if BASH_ENV is set to /etc/bashrc .",
      "rationale": "Setting a timeout value reduces the window of opportunity for unauthorized user access to another user's shell session that has been left unattended. It also ends the inac tive session and releases the resources associated with that session. 528 | P a g e",
      "remediation": ": Review /etc/bashrc , /etc/profile , and all files ending in *.sh in the /etc/profile.d/ directory and remove or edit all TMOUT=_n_ entries to follow local site policy. TMOUT should not exceed 900 or be equal to 0. Configure TMOUT in one of the following files: \uf0b7 A file in the /etc/profile.d/ directory ending in .sh \uf0b7 /etc/profile \uf0b7 /etc/bashrc TMOUT configuration examples: \uf0b7 As multiple lines: TMOUT=900 readonly TMOUT export TMOUT \uf0b7 As a single line: readonly TMOUT=900 ; export TMOUT 529 | P a g e Additional Information: \uf0b7 The audit and remediation in this recommendation apply to bash and shell. If other shells are supported on the system, it is recommended that their configuration files are also checked. Other methods of setting a timeout exist for other shells not covered here. \uf0b7 Ensure that the timeout conforms to your local policy. CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.3 Configure Automatic Session Locking on Enterprise Assets Configure automatic session locking on enterprise assets after a defined period of inactivity. For general purpose operating systems, the period must not exceed 15 minutes. For mobile end -user devices, the period must not exceed 2 minutes. \u25cf \u25cf \u25cf v7 16.11 Lock Workstation Sessions After Inactivity Automatically lock workstation sessions after a standard period of inactivity. \u25cf \u25cf \u25cf 530 | P a g e",
      "impact": "None",
      "audit_command": "Run the following script to verify that TMOUT is configured to: include a timeout of no more than 900 seconds, to be readonly , to be exported , and is not being changed to a long er timeout. #!/bin/bash output1=\"\" output2=\"\" [ -f /etc/bashrc ] && BRC=\"/etc/bashrc\" for f in \"$BRC\" /etc/profile /etc/profile.d/*.sh ; do grep -Pq '^\\s*([^#]+ \\s+)?TMOUT=(900|[1 -8][0-9][0-9]|[1-9][0-9]|[1-9])\\b' \"$f\" && grep -Pq '^\\s*([^#]+; \\s*)?reado nly\\s+TMOUT( \\s+|\\s*;|\\s*$|=(900|[1 - 8][0-9][0-9]|[1-9][0-9]|[1-9]))\\b' \"$f\" && grep -Pq '^\\s*([^#]+; \\s*)?export \\s+TMOUT( \\s+|\\s*;|\\s*$|=(900|[1 -8][0-9][0-9]|[1-9][0- 9]|[1-9]))\\b' \"$f\" && output1=\"$f\" done grep -Pq '^\\s*([^#]+ \\s+)?TMOUT=(9[0 -9][1-9]|9[1-9][0-9]|0+|[1 -9]\\d{3,})\\b' /etc/profile /etc/profile.d/*.sh \"$BRC\" && output2=$(grep -Ps '^\\s*([^#]+ \\s+)?TMOUT=(9[0 -9][1-9]|9[1-9][0-9]|0+|[1 -9]\\d{3,})\\b' /etc/profile /etc/profile.d/*.sh $BRC) if [ -n \"$output1\" ] && [ -z \"$output2\" ]; then echo -e \"\\nPASSED\\n\\nTMOUT is configured in: \\\"$output1 \\\"\\n\" else [ -z \"$output1\" ] && echo -e \"\\nFAILED\\n\\nTMOUT is not configured \\n\" [ -n \"$output2\" ] && echo -e \"\\nFAILED\\n\\nTMOUT is incorrectly configured in: \\\"$output2 \\\"\\n\" fi"
    },
    {
      "id": "5.5.5",
      "title": "Ensure default user umask is configured",
      "section": "Section 5.5",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.5.5",
      "description": "Ensure default user umask is configured",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "system file permissions (Manual) ................................ ................................ ... 541"
    }
  ]
}