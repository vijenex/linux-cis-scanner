{
  "milestone": "3.5",
  "version": "1.0.0",
  "description": "CentOS Linux 7 CIS Benchmark v3.1.2 - Section 3.5",
  "controls": [
    {
      "id": "3.5.1.1",
      "title": "Ensure firewalld is installed",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": true,
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.1.1",
      "description": "firewalld is a firewall management tool for Linux operating systems. It provides firewall features by acting as a front -end for the Linux kernel's netfilter framework via the iptables backend or provides firewall features by acting as a front -end for the Linux kernel's netfilter framework via the nftables utility. firewalld replaces iptables as the default firewall management tool. Use the firewalld utility to configure a firewall for less complex firewalls. The utility is easy to use and covers the typical use cases scenario. FirewallD supports both IPv4 and IPv6 n etworks and can administer separate firewall zones with varying degrees of trust as defined in zone profiles. Note: Starting in v0.6.0, FirewallD added support for acting as a front -end for the Linux kernel's netfilter framework via the nftables userspace utility, acting as an alternative to the nft command line program.",
      "rationale": "A firewall utility is required to configure the Linux kernel's netfilter framework via the iptables or nftables back -end. The Linux kernel's netfilter framework host -based firewa ll can protect against threats originating from within a corporate network to include malicious mobile code and poorly configured software on a host. Note: Only one firewall utility should be installed and configured. FirewallD is dependent on the iptables package. Impact: Changing firewall settings while connected over the network can result in being locked out of the system. 257 | P a g e",
      "remediation": ": Run the following command to install FirewallD and iptables : # yum install firewalld iptables CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.4 Implement and Manage a Firewall on Servers Implement and manage a firewall on servers, where supported. Example implementations include a virtual firewall, operating system firewall, or a third - party firewall agent. \u25cf \u25cf \u25cf v7 9.4 Apply Host -based Firewalls or Port Filtering Apply host -based firewalls or port filtering tools on end systems, with a default - deny rule that drops all traffic except those services and ports that are explicitly allowed. \u25cf \u25cf \u25cf 258 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command to verify that FirewallD and iptables are installed: # rpm -q firewalld iptables firewalld -<version> iptables -<version>",
      "package_name": "firewalld",
      "expected_status": "installed"
    },
    {
      "id": "3.5.1.2",
      "title": "Ensure iptables -services not installed with firewalld",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": true,
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.1.2",
      "description": "The iptables -services package contains the iptables.service and ip6tables.service . These services allow for management of the Host Based Firewall provided by the iptables package.",
      "rationale": "iptables.service and ip6tables.service are still supported and can be installed with the iptables -services package. Running both firewalld and the services included in the iptables -services package may lead to conflict. Impact: Running both firewalld and iptables/ip6table s service may lead to conflict.",
      "remediation": ": Run the following commands to stop the servi ces included in the iptables -services package and remove the iptables -services package # systemctl stop iptables # systemctl stop ip6tables # yum remove iptables -services 259 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.4 Implement and Manage a Firewall on Servers Implement and manage a firewall on servers, where supported. Example implementations include a virtual firewall, operating system firewall, or a third - party firewall agent. \u25cf \u25cf \u25cf v8 4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software Uninstall or disable unnecessary services on enterprise assets and software, such as an unused file sharing service, web application module, or service function. \u25cf \u25cf v7 9.4 Apply Host -based Firewalls or Port Filtering Apply host -based firewalls or port filtering tools on end systems, with a default - deny rule that drops all traffic except those services and ports that are explicitly allowed. \u25cf \u25cf \u25cf 260 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands to verify that the iptables -services package is not installed # rpm -q iptables -services package iptables -services is not installed",
      "expected_status": "installed"
    },
    {
      "id": "3.5.1.3",
      "title": "Ensure nftables either not installed or masked with firewalld",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": true,
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.1.3",
      "description": "Ensure nftables either not installed or masked with firewalld",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required",
      "expected_status": "installed"
    },
    {
      "id": "3.5.1.4",
      "title": "Ensure firewalld service enabled and running",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.1.4",
      "description": "Ensure firewalld service enabled and running",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required",
      "service_name": "firewalld",
      "expected_status": "enabled"
    },
    {
      "id": "3.5.1.5",
      "title": "Ensure firewalld default zone is set",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.1.5",
      "description": "A firewall zone defines the trust level for a connection, interface or source address binding. This is a one to many relation, which means that a connection, interface or source can only be part of one zone, but a zone can be used for many network connections, interfaces and sources. \uf0b7 The default zone is the zone that is used for everything that is not explicitly bound/assigned to another zone. \uf0b7 If no zone assigned to a connection, interface or source, only the default zone is used. \uf0b7 The default zone is not always listed as being used for an interface or source as it will be used for it either way. This depends on the manager of the interfaces. Connections handled by NetworkManager are listed as NetworkManager requests to add the zone binding for the interface used by the connection. Also interfaces under control of the network service are listed also because the service requests it. Note: \uf0b7 A firewalld zone configuration file contains the information for a zone. o These are the zone description, services, ports, protocols, icmp -blocks, masquerade, forward -ports and rich language rules in an XML file format. o The file name has to be zone_name.xml where length of zone_name is currently limited to 17 chars. \uf0b7 NetworkManager binds interfaces to zones automatically",
      "rationale": "Because the default zone is the zone th at is used for everything that is not explicitly bound/assigned to another zone, it is important for the default zone to set",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": ": Run the following command and verify that the default zone adheres to company policy: # firewall -cmd --get-default-zone 265 | P a g e Reme diation: Run the following command to set the default zone: # firewall -cmd --set-default-zone=<NAME_OF_ZONE> Example: # firewall -cmd --set-default-zone=public",
      "service_name": "zone"
    },
    {
      "id": "3.5.1.6",
      "title": "Ensure network interfaces are assigned to appropriate zone",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": false,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.1.6",
      "description": "firewall zones define the trust level of network connections or interfaces.",
      "rationale": "A network interface not assigned to the appropriate zone can allow unexpected or undesired network traffic to be accepted on the interface. Impact: Changing firewall settings while connected over network can result in being locked out of the system.",
      "remediation": "Run the following comman d to assign an interface to the approprate zone. # firewall -cmd --zone=<Zone NAME> --change-interface=<INTERFACE NAME> Example: # firewall -cmd --zone=customezone --change-interface=eth0 267 | P a g e Default Value: default zone defined in the firewalld configuration",
      "impact": "None",
      "audit_command": "Run the following and verify that the interface(s) follow site policy for zone a ssignment # find /sys/class/net/* -maxdepth 1 | awk -F\"/\" '{print $NF}' | while read -r netint; do [ \"$netint\" != \"lo\" ] && firewall -cmd --get-active-zones | grep - B1 $netint; done Example output: <custom zone> eth0"
    },
    {
      "id": "3.5.1.7",
      "title": "Ensure firewalld drops unnecessary services and ports",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.1.7",
      "description": "Ensure firewalld drops unnecessary services and ports",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "3.5.2.1",
      "title": "Ensure nftables is installed",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": true,
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.2.1",
      "description": "nftables provides a new in -kernel packet classification framew ork that is based on a network -specific Virtual Machine (VM) and a new nft userspace command line tool. nftables reuses the existing Netfilter subsystems such as the existing hook infrastructure, the connection tracking system, NAT, userspace queuing and l ogging subsystem. Note: \uf0b7 nftables is available in Linux kernel 3.13 and newer. \uf0b7 Only one firewall utility should be installed and configured.",
      "rationale": "nftables is a subsystem of the Linux kernel that can protect against threats originating from within a corporate network to include malicious mobile code and poorly configured software on a host. Impact: Changing firewall settings while connected over the network can result in being locked out of the system.",
      "remediation": ": Run the following command to install nftables # yum install nftables 274 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.4 Implement and Manage a Firewall on Servers Implement and manage a firewall on servers, where supported. Example implementations include a virtual firewall, operating system firewall, or a third - party firewall agent. \u25cf \u25cf \u25cf v7 9.4 Apply Host -based Firewalls or Port Filtering Apply host -based firewalls or port filtering tools on end systems, with a default - deny rule that drops all traffic except those services and ports that are explicitly allowed. \u25cf \u25cf \u25cf 275 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command to verify that nftables is installed: # rpm -q nftables nftables -<version>",
      "package_name": "nftables",
      "expected_status": "installed"
    },
    {
      "id": "3.5.2.10",
      "title": "Ensure nftables service is enabled",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.2.10",
      "description": "The nftables service allows for the loading of nftables rulesets during boot, or starting on the nftables service",
      "rationale": "The nftables service restores the nftables rules from the rules files referenced in the /etc/sysconfig/nftables.conf file during boot or the starting of the nftables service",
      "remediation": ": Run the following command to enabl e the nftables service: # systemctl enable nftables CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.4 Implement and Manage a Firewall on Servers Implement and manage a firewall on servers, where supported. Example implementations include a virtual firewall, operating system firewall, or a third - party firewall agent. \u25cf \u25cf \u25cf v7 9.4 Apply Host -based Firewalls or Port Filtering Apply host -based firewalls or port filtering tools on end systems, with a default - deny rule that drops all traffic except those services and ports that are explicitly allowed. \u25cf \u25cf \u25cf 292 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify that the nftables service is enabled: # systemctl is -enabled nftables enabled",
      "service_name": "nftables",
      "expected_status": "enabled"
    },
    {
      "id": "3.5.2.11",
      "title": "Ensure nftables rules are permanent",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.2.11",
      "description": "Ensure nftables rules are permanent",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "3.5.2.2",
      "title": "Ensure firewalld is either not installed or masked with nftables",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": true,
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.2.2",
      "description": "Ensure firewalld is either not installed or masked with nftables",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required",
      "expected_status": "installed"
    },
    {
      "id": "3.5.2.3",
      "title": "Ensure iptables -services not installed with nftables",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": true,
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.2.3",
      "description": "The iptables -services package contains the iptables.service and ip6tables.service . These services allow for management of the Host Based Firewall provided by the iptables package.",
      "rationale": "iptables.service and ip6tables.service are still sup ported and can be installed with the iptables -services package. Running both nftables and the services included in the iptables -services package may lead to conflict.",
      "remediation": ": Run the following commands to stop the services included in the iptables -services package and remove the iptables -services package # systemctl stop iptables # systemctl stop ip6tables # yum remove iptables -services 278 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.4 Implement and Manage a Firewall on Servers Implement and manage a firewall on servers, where supported. Example implementations include a virtual firewall, operating system firewall, or a third - party firewall agent. \u25cf \u25cf \u25cf v8 4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software Uninstall or disable unnecessary services on enterprise assets and software, such as an unused file sharing service, web application module, or service function. \u25cf \u25cf v7 9.4 Apply Host -based Firewalls or Port Filtering Apply host -based firewalls or port filtering tools on end systems, with a default - deny rule that drops all traffic except those services and ports that are explicitly allowed. \u25cf \u25cf \u25cf 279 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands to verify that the iptables -services package is not ins talled # rpm -q iptables -services package iptables -services is not installed",
      "expected_status": "installed"
    },
    {
      "id": "3.5.2.4",
      "title": "Ensure iptables are flushed with nftables",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.2.4",
      "description": "nftables is a replacement for iptables, ip6tables, ebtables and arptables",
      "rationale": "It is possible to mix iptables and nftables. However, this increases complexity and also the chance to introduce errors. For simplicity flush out all iptables rules, and ensure it is not loaded",
      "remediation": ": Run the following commands to flush iptables: For iptables: # iptables -F For ip6tables: # ip6tables -F 280 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.4 Implement and Manage a Firewall on Servers Implement and manage a firewall on servers, where supported. Example implementations include a virtual firewall, operating system firewall, or a third - party firewall agent. \u25cf \u25cf \u25cf v7 9.4 Apply Host -based Firewalls or Port Filtering Apply host -based firewalls or port filtering tools on end systems, with a default - deny rule that drops all traffic except those services and ports that are explicitly allowed. \u25cf \u25cf \u25cf 281 | P a g e",
      "impact": "None",
      "audit_command": "Run the f ollowing commands to ensure not iptables rules exist For iptables: # iptables -L No rules should be returned For ip6tables: # ip6tables -L No rules should be returned"
    },
    {
      "id": "3.5.2.5",
      "title": "Ensure an nftables table exists",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.2.5",
      "description": "Tables hold chains. Each table only has one address family and only applies to packets of this family. Tables can have one of five families.",
      "rationale": "nftables doesn't have any default tables. Without a table being build, nftables will not filter network traffic. Impact: Adding rules to a running nftables can cause loss of conne ctivity to the system",
      "remediation": ": Run the following command to create a table in nftables # nft create table inet <table name> Example: # nft create table inet filter 282 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.4 Implement and Manage a Firewall on Servers Implement and manage a firewall on servers, where supported. Example implementations include a virtual firewall, operating system firewall, or a third - party firewall agent. \u25cf \u25cf \u25cf v7 9.4 Apply Host -based Firewalls or Port Filtering Apply host -based firewalls or port filtering tools on end systems, with a default - deny rule that drops all traffic except those services and ports that are explicitly allowed. \u25cf \u25cf \u25cf 283 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command to verify that a nftables table exists: # nft list tables Return should include a list of nftables: Example: table inet filter"
    },
    {
      "id": "3.5.2.6",
      "title": "Ensure nftables base chains exist",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.2.6",
      "description": "Chains are containers for rules. They exist in two kinds, base chains and regular chains. A base chain is an entry point for packets from the networking stack, a regular chain may be used as jump target and is used for better rule organization.",
      "rationale": "If a base chain doesn't ex ist with a hook for input, forward, and delete, packets that would flow through those chains will not be touched by nftables. Impact: If configuring nftables over ssh, creating a base chain with a policy of drop will cause loss of connectivity. Ensure that a rule allowing ssh has been added to the base chain prior to setting the base chain's policy to drop",
      "remediation": ": Run the following command to create the base chains: # nft cr eate chain inet <table name> <base chain name> { type filter hook <(input|forward|output)> priority 0 \\; } Example: # nft create chain inet filter input { type filter hook input priority 0 \\; } # nft create chain inet filter forward { type filter hook forward priority 0 \\; } # nft create chain inet filter output { type filter hook output priority 0 \\; } CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.4 Implement and Manage a Firewall on Servers Implement and manage a firewall on servers, where supported. Example implementations include a virtual firewall, operating system firewall, or a third - party firewall agent. \u25cf \u25cf \u25cf v7 9.4 Apply Host -based Firewalls or Port Filtering Apply host -based firewalls or port filtering tools on end systems, with a default - deny rule that drops all traffic except those services and ports that are explicitly allowed. \u25cf \u25cf \u25cf 285 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands and verify that base chains exist for INPUT , FORWARD , and OUTPUT . # nft list ruleset | grep 'hook input' type filter h ook input priority 0; # nft list ruleset | grep 'hook forward' type filter hook forward priority 0; # nft list ruleset | grep 'hook output' type filter hook output priority 0; 284 | P a g e"
    },
    {
      "id": "3.5.2.7",
      "title": "Ensure nftables loopback traffic is configured",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.2.7",
      "description": "Configure the loopback interface to accept traffic. Configure all other interfaces to deny traffic to the loopback network",
      "rationale": "Loopback traffic is generated between processes on machine and is typically critical to operation of the system. The loopback interface is the only place that loopback network traffic should be seen, all other interfaces should ignore traffic on this network as an anti - spoofing measure.",
      "remediation": ": Run the following commands to implement the loopback rules: # nft add rule inet filter input iif lo accept # nft create rule inet filter input ip saddr 127.0.0.0/8 counter drop IF IPv6 is enabled: Run the following command to implement t he IPv6 loopback rules: # nft add rule inet filter input ip6 saddr ::1 counter drop CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.4 Implement and Manage a Firewall on Servers Implement and manage a firewall on servers, where supported. Example implementations include a virtual firewall, operating system firewall, or a third - party firewall agent. \u25cf \u25cf \u25cf v7 9.4 Apply Host -based Firewalls or Port Filtering Apply host -based firewalls or port filtering tools on end systems, with a default - deny rule that drops all traffic except those services and ports that are explicitly allowed. \u25cf \u25cf \u25cf 287 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands to verify that the loopback interface i s configured: # nft list ruleset | awk '/hook input/,/}/' | grep 'iif \"lo\" accept' iif \"lo\" accept # nft list ruleset | awk '/hook input/,/}/' | grep 'ip saddr' ip saddr 127.0.0.0/8 counter packets 0 bytes 0 drop IF IPv6 is enabled, run the following co mmand to verify that the IPv6 loopback interface is configured: # nft list ruleset | awk '/hook input/,/}/' | grep 'ip6 saddr' ip6 saddr ::1 counter packets 0 bytes 0 drop OR Verify that IPv6 is disabled: Run the following script. Output will confirm if I Pv6 is disabled on the system. 286 | P a g e #!/bin/bash [ -n \"$passing\" ] && passing=\"\" [ -z \"$(grep \"^ \\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disabled=1)\" ] && passing=\"true\" grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" /etc/sysctl.co nf \\ /etc/sysctl.d/*.conf && grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" \\ /etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$ \" && \\ sysctl net.ipv6.conf.default.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" && passing=\"true\" if [ \"$passing\" = true ] ; then echo \"IPv6 is disabled on the system\" else echo \"IPv6 is enabled on the syste m\" fi",
      "parameter_name": "ipv6.disabled",
      "expected_value": "1"
    },
    {
      "id": "3.5.2.8",
      "title": "Ensure nftables outbound and established connections are configured",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.2.8",
      "description": "Ensure nftables outbound and established connections are configured",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "3.5.2.9",
      "title": "Ensure nftables default deny firewall policy (Automat ed)",
      "section": "Section 3.5",
      "profile": "Level1",
      "automated": false,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 3.5.2.9",
      "description": "Base chain policy is the default verdict that will be applied to packets reaching the end of the chain.",
      "rationale": "There are two policies: accept (Default) and drop. If the policy is set to accept , the firewall will accept any packet that is not configured to be denied and the packet will continue traversing the network stack. It is easier to white list acceptable usag e than to black list unacceptable usage. Note: Changing firewall settings while connected over the network can result in being locked out of the system. Impact: If configuring nftables over ssh, creating a base chain with a policy of drop will cause loss o f connectivity. Ensure that a rule allowing ssh has been added to the base chain prior to setting the base chain's policy to drop",
      "remediation": "Run the f ollowing command for the base chains with the input, forward, and output hooks to implement a default DROP policy: # nft chain <table family> <table name> <chain name> { policy drop \\; } Example: # nft chain inet filter input { policy drop \\; } # nft chain inet filter forward { policy drop \\; } # nft chain inet filter output { policy drop \\; } Default Value: accept",
      "impact": "None",
      "audit_command": "Run the following commands and verify that base chains contain a policy of DROP . # nft list ruleset | grep 'hook input' type filter hook input priority 0; policy drop; # nft list ruleset | grep 'hook forward' type filter hook forward priority 0; policy drop; # nft list ruleset | grep 'hook output' type filter hook output priority 0; policy drop; 290 | P a g e"
    }
  ]
}