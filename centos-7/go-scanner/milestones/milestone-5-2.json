{
  "milestone": "5.2",
  "version": "1.0.0",
  "description": "CentOS Linux 7 CIS Benchmark v3.1.2 - Section 5.2",
  "controls": [
    {
      "id": "5.2.1",
      "title": "Ensure sudo is installed",
      "section": "Section 5.2",
      "profile": "Level1",
      "automated": true,
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.2.1",
      "description": "sudo allows a permitted user to execute a command as the superuser or another user, as specified by the security policy. The invoking user's real (not effective) user ID is used to determine the user name with which to query the security policy.",
      "rationale": "sudo supports a plugin architecture for security policies and input/output logging. Third parties can develop and distribute their own policy and I/O logging plugins to work seamlessly with the sudo front end. The defa ult security policy is sudoers, which is configured via the file /etc/sudoers. The security policy determines what privileges, if any, a user has to run sudo. The policy may require that users authenticate themselves with a password or another authenticati on mechanism. If authentication is required, sudo will exit if the user's password is not entered within a configurable time limit. This limit is policy -specific.",
      "remediation": "Run the following command to install sudo. # yum install sudo",
      "impact": "None",
      "audit_command": "Verify that sudo in installed. Run the following command: # rpm -q sudo sudo-<VERSION >",
      "package_name": "sudo",
      "expected_status": "installed"
    },
    {
      "id": "5.2.11",
      "title": "Ensure only approved MAC algorithms are used (Ticket 6474)",
      "section": "Section 5.2",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.2.11",
      "description": "Ensure only approved MAC algorithms are used (Ticket 6474)",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "5.2.19",
      "title": "Ensure SSH MaxSessions is set to 4 or less\"",
      "section": "Section 5.2",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.2.19",
      "description": "Ensure SSH MaxSessions is set to 4 or less\"",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "5.2.2",
      "title": "Ensure sudo commands use pty",
      "section": "Section 5.2",
      "profile": "Level1",
      "automated": true,
      "type": "SudoConfig",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.2.2",
      "description": "Ensure sudo commands use pty",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "5.2.3",
      "title": "Ensure sudo log file exists",
      "section": "Section 5.2",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.2.3",
      "description": "sudo can use a custom log file Note: visudo edits the sudoers file in a safe fashion, analogous to vipw(8). visudo locks the sudoers file against multiple simultaneous edits, provides basic sanity checks, and checks for parse errors. If the sudoers file is currently being edited you will receive a message to try again later. The -f option allows you to tell visudo which file to edit.",
      "rationale": "A sudo log file simplifies auditing of sudo commands Impact: Editing the sudo configuration incorrectly can cause sudo to stop functioning",
      "remediation": "edit the file /etc/sudoers or a file in /etc/sudoers.d/ with visudo or visudo -f <PATH TO FILE> and add the following line: Defaults logfile=\"<PATH TO CUSTOM LOG FILE>\" Example: Defaults logfile=\"/var/log/sudo.log\" 444 | P a g e",
      "impact": "None",
      "audit_command": "Verify that sudo has a custom log file configured Run the following command: # grep -Ei '^\\s*Defaults \\s+([^#;]+, \\s*)?logfile \\s*=\\s*(\")?[^#;]+(\")?' /etc/sudoers /etc/sudoers.d/* Defaults logfile=\"/var/log/sudo.log\"",
      "file_path": "/etc/sudoers",
      "pattern": "-Ei"
    }
  ]
}