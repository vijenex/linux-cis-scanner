{
  "milestone": "1.1",
  "version": "1.0.0",
  "description": "CentOS Linux 7 CIS Benchmark v3.1.2 - Section 1.1",
  "controls": [
    {
      "id": "1.1.1.1",
      "title": "Ensure mounting of cramfs filesystems is disabled (Aut omated)",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": false,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.1.1",
      "description": "The cramfs filesystem type is a compressed read -only Linux filesystem embedded in small footprint systems. A cramfs image can be used without having to first decompress the image.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the server. If this filesystem type is not needed, disable it.",
      "remediation": ": Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vim /etc/modprob e.d/cramfs.conf and add the following line: install cramfs /bin/true Run the following command to unload the cramfs module: # rmmod cramfs 21 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annua lly, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 22 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands and verify the output is as indicated: # modprobe -n -v cramfs | grep -E '(cramfs|install)' install /bin/true # lsmod | grep cramfs <No output>"
    },
    {
      "id": "1.1.1.3",
      "title": "Ensure mounting of udf filesystems is disabled",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.1.3",
      "description": "The udf filesystem type is the universal disk format used to implement ISO/IEC 13346 and ECMA -167 specifications. This is an open vendor filesystem type for data storage on a broad range of media. This filesystem type is necessary to support writing DVDs and newe r optical disc formats.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "remediation": ": Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/udf.conf and add the following line: install ud f /bin/true Run the following command to unload the udf module: # rmmod udf 25 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 26 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands and verify the output is as indicated: # modprobe -n -v udf | grep -E '(udf|install)' install /bin/true # lsmod | grep udf <No output>"
    },
    {
      "id": "1.1.12",
      "title": "Ensure /var/tmp partition includes the noexec option",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.12",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Since the /var/tmp filesystem is only intended for temporary f ile storage, set this option to ensure that users cannot run executable binaries from /var/tmp .",
      "remediation": ": For existing /var/tmp partitions, edit the /etc/fstab file and add noexec to the fourth field (mounting options) of the /var/tmp entry. See the fstab(5) manual page for more information. Run the following command to remount /var/tmp : # mount -o remount,noexec /var/tmp 49 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 2.6 Address unapproved software Ensure that unauthorized software is either removed or the inventory is updated in a timely manner \u25cf \u25cf \u25cf 50 | P a g e",
      "impact": "None",
      "audit_command": "If a /var/tmp partition exists, run the following command to verify that the noexec option is set: # findmnt -n /var/tmp | grep -Ev '\\bnoexec\\b' Nothing should be returned",
      "mount_point": "/var/tmp",
      "required_option": "noexec"
    },
    {
      "id": "1.1.13",
      "title": "Ensure /var/tmp partition includes the nodev option",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.13",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /var/tmp filesystem is not intended to support devices, set this option to ensure that users cannot attempt to cr eate block or character special devices in /var/tmp .",
      "remediation": ": For existing /var/tmp partitions, edit the /etc/fstab file and add nodev to the fourth field (mounting options) of the /var/tmp entry. See the fstab(5) manual page for more information. Run the following command to remount /var/tmp : # mount -o remount,node v /var/tmp 51 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non-computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configuration s Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf v7 13 Data Protection Data Protection 52 | P a g e",
      "impact": "None",
      "audit_command": "If a /var/tmp partition exists, run the following command to verify that the nodev option is set: # findmnt -n /var/tmp | grep -Ev '\\bnodev\\b' Nothing should be returned",
      "mount_point": "/var/tmp",
      "required_option": "nodev"
    },
    {
      "id": "1.1.14",
      "title": "Ensure /var/tmp partition includes the nosuid option",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.14",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /var/tmp filesystem is only intended for temporary file storage, set this optio n to ensure that users cannot create setuid files in /var/tmp .",
      "remediation": ": For existing /var/tmp partitions, edit the /etc/fstab file and add nosuid to the fourth field (mounting options) of the /var/tmp entry. See the fstab(5) manual page for more information. Run the following command to remount /var/tmp : # mount -o remount,nosuid /var/tmp 53 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf v7 13 Data Protection Data Protection 54 | P a g e",
      "impact": "None",
      "audit_command": "If a /var/tmp partition exists, run the following command to verify that that the nosuid option is set: # findmnt -n /var/tmp | grep -Ev '\\bnosuid\\b' Nothing should be returned",
      "mount_point": "/var/tmp",
      "required_option": "nosuid"
    },
    {
      "id": "1.1.18",
      "title": "Ensure /home partition includes the nodev option",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.18",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the user partitions are not intended to support devices, set this option to ensure that users cannot attempt to creat e block or character special devices.",
      "remediation": ": For existing /home partitions, edit the /etc/fstab file and add nodev to the fourth field (mounting options) of the /home entry. See the fstab(5) manual page for more information. Run the following command to remount /home : # mount -o remount,nodev /home Additional Information: The actions in this recommendation refer to the /home partition, which is the default user partition. If you have created other user partitions, it is recommended that the Remediation and Audit steps be applied to these partitions as well. 61 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standar d security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf v7 13 Data Protection Data Protection 62 | P a g e",
      "impact": "None",
      "audit_command": "If a /home partition exists, run the following command to verify that that the nodev option is set: # findmnt /home | grep -Ev '\\bnodev\\b' Nothing should be returned",
      "mount_point": "/home",
      "required_option": "nodev"
    },
    {
      "id": "1.1.19",
      "title": "Ensure removable media partitions include noexec option",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.19",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Setting this option on a file system prevents users from executing programs from the removable media. This deters user s from being able to introduce potentially malicious software on the system.",
      "remediation": ": Edit the /etc/fstab file and add noexec to the fourth field (mounting options) of all removable media partitions. Look for entries that have mount points that contain words such as floppy or cdrom. See the fstab(5) manual page for more information. 63 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 2.6 Address unapproved software Ensure that unauthorized software is either removed or the inventory is updated in a timely manner \u25cf \u25cf \u25cf v7 13 Data Protection Data Protection 64 | P a g e",
      "impact": "None",
      "audit_command": "Run the following script and verify that the noexec option is set on all removable media partitions. #!/usr/bin/bash for rmpo in $(lsblk -o RM,MOUNTPOINT | awk -F \" \" '/1/ {print $2}'); do findmnt -n \"$rmpo\" | grep -Ev \"\\bnoexec\\b\" done Nothing should be returned"
    },
    {
      "id": "1.1.2",
      "title": "Ensure /tmp is configured",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.2",
      "description": "The /tmp directory is a world -writable directory used for temporary storage by all users and some applications.",
      "rationale": "Making /tmp its own file system allows an administrator to set the noexec option on the mount, making /tmp useless for an attacker to install executable code. It would also prevent an attacker from establishing a hardlink to a system setuid program and wait for it to be updated. Once the program was updated, the h ardlink would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw. This can be accomplished by either mounting tmpfs to /tmp, or creating a separate partition for /tmp. Impact: Since the /tmp directory is intended to be world -writable, there is a risk of resource exhaustion if it is not bound to a separate partition. Running out of /tmp space is a problem regardless of what kind of filesystem lies under it, but in a default installation a disk -based /tmp will essentially have the whole disk available, as it only creates a single / partition. On the other hand, a RAM -based /tmp as with tmpfs will almost certainly be much smaller, whic h can lead to applications filling up the filesystem much more easily. 27 | P a g e",
      "remediation": "Create or update an entry for /tmp in either /etc/fstab OR in a systemd tmp.mount file: If /etc/fstab is used: configure /etc/fstab as appropriate. Example: tmpfs /tmp tmpfs defaults,rw,nosuid,nodev,noexec,relatime 0 0 Run the following command to remount /tmp # mount -o remount,noexec,nodev,nosuid /tmp OR if systemd tmp.mount file is used: run the following command to create the file /etc/systemd/system/tmp.mount if it doesn't exist: # [ ! -f /etc/systemd/system/tmp.mount ] && cp -v /usr/lib/systemd/system/tmp.mount /etc/systemd/system/ Edit the file /etc/systemd/system/tmp.mo unt: [Mount] What=tmpfs Where=/tmp Type=tmpfs Options=mode=1777,strictatime,noexec,nodev,nosuid 28 | P a g e Run the following command to reload the systemd daemon: # systemctl daemon -reload Run the following command to unmask and start tmp.mount : # systemctl --now unmask tmp.mount",
      "impact": "None",
      "audit_command": "Run the following command and verify output shows /tmp to tmpfs or a system partition: # findmnt -n /tmp /tmp tmpfs tmpfs rw,nosuid,nodev,noexec If /etc/fstab is used: run the following command and verify that tmpfs has been mounted to tmpfs , or a system partition has been created for /tmp # grep -E '\\s/tmp\\s' /etc/fstab | grep -E -v '^\\s*#' tmpfs /tmp tmpfs defaults,noexec,nosuid,nodev 0 0 OR If systemd tmp.mount file is used: run the following command and verify that tmp.mount is enabled: # systemctl show \"tmp.mount\" | grep -i unitfilestate UnitFileState=enabled",
      "file_path": "/tmp"
    },
    {
      "id": "1.1.20",
      "title": "Ensure nodev option set on removable media partitions",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.20",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Removable media containing character and block special devices coul d be used to circumvent security controls by allowing non -root users to access sensitive device files such as /dev/kmem or the raw disk partitions.",
      "remediation": ": Edit the /etc/fstab file and add nodev to the fourth field (mounting options) of all removable media partitions. Look for entries that have mount points that contain words such as floppy or cdrom. See the fstab(5) manual page for more information. 65 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review an d update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating syste ms and software. \u25cf \u25cf \u25cf v7 13 Data Protection Data Protection 66 | P a g e",
      "impact": "None",
      "audit_command": "Run the following script and verify that the nodev option is set on all removable media partitions. #!/usr/bin/bash for rmpo in $(lsblk -o RM,MOUNTPOINT | awk -F \" \" '/1/ {print $2}'); do findmnt -n \"$rmpo\" | grep -Ev \"\\bnodev\\b\" done Nothing should be returned"
    },
    {
      "id": "1.1.21",
      "title": "Ensure nosuid option set on removable media partitions",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.21",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Setting this option on a file system prevents users from introducing privileged programs onto the system and allowing non -root users to execute them.",
      "remediation": ": Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) of all removable media partitions. Look for entries that have mount points that contain words such as floppy or cdrom. See the fstab(5) manual page fo r more information. 67 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Confi gurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf v7 13 Data Protection Data Protection 68 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify that the nosuid option is set on all removable media partitions. #!/usr/bin/bash for rmpo in $(lsblk -o RM,MOUNTPOINT | awk -F \" \" '/1/ {print $2}'); do findmnt -n \"$rmpo\" | grep -Ev \"\\bnosuid\\b\" done Nothing shoul d be returned"
    },
    {
      "id": "1.1.22",
      "title": "Ensure sticky bit is set on all world -writable directories",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.22",
      "description": "Ensure sticky bit is set on all world -writable directories",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "1.1.3",
      "title": "Ensure noexec option set on /tmp partition",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.3",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /tmp .",
      "remediation": ": Edit the /etc/fstab file OR the /etc/systemd/system/local - fs.target.wants/tmp.mount file: IF /etc/fstab is used to mount /tmp Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /tmp partition. See the fstab(5) manual page for more information. Run the following command to remount /tmp : # mount -o remount,noexec /tmp OR if systemd is used to mount /tmp :_ Edit /etc/systemd/system/local -fs.target.wants/tmp.mount to add noexec to the /tmp mount options: [Mount] Options=mode=1777,strictatime,noexec,nodev,nosuid Run the following command to restart the systemd daemon: # systemc tl daemon -reload Run the following command to restart tmp.mount # systemctl restart tmp.mount CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occ ur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 2.6 Address unapproved software Ensure that unauthorized software is either removed or the inventory is updated in a timely manner \u25cf \u25cf \u25cf 32 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command to verify the noexec option is set: # findmnt -n /tmp | grep -Ev '\\bnodev\\b' Nothing should be returned 31 | P a g e",
      "mount_point": "/tmp",
      "required_option": "noexec"
    },
    {
      "id": "1.1.4",
      "title": "Ensure nodev option set on /tmp partition",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.4",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /tmp filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /tmp .",
      "remediation": ": Edit the /etc/fstab file OR the /etc/systemd/system/local - fs.target.wants/tmp.mount file: IF /etc/fstab is used to mount /tmp Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /tmp partition. See the fstab(5) manual page for more information. Run the following command to remount /tmp : # mount -o remount,nodev /tmp OR if systemd is used to mount /tmp : Edit /etc/systemd/system/local -fs.target.wants/tmp.mount to add nodev to the /tmp mount options: [Mount] Options=mode=1777,strictatime,noexec,nodev,nosuid Run the following command to restart the systemd daemon: # systemctl daemon -reload Run the following command to restart tmp.mount # systemctl restart tmp.mount CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 34 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify the nodev option is set: # findmnt -n /tmp -n | grep -Ev '\\bnodev\\b' Nothing should be returned 33 | P a g e",
      "mount_point": "/tmp",
      "required_option": "nodev"
    },
    {
      "id": "1.1.5",
      "title": "Ensure nosuid option set on /tmp partition",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.5",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /tmp .",
      "remediation": ": IF /etc/fstab is used to mount /tmp Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /tmp partition. See the fstab(5) manual page for more information. Run the following command to remount /tmp : # mount -o remount,nosuid /tmp OR if systemd is used to mount /tmp : Edit /etc/systemd/system/loca l-fs.target.wants/tmp.mount to add nosuid to the /tmp mount options: [Mount] Options=mode=1777,strictatime,noexec,nodev,nosuid Run the following command to restart the systemd daemon: # systemctl daemon -reload Run the following command to restart tmp.moun t: 35 | P a g e # systemctl restart tmp.mount CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf v7 13 Data Protection Data Protection 36 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify the nodev option is set: # findmnt -n /tmp -n | grep -Ev '\\bnosuid\\b' Nothing should be returned",
      "mount_point": "/tmp",
      "required_option": "nosuid"
    },
    {
      "id": "1.1.6",
      "title": "Ensure /dev/shm is configured",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.6",
      "description": "/dev/shm is a traditional shared memory concept. One program will create a memory portion, which other processes (if permitted) can access. Mounting tmpfs at /dev/shm is handled autom atically by systemd.",
      "rationale": "Any user can upload and execute files inside the /dev/shm similar to the /tmp partition. Configuring /dev/shm allows an administrator to set the noexec option on the mount, making /dev/shm useless for an attacker to install executable code. It would also prevent an attacker from establishing a hardlink to a system setuid program and wait for it to be updated. Once the program was updated, the hardlink would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw.",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": ": Run the following command and verify output shows /dev/shm is mounted: # findmnt -n /dev/shm tmpfs on /dev/shm type tmpfs (rw,nosuid,nodev,noexec,relatime,seclabel) Run the following command and verify an entry for /dev/shm exists in /etc/fstab : # grep -E '\\s/dev/shm \\s' /etc/fstab tmpfs /dev/shm tmpfs defaults,noexec,nodev,nosuid 0 0 37 | P a g e Remedi ation: Edit /etc/fstab and add or edit the following line: tmpfs /dev/shm tmpfs defaults,noexec,nodev,nosuid,seclabel 0 0 Run the following command to remount /dev/shm : # mount -o remount,noexec,nodev,nosuid /dev/shm Additional Information: \uf0b7 An entry for /dev/shm in /etc/fstab will take precedence. \uf0b7 tmpfs can be resized using the size={size} parameter in /etc/fstab . If we don't specify the size, it will be half the RAM. Resize tmpfs example: tmpfs /dev/shm tmpfs defaults,noexec,nodev,nosu id,size=2G 0 0 CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non-computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configuration s Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf v7 13 Data Protection Data Protection 38 | P a g e",
      "file_path": "/dev/shm"
    },
    {
      "id": "1.1.7",
      "title": "Ensure noexec option set on /dev/shm partition",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.7",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Setting this option on a file system prevents users from executing programs from shared memory. This deters users from introducing potentially malicious software on the system.",
      "remediation": ": Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /dev/shm partition. See the fstab(5) manual page for more information. Run the following command to remount /dev/shm : # mount -o remount,noexec,nodev,nosuid /dev/shm Additional I nformation: /dev/shm is mounted automatically by systemd. /dev/shm needs to be added to /etc/fstab to add mount options even though it is already being mounted on boot. 39 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review an d update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 2.6 Address unapproved software Ensure that unauthorized software is either removed or the inventory is updated in a timely manner \u25cf \u25cf \u25cf v7 13 Data Protection Data Protection 40 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command to verify that the noexec option is set: # findmnt -n /dev/shm | grep -Ev '\\bnoexec\\b' Nothing should be returned",
      "mount_point": "/dev/shm",
      "required_option": "noexec"
    },
    {
      "id": "1.1.8",
      "title": "Ensure nodev option set on /dev/shm partition",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.8",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /dev/shm filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create special devices in /dev/shm partitions.",
      "remediation": ": Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /dev/shm partition. See the fstab(5) manual page for more information. Run the following command to remount /dev/shm : # mount -o remount,noexec,nodev,nosuid /dev/shm Additional Information: /dev/shm is mounted automatically by systemd. /dev/shm needs to be added t o /etc/fstab to add mount options even though it is already being mounted on boot. 41 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that coul d impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf v7 13 Data Protection Data Protection 42 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command to verify that the nodev option is set: # findmnt -n /dev/shm | grep -Ev '\\bnodev\\b' Nothing should be returned",
      "mount_point": "/dev/shm",
      "required_option": "nodev"
    },
    {
      "id": "1.1.9",
      "title": "Ensure nosuid option set on /dev/shm partition",
      "section": "Section 1.1",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 1.1.9",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Setting this option on a file syste m prevents users from introducing privileged programs onto the system and allowing non -root users to execute them.",
      "remediation": ": Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /dev/shm partition. See the fstab(5) manual page for more information. Run the following command to remount /dev/shm : # mount -o remount,noexec,nodev,nosuid /dev/shm Additional Information: /dev/shm is mounted automatically by systemd. /dev/shm needs to be added to /etc/fstab to add mount options even though it is already being mounted on boot. 43 | P a g e CIS Controls: Controls Version Contr ol IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security co nfiguration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf v7 13 Data Protection Data Protection 44 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command to verify that the nosuid option is set: # findmnt -n /dev/shm | grep -Ev '\\bnosuid\\b' Nothing should be returned",
      "mount_point": "/dev/shm",
      "required_option": "nosuid"
    }
  ]
}