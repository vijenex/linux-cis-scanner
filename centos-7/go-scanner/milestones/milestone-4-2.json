{
  "milestone": "4.2",
  "version": "1.0.0",
  "description": "CentOS Linux 7 CIS Benchmark v3.1.2 - Section 4.2",
  "controls": [
    {
      "id": "4.2.1.1",
      "title": "Ensure rsyslog is installed",
      "section": "Section 4.2",
      "profile": "Level1",
      "automated": true,
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 4.2.1.1",
      "description": "The rsyslog software is a recommended replacement to the original syslogd daemon. rsyslog provides improvements over syslogd , including: \uf0b7 connection -oriented (i.e. TCP) transmission of logs \uf0b7 The option to log to database formats \uf0b7 Encryption of log data en route to a central logging server",
      "rationale": "The security enhancements of rsyslog such as connection -oriented (i.e. TCP) transmission of logs, the option to log to database formats, and the encryption of log data en route to a central logging server) justify installing and configuring the package.",
      "remediation": ": Run the following command to install rsyslog: # yum install rsysl og 395 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 8.2 Collect Audit Logs Collect audit logs. Ensure that logging, per the enterprise\u2019s audit log management process, has been enabled across enterprise assets. \u25cf \u25cf \u25cf v7 6.2 Activate audit logging Ensure that local logging has been enabled on all systems and networking devices. \u25cf \u25cf \u25cf v7 6.3 Enable Detailed Logging Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destin ation addresses, and other useful elements. \u25cf \u25cf 396 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command to Verify rsyslog is installed: # rpm -q rsyslog rsyslog-<version>",
      "package_name": "rsyslog",
      "expected_status": "installed"
    },
    {
      "id": "4.2.1.2",
      "title": "Ensure rsyslog Service is enabled and running",
      "section": "Section 4.2",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 4.2.1.2",
      "description": "rsyslog needs to be enabled and running to perform logging",
      "rationale": "If the rsyslog service is not activated the system may default to the syslogd service or lack logging instead.",
      "remediation": ": Run the following command to enable and start rsyslog : # systemctl --now enable rsyslog 397 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 8.2 Collect Audit Logs Collect audit logs. Ensure that logging, per the enterprise\u2019s audit log management process, has been enabled across enterprise assets. \u25cf \u25cf \u25cf v7 6.2 Activate audit logging Ensure that local logging has been enabled on all systems and networking devices. \u25cf \u25cf \u25cf v7 6.3 Enable Detailed Logging Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, desti nation addresses, and other useful elements. \u25cf \u25cf 398 | P a g e",
      "impact": "None",
      "audit_command": "Run one of the following commands to verify rsyslog is enabled: # systemctl is -enabled rsyslog enabled Run the following command to verify that rsyslog is running: # systemctl status rsyslog | grep 'active (running) ' Active: active (running) since <Day date time>",
      "service_name": "rsyslog",
      "expected_status": "enabled"
    },
    {
      "id": "4.2.1.3",
      "title": "Ensure rsyslog default file permissions configured",
      "section": "Section 4.2",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 4.2.1.3",
      "description": "rsyslog will create logfiles that do not already exist on the system. This setting controls what permissions will be applied to these newly created files. The $FileCreateMode parameter specifies the file creation mode with which rsyslogd creates new files. If not specified, the value 0644 is used. Notes: \uf0b7 The value given must always be a 4 -digit octal number, with the initial digit being zero. \uf0b7 This setting can be overridden by a less restrictive setting in any file ending in .conf in the /etc/rsyslog.d/ directory",
      "rationale": "It is important to ensure that log files have the correct permissions to ensure that sensitive data is archived and protected.",
      "remediation": "Edit the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files and set $FileCreateMode to 0640 or more restrictive: $FileCreateMode 0640 399 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify that $FileCreateMode is 0640 or more restrictive: # grep ^ \\$FileCreateMod e /etc/rsyslog.conf /etc/rsyslog.d/*.conf $FileCreateMode 0640 Verify that no results return with a less restrictive file mode"
    },
    {
      "id": "4.2.1.4",
      "title": "Ensure logging is configured",
      "section": "Section 4.2",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 4.2.1.4",
      "description": "The /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files specifies rules for logging and which files are to be used to log certain classes of messages.",
      "rationale": "A great deal of important security -related information is sent via rsyslog (e.g., successful and failed su attempts, failed login attempts, roo t login attempts, etc.).",
      "remediation": "Edit the following lines in the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files as appropriate for your environment: *.emerg :omusrmsg:* auth,authpriv.* /var/log/secure mail.* -/var/log/mail mail.info -/var/log/mail.info mail.warning -/var/log/mail.warn mail.err /var/log/mail.err news.crit -/var/log/news/news.crit news.err -/var/log/news/news.err news.notice -/var/log/news/news.notice *.=warning;*.=err -/var/log/warn *.crit /var/log/warn *.*;mail.none;news.none -/var/log/messages local0,local1.* -/var/log/localmessages local2,local3.* -/var/log/localmessages local4,local5.* -/var/log/ localmessages local6,local7.* -/var/log/localmessages Run the following command to reload the rsyslogd configuration: # systemctl restart rsyslog",
      "impact": "None",
      "audit_command": "Review the contents of the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files to ensure appropriate logging is set. In addition, run the following command and verify that the log files are logging information: # ls -l /var/lo g/ 401 | P a g e"
    },
    {
      "id": "4.2.1.5",
      "title": "Ensure rsyslog is configured to se nd logs to a remote log host",
      "section": "Section 4.2",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 4.2.1.5",
      "description": "Ensure rsyslog is configured to se nd logs to a remote log host",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required",
      "service_name": "rsyslog"
    },
    {
      "id": "4.2.1.6",
      "title": "Ensure remote rsyslog messages are only accepted on designated log",
      "section": "Section 4.2",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 4.2.1.6",
      "description": "Ensure remote rsyslog messages are only accepted on designated log",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "4.2.2.1",
      "title": "Ensure journald is configured to send logs to rsyslog",
      "section": "Section 4.2",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 4.2.2.1",
      "description": "Data from journald may be stored in vola tile memory or persisted locally on the server. Utilities exist to accept remote export of journald logs, however, use of the rsyslog service provides a consistent means of log collection and export. Notes: \uf0b7 This recommendation assumes that recommendation 4 .2.1.5, \"Ensure rsyslog is configured to send logs to a remote log host\" has been implemented. \uf0b7 The main configuration file /etc/systemd/journald.conf is read before any of the custom *.conf files. If there are custom configs present, they override the main configuration parameters \uf0b7 As noted in the journald man pages: journald logs may be exported to rsyslog either through the process mentioned here, or through a facility like systemd- journald.service . There are trade -offs involved in each implementation, where ForwardToSyslog will immediately capture all events (and forward to an external log server, if properly configured), but may not capture all boot -up activities. Mechanisms such as systemd-journald.service , on the other hand, will record bootup events, but may delay sending the information to rsyslog, leading to the potential for log manipulation prior to export. Be aware of the limitations of all t ools employed to secure a system.",
      "rationale": "Storing log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.",
      "remediation": "Edit the /etc/systemd/journald.conf file and add the following line: ForwardToSy slog=yes",
      "impact": "None",
      "audit_command": "Review /etc/systemd/journald.conf and verify that logs are forwarded to syslog # grep -E ^\\s*ForwardToSyslog /etc/systemd/journald.conf ForwardToSyslog=yes 409 | P a g e"
    },
    {
      "id": "4.2.2.2",
      "title": "Ensure journald is configured to compress large log files",
      "section": "Section 4.2",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 4.2.2.2",
      "description": "The journald system includes the capability of compressing overly large files to avoid filling up the system with logs or making the logs unmanageably large. Note: The main configuration file /etc/systemd/journald.conf is read before any of the custom *.conf files. If there are custom configs present, they override the main configuration parameters",
      "rationale": "Uncompressed large files may unexpectedly fill a filesystem leading to resource unavailability. Compressing logs prior to write can prevent sudden, unexpected filesystem impacts.",
      "remediation": "Edit the /etc/systemd/journald.conf file and add the following line: Compress=yes",
      "impact": "None",
      "audit_command": "Review /etc/systemd/journald.conf and verify that large files will be compressed: # grep -E ^\\s*Compress /etc/systemd/journald.conf Compress=yes"
    },
    {
      "id": "4.2.2.3",
      "title": "Ensure journald is configure d to write logfiles to persistent disk",
      "section": "Section 4.2",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 4.2.2.3",
      "description": "Ensure journald is configure d to write logfiles to persistent disk",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "4.2.3",
      "title": "Ensure permissions on all logfiles are configured",
      "section": "Section 4.2",
      "profile": "Level1",
      "automated": false,
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 4.2.3",
      "description": "Log files stored in /var/log/ contain logged information from many services on the system, or on log hosts others as well.",
      "rationale": "It is important to ensure that log files have the correct permissions to ensure that sensitive data is archived and protected. Other/world should not have the ability to view this information. Group should not have the ability to modify this information.",
      "remediation": ": Run the following commands to set permissions on all existing log files: # find /var/log -type f -exec chmod g -wx,o-rwx \"{}\" + Note: The configuration for your logging software or services may need to also be modified for any logs that had incorrect permissions, otherwise, the permissions may be reverted to the incorrect permissions 415 | P a g e CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user\u2019s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 416 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify that other has no permissions on any files and group does not have write or execute permissions on any files: # find /var/log -type f -perm /g+wx,o+rwx -exec ls -l {} \\; Nothing should be returned"
    },
    {
      "id": "4.2.4",
      "title": "Ensure logrotate is configured",
      "section": "Section 4.2",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 4.2.4",
      "description": "Ensure logrotate is configured",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    }
  ]
}