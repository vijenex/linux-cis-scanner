{
  "milestone": "5.3",
  "version": "1.0.0",
  "description": "CentOS Linux 7 CIS Benchmark v3.1.2 - Section 5.3",
  "controls": [
    {
      "id": "5.3.1",
      "title": "Ensure permissions on /etc/ssh/sshd_config are configured",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.1",
      "description": "Ensure permissions on /etc/ssh/sshd_config are configured",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "5.3.1.1",
      "title": "Ensure iptables packages are installed",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.1.1",
      "description": "iptables is a utility program that allows a system administrator to configure the t ables provided by the Linux kernel firewall, implemented as different Netfilter modules, and the chains and rules it stores. Different kernel modules and programs are used for different protocols; iptables applies to IPv4, ip6tables to IPv6, arptables to A RP, and ebtables to Ethernet frames.",
      "rationale": "A method of configuring and maintaining firewall rules is necessary to configure a Host Based Firewall.",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Run the following command to verify that iptables and iptables -services are installed: rpm -q iptables iptables -services iptables -<version> iptables -services -<version>",
      "package_name": "iptables",
      "expected_status": "installed"
    },
    {
      "id": "5.3.1.2",
      "title": "Ensure nftables is not installed with iptables",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.1.2",
      "description": "nftables is a subsystem of the Linux kernel providing filtering and classification of network packets/datagrams/frames and is the successor to iptables.",
      "rationale": "Running both iptables and nftables may lead to conflict.",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Run the following commend to verify that nftables is not installed: # rpm -q nftables package nftables is not installed",
      "expected_status": "installed"
    },
    {
      "id": "5.3.1.3",
      "title": "Ensure firewalld is either not installed or ma sked with iptables",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.1.3",
      "description": "Ensure firewalld is either not installed or ma sked with iptables",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required",
      "expected_status": "installed"
    },
    {
      "id": "5.3.10",
      "title": "Ensure SSH root login is disabled",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.10",
      "description": "The PermitRootLogin parameter specifies if the root user can log in using ssh. The default is no.",
      "rationale": "Disallowing root logins over SSH requires system admins to authenticate using their own individual account, then escalating to root via sudo . This in turn limits opportunity for non - repudiation and provides a clear audit trail in the event of a security incident",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: PermitRootLogin no Default Value: PermitRootLogin without -passw ord",
      "impact": "None",
      "audit_command": "Run the following command and verify that output matches: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep permitrootlogin permitrootlogin no Run the following command and verify the output: # grep -Ei '^\\s*PermitRootLogin \\s+yes' /etc/ssh/sshd_config Nothing should be returned"
    },
    {
      "id": "5.3.11",
      "title": "Ensure SSH PermitEmptyPasswor ds is disabled",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.11",
      "description": "The PermitEmptyPasswords parameter specifies if the SSH server allows login to accounts with empty password strings.",
      "rationale": "Disallowing remote shell access to accounts that have an empty password reduces the probability of unauthorized access to the system",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: PermitEmptyPasswords no Default Value: PermitEmptyPasswords no",
      "impact": "None",
      "audit_command": "Run the following command and verify that output matches: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep permitemptypasswords permitemptypasswords no Run the following command and verify the output: # grep -Ei '^\\s*PermitEmptyPasswords \\s+yes' /etc/ssh/sshd_config Nothing should be returned"
    },
    {
      "id": "5.3.12",
      "title": "Ensure SSH PermitUserEnvironment is disabled",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.12",
      "description": "The PermitUserEnvironment option allows users to present environment options to the ssh daemon.",
      "rationale": "Permitting users the ability to set environment variables through the SSH daemon could potentially allow users to bypass security controls (e.g. setting an execution path tha t has ssh executing a Trojan\u2019s programs)",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: PermitUserEnvironment no Default Value: PermitUserEnvironment no",
      "impact": "None",
      "audit_command": "Run the following command and verify that output matches: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep permituserenvironment permituserenvir onment no Run the following command and verify the output: # grep -Ei '^\\s*PermitUserEnvironment \\s+yes' /etc/ssh/sshd_config Nothing should be returned"
    },
    {
      "id": "5.3.13",
      "title": "Ensure only strong Ciphers are used",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.13",
      "description": "This variable limits the ciphers that SSH can use during communication. Note: Some organizations may have stricter requirements for approved ciphers. Ensure that ciphers used are in compliance with site policy.",
      "rationale": "Weak ciphers that are used for authentication to the cryptographic module cannot be relied upon to provide conf identiality or integrity, and system data may be compromised. \uf0b7 The DES, Triple DES, and Blowfish ciphers, as used in SSH, have a birthday bound of approximately four billion blocks, which makes it easier for remote attackers to obtain cleartext data via a b irthday attack against a long -duration encrypted session, aka a \"Sweet32\" attack \uf0b7 The RC4 algorithm, as used in the TLS protocol and SSL protocol, does not properly combine state data with key data during the initialization phase, which makes it easier for remote attackers to conduct plaintext -recovery attacks against the initial bytes of a stream by sniffing network traffic that occasionally relies on keys affected by the Invariance Weakness, and then using a brute -force approach involving LSB values, aka t he \"Bar Mitzvah\" issue \uf0b7 The passwords used during an SSH session encrypted with RC4 can be recovered by an attacker who is able to capture and replay the session \uf0b7 Error handling in the SSH protocol; Client and Server, when using a block cipher algorithm in C ipher Block Chaining (CBC) mode, makes it easier for remote attackers to recover certain plaintext data from an arbitrary block of ciphertext in an SSH session via unknown vectors 474 | P a g e",
      "remediation": "Edit the /etc/ssh/sshd_config file add/modify the Ciphers line to contain a comma separated list of the site approved ciphers Example: Ciphers chacha20 -poly1305@openssh.com,aes256 -gcm@openssh.com,aes128 - gcm@openssh.com,aes256 -ctr,aes192 -ctr,aes128 -ctr Default Value: Ciphers chacha20 -poly1305@openssh.com,aes128 -ctr,aes192 -ctr,aes256 -ctr,aes128 - gcm@openssh.com,aes256 -gcm@openssh.com,aes128 -cbc,aes1 92-cbc,aes256 - cbc,blowfish -cbc,cast128 -cbc,3des -cbc",
      "impact": "None",
      "audit_command": "Run the following command and verify the output: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -Ei '^\\s*ciphers \\s+([^#]+,)?(3des - cbc|aes128 -cbc|aes192 -cbc|aes256 -cbc|arcfour|arcfour128|arcfour256|blowfish - cbc|cast128 -cbc|rijndael -cbc@lysator.liu.se) \\b' Nothing should be returned Run the following command and verify the output: grep -Ei '^\\s*ciphers \\s+([^#]+,)?(3des -cbc|aes128 -cbc|aes192 -cbc|aes256 - cbc|arcfour|arcfour128|arcfour256|blowfish -cbc|cast128 -cbc|rijndael - cbc@lysator.liu.se) \\b' /etc/ssh/sshd_config Nothing should be returned"
    },
    {
      "id": "5.3.14",
      "title": "Ensure o nly strong MAC algorithms are used",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.14",
      "description": "This variable Specifies the available MAC (message authentication code) algorithms. The MAC algorithm is used in protocol version 2 for data integrity protection. Multiple algorithms must be comma -separated. Note: Some organizations may have stricter requirements for approved MACs. Ensure that MACs used are in compliance with site policy.",
      "rationale": "MD5 and 96 -bit MAC algorit hms are considered weak and have been shown to increase exploitability in SSH downgrade attacks. Weak algorithms continue to have a great deal of attention as a weak spot that can be exploited with expanded computing power. An attacker that breaks the algo rithm could take advantage of a MiTM position to decrypt the SSH tunnel and capture credentials and information",
      "remediation": "Edit the /etc/ssh/sshd_config file and add/modify the MACs line to contain a comma separated list of the site approved MACs Example: MACs hmac -sha2-512-etm@openssh.com,hmac -sha2-256-etm@openssh.com,hmac -sha2- 512,hmac -sha2-256 Default Value: MACs umac -64-etm@openssh.com,umac -128 -etm@openssh.com,hmac -sha2 -256 - etm@openssh.com,hmac -sha2 -512 -etm@openssh.com,hmac -sha1 - etm@openssh.com,umac -64@openssh.com,umac -128@openssh.com,hmac -sha2 - 256,hmac -sha2 -512,hmac -sha1,hmac -sha1 -etm@openssh.com",
      "impact": "None",
      "audit_command": "Run the following command and verify the output: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | aw k '{print $1}')\" | grep -Ei '^\\s*macs\\s+([^#]+,)?(hmac - md5|hmac -md5-96|hmac-ripemd160|hmac -sha1|hmac -sha1-96|umac- 64@openssh \\.com|hmac -md5-etm@openssh \\.com|hmac -md5-96-etm@openssh \\.com|hmac - ripemd160 -etm@openssh \\.com|hmac -sha1-etm@openssh \\.com|hmac -sha1-96- etm@openssh \\.com|umac -64-etm@openssh \\.com|umac -128-etm@openssh \\.com)\\b' Nothing should be returned Run the following command and verify the output: # grep -Ei '^\\s*macs\\s+([^#]+,)?(hmac -md5|hmac -md5-96|hmac-ripemd160|hmac - sha1|hmac -sha1-96|umac-64@openssh \\.com|hmac -md5-etm@openssh \\.com|hmac -md5-96- etm@openssh \\.com|hmac -ripemd160 -etm@openssh \\.com|hmac -sha1- etm@openssh \\.com|hmac -sha1-96-etm@openssh \\.com|umac -64-etm@openssh \\.com|umac - 128-etm@openssh \\.com)\\b' /etc/ssh/sshd_config Nothing should be returned 477 | P a g e"
    },
    {
      "id": "5.3.15",
      "title": "Ensure only strong Key Exchange algorithms are used",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.15",
      "description": "Key exchange is any method in cryptography by which cryptographic keys are exchanged between two parties, allowing use of a cryptographic algorithm. If the sender and receiver wish to exchange encrypted messages, each must be equipped to encrypt messages to be sent and decrypt messages received Note: Some organizations may have stricter requirements for approved Key Exchange algorithms. Ensure that Key Exchange algorithms used are in c ompliance with site policy.",
      "rationale": "Key exchange methods that are considered weak should be removed. A key exchange method may be weak because too few bits are used or the hashing algorithm is considered too weak. Using weak algorithms could expose conn ections to man -in-the-middle attacks",
      "remediation": "Edit the /etc/ssh/sshd_config file add/modify the KexAlgorithms lin e to contain a comma separated list of the site approved key exchange algorithms Example: KexAlgorithms curve25519 -sha256,curve25519 -sha256@libssh.org,ecdh -sha2- nistp521,ecdh -sha2-nistp384,ecdh -sha2-nistp256,diffie -hellman-group-exchange - sha256 Default Val ue: kexalgorithms curve25519 -sha256,curve25519 -sha256@libssh.org,ecdh -sha2 - nistp256,ecdh -sha2 -nistp384,ecdh -sha2 -nistp521,diffie -hellman -group -exchange - sha256,diffie -hellman -group14 -sha1,diffie -hellman -group1 -sha1",
      "impact": "None",
      "audit_command": "Run the following command and verify the output: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -Ei '^\\s*kexalgorithms \\s+([^#]+,)?(diffie -hellman-group1-sha1|diffie -hellman- group14-sha1|diffie -hellman-group-exchange -sha1)\\b' Nothing should be returned Run the following command and verify the output: # grep -Ei '^\\s*kexalgorithms \\s+([^#]+,)?(diffie -hellman-group1-sha1|diffie - hellman-group14-sha1|diffie -hellman-group-exchange -sha1)\\b' /etc/ssh/sshd_config Nothing should be returned 481 | P a g e"
    },
    {
      "id": "5.3.16",
      "title": "Ensure SSH Idle Timeout Interval is configured",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.16",
      "description": "The two options ClientAliveInterval and ClientAliveCountMax control the timeout of ssh sessions. \uf0b7 ClientAliveInterval sets a timeout interval in seconds after which if no data has been received from the client, sshd will send a message through the encrypted channel to request a response from the client. The default is 0, indicating that these messages will not be sent to the client. \uf0b7 ClientAliveCountMax sets the number of client alive messages which may be sent without sshd receiving any messages back from the client. If this threshold is reached while client alive messages are being sent, sshd will disconnect the client, terminating the session. The default value is 3. o The client alive messages are sent through the encrypted channel o Setting ClientAliveCountMax to 0 disables connection termination Example: The default value is 3. If ClientAliveInterval is set to 15, and ClientAliveCountMax is left at the default, unresponsive SSH clients will be disconnected after approximately 45 seconds",
      "rationale": "Having no timeout value associated with a connection could allow an unauthorized user access to another user's ssh session (e. g. user walks away from their computer and doesn't lock the screen). Setting a timeout value reduces this risk. \uf0b7 The recommended ClientAliveInterval setting is no greater than 900 seconds (15 minutes) \uf0b7 The recommended ClientAliveCountMax setting is 0 \uf0b7 At the 15 minute interval, if the ssh session is inactive, the session will be terminated. 484 | P a g e Impact: In some cases this setting may cause termination of long -running scripts over SSH or remote automation tools which rely on SSH. In developing the local site policy, the requirements of such scripts should be considered and appropriate ServerAliveInterval and ClientAliveInterval settings should be calculated to insure operational continuity.",
      "remediation": ": Edit the /etc/ssh/sshd_config file to set the parameters according to site policy. This should include ClientAliveInterval between 1 and 900 and ClientAliveCountMax of 0: ClientAliveInterval 900 ClientAliveCountMax 0 Default Value: ClientAliveInterval 0 ClientAliveCountMax 3 485 | P a g e Reference s: 1. https://man.openbsd.org/sshd_config CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occu r that could impact this Safeguard. \u25cf \u25cf \u25cf v7 16.11 Lock Workstation Sessions After Inactivity Automatically lock workstation sessions after a standard period of inactivity. \u25cf \u25cf \u25cf 486 | P a g e",
      "impact": "None",
      "audit_command": "Run the following commands and verify ClientAliveInterval is be tween 1 and 900: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep clientaliveinterval clientaliveinterval 900 Run the following command and verify ClientAliveCountMax is 0: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep clientalivecountmax clientalivecountmax 3 Run the following commands and verify the output: # grep -Ei '^\\s*ClientAliveInterval \\s+(0|9[0 -9][1-9]|[1-9][0-9][0-9][0- 9]+|1[6-9]m|[2-9][0-9]m|[1-9][0-9][0-9]+m)\\b' /etc/ssh/sshd_config Nothing should be returned # grep -Ei '^\\s*ClientAliveCountMax \\s+([1-9]|[1-9][0-9]+)\\b' /etc/ssh/sshd_config Nothing should be returned"
    },
    {
      "id": "5.3.17",
      "title": "Ensure SSH LoginGraceTime is set to one minute or less",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.17",
      "description": "The LoginGraceTime parameter specifies the time allowed for successful authentication to the SSH server. The longer the Grace period is the more open unauthenticated connections can exist. Like other session controls in this session the Grace Period should be limited to appropriate organizational limits to ensure the service is available for needed access.",
      "rationale": "Setting the LoginGraceTime parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. It will also limit the number o f concurrent unauthenticated connections While the recommended setting is 60 seconds (1 Minute), set the number based on site policy.",
      "remediation": ": Edit the /etc/ssh/sshd_config file to set the parameter as follows: LoginGraceTime 60 487 | P a g e Default Value: LoginGraceTime 2m Referen ces: 1. SSHD_CONFIG(5) CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.1 Establish and Maintain a Secure Configuration Process Establish and maintain a secure configuration process for enterprise assets (end - user devices, including portable and mobile, non -computing/IoT devices, and servers) and software (operating systems and applications). Review and update documentation annually, or when significant enterprise changes occur that could impact this Safeguard. \u25cf \u25cf \u25cf v7 5.1 Establish Secure Configurations Maintain documented, standard security configuration standards for all authorized operating systems and software. \u25cf \u25cf \u25cf 488 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify that output LoginGraceTime is between 1 and 60 seconds or 1m: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep logingracetime logingracetime 60 Run the following command and verify the output: # grep -Ei '^\\s*LoginGraceTime \\s+(0|6[1 -9]|[7-9][0-9]|[1-9][0-9][0- 9]+|[^1]m)' /etc/ssh/sshd_config Nothing should be returned"
    },
    {
      "id": "5.3.18",
      "title": "Ensure SSH warning banner is configured",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.18",
      "description": "The Banner parameter specifies a file whose contents must be sent to the remote user before authentication is permitted. By default, no banner is displayed.",
      "rationale": "Banners are used to warn connecting users of the particular site's policy regarding connection. Presenting a warning message prior to the normal user login may assist the prosecution of trespassers on the computer system.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: Banner /etc/issue.net",
      "impact": "None",
      "audit_command": "Run the following command and verify that output matches: # sshd -T -C user=root -C host=\"$(h ostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep banner banner /etc/issue.net"
    },
    {
      "id": "5.3.19",
      "title": "Ensure SSH PAM is enabled",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.19",
      "description": "UsePAM Enables the Pluggable Authentication Module interface. If set to \u201cyes\u201d this will enable PAM authentication using ChallengeResponseAuthentication and PasswordAuthentication in addition to PAM account and session module processing for all authentication types",
      "rationale": "When useP AM is set to yes, PAM runs through account and session types properly. This is important if you want to restrict access to services based off of IP, time or other factors of the account. Additionally, you can make sure users inherit certain environment var iables on login or disallow access to the server Impact: If UsePAM is enabled, you will not be able to run sshd(5) as a non -root user.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: UsePAM yes 491 | P a g e Default Value: usePAM yes",
      "impact": "None",
      "audit_command": "Run the following command and verify that output matches: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$( grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -i usepam usepam yes Run the following command and verify the output: # grep -Ei '^\\s*UsePAM \\s+no' /etc/ssh/sshd_config Nothing should be returned"
    },
    {
      "id": "5.3.2",
      "title": "Ensure permissions on SSH private host key files are configured",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.2",
      "description": "Ensure permissions on SSH private host key files are configured",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "5.3.2.1",
      "title": "Ensure iptables loopbac k traffic is configured",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.2.1",
      "description": "Configure the loopback interface to accept traffic. Configure all other interfaces to deny traffic to the loopback network (127.0.0.0/8).",
      "rationale": "Loopback traffic is generated between processes on machine and is typically critical to operation of the system. The loopback interface is the only place that loopback network (127.0.0.0/8) traffic should be seen, all other interfaces should ign ore traffic on this network as an anti -spoofing measure. Note: Changing firewall settings while connected over network can result in being locked out of the system.",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Run the following commands and verify output includes the listed rules in order (packet and byte counts may differ): # iptables -L INPUT -v -n Chain INPUT (policy DROP 0 packets, 0 bytes) pkts bytes target prot opt in out source destination 0 0 ACCEPT all -- lo * 0.0.0.0/0 0.0.0.0/0 0 0 DROP all -- * * 127.0.0.0/8 0.0.0.0/0 # iptables -L OUTPUT -v -n Chain OUTPUT (policy DROP 0 packets, 0 bytes) pkts bytes target prot opt in out source destination 0 0 A CCEPT all -- * lo 0.0.0.0/0 0.0.0.0/0"
    },
    {
      "id": "5.3.2.2",
      "title": "Ensure iptables outbound and established connections are configured",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.2.2",
      "description": "Ensure iptables outbound and established connections are configured",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "5.3.2.3",
      "title": "Ensure iptables rules exist for all open ports",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.2.3",
      "description": "Any ports that have been opened on non -loopback addresses need firewall rules to govern traffic.",
      "rationale": "Without a firewall rule configured for open ports default firewall policy will drop all packets to these ports. Note: \uf0b7 Changing firewall settings while connected over network can result in being locked out of the system. \uf0b7 The remediation command opens up the port to traffic from all sources. Consult iptables documentation and set any restrictions in compliance with site policy. 309 | P a g e",
      "remediation": "command opens up the port to traffic from all sources. Consult iptables documentation and set any restrictions in compliance with site policy. 309 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command to determine open ports: # ss -4tuln Netid State Recv -Q Send-Q Local Addres s:Port Peer Address:Port udp UNCONN 0 0 *:68 *:* udp UNCONN 0 0 *:123 *:* tcp LISTEN 0 128 *:22 *:* Run the following command to determine firewall rules: # iptables -L INPUT -v -n Chain INPUT (policy DROP 0 packets, 0 bytes) pkts bytes target prot opt in out source destination 0 0 ACCEPT all -- lo * 0.0.0.0/0 0.0.0.0/0 0 0 DROP all -- * * 127.0.0.0/8 0.0.0.0/0 0 0 ACCEPT tcp -- * * 0.0.0.0/0 0.0.0.0/0 tcp dpt:22 state NEW Verify all open ports listening on non -localhost addresses have at least one firewall rule. Note: The last line identified by the \"tcp dpt:22 state NEW\" identifies it as a firewall rule for new connections on tcp port 22."
    },
    {
      "id": "5.3.2.4",
      "title": "Ensure iptables default deny firewall policy",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.2.4",
      "description": "A default deny all policy on connections ensures that any unconfigured network usage will be rejected.",
      "rationale": "With a default accept policy the firewall will accept any packet that is not configured to be denied. It is easier to white list acceptable usage than to black list unacceptable usage. Note: Changing firewall settings while connected over network can result in being locked out of the system.",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Run the following command and verify that the policy for the INPUT , OUTPUT , and FORWARD chains is DROP or REJECT : # iptables -L Chain INPUT (policy DROP) Chain FORWARD (policy DROP) Chain OUTPUT (policy DROP)"
    },
    {
      "id": "5.3.2.5",
      "title": "Ensure iptables rules are saved",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.2.5",
      "description": "The iptables -services package includes the /etc/sysconfig/iptables file. The iptables rules in this file will be loaded by the iptables.service during boot, or when it is started or re -loaded.",
      "rationale": "If the iptables rules are not saved and a system re -boot occurs, the iptables rules will be lost.",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Review the file /etc/sysconfig/iptables and ensure it contains the complete correct rule -set. Example: /etc/sysconfig/iptables # sample configuration for iptables service # you can edit this manually or use system-config-firewall # Generated by iptables -save v1.4.21 on Wed Mar 25 14:23:37 2020 *filter :INPUT DROP [4:463] :FORWARD DROP [0:0] :OUTPUT DROP [0:0] -A INPUT -i lo -j ACCEPT -A INPUT -s 127.0.0.0/8 -j DROP -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT -A INPUT -p tcp -m tcp --dport 22 -m state --state NEW -j ACCEPT -A OUTPUT -o lo -j ACCEPT -A OUTPUT -p tcp -m state --state NEW,ESTAB LISHED -j ACCEPT -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT COMMIT # Completed on Wed Mar 25 14:23:37 2020 314 | P a g e"
    },
    {
      "id": "5.3.2.6",
      "title": "Ensure iptables is enabled and running",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.2.6",
      "description": "iptables.service is a utility for configuring and maintaining iptables .",
      "rationale": "iptables.service will load the iptables rules saved in the file /etc/sysconfig/iptables at boot, otherwise the iptables rules will be cleared during a re -boot of the system.",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Run the following commands to verify iptables is enabl ed: # systemctl is -enabled iptables enabled Run the following command to verify iptables.service is active and running or exited # systemctl status iptables | grep -E \" Active: active \\((running|exited) \\) \" Active: active (exited) since <day date and time>"
    },
    {
      "id": "5.3.21",
      "title": "Ensure SSH MaxStartups is configured",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.21",
      "description": "The MaxStartups parameter specifies the maximum number of concurrent unauthenticated connections to the SSH daemon.",
      "rationale": "To protect a system from denial of service due to a large number of pending authentication connection attempts, use the rate limiting function o f MaxStartups to protect availability of sshd logins and prevent overwhelming the daemon.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: maxstartups 10:30:60 Default Value: MaxStartups 10:30:10 0 496 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify that output MaxStartups is 10:30:60 or more restrictive: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(ho stname) /etc/hosts | awk '{print $1}')\" | grep -i maxstartups maxstartups 10:30:60 Run the following command and verify the output: # grep -Ei '^\\s*maxstartups \\s+(((1[1 -9]|[1-9][0-9][0-9]+):([0 -9]+):([0 - 9]+))|(([0 -9]+):(3[1 -9]|[4-9][0-9]|[1-9][0-9][0-9]+):([0-9]+))|(([0 -9]+):([0 - 9]+):(6[1 -9]|[7-9][0-9]|[1-9][0-9][0-9]+)))' /etc/ssh/sshd_config Nothing should be returned"
    },
    {
      "id": "5.3.22",
      "title": "Ensure SSH MaxSessions is limited",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.22",
      "description": "Ensure SSH MaxSessions is limited",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "5.3.3",
      "title": "Ensure permissions on SSH public host key files are configured",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.3",
      "description": "Ensure permissions on SSH public host key files are configured",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "5.3.3.1",
      "title": "Ensure ip6table s loopback traffic is configured",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.3.1",
      "description": "Configure the loopback interface to accept traffic. Configure all other interfaces to deny traffic to the loopback network (::1).",
      "rationale": "Loopback traffic is generated between processes on machine and is typically critical to operation of the system. The loopback interface is the only place that loopback network (::1) traffic should be seen, all other interfaces should ignore traf fic on this network as an anti -spoofing measure. Note: Changing firewall settings while connected over network can result in being locked out of the system.",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Run the following commands and verify output includes the listed rules in order (packet and byte counts may differ): # ip6tables -L INPUT -v -n Chain INPUT (policy DROP 0 packets, 0 bytes) pkts bytes target prot opt in out source destination 0 0 ACCEPT all lo * ::/0 ::/0 0 0 DROP all * * ::1 ::/0 # ip6tables -L OUTPUT -v -n Chain OUTPUT (policy DROP 0 packets, 0 bytes) pkts bytes target prot opt in out source destination 0 0 ACCEPT all * lo ::/0 ::/0 OR verify IPv6 is disabled: Run the following script. Output will confirm if IPv6 is disabled on the system. 320 | P a g e #!/bin/bash [ -n \"$passing\" ] && passing=\"\" [ -z \"$(grep \"^ \\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\" grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" /etc/sysctl.conf \\ /etc/sysctl.d/*.conf && grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" \\ /etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" && \\ sysctl net.ipv6.conf.default.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv 6\\s*=\\s*1\\b(\\s+#.*)?$\" && passing=\"true\" if [ \"$passing\" = true ] ; then echo \"IPv6 is disabled on the system\" else echo \"IPv6 is enabled on the system\" fi",
      "parameter_name": "ipv6.disable",
      "expected_value": "1"
    },
    {
      "id": "5.3.3.2",
      "title": "Ensure ip6tables outbound and established connections are configured",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.3.2",
      "description": "Ensure ip6tables outbound and established connections are configured",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Manual review required"
    },
    {
      "id": "5.3.3.3",
      "title": "Ensure ip6tables firewall rules e xist for all open ports",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.3.3",
      "description": "Any ports that have been opened on non -loopback addresses need firewall rules to govern traffic.",
      "rationale": "Without a firewall rule configured for open ports default firewall policy will drop all packets to these ports. Note: \uf0b7 Changing firewall settings while connected over network can result in being locked out of the system. \uf0b7 The remediation command opens up the port to traffic from al l sources. Consult iptables documentation and set any restrictions in compliance with site policy.",
      "remediation": "command opens up the port to traffic from al l sources. Consult iptables documentation and set any restrictions in compliance with site policy.",
      "impact": "None",
      "audit_command": "Run the following command to determine open ports: # ss -6tuln Netid State Recv -Q Send-Q Local Address:Port Peer Address:P ort udp UNCONN 0 0 ::1:123 :::* udp UNCONN 0 0 :::123 :::* tcp LISTEN 0 128 :::22 :::* tcp LISTEN 0 20 ::1:25 :::* Run the following command to determine firewall rules: 324 | P a g e # ip6tables -L INPUT -v -n Chain INPUT (policy DROP 0 packets, 0 bytes) pkts bytes target prot opt in out source destination 0 0 ACCEPT all lo * ::/0 ::/0 0 0 DROP all * * ::1 ::/0 0 0 ACCEPT tcp * * ::/0 ::/0 tcp dpt:22 state NEW Verify all open ports listening on non -localhost addresses have at least one firewall rule. The last line identified by the \"tcp dpt:22 state NEW\" identifies it as a firewall rule for new connections on tcp port 22. OR verify IPv6 is disabled: Run the following script. Output will confirm if IPv6 is disabled on the system. #!/bin/bash [ -n \"$passing\" ] && passing=\"\" [ -z \"$(grep \"^ \\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\" grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" /etc/sysctl.conf \\ /etc/sysctl.d/*.conf && grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" \\ /etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" && \\ sysctl net.ipv6.conf.default.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" && passing=\"true\" if [ \"$passing\" = true ] ; then echo \"IPv6 is disabled on the system\" else echo \"IPv6 is enabled on the system\" fi",
      "parameter_name": "ipv6.disable",
      "expected_value": "1"
    },
    {
      "id": "5.3.3.4",
      "title": "Ensure ip6tables default deny firewall policy",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.3.4",
      "description": "A default deny all policy on connections ensures that any unconfigured network usage will be rejected.",
      "rationale": "With a default accept policy the firewall will accept any packet that is not configured to be denied. It is easier to white list acceptable usage than to black list unacceptable usage. Note: Changing firewall settings while connected over network can result in being locked out of the system.",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Run the following command and verify that the policy for the INPUT, OUTPUT, and FORWA RD chains is DROP or REJECT: # ip6tables -L Chain INPUT (policy DROP) Chain FORWARD (policy DROP) Chain OUTPUT (policy DROP) OR Verify IPv6 is disabled: Run the following script. Output will confirm if IPv6 is disabled on the system. 327 | P a g e #!/bin/bash [ -n \"$passing\" ] && passing=\"\" [ -z \"$(grep \"^ \\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\" grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" /etc/sysctl.conf \\ /etc/sysctl.d/*.conf && grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" \\ /etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" && \\ sysctl net.ipv6.conf.default.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" && passing=\"true\" if [ \"$passing\" = true ] ; then echo \"IPv6 is disabled on the system\" else echo \"IPv6 is enabled on the system\" fi",
      "parameter_name": "ipv6.disable",
      "expected_value": "1"
    },
    {
      "id": "5.3.3.5",
      "title": "Ensure ip6tables rules are saved",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.3.5",
      "description": "Ensure ip6tables rules are saved",
      "rationale": "If the ip6tables rules are not saved and a system re -boot occurs, the ip6tables rules will be lost.",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "Review the file /etc/sysconfig/ip6tables and ensure it contains the complete correct rule -set. Example: /etc/sysconfig/ip6tables # sample configuration for iptables service # you can edit this manually or use system -config-firewall # Generated by iptables -save v1.4.21 on Wed Mar 25 14:23:37 2020 *filter :INPUT DROP [0:0] :FORWARD DROP [0:0] :OUTPUT DROP [0:0] -A INPUT -i lo -j ACCEPT -A INPUT -s ::1/128 -j DROP -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT -A INPUT -p tcp -m tcp --dport 22 -m state --state NEW -j ACCEPT -A OUTPUT -o lo -j ACCEPT -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT COMMIT # Completed on Wed Mar 25 14:58:32 2020 OR Verify IPv6 is disabled: Run the following script. Output will confirm if IPv6 is disabled on the system. 329 | P a g e #!/bin/bash [ -n \"$passing\" ] && passing=\"\" [ -z \"$(grep \"^ \\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\" grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\s*=\\s*1\\b(\\s+#.*)?$\" /etc/sysctl.conf \\ /etc/sysctl.d/*.conf && grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" \\ /etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" && \\ sysctl net.ipv6.conf.default.disable_ipv6 | \\ grep -Eq \"^\\s*net\\.ipv6\\.conf\\.default \\.disable_ipv6 \\s*=\\s*1\\b(\\s+#.*)?$\" && passing=\"true\" if [ \"$passing\" = true ] ; then echo \"IPv6 is disabled on the syste m\" else echo \"IPv6 is enabled on the system\" fi 330 | P a g e",
      "parameter_name": "ipv6.disable",
      "expected_value": "1"
    },
    {
      "id": "5.3.3.6",
      "title": "Ensure ip6tables is enabled and running",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.3.6",
      "description": "Ensure ip6tables is enabled and running",
      "rationale": "Refer to CIS Benchmark documentation",
      "remediation": "Refer to CIS Benchmark documentation",
      "impact": "None",
      "audit_command": "ing ................................ ................................ ................................ ............................. 334 4.1 Configure System Accounting (auditd) ................................ ................................ ................... 335"
    },
    {
      "id": "5.3.4",
      "title": "Ensure SSH access is limited",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.4",
      "description": "There are several options available to limit which users and group can access the system via SSH. It is recommended that at least one of the following options be leveraged: \uf0b7 AllowUsers : o The AllowUsers variable gives the system administrator the option of allowing specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this variable. If a system administrator wants to restrict user access further by only allowing the allowed users to log in from a particular hos t, the entry can be specified in the form of user@host. \uf0b7 AllowGroups : o The AllowGroups variable gives the system administrator the option of allowing specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable. \uf0b7 DenyUsers : o The DenyUsers variable gives the system administrator the option of denying specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recogn ized with this variable. If a system administrator wants to restrict user access further by specifically denying a user's access from a particular host, the entry can be specified in the form of user@host. \uf0b7 DenyGroups : o The DenyGroups variable gives the sys tem administrator the option of denying specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable.",
      "rationale": "Restricting which users can remotely access the s ystem via SSH will help ensure that only authorized users access the system. 455 | P a g e",
      "remediation": "Edit the /etc/ssh/sshd_config file to set one or more of the parameter as follows: AllowUsers <userlist> OR AllowGroups <grouplist> OR DenyUsers <userlist> OR DenyGroups <grouplist> Default Value: None",
      "impact": "None",
      "audit_command": "Run the following commands and verify the output: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -Pi '^\\h*(allow|deny)(users|groups) \\h+\\H+(\\h+.*)?$' # grep -Pi '^\\h*(allow|deny)(users|groups) \\h+\\H+(\\h+.*)?$' /etc/ssh/sshd_config Verify that the output of both commands matches at least one of the following lines: allowusers <userlist> allowgroups <grouplist> denyusers <userlist> denygroups <grouplist>"
    },
    {
      "id": "5.3.5",
      "title": "Ensure SSH Log",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.5",
      "description": "INFO level is the basic level that only records login activity of SSH users. In many situations, such as Incident Response, it is important to determine when a particular user was active on a system. The logout record can eliminate those users who disconnected , which helps narrow the field. VERBOSE level specifies that login and logout activity as well as the key fingerprint for any SSH key used for login will be logged. This information is important for SSH key management, especially in legacy environments.",
      "rationale": "SSH provides several logging levels with varying amounts of verbosity. DEBUG is specifically not recommended other than strictly for debugging SSH communications since it provides so much data that it is difficult to identify important security in formation.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: LogLevel VERBOSE OR LogLevel INFO Default Value: LogLevel INFO",
      "impact": "None",
      "audit_command": "Run the following command and verify that output matches loglevel VERBOSE or loglevel INFO : # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep loglevel loglevel VERBOSE or logl evel INFO Run the following command and verify the output matches: # grep -i 'loglevel' /etc/ssh/sshd_config | grep -Evi '(VERBOSE|INFO)' Nothing should be returned 458 | P a g e"
    },
    {
      "id": "5.3.7",
      "title": "Ensure SSH MaxAuthTries is set to 4 or less",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.7",
      "description": "The MaxAuthTries parameter specifies the maximum number of authentication attempts permitted per connection. When the login failure count reaches half the number, error messages will be written to the syslog file detailing the login failure.",
      "rationale": "Setting the MaxAuthTries parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. While the recommended setting is 4, set the number based on site policy.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: MaxAuthTries 4 Default Value: MaxAuthTries 6 462 | P a g e",
      "impact": "None",
      "audit_command": "Run the following command and verify that output MaxAuthTries is 4 o r less: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep maxauthtries maxauthtries 4 Run the following command and verify that the output: # grep -Ei '^\\s*maxauthtries \\s+([5-9]|[1-9][0-9]+)' /etc/ssh/sshd_config Nothing is returned"
    },
    {
      "id": "5.3.8",
      "title": "Ensure SSH IgnoreRhosts is enabled",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.8",
      "description": "The IgnoreRhosts parameter specifies that .rhosts and .shosts files will not be used in RhostsRSAAuthentication or HostbasedAuthentication .",
      "rationale": "Setting this parameter forces users to enter a password when authenticating with ssh.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: IgnoreRhosts yes Default Value: IgnoreRhosts yes",
      "impact": "None",
      "audit_command": "Run the following command and verify that output matches: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep ignorerhosts ignorerho sts yes Run the following command and verify the output: # grep -Ei '^\\s*ignorerhosts \\s+no\\b' /etc/ssh/sshd_config Nothing should be returned"
    },
    {
      "id": "5.3.9",
      "title": "Ensure SSH HostbasedAuthentication is disabled",
      "section": "Section 5.3",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "severity": "medium",
      "cis_reference": "CIS CentOS Linux 7 Benchmark v3.1.2 - 5.3.9",
      "description": "The HostbasedAuthentication parameter specifies if authentication is allowed through trusted hosts via the user of .rhosts , or /etc/hosts.equiv , along with successful public key client host authentication. This option only applies to SSH Protocol Version 2.",
      "rationale": "Even though the .rhosts files are ineffective if support is disabled in /etc/pam.conf , disabling the ability to us e .rhosts files in SSH provides an additional layer of protection.",
      "remediation": "Edit the /etc/ssh/sshd_config file to set the parameter as follows: HostbasedAuthentication no Default Value: HostbasedAuthentication no",
      "impact": "None",
      "audit_command": "Run the following command and verify that output matches: # sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep hostbasedaut hentication hostbasedauthentication no Run the following command and verify the output matches: # grep -Ei '^\\s*HostbasedAuthentication \\s+yes' /etc/ssh/sshd_config Nothing should be returned"
    }
  ]
}