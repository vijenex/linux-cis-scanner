{
  "milestone": "2.1 Configure Server Services",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 2.1 Configure Server Services",
  "controls": [
    {
      "id": "2.1.1",
      "title": "Ensure autofs services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "autofs"
      ],
      "package_names": [
        "autofs"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.1",
      "description": "The /tmp directory is a world -writable directory used for temporary storage by all users and some applications.\nNote: If an entry for /tmp exists in /etc/fstab it will take precedence over entries in a systemd unit file. There is an exception to this when a system is diskless and connected to iSCSI, entries in /etc/fstab may not take precedence over a systemd unit file.",
      "remediation": "First ensure that systemd is correctly configured to ensure that /tmp will be mounted at boot time.\n# systemctl unmask tmp.mount For specific configuration requirements of the /tmp mount for your environment, modify /etc/fstab .\nExample of using tmpfs with specific mount options:\ntmpfs /tmp tmpfs defaults,rw,nosuid,nodev,noexec,relatime,size=2G 0 0 Note: the size=2G is an example of setting a specific size for tmpfs .\nExample of using a volume or disk with specific mount options. The source location of the volume or disk will vary depending on your environment:\n<device> /tmp <fstype> defaults,nodev,nosuid,noexec 0 0"
    },
    {
      "id": "2.1.2",
      "title": "Ensure avahi daemon services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "avahi-daemon"
      ],
      "package_names": [
        "avahi-daemon"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.2",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "remediation": "- IF - a separate partition exists for /tmp .\nEdit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /tmp partition.\nExample:\n<device> /tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /tmp with the configured options:\n# mount -o remount /tmp"
    },
    {
      "id": "2.1.3",
      "title": "Ensure dhcp server services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "isc-dhcp-server",
        "isc-dhcp-server6"
      ],
      "package_names": [
        "isc-dhcp-server"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.3",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "remediation": "- IF - a separate partition exists for /tmp .\nEdit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /tmp partition.\nExample:\n<device> /tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /tmp with the configured options:\n# mount -o remount /tmp"
    },
    {
      "id": "2.1.4",
      "title": "Ensure dns server services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "bind9"
      ],
      "package_names": [
        "bind9"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.4",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "remediation": "- IF - a separate partition exists for /tmp .\nEdit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /tmp partition.\nExample:\n<device> /tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /tmp with the configured options:\n# mount -o remount /tmp Internal Only - General"
    },
    {
      "id": "2.1.5",
      "title": "Ensure dnsmasq services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "dnsmasq"
      ],
      "package_names": [
        "dnsmasq"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.5",
      "description": "dnsmasq is a lightweight tool that provides DNS caching, DNS forwarding and DHCP (Dynamic Host Configuration Protocol) services.",
      "remediation": "Run the following commands to stop dnsmasq.service and remove dnsmasq package:\n# systemctl stop dnsmasq.service\n# apt purge dnsmasq - OR - - IF - the dnsmasq package is required as a dependency:\nRun the following commands to stop and mask the dnsmasq.service :\n# systemctl stop dnsmasq.service\n# systemctl mask dnsmasq.service"
    },
    {
      "id": "2.1.6",
      "title": "Ensure ftp server services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "vsftpd"
      ],
      "package_names": [
        "vsftpd"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.6",
      "description": "The File Transfer Protocol (FTP) provides networked computers with the ability to transfer files. vsftpd is the Very Secure File Transfer Protocol Daemon.",
      "remediation": "Run the following commands to stop vsftpd.service and remove the vsftpd package:\n# systemctl stop vsftpd.service\n# apt purge vsftpd - OR - - IF - the vsftpd package is required as a dependency:\nRun the following commands to stop and mask the vsftpd.service :\n# systemctl stop vsftpd.service\n# systemctl mask vsftpd.service Note: Other ftp server packages may exist. If not required and authorized by local site policy, they should also be removed. If the package is required for a dependency, the service should be stopped and masked."
    },
    {
      "id": "2.1.7",
      "title": "Ensure ldap server services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "slapd"
      ],
      "package_names": [
        "slapd"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.7",
      "description": "The Lightweight Directory Access Protocol (LDAP) was introduced as a replacement for NIS/YP. It is a service that provides a method for looking up information from a central database.",
      "remediation": "Run the following commands to stop slapd.service and remove the slapd package:\n# systemctl stop slapd.service\n# apt purge slapd - OR - - IF - the slapd package is required as a dependency:\nRun the following commands to stop and mask slapd.service :\n# systemctl stop slapd.service\n# systemctl mask slapd.service"
    },
    {
      "id": "2.1.8",
      "title": "Ensure message access server services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "dovecot",
        "cyrus-imap"
      ],
      "package_names": [
        "dovecot-imapd",
        "dovecot-pop3d",
        "cyrus-imap"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.8",
      "description": "dovecot-imapd and dovecot-pop3d are an open source IMAP and POP3 server for Linux based systems.",
      "remediation": "Run one of the following commands to remove dovecot-imapd and dovecot-pop3d :\nRun the following commands to stop dovecot.socket and dovecot.service , and\nremove the dovecot-imapd and dovecot-pop3d packages:\n# systemctl stop dovecot.socket dovecot.service\n# apt purge dovecot -imapd dovecot -pop3d - OR - - IF - a package is installed and is required for dependencies:\nRun the following commands to stop and mask dovecot.socket and dovecot.service :\n# systemctl stop dovecot.socket dovecot.service\n# systemctl mask dovecot.socket dovecot.service"
    },
    {
      "id": "2.1.9",
      "title": "Ensure network file system services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "nfs-server"
      ],
      "package_names": [
        "nfs-kernel-server"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.9",
      "description": "The Network File System (NFS) is one of the first and most widely distributed file systems in the UNIX environment. It provides the ability for systems to mount file systems of other servers through the network.",
      "remediation": "Run the following command to stop nfs-server.service and remove nfs-kernel- server package:\n# systemctl stop nfs -server.service\n# apt purge nfs -kernel-server - OR - - IF - the nfs-kernel-server package is required as a dependency:\nRun the following commands to stop and mask the nfs-server.service :\n# systemctl stop nfs -server.service\n# systemctl mask nfs -server.service"
    },
    {
      "id": "2.1.10",
      "title": "Ensure nis server services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "nis"
      ],
      "package_names": [
        "nis"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.10",
      "description": "The Network Information Service (NIS) (formally known as Yellow Pages) is a client - server directory service protocol for distributing system configuration files. The NIS server is a collection of programs that allow for the distribution of configuration fi les. The NIS client ( ypbind ) was used to bind a machine to an NIS server and receive the distributed configuration files.",
      "remediation": "Run the following commands to stop ypserv.service and remove ypserv package:\n# systemctl stop ypserv.service\n# apt purge ypserv - OR - - IF - the ypserv package is required as a dependency:\nRun the following commands to stop and mask ypserv.service :\n# systemctl stop ypserv.service\n# systemctl mask ypserv.service"
    },
    {
      "id": "2.1.11",
      "title": "Ensure print server services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "cups"
      ],
      "package_names": [
        "cups"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.11",
      "description": "The Common Unix Print System (CUPS) provides the ability to print to both local and network printers. A system running CUPS can also accept print jobs from remote systems and print them to local printers. It also provides a web based remote administration capability.",
      "remediation": "Run the following commands to stop cups.socket and cups.service , and remove the cups package:\n# systemctl stop cups.socket cups.service\n# apt purge cups - OR - - IF - the cups package is required as a dependency:\nRun the following commands to stop and mask the cups.socket and cups.service :\n# systemctl stop cups.socket cups.service\n# systemctl mask cups.socket cups.service"
    },
    {
      "id": "2.1.12",
      "title": "Ensure rpcbind services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "rpcbind"
      ],
      "package_names": [
        "rpcbind"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.12",
      "description": "The rpcbind utility maps RPC services to the ports on which they listen. RPC processes notify rpcbind when they start, registering the ports they are listening on and the RPC program numbers they expect to serve. The client system then contacts rpcbind on the server with a particular RPC program number. The rpcbind.service redirects the client to the proper port number so it can communicate with the requested service.\nPortmapper is an RPC service, which always listens on tcp and udp 111, and is used to map other RPC services (such as nfs, nlockmgr, quotad, mountd, etc.) to their corresponding port number on the server. When a remote host makes an RPC call to that server , it first consults with portmap to determine where the RPC server is listening.",
      "remediation": "Run the following commands to stop rpcbind.socket and rpcbind.service , and\nremove the rpcbind package:\n# systemctl stop rpcbind.socket rpcbind.service\n# apt purge rpcbind - OR - - IF - the rpcbind package is required as a dependency:\nRun the following commands to stop and mask the rpcbind.socket and rpcbind.service :\n# systemctl stop rpcbind.socket rpcbind.service\n# systemctl mask rpcbind.socket rpcbind.service"
    },
    {
      "id": "2.1.13",
      "title": "Ensure rsync services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "rsync"
      ],
      "package_names": [
        "rsync"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.13",
      "description": "The rsync service can be used to synchronize files between systems over network links.",
      "remediation": "Run the following commands to stop rsync.service , and remove the rsync package:\n# systemctl stop rsync.service\n# apt purge rsync - OR - - IF - the rsync package is required as a dependency:\nRun the following commands to stop and mask rsync.service :\n# systemctl stop rsync.service\n# systemctl mask rsync.service"
    },
    {
      "id": "2.1.14",
      "title": "Ensure samba file server services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "smbd"
      ],
      "package_names": [
        "samba"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.14",
      "description": "The Samba daemon allows system administrators to configure their Linux systems to share file systems and directories with Windows desktops. Samba will advertise the file systems and directories via the Server Message Block (SMB) protocol. Windows desktop u sers will be able to mount these directories and file systems as letter drives on their systems.",
      "remediation": "Run the following commands to stop smbd.service and remove samba package:\n# systemctl stop smbd.service\n# apt purge samba - OR - - IF - the samba package is required as a dependency:\nRun the following commands to stop and mask the smbd.service :\n# systemctl stop smbd.service\n# systemctl mask smbd.service"
    },
    {
      "id": "2.1.15",
      "title": "Ensure snmp services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "snmpd"
      ],
      "package_names": [
        "snmp"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.15",
      "description": "Simple Network Management Protocol (SNMP) is a widely used protocol for monitoring the health and welfare of network equipment, computer equipment and devices like UPSs.\nNet-SNMP is a suite of applications used to implement SNMPv1 (RFC 1157), SNMPv2 (RFCs 1901 -1908), and SNMPv3 (RFCs 3411 -3418) using both IPv4 and IPv6.\nSupport for SNMPv2 classic (a.k.a. \"SNMPv2 historic\" - RFCs 1441 -1452) was dropped with the 4.0 release of the UCD -snmp package.\nThe Simple Network Management Protocol (SNMP) server is used to listen for SNMP commands from an SNMP management system, execute the commands or collect the information and then send results back to the requesting system.",
      "remediation": "Run the following commands to stop snmpd.service and remove the snmpd package:\n# systemctl stop snmpd.service\n# apt purge snmpd - OR - If the package is required for dependencies:\nRun the following commands to stop and mask the snmpd.service :\n# systemctl stop snmpd.service\n# systemctl mask snmpd.service"
    },
    {
      "id": "2.1.16",
      "title": "Ensure tftp server services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "tftpd-hpa"
      ],
      "package_names": [
        "tftpd-hpa"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.16",
      "description": "Trivial File Transfer Protocol (TFTP) is a simple protocol for exchanging files between two TCP/IP machines. TFTP servers allow connections from a TFTP Client for sending and receiving files.",
      "remediation": "Run the following commands to stop tftpd-hpa.service , and remove the tftpd-hpa package:\n# systemctl stop tftpd -hpa.service\n# apt purge tftpd -hpa - OR - - IF - the tftpd-hpa package is required as a dependency:\nRun the following commands to stop and mask tftpd-hpa.service :\n# systemctl stop tftpd -hpa.service\n# systemctl mask tftpd -hpa.service"
    },
    {
      "id": "2.1.17",
      "title": "Ensure web proxy server services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "squid"
      ],
      "package_names": [
        "squid"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.17",
      "description": "Squid is a standard proxy server used in many distributions and environments.",
      "remediation": "Run the following commands to stop squid.service and remove the squid package:\n# systemctl stop squid.service\n# apt purge squid - OR - If the squid package is required as a dependency:\nRun the following commands to stop and mask the squid.service :\n# systemctl stop squid.service\n# systemctl mask squid.service"
    },
    {
      "id": "2.1.18",
      "title": "Ensure web server services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "apache2",
        "nginx"
      ],
      "package_names": [
        "apache2",
        "nginx"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.18",
      "description": "Web servers provide the ability to host web site content.",
      "remediation": "Run the following commands to stop httpd.socket , httpd.service and remove the apache2 package:\n# systemctl stop apache2.socket apache2.service\n# apt purge apache2\nRun the following commands to stop nginx.service and remove the nginx package:\n# systemctl stop nginx.service\n# apt purge nginx - OR - - IF - a package is installed and is required for dependencies:\n- IF - the httpd package is required for dependencies:\nRun the following commands to stop and mask httpd.socket and httpd.service :\n# systemctl stop httpd.socket httpd.service\n# systemctl mask httpd.socket httpd.service - IF - the nginx package is required for dependencies:\nRun the following commands to stop and mask nginx.service :\n# systemctl stop nginx.service\n# systemctl mask nginx.service Note: Other web server packages may exist. If not required and authorized by local site policy, they should also be removed. If the package is required for a dependency, the service and socket should be stopped and masked."
    },
    {
      "id": "2.1.19",
      "title": "Ensure xinetd services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "xinetd"
      ],
      "package_names": [
        "xinetd"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.19",
      "description": "The eXtended InterNET Daemon ( xinetd ) is an open source super daemon that replaced the original inetd daemon. The xinetd daemon listens for well known services and dispatches the appropriate daemon to properly respond to service requests.",
      "remediation": "Run the following commands to stop xinetd.service , and remove the xinetd package:\n# systemctl stop xinetd.service\n# apt purge xinetd -OR- -IF- the xinetd package is required as a dependency:\nRun the following commands to stop and mask the xinetd.service :\n# systemctl stop xinetd.service\n# systemctl mask xinetd.service"
    },
    {
      "id": "2.1.20",
      "title": "Ensure X window server services are not in use",
      "section": "Services",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [],
      "package_names": [
        "xserver-xorg-core"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.20",
      "description": "The X Window System provides a Graphical User Interface (GUI) where users can have multiple windows in which to run programs and various add on. The X Windows system is typically used on workstations where users login, but not on servers where users typica lly do not login.",
      "remediation": "- IF - a Graphical Desktop Manager or X -Windows server is not required and approved by local site policy:\nRun the following command to remove the X Windows Server package:\n# apt purge xserver -common"
    },
    {
      "id": "2.1.21",
      "title": "Ensure mail transfer agents are configured for local-only mode",
      "section": "Services",
      "profile": "Level1",
      "type": "MTALocalOnly",
      "config_file": "/etc/postfix/main.cf",
      "expected_setting": "inet_interfaces = loopback-only",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.21",
      "description": "Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to listen for incoming mail and transfer the messages to the appropriate user or mail server. If the system is not intended to be a mail server, it is recommended that the MTA be configured to only process local mail.",
      "remediation": "Edit /etc/postfix/main.cf and add the following line to the RECEIVING MAIL section. If the line already exists, change it to look like the line below:\ninet_interfaces = loopback -only\nRun the following command to restart postfix :\n# systemctl restart postfix Note:\n• This recommendation is designed around the postfix mail server.\n• Depending on your environment you may have an alternative MTA installed such as exim4 or sendmail. If this is the case consult the documentation for your installed MTA to configure the recommended state."
    },
    {
      "id": "2.1.22",
      "title": "Ensure only approved services are listening on a network interface",
      "section": "Services",
      "profile": "Level1",
      "type": "Manual",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "2.1.22",
      "description": "A network port is identified by its number, the associated IP address, and the type of the communication protocol such as TCP or UDP.\nA listening port is a network port on which an application or process listens on, acting as a communication endpoint.\nEach listening port can be open or closed (filtered) using a firewall. In general terms, an open port is a network port that accepts incoming packets from remote locations.",
      "remediation": "Run the following commands to stop the service and remove the package containing the service:\n# systemctl stop <service_name>.socket <service_name>.service\n# apt purge <package_name> - OR - If required packages have a dependency:\nRun the following commands to stop and mask the service and socket:\n# systemctl stop <service_name>.socket <service_name>.service\n# systemctl mask <service_name>.socket <service_name>.service Note: replace <service_name> with the appropriate service name."
    }
  ]
}