{
  "milestone": "6.2 System Auditing",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 6.2 System Auditing",
  "controls": [
    {
      "id": "6.2.1.1",
      "title": "Ensure auditd packages are installed",
      "section": "System Auditing",
      "description": "auditd is the userspace component to the Linux Auditing System.",
      "rationale": "The capturing of system events provides system administrators with information to allow them to determine if unauthorized access to their system is occurring.",
      "impact": "None.",
      "remediation": "Run the following command to install auditd: apt install auditd audispd-plugins",
      "profile": "Level2",
      "type": "MultiPackage",
      "package_names": ["auditd", "audispd-plugins"],
      "should_be_installed": true
    },
    {
      "id": "6.2.1.2",
      "title": "Ensure auditd service is enabled and active",
      "section": "System Auditing",
      "description": "Turn on the auditd daemon to record system events.",
      "rationale": "The capturing of system events provides system administrators with information to allow them to determine if unauthorized access to their system is occurring.",
      "impact": "None.",
      "remediation": "Run the following command to enable auditd: systemctl --now enable auditd",
      "profile": "Level2",
      "type": "Service",
      "service_name": "auditd",
      "expected_status": "enabled"
    },
    {
      "id": "6.2.1.3",
      "title": "Ensure auditing for processes that start prior to auditd is enabled",
      "section": "System Auditing",
      "description": "Configure grub so that processes that are capable of being audited can be audited even if they start up prior to auditd startup.",
      "rationale": "Audit events need to be captured on processes that start up prior to auditd, so that potential malicious activity cannot escape detection.",
      "impact": "None.",
      "remediation": "Edit /etc/default/grub and add audit=1 to GRUB_CMDLINE_LINUX parameter",
      "profile": "Level2",
      "type": "BootParameter",
      "parameters": ["audit=1"],
      "config_file": "/etc/default/grub"
    },
    {
      "id": "6.2.1.4",
      "title": "Ensure audit_backlog_limit is configured",
      "section": "System Auditing",
      "description": "The backlog limit has a default setting of 64.",
      "rationale": "During boot if audit=1, then the backlog will hold 64 records. If more than 64 records are created during boot, auditd records will be lost and potential malicious activity could go undetected.",
      "impact": "None.",
      "remediation": "Edit /etc/default/grub and add audit_backlog_limit=8192 to GRUB_CMDLINE_LINUX parameter",
      "profile": "Level2",
      "type": "BootParameter",
      "parameters": ["audit_backlog_limit=8192"],
      "config_file": "/etc/default/grub"
    },
    {
      "id": "6.2.2.1",
      "title": "Ensure audit log storage size is configured",
      "section": "System Auditing",
      "description": "Configure the maximum size of the audit log file.",
      "rationale": "It is important that an appropriate size is set for audit logs so that they are retained for an appropriate period of time.",
      "impact": "None.",
      "remediation": "Set max_log_file parameter in /etc/audit/auditd.conf",
      "profile": "Level2",
      "type": "AuditdConfig",
      "config_file": "/etc/audit/auditd.conf",
      "parameter": "max_log_file",
      "expected_value": "",
      "check_configured": true
    },
    {
      "id": "6.2.2.2",
      "title": "Ensure audit logs are not automatically deleted",
      "section": "System Auditing",
      "description": "The max_log_file_action setting determines how to handle the audit log file reaching the max file size.",
      "rationale": "In high security contexts, the benefits of maintaining a long audit history exceed the cost of storing the audit history.",
      "impact": "None.",
      "remediation": "Set max_log_file_action keep_logs in /etc/audit/auditd.conf",
      "profile": "Level2",
      "type": "AuditdConfig",
      "config_file": "/etc/audit/auditd.conf",
      "parameter": "max_log_file_action",
      "expected_value": "keep_logs"
    },
    {
      "id": "6.2.2.3",
      "title": "Ensure system is disabled when audit logs are full",
      "section": "System Auditing",
      "description": "The auditd daemon can be configured to halt the system when the audit logs are full.",
      "rationale": "In high security contexts, the risk of detecting unauthorized access or nonrepudiation exceeds the benefit of the system's availability.",
      "impact": "In the event of an audit log failure the system will shutdown.",
      "remediation": "Set space_left_action email, action_mail_acct root, admin_space_left_action halt in /etc/audit/auditd.conf",
      "profile": "Level2",
      "type": "AuditdConfig",
      "config_file": "/etc/audit/auditd.conf",
      "parameter": "admin_space_left_action",
      "expected_value": "halt"
    },
    {
      "id": "6.2.2.4",
      "title": "Ensure system warns when audit logs are low on space",
      "section": "System Auditing",
      "description": "The space_left_action parameter tells the system what action to take when the system has detected that it is low on disk space.",
      "rationale": "Notifying administrators of an impending disk space problem may allow them to take corrective action prior to any disruption.",
      "impact": "None.",
      "remediation": "Set space_left_action email in /etc/audit/auditd.conf",
      "profile": "Level2",
      "type": "AuditdConfig",
      "config_file": "/etc/audit/auditd.conf",
      "parameter": "space_left_action",
      "expected_value": "email"
    },
    {
      "id": "6.2.3.1",
      "title": "Ensure changes to system administration scope (sudoers) is collected",
      "section": "System Auditing",
      "description": "Monitor scope changes for system administrations.",
      "rationale": "Changes in the /etc/sudoers file can indicate that an unauthorized change has been made to sudo privileges.",
      "impact": "None.",
      "remediation": "Add audit rules to monitor /etc/sudoers and /etc/sudoers.d/",
      "profile": "Level2",
      "type": "AuditRule",
      "rule_file": "/etc/audit/rules.d/50-scope.rules",
      "expected_rules": [
        "-w /etc/sudoers -p wa -k scope",
        "-w /etc/sudoers.d -p wa -k scope"
      ]
    },
    {
      "id": "6.2.4.1",
      "title": "Ensure audit log files mode is configured",
      "section": "System Auditing",
      "description": "Audit log files contain information about the system and system activity.",
      "rationale": "Unauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.",
      "impact": "None.",
      "remediation": "Run the following command to set the correct permissions: chmod g-w,o-rwx /var/log/audit/*",
      "profile": "Level2",
      "type": "AuditLogPermissions",
      "log_directory": "/var/log/audit",
      "expected_file_mode": "640",
      "expected_owner": "root",
      "expected_group": "adm"
    },
    {
      "id": "6.2.4.5",
      "title": "Ensure audit configuration files mode is configured",
      "section": "System Auditing",
      "description": "Audit configuration files control the operation of the audit daemon.",
      "rationale": "Unauthorized modification of audit configuration files could lead to audit bypass or denial of service.",
      "impact": "None.",
      "remediation": "Run the following command to set the correct permissions: chmod 640 /etc/audit/auditd.conf",
      "profile": "Level2",
      "type": "FilePermission",
      "file_path": "/etc/audit/auditd.conf",
      "expected_mode": "640",
      "expected_owner": "root",
      "expected_group": "root"
    }
  ]
}