{
  "milestone": "6.2 System Auditing",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 6.2 System Auditing",
  "controls": [
    {
      "id": "6.2.1.1",
      "title": "Ensure auditd packages are installed",
      "section": "System Auditing",
      "profile": "Level2",
      "type": "MultiPackage",
      "package_names": [
        "auditd",
        "audispd-plugins"
      ],
      "should_be_installed": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.1.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.1.2",
      "title": "Ensure auditd service is enabled and active",
      "section": "System Auditing",
      "profile": "Level2",
      "type": "Service",
      "service_name": "auditd",
      "expected_status": "enabled",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.1.2",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.1.3",
      "title": "Ensure auditing for processes that start prior to auditd is enabled",
      "section": "System Auditing",
      "profile": "Level2",
      "type": "BootParameter",
      "parameters": [
        "audit=1"
      ],
      "config_file": "/etc/default/grub",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.1.3",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.1.4",
      "title": "Ensure audit_backlog_limit is configured",
      "section": "System Auditing",
      "profile": "Level2",
      "type": "BootParameter",
      "parameters": [
        "audit_backlog_limit=8192"
      ],
      "config_file": "/etc/default/grub",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.1.4",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.2.1",
      "title": "Ensure audit log storage size is configured",
      "section": "System Auditing",
      "profile": "Level2",
      "type": "AuditdConfig",
      "config_file": "/etc/audit/auditd.conf",
      "parameter": "max_log_file",
      "expected_value": "",
      "check_configured": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.2.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.2.2",
      "title": "Ensure audit logs are not automatically deleted",
      "section": "System Auditing",
      "profile": "Level2",
      "type": "AuditdConfig",
      "config_file": "/etc/audit/auditd.conf",
      "parameter": "max_log_file_action",
      "expected_value": "keep_logs",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.2.2",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.2.3",
      "title": "Ensure system is disabled when audit logs are full",
      "section": "System Auditing",
      "profile": "Level2",
      "type": "AuditdConfig",
      "config_file": "/etc/audit/auditd.conf",
      "parameter": "admin_space_left_action",
      "expected_value": "halt",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.2.3",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.2.4",
      "title": "Ensure system warns when audit logs are low on space",
      "section": "System Auditing",
      "profile": "Level2",
      "type": "AuditdConfig",
      "config_file": "/etc/audit/auditd.conf",
      "parameter": "space_left_action",
      "expected_value": "email",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.2.4",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.3.1",
      "title": "Ensure changes to system administration scope (sudoers) is collected",
      "section": "System Auditing",
      "profile": "Level2",
      "type": "AuditRule",
      "rule_file": "/etc/audit/rules.d/50-scope.rules",
      "expected_rules": [
        "-w /etc/sudoers -p wa -k scope",
        "-w /etc/sudoers.d -p wa -k scope"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.3.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.4.1",
      "title": "Ensure audit log files mode is configured",
      "section": "System Auditing",
      "profile": "Level2",
      "type": "AuditLogPermissions",
      "log_directory": "/var/log/audit",
      "expected_file_mode": "640",
      "expected_owner": "root",
      "expected_group": "adm",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.4.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "6.2.4.5",
      "title": "Ensure audit configuration files mode is configured",
      "section": "System Auditing",
      "profile": "Level2",
      "type": "FilePermission",
      "file_path": "/etc/audit/auditd.conf",
      "expected_mode": "640",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.2.4.5",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    }
  ]
}