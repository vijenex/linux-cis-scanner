{
  "milestone": "6.1 System Logging",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 6.1 System Logging",
  "controls": [
    {
      "id": "6.1.1.1.1",
      "title": "Ensure journald service is active",
      "section": "System Logging",
      "description": "The systemd-journald service is an essential component of systemd.",
      "rationale": "In the event of a system failure, the availability of systemd-journald has a high impact on troubleshooting system issues.",
      "impact": "None.",
      "remediation": "Run the following command to enable and start systemd-journald: systemctl --now enable systemd-journald.service",
      "profile": "Level1",
      "type": "Service",
      "service_name": "systemd-journald",
      "expected_status": "enabled"
    },
    {
      "id": "6.1.1.1.2",
      "title": "Ensure journald log file access is configured",
      "section": "System Logging",
      "description": "The systemd-journald service saves log data either to /run/log/journal or to /var/log/journal.",
      "rationale": "If log data is written to /run/log/journal, the log data will not persist across reboots.",
      "impact": "Manual verification required.",
      "remediation": "Review systemd-journald configuration and ensure log file access is properly configured.",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "6.1.1.1.3",
      "title": "Ensure journald log file rotation is configured",
      "section": "System Logging",
      "description": "The systemd-journald service can be configured to rotate log files based on size and time.",
      "rationale": "Log rotation prevents log files from consuming excessive disk space.",
      "impact": "Manual verification required.",
      "remediation": "Configure SystemMaxUse, SystemKeepFree, SystemMaxFileSize, and SystemMaxFiles in /etc/systemd/journald.conf",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "6.1.1.1.4",
      "title": "Ensure journald ForwardToSyslog is disabled",
      "section": "System Logging",
      "description": "The ForwardToSyslog option controls whether log messages received by the journal daemon will be forwarded to a traditional syslog daemon.",
      "rationale": "Storing log data in multiple locations increases storage consumption and can complicate log analysis.",
      "impact": "None.",
      "remediation": "Edit /etc/systemd/journald.conf and set: ForwardToSyslog=no",
      "profile": "Level1",
      "type": "JournaldConfig",
      "config_file": "/etc/systemd/journald.conf",
      "parameter": "ForwardToSyslog",
      "expected_value": "no"
    },
    {
      "id": "6.1.1.1.5",
      "title": "Ensure journald Storage is configured",
      "section": "System Logging",
      "description": "The Storage option controls where log data is stored.",
      "rationale": "Proper storage configuration ensures logs persist across reboots and are available for analysis.",
      "impact": "None.",
      "remediation": "Edit /etc/systemd/journald.conf and set: Storage=persistent",
      "profile": "Level1",
      "type": "JournaldConfig",
      "config_file": "/etc/systemd/journald.conf",
      "parameter": "Storage",
      "expected_value": "persistent"
    },
    {
      "id": "6.1.1.1.6",
      "title": "Ensure journald Compress is configured",
      "section": "System Logging",
      "description": "The Compress option controls whether log files are compressed.",
      "rationale": "Compressing logs saves storage space and can improve performance.",
      "impact": "None.",
      "remediation": "Edit /etc/systemd/journald.conf and set: Compress=yes",
      "profile": "Level1",
      "type": "JournaldConfig",
      "config_file": "/etc/systemd/journald.conf",
      "parameter": "Compress",
      "expected_value": "yes"
    },
    {
      "id": "6.1.1.2.1",
      "title": "Ensure systemd-journal-remote is installed",
      "section": "System Logging",
      "description": "The systemd-journal-remote package provides the capability to receive systemd journal messages from remote systems.",
      "rationale": "If the system is intended to be a log aggregation server, systemd-journal-remote should be installed.",
      "impact": "None.",
      "remediation": "Install systemd-journal-remote: apt install systemd-journal-remote",
      "profile": "Level1",
      "type": "Package",
      "package_name": "systemd-journal-remote",
      "should_be_installed": false
    },
    {
      "id": "6.1.1.2.4",
      "title": "Ensure systemd-journal-remote service is not in use",
      "section": "System Logging",
      "description": "The systemd-journal-remote service should not be running unless the system is intended to be a log aggregation server.",
      "rationale": "If the system is not intended to be a log aggregation server, the service should be disabled.",
      "impact": "None.",
      "remediation": "Disable systemd-journal-remote service: systemctl disable systemd-journal-remote",
      "profile": "Level1",
      "type": "Service",
      "service_name": "systemd-journal-remote",
      "expected_status": "disabled"
    },
    {
      "id": "6.1.2.1",
      "title": "Ensure rsyslog is installed",
      "section": "System Logging",
      "description": "The rsyslog software is a recommended replacement for the original syslogd daemon.",
      "rationale": "The security enhancements of rsyslog such as connection-oriented (i.e. TCP) transmission of logs, the option to log to database formats, and the encryption of log data en route to a central logging server justify installing and configuring the package.",
      "impact": "None.",
      "remediation": "Install rsyslog: apt install rsyslog",
      "profile": "Level1",
      "type": "Package",
      "package_name": "rsyslog",
      "should_be_installed": true
    },
    {
      "id": "6.1.2.2",
      "title": "Ensure rsyslog service is enabled and active",
      "section": "System Logging",
      "description": "Once the rsyslog package is installed it needs to be activated.",
      "rationale": "If the rsyslog service is not activated the system may not be logging events, which could make auditing and forensic investigation impossible.",
      "impact": "None.",
      "remediation": "Run the following command to enable rsyslog: systemctl --now enable rsyslog",
      "profile": "Level1",
      "type": "Service",
      "service_name": "rsyslog",
      "expected_status": "enabled"
    },
    {
      "id": "6.1.2.3",
      "title": "Ensure journald is configured to send logs to rsyslog",
      "section": "System Logging",
      "description": "Data from journald may be stored in volatile memory or persisted locally on the server.",
      "rationale": "Storing log data on a remote host protects log integrity from local attacks.",
      "impact": "None.",
      "remediation": "Edit /etc/systemd/journald.conf and set: ForwardToSyslog=yes",
      "profile": "Level1",
      "type": "JournaldConfig",
      "config_file": "/etc/systemd/journald.conf",
      "parameter": "ForwardToSyslog",
      "expected_value": "yes"
    },
    {
      "id": "6.1.2.4",
      "title": "Ensure rsyslog log file creation mode is configured",
      "section": "System Logging",
      "description": "The $FileCreateMode directive in rsyslog configuration specifies the default permissions for log files created by rsyslogd.",
      "rationale": "It is important to ensure that log files have the correct permissions to ensure that sensitive log data is protected.",
      "impact": "None.",
      "remediation": "Edit the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files and set $FileCreateMode 0640",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/rsyslog.conf",
      "pattern": "\\$FileCreateMode\\s+0640",
      "expected_match": true
    },
    {
      "id": "6.1.2.7",
      "title": "Ensure rsyslog is not configured to receive logs from a remote client",
      "section": "System Logging",
      "description": "The $ModLoad imtcp and $InputTCPServerRun directives enable rsyslog to receive messages from remote hosts.",
      "rationale": "If the system is not intended to be a log aggregation server, accepting remote log messages could fill up the system's storage device or enable a denial of service attack.",
      "impact": "None.",
      "remediation": "Edit the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files and remove or comment out any lines that enable remote log reception.",
      "profile": "Level1",
      "type": "RsyslogConfig",
      "config_files": ["/etc/rsyslog.conf", "/etc/rsyslog.d/*.conf"],
      "prohibited_directives": ["$ModLoad imtcp", "$InputTCPServerRun", "$ModLoad imudp", "$UDPServerRun"]
    },
    {
      "id": "6.1.1.4",
      "title": "Ensure only one logging system is in use",
      "section": "System Logging",
      "description": "The systemd-journald service can coexist with rsyslog or syslog-ng, but only one should be configured to avoid conflicts.",
      "rationale": "Having multiple logging systems can lead to conflicts and missed log entries.",
      "impact": "None.",
      "remediation": "Configure either systemd-journald with rsyslog OR systemd-journald standalone, but not multiple conflicting systems.",
      "profile": "Level1",
      "type": "SingleLoggingSystem",
      "logging_services": ["systemd-journald", "rsyslog", "syslog-ng"]
    },
    {
      "id": "6.1.2.2",
      "title": "Ensure journald ForwardToSyslog is disabled",
      "section": "System Logging",
      "description": "The ForwardToSyslog option controls whether log messages received by the journal daemon will be forwarded to a traditional syslog daemon.",
      "rationale": "Storing log data in multiple locations increases storage consumption and can complicate log analysis.",
      "impact": "None.",
      "remediation": "Edit /etc/systemd/journald.conf and set: ForwardToSyslog=no",
      "profile": "Level1",
      "type": "JournaldConfig",
      "config_file": "/etc/systemd/journald.conf",
      "parameter": "ForwardToSyslog",
      "expected_value": "no"
    },
    {
      "id": "6.1.2.3",
      "title": "Ensure journald Compress is configured",
      "section": "System Logging",
      "description": "The Compress option controls whether log files are compressed.",
      "rationale": "Compressing logs saves storage space and can improve performance.",
      "impact": "None.",
      "remediation": "Edit /etc/systemd/journald.conf and set: Compress=yes",
      "profile": "Level1",
      "type": "JournaldConfig",
      "config_file": "/etc/systemd/journald.conf",
      "parameter": "Compress",
      "expected_value": "yes"
    },
    {
      "id": "6.1.2.4",
      "title": "Ensure journald Storage is configured",
      "section": "System Logging",
      "description": "The Storage option controls where log data is stored.",
      "rationale": "Proper storage configuration ensures logs persist across reboots and are available for analysis.",
      "impact": "None.",
      "remediation": "Edit /etc/systemd/journald.conf and set: Storage=persistent",
      "profile": "Level1",
      "type": "JournaldConfig",
      "config_file": "/etc/systemd/journald.conf",
      "parameter": "Storage",
      "expected_value": "persistent"
    },
    {
      "id": "6.1.3.1",
      "title": "Ensure rsyslog is installed",
      "section": "System Logging",
      "description": "The rsyslog software is a recommended replacement for the original syslogd daemon.",
      "rationale": "The security enhancements of rsyslog such as connection-oriented (i.e. TCP) transmission of logs, the option to log to database formats, and the encryption of log data en route to a central logging server justify installing and configuring the package.",
      "impact": "None.",
      "remediation": "Install rsyslog: apt install rsyslog",
      "profile": "Level1",
      "type": "Package",
      "package_name": "rsyslog",
      "should_be_installed": true
    },
    {
      "id": "6.1.3.2",
      "title": "Ensure rsyslog service is enabled and active",
      "section": "System Logging",
      "description": "Once the rsyslog package is installed it needs to be activated.",
      "rationale": "If the rsyslog service is not activated the system may not be logging events, which could make auditing and forensic investigation impossible.",
      "impact": "None.",
      "remediation": "Run the following command to enable rsyslog: systemctl --now enable rsyslog",
      "profile": "Level1",
      "type": "Service",
      "service_name": "rsyslog",
      "expected_status": "enabled"
    },
    {
      "id": "6.1.3.7",
      "title": "Ensure rsyslog is not configured to receive logs from a remote client",
      "section": "System Logging",
      "description": "The $ModLoad imtcp and $InputTCPServerRun directives enable rsyslog to receive messages from remote hosts.",
      "rationale": "If the system is not intended to be a log aggregation server, accepting remote log messages could fill up the system's storage device or enable a denial of service attack.",
      "impact": "None.",
      "remediation": "Edit the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files and remove or comment out any lines that enable remote log reception.",
      "profile": "Level1",
      "type": "RsyslogConfig",
      "config_files": ["/etc/rsyslog.conf", "/etc/rsyslog.d/*.conf"],
      "prohibited_directives": ["$ModLoad imtcp", "$InputTCPServerRun", "$ModLoad imudp", "$UDPServerRun"]
    },
    {
      "id": "6.1.4.1",
      "title": "Ensure access to all logfiles has been configured",
      "section": "System Logging",
      "description": "Log files stored in /var/log/ should have appropriate permissions and ownership set to ensure that sensitive log data cannot be accessed by unauthorized users.",
      "rationale": "It is important to ensure that log files have the correct permissions to ensure that sensitive log data is protected.",
      "impact": "None.",
      "remediation": "Run the following commands to set appropriate permissions on log files: find /var/log -type f -exec chmod g-wx,o-rwx {} + && find /var/log -type d -exec chmod g-w,o-rwx {} +",
      "profile": "Level1",
      "type": "LogFilePermissions",
      "log_directory": "/var/log",
      "expected_file_permissions": "640",
      "expected_dir_permissions": "750"
    }
  ]
}