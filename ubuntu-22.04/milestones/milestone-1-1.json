{
  "milestone": "1.1",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 1.1 Filesystem Configuration",
  "controls": [
    {
      "id": "1.1.1.1",
      "title": "Ensure cramfs kernel module is not available",
      "section": "Initial Setup",
      "description": "The cramfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems. A cramfs image can be used without having to first decompress the image.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "impact": "As cramfs is a read-only compressed filesystem, there should be very little impact as long as none of your applications rely on cramfs.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/cramfs.conf and add the following line: install cramfs /bin/true",
      "profile": "Level1",
      "type": "KernelModule",
      "module_name": "cramfs",
      "expected_status": "not_available"
    },
    {
      "id": "1.1.1.2",
      "title": "Ensure freevxfs kernel module is not available",
      "section": "Initial Setup",
      "description": "The freevxfs filesystem type is a free version of the Veritas type filesystem. This is the primary filesystem type for HP-UX operating systems.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "impact": "As this filesystem is not commonly used, there should be little impact.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/freevxfs.conf and add the following line: install freevxfs /bin/true",
      "profile": "Level1",
      "type": "KernelModule",
      "module_name": "freevxfs",
      "expected_status": "not_available"
    },
    {
      "id": "1.1.1.3",
      "title": "Ensure hfs kernel module is not available",
      "section": "Initial Setup",
      "description": "The hfs filesystem type is a hierarchical filesystem that allows you to mount Mac OS filesystems.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "impact": "As this filesystem is not commonly used on Linux systems, there should be little impact.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/hfs.conf and add the following line: install hfs /bin/true",
      "profile": "Level1",
      "type": "KernelModule",
      "module_name": "hfs",
      "expected_status": "not_available"
    },
    {
      "id": "1.1.1.4",
      "title": "Ensure hfsplus kernel module is not available",
      "section": "Initial Setup",
      "description": "The hfsplus filesystem type is a hierarchical filesystem designed to replace hfs that allows you to mount Mac OS filesystems.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "impact": "As this filesystem is not commonly used on Linux systems, there should be little impact.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/hfsplus.conf and add the following line: install hfsplus /bin/true",
      "profile": "Level1",
      "type": "KernelModule",
      "module_name": "hfsplus",
      "expected_status": "not_available"
    },
    {
      "id": "1.1.1.5",
      "title": "Ensure jffs2 kernel module is not available",
      "section": "Initial Setup",
      "description": "The jffs2 (journaling flash filesystem 2) filesystem type is a log-structured filesystem used in flash memory devices.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "impact": "As this filesystem is not commonly used on traditional systems, there should be little impact.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/jffs2.conf and add the following line: install jffs2 /bin/true",
      "profile": "Level1",
      "type": "KernelModule",
      "module_name": "jffs2",
      "expected_status": "not_available"
    },
    {
      "id": "1.1.1.6",
      "title": "Ensure overlay kernel module is not available",
      "section": "Initial Setup",
      "description": "The overlay filesystem combines two filesystems - an 'upper' filesystem and a 'lower' filesystem. When a name exists in both filesystems, the object in the 'upper' filesystem is visible while the object in the 'lower' filesystem is either hidden or, in the case of directories, merged with the 'upper' object.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "impact": "Disabling the overlay filesystem will prevent its use. Ensure that it is not needed by the system or applications before disabling.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/overlay.conf and add the following line: install overlay /bin/true",
      "profile": "Level2",
      "type": "KernelModule",
      "module_name": "overlay",
      "expected_status": "not_available"
    },
    {
      "id": "1.1.1.7",
      "title": "Ensure squashfs kernel module is not available",
      "section": "Initial Setup",
      "description": "The squashfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems. A squashfs image can be used without having to first decompress the image.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "impact": "Disabling squashfs will prevent the use of snap packages. Ensure that snap packages are not used before disabling this filesystem.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/squashfs.conf and add the following line: install squashfs /bin/true",
      "profile": "Level2",
      "type": "KernelModule",
      "module_name": "squashfs",
      "expected_status": "not_available"
    },
    {
      "id": "1.1.1.8",
      "title": "Ensure udf kernel module is not available",
      "section": "Initial Setup",
      "description": "The udf filesystem type is the universal disk format used to implement ISO/IEC 13346 and ECMA-167 specifications. This is an open vendor neutral filesystem type for data storage on a broad range of media.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "impact": "As this filesystem is primarily used for optical media, there should be little impact unless optical media access is required.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/udf.conf and add the following line: install udf /bin/true",
      "profile": "Level1",
      "type": "KernelModule",
      "module_name": "udf",
      "expected_status": "not_available"
    },
    {
      "id": "1.1.1.9",
      "title": "Ensure usb-storage kernel module is not available",
      "section": "Initial Setup",
      "description": "USB storage provides a means to transfer and store files on a universal serial bus hard drive, thumb drive, or other USB storage device.",
      "rationale": "Restricting USB access on the system will decrease the physical attack surface for a device and diminish the risk of USB malware.",
      "impact": "Disabling USB storage will prevent the use of USB storage devices. Ensure that USB storage is not required before implementing this control.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/usb-storage.conf and add the following line: install usb-storage /bin/true",
      "profile": "Level1",
      "type": "KernelModule",
      "module_name": "usb-storage",
      "expected_status": "not_available"
    },
    {
      "id": "1.1.1.10",
      "title": "Ensure unused filesystems kernel modules are not available",
      "section": "Initial Setup",
      "description": "Filesystem kernel modules should be blacklisted unless they are required by the system.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "impact": "Disabling unused filesystem modules will prevent their use. Ensure they are not required before disabling.",
      "remediation": "For each unused filesystem, edit or create a file in the /etc/modprobe.d/ directory and add install <filesystem> /bin/true",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "1.1.1.11",
      "title": "Ensure firewire-core kernel module is not available",
      "section": "Initial Setup",
      "description": "FireWire is a high speed serial bus that connects devices to a personal computer.",
      "rationale": "Disabling FireWire will reduce the attack surface of the system.",
      "impact": "Disabling FireWire will prevent the use of FireWire devices. Ensure that FireWire is not required before implementing this control.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf Example: vi /etc/modprobe.d/firewire.conf and add the following line: install firewire-core /bin/true",
      "profile": "Level1",
      "type": "KernelModule",
      "module_name": "firewire-core",
      "expected_status": "not_available"
    },
    {
      "id": "1.1.2.1.1",
      "title": "Ensure /tmp is a separate partition",
      "section": "Initial Setup",
      "description": "The /tmp directory is a world-writable directory used for temporary storage by all users and some applications.",
      "rationale": "Making /tmp its own file system allows an administrator to set the noexec option on the mount, making /tmp useless for an attacker to install executable code.",
      "impact": "None if /tmp is already a separate partition.",
      "remediation": "Configure /tmp as a separate partition or logical volume.",
      "profile": "Level2",
      "type": "MountPoint",
      "mount_point": "/tmp",
      "expected_status": "separate_partition"
    },
    {
      "id": "1.1.2.1.2",
      "title": "Ensure nodev option set on /tmp partition",
      "section": "Initial Setup",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /tmp filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /tmp.",
      "impact": "None.",
      "remediation": "Edit /etc/fstab and add nodev to the fourth field for the /tmp partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/tmp",
      "required_option": "nodev"
    },
    {
      "id": "1.1.2.1.3",
      "title": "Ensure nosuid option set on /tmp partition",
      "section": "Initial Setup",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /tmp.",
      "impact": "None.",
      "remediation": "Edit /etc/fstab and add nosuid to the fourth field for the /tmp partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/tmp",
      "required_option": "nosuid"
    },
    {
      "id": "1.1.2.1.4",
      "title": "Ensure noexec option set on /tmp partition",
      "section": "Initial Setup",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /tmp.",
      "impact": "Some applications may require executable access to /tmp.",
      "remediation": "Edit /etc/fstab and add noexec to the fourth field for the /tmp partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/tmp",
      "required_option": "noexec"
    },
    {
      "id": "1.1.2.2.1",
      "title": "Ensure /dev/shm is tmpfs or a separate partition",
      "section": "Initial Setup",
      "description": "The /dev/shm directory is a world-writable directory used for shared memory.",
      "rationale": "Making /dev/shm its own file system allows an administrator to set mount options for enhanced security.",
      "impact": "None if /dev/shm is already properly configured.",
      "remediation": "Configure /dev/shm as tmpfs or separate partition.",
      "profile": "Level1",
      "type": "MountPoint",
      "mount_point": "/dev/shm",
      "expected_status": "separate_partition"
    },
    {
      "id": "1.1.2.2.2",
      "title": "Ensure nodev option set on /dev/shm partition",
      "section": "Initial Setup",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /dev/shm filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices.",
      "impact": "None.",
      "remediation": "Edit /etc/fstab and add nodev to the fourth field for the /dev/shm partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/dev/shm",
      "required_option": "nodev"
    },
    {
      "id": "1.1.2.2.3",
      "title": "Ensure nosuid option set on /dev/shm partition",
      "section": "Initial Setup",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /dev/shm filesystem is only intended for shared memory, set this option to ensure that users cannot create setuid files.",
      "impact": "None.",
      "remediation": "Edit /etc/fstab and add nosuid to the fourth field for the /dev/shm partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/dev/shm",
      "required_option": "nosuid"
    },
    {
      "id": "1.1.2.2.4",
      "title": "Ensure noexec option set on /dev/shm partition",
      "section": "Initial Setup",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Since the /dev/shm filesystem is only intended for shared memory, set this option to ensure that users cannot run executable binaries.",
      "impact": "None.",
      "remediation": "Edit /etc/fstab and add noexec to the fourth field for the /dev/shm partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/dev/shm",
      "required_option": "noexec"
    },
    {
      "id": "1.1.2.3.1",
      "title": "Ensure separate partition exists for /home",
      "section": "Initial Setup",
      "description": "The /home directory is used to support user home directories.",
      "rationale": "Making /home its own file system allows an administrator to set disk quotas and mount options for enhanced security.",
      "impact": "None if /home is already a separate partition.",
      "remediation": "Configure /home as a separate partition or logical volume.",
      "profile": "Level2",
      "type": "MountPoint",
      "mount_point": "/home",
      "expected_status": "separate_partition"
    },
    {
      "id": "1.1.2.3.2",
      "title": "Ensure nodev option set on /home partition",
      "section": "Initial Setup",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /home filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices.",
      "impact": "None.",
      "remediation": "Edit /etc/fstab and add nodev to the fourth field for the /home partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/home",
      "required_option": "nodev"
    },
    {
      "id": "1.1.2.3.3",
      "title": "Ensure nosuid option set on /home partition",
      "section": "Initial Setup",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /home filesystem is only intended for user home directories, set this option to ensure that users cannot create setuid files.",
      "impact": "None.",
      "remediation": "Edit /etc/fstab and add nosuid to the fourth field for the /home partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/home",
      "required_option": "nosuid"
    }
  ]
}