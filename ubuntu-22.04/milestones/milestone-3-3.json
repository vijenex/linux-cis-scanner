{
  "milestone": "3.3",
  "title": "Network Parameters (Host and Router)",
  "description": "Configure network parameters for both host and router configurations",
  "controls": [
    {
      "id": "3.3.1",
      "title": "Ensure ip forwarding is disabled",
      "description": "The net.ipv4.ip_forward and net.ipv6.conf.all.forwarding flags are used to tell the system whether it can forward packets or not.",
      "rationale": "Setting the flags to 0 ensures that a system with multiple interfaces (for example, a hard proxy), will never be able to forward packets, and therefore, never serve as a router.",
      "impact": "None if the system is not intended to be a router.",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.ip_forward",
      "expected_value": "0"
    },
    {
      "id": "3.3.2",
      "title": "Ensure packet redirect sending is disabled",
      "description": "ICMP Redirects are used to send routing information to other hosts.",
      "rationale": "An attacker could use a compromised host to send invalid ICMP redirects to other router devices in an attempt to corrupt routing and have users access a system set up by the attacker as opposed to a valid system.",
      "impact": "None.",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.send_redirects",
      "expected_value": "0"
    },
    {
      "id": "3.3.3",
      "title": "Ensure bogus icmp responses are ignored",
      "description": "Setting net.ipv4.icmp_ignore_bogus_error_responses to 1 prevents the kernel from logging bogus responses (RFC-1122 non-compliant) from broadcast reframes.",
      "rationale": "Some routers (and some attackers) will send responses that violate RFC-1122 and attempt to fill up a log file system with many useless error messages.",
      "impact": "None.",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.icmp_ignore_bogus_error_responses",
      "expected_value": "1"
    },
    {
      "id": "3.3.4",
      "title": "Ensure broadcast icmp requests are ignored",
      "description": "Setting net.ipv4.icmp_echo_ignore_broadcasts to 1 prevents the system from responding to ICMP pings and timestamp requests from networks.",
      "rationale": "Accepting ICMP echo and timestamp requests with broadcast or multicast destinations for your network could be used to trick your host into starting (or participating) in a Smurf attack.",
      "impact": "Disabling ICMP may break some network diagnostic tools.",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.icmp_echo_ignore_broadcasts",
      "expected_value": "1"
    },
    {
      "id": "3.3.5",
      "title": "Ensure icmp redirects are not accepted",
      "description": "ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path.",
      "rationale": "Attackers could use bogus ICMP redirect messages to maliciously alter the system routing tables and get them to send packets to incorrect networks and allow your system packets to be captured.",
      "impact": "None.",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.accept_redirects",
      "expected_value": "0"
    },
    {
      "id": "3.3.6",
      "title": "Ensure secure icmp redirects are not accepted",
      "description": "Secure ICMP redirects are the same as ICMP redirects, except they come from gateways listed on the default gateway list.",
      "rationale": "It is still possible for even known gateways to be compromised. Setting net.ipv4.conf.all.secure_redirects to 0 protects the system from routing table updates by possibly compromised known gateways.",
      "impact": "None.",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.secure_redirects",
      "expected_value": "0"
    },
    {
      "id": "3.3.7",
      "title": "Ensure reverse path filtering is enabled",
      "description": "Setting net.ipv4.conf.all.rp_filter and net.ipv4.conf.default.rp_filter to 1 forces the Linux kernel to utilize reverse path filtering on a received packet to determine if the packet was valid.",
      "rationale": "Setting these flags is a good way to deter attackers from sending your system bogus packets that cannot be responded to.",
      "impact": "None.",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.rp_filter",
      "expected_value": "1"
    },
    {
      "id": "3.3.8",
      "title": "Ensure source routed packets are not accepted",
      "description": "In networking, source routing allows a sender to partially or fully specify the route packets take through a network.",
      "rationale": "Setting net.ipv4.conf.all.accept_source_route and net.ipv4.conf.default.accept_source_route to 0 disables the system from accepting source routed packets.",
      "impact": "None.",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.accept_source_route",
      "expected_value": "0"
    },
    {
      "id": "3.3.9",
      "title": "Ensure suspicious packets are logged",
      "description": "When enabled, this feature logs packets with un-routable source addresses to the kernel log.",
      "rationale": "Enabling this feature and logging these packets allows an administrator to investigate the possibility that an attacker is sending spoofed packets to their system.",
      "impact": "None.",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.log_martians",
      "expected_value": "1"
    },
    {
      "id": "3.3.10",
      "title": "Ensure tcp syn cookies is enabled",
      "description": "When tcp_syncookies is set, the kernel will handle TCP SYN packets normally until the half-open connection queue is full, at which time, the SYN cookie functionality kicks in.",
      "rationale": "Attackers use SYN flood attacks to perform a denial of service attacked on a system by sending many SYN packets without completing the three way handshake.",
      "impact": "None.",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.tcp_syncookies",
      "expected_value": "1"
    },
    {
      "id": "3.3.11",
      "title": "Ensure ipv6 router advertisements are not accepted",
      "description": "This setting controls whether the system will accept IPv6 router advertisements.",
      "rationale": "It is recommended that systems do not accept router advertisements as they could be tricked into routing traffic to compromised machines.",
      "impact": "None if IPv6 is not used.",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv6.conf.all.accept_ra",
      "expected_value": "0"
    }
  ]
}