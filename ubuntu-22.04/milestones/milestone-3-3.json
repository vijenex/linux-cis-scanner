{
  "milestone": "3.3",
  "title": "Network Parameters (Host and Router)",
  "description": "Configure network parameters for both host and router configurations",
  "controls": [
    {
      "id": "3.3.1",
      "title": "Ensure ip forwarding is disabled",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.ip_forward",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1",
      "description": "• server o The server directive specifies an NTP server which can be used as a time source. The client -server relationship is strictly hierarchical: a client might synchronize its system time to that of the server, but the server’s system time will never be influence d by that of a client.\no This directive can be used multiple times to specify multiple servers.\no The directive is immediately followed by either the name of the server, or its IP address.\n• pool o The syntax of this directive is similar to that for the server directive, except that it is used to specify a pool of NTP servers rather than a single NTP server. The pool name is expected to resolve to multiple addresses which might change over time.\no This directive can be used multiple times to specify multiple pools.\no All options valid in the server directive can be used in this directive too.",
      "remediation": "Edit /etc/chrony/chrony.conf or a file ending in .sources in /etc/chrony/sources.d/ and add or edit server or pool lines as appropriate according to local site policy:\nEdit the Chrony configuration and add or edit the server and/or pool lines returned by the Audit Procedure as appropriate according to local site policy <[server|pool]> <[remote -server|remote -pool]> Example script to add a drop -in configuration for the pool directive:\n#!/usr/bin/env bash [ ! -d \"/etc/chrony/sources.d/\" ] && mkdir /etc/chrony/sources.d/ printf '%s ' \"\" \"#The maxsources option is unique to the pool directive\" \\ \"pool time.nist.gov iburst maxsources 4\" >> /etc/chrony/sources.d/60 - sources.sources chronyc reload sources &>/dev/null Example script to add a drop -in configuration for the server directive:\n#!/usr/bin/env bash [ ! -d \"/etc/chrony/sources.d/\" ] && mkdir /etc/chrony/sources.d/ printf '%s ' \"\" \"server time -a-g.nist.gov iburst\" \"server 132.163.97.3 iburst\" \\ \"server time -d-b.nist.gov iburst\" >> /etc/chrony/sources.d/60 - sources.sources chronyc reload sources &>/dev/null\nRun the following command to reload the chronyd config:\n# systemctl reload -or-restart chronyd"
    },
    {
      "id": "3.3.2",
      "title": "Ensure packet redirect sending is disabled",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.send_redirects",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.2",
      "description": "The chrony package is installed with a dedicated user account _chrony . This account is granted the access required by the chronyd service",
      "remediation": "Add or edit the user line to /etc/chrony/chrony.conf or a file ending in .conf in /etc/chrony/conf.d/ :\nuser _chrony - OR - If another time synchronization service is in use on the system, run the following command to remove chrony from the system:\n# apt purge chrony\n# apt autoremove chrony"
    },
    {
      "id": "3.3.3",
      "title": "Ensure bogus icmp responses are ignored",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.icmp_ignore_bogus_error_responses",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.3",
      "description": "chrony is a daemon for synchronizing the system clock across the network",
      "remediation": "- IF - chrony is in use on the system, run the following commands:\nRun the following command to unmask chrony.service :\n# systemctl unmask chrony.service\nRun the following command to enable and start chrony.service :\n# systemctl --now enable chrony.service - OR - If another time synchronization service is in use on the system, run the following command to remove chrony :\n# apt purge chrony\n# apt autoremove chrony"
    },
    {
      "id": "3.3.4",
      "title": "Ensure broadcast icmp requests are ignored",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.icmp_echo_ignore_broadcasts",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.4",
      "description": "The nullok argument overrides the default action of pam_unix.so to not permit the user access to a service if their official password is blank.",
      "remediation": "Run the following command:\n# grep -PH -- '^*([^#]++)?pam_unix \\.so+([^#]++)?nullok ' /usr/share/pam -configs/*\nEdit any files returned and remove the nullok argument for the pam_unix lines Example File:\nName: Unix authentication Default: yes Priority: 256 Auth-Type: Primary Auth:\n[success=end default=ignore] pam_unix.so try_first_pass # < - **ensure line does not include nullok nullok** Auth-Initial:\n[success=end default=ignore] pam_unix.so # < - **ensure line does not include nullok nullok** Account-Type: Primary Account:\n[success=end new_authtok_reqd=done default=ignore] pam_unix.so Account-Initial:\n[success=end new_authtok_reqd=done default=ignore] pam_unix.so Session-Type: Additional Session:\nrequired pam_unix.so Session-Initial:\nrequired pam_unix.so Password -Type: Primary Password:\n[success=end default=ignore] pam_unix.so obscure use_authtok try_first_pass yescrypt Password -Initial:\n[success=end default=ignore] pam_unix.so obscure yescrypt\nRun the following command to update the files in the /etc/pam.d/ directory:\n# pam-auth-update --enable <EDITED_PROFILE_NAME> Example:\n# pam-auth-update --enable unix Note: If custom files are being used, the corresponding files in /etc/pam.d/ would need to be edited directly, and the pam-auth-update --enable <EDITED_PROFILE_NAME> command skipped Internal Only - General"
    },
    {
      "id": "3.3.5",
      "title": "Ensure icmp redirects are not accepted",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.accept_redirects",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.5",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "3.3.6",
      "title": "Ensure secure icmp redirects are not accepted",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.secure_redirects",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.6",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "3.3.7",
      "title": "Ensure reverse path filtering is enabled",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.rp_filter",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.7",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "3.3.8",
      "title": "Ensure source routed packets are not accepted",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.accept_source_route",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.8",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "3.3.9",
      "title": "Ensure suspicious packets are logged",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.log_martians",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.9",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "3.3.10",
      "title": "Ensure tcp syn cookies is enabled",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.tcp_syncookies",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.10",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "3.3.11",
      "title": "Ensure ipv6 router advertisements are not accepted",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv6.conf.all.accept_ra",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.11",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    }
  ]
}