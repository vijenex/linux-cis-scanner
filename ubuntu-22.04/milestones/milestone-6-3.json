{
  "milestone": "6.3 Configure Filesystem Integrity Checking",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 6.3 Configure Filesystem Integrity Checking",
  "controls": [
    {
      "id": "6.3.1",
      "title": "Ensure AIDE is installed",
      "section": "System Auditing",
      "profile": "Level1",
      "type": "MultiPackage",
      "package_names": [
        "aide",
        "aide-common"
      ],
      "should_be_installed": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.3.1",
      "description": "AIDE takes a snapshot of filesystem state including modification times, permissions, and file hashes which can then be used to compare against the current state of the filesystem to detect modifications to the system.",
      "remediation": "Install AIDE using the appropriate package manager or manual installation:\n# apt install aide aide -common\nConfigure AIDE as appropriate for your environment. Consult the AIDE documentation for options.\nRun the following commands to initialize AIDE:\n# aideinit\n# mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db"
    },
    {
      "id": "6.3.2",
      "title": "Ensure filesystem integrity is regularly checked",
      "section": "System Auditing",
      "profile": "Level1",
      "type": "CronJob",
      "cron_user": "root",
      "expected_job": "aide",
      "job_description": "AIDE filesystem integrity check",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.3.2",
      "description": "Periodic checking of the filesystem integrity is needed to detect changes to the filesystem.",
      "remediation": "If cron will be used to schedule and run aide check:\nRun the following command:\n# crontab -u root -e\nAdd the following line to the crontab:\n0 5 * * * /usr/bin/aide.wrapper --config /etc/aide/aide.conf --update - OR - If aidecheck.service and aidecheck.timer will be used to schedule and run aide check:\nCreate or edit the file /etc/systemd/system/aidecheck.service and add the following lines:\n[Unit] Description=Aide Check [Service] Type=simple ExecStart=/usr/bin/aide.wrapper --config /etc/aide/aide.conf --update [Install] WantedBy=multi -user.target\nCreate or edit the file /etc/systemd/system/aidecheck.timer and add the following lines:\n[Unit] Description=Aide check every day at 5AM [Timer] OnCalendar=* -*-* 05:00:00 Unit=aidecheck.service [Install] WantedBy=multi -user.target\nRun the following commands:\n# chown root:root /etc/systemd/system/aidecheck.*\n# chmod 0644 /etc/systemd/system/aidecheck.*\n# systemctl daemon -reload\n# systemctl enable aidecheck.service\n# systemctl --now enable aidecheck.timer"
    },
    {
      "id": "6.3.3",
      "title": "Ensure cryptographic mechanisms are used to protect the integrity of audit tools",
      "section": "System Auditing",
      "profile": "Level1",
      "type": "AIDEConfig",
      "config_file": "/etc/aide/aide.conf",
      "monitored_tools": [
        "/sbin/auditctl",
        "/sbin/auditd",
        "/sbin/ausearch",
        "/sbin/aureport",
        "/sbin/autrace",
        "/sbin/augenrules"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "6.3.3",
      "description": "Audit tools include, but are not limited to, vendor -provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.",
      "remediation": "Run the following command to determine the absolute path to the non -symlinked version on the audit tools:\n# readlink -e /sbin The output will be either /usr/sbin - OR - /sbin . Ensure the correct path is used.\nEdit /etc/aide/aide.conf and add or update the following selection lines replacing <PATH> with the correct path returned in the command above:\n# Audit Tools <PATH>/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512 <PATH>/auditd p+i+n+u+g+s+b+acl+xattrs+sha512 <PATH>/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512 <PATH>/aureport p+i+n+u+g+s+b+acl+xattrs+sha512 <PATH>/autrace p+i+n+u+g+s+b+acl+xattrs+sha512 <PATH>/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512 Example\n# printf '%s ' \"\" \"# Audit Tools\" \"$(readlink -e /sbin/auditctl) p+i+n+u+g+s+b+acl+xattrs+sha512\" \"$(readlink -e /sbin/auditd) p+i+n+u+g+s+b+acl+xattrs+sha512\" \"$(readlink -e /sbin/ausearch) p+i+n+u+g+s+b+acl+xattrs+sha512\" \"$(readlink -e /sbin/aureport) p+i+n+u+g+s+b+acl+xattrs+sha512\" \"$(readlink -e /sbin/autrace) p+i+n+u+g+s+b+acl+xattrs+sha512\" \"$(readlink -e /sbin/augenrules) p+i+n+u+g+s+b+acl+xattrs+sha512\" >> \"$(readlink -e /etc/aide/aide.conf || readlink -e /etc/aide.conf)\" Note: - IF - /etc/aide/aide.conf includes a @@x_include statement:\nExample:\n@@x_include /etc/aide/aide.conf.d ^[a -zA-Z0-9_-]+$ • @@x_include FILE • @@x_include DIRECTORY REGEX o @x_include is identical to @@include , except that if a config file is executable it is run and the output is used as config.\no If the executable file exits with status greater than zero or writes to stderr aide stops with an error.\no For security reasons DIRECTORY and each executable config file must be owned by the current user and must not be group or world -writable."
    }
  ]
}