{
  "milestone": "3.1 Network Devices & 3.2 Network Kernel Modules",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Sections 3.1 Network Devices & 3.2 Network Kernel Modules",
  "controls": [
    {
      "id": "3.1.1",
      "title": "Ensure IPv6 status is identified",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "Manual",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.1.1",
      "description": "AppArmor provides Mandatory Access Controls.",
      "remediation": "Run the following command to install apparmor and apparmor -utils :\n# apt install apparmor apparmor -utils",
      "automated": false
    },
    {
      "id": "3.1.2",
      "title": "Ensure wireless interfaces are not available",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "WirelessInterface",
      "expected_status": "disabled",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.1.2",
      "description": "AppArmor is a kernel enhancement to confine programs to a limited set of resources.\nAppArmor is enabled by default.\nNote: This recommendation is designed around the grub bootloader, if LILO or another bootloader is in use in your environment enact equivalent settings.",
      "remediation": "Edit /etc/default/grub of file in /etc/default/grub.d and remove the apparmor=0 parameters to the GRUB_CMDLINE_LINUX= line\nRun the following commands to update the grub2 configuration and reboot the system:\n# update -grub\n# reboot",
      "automated": true
    },
    {
      "id": "3.1.3",
      "title": "Ensure bluetooth services are not in use",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "ServiceNotInUse",
      "service_names": [
        "bluetooth"
      ],
      "package_names": [
        "bluez"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.1.3",
      "description": "AppArmor profiles define what resources applications are able to access.",
      "remediation": "Run the following command to set all profiles to enforce mode:\n# aa-enforce /etc/apparmor.d/* - OR -\nRun the following command to set all profiles to complain mode:\n# aa-complain /etc/apparmor.d/* Note: Any unconfined processes may need to have a profile created or activated for them and then be restarted Internal Only - General",
      "automated": true
    },
    {
      "id": "3.2.1",
      "title": "Ensure dccp kernel module is not available",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelModule",
      "module_name": "dccp",
      "expected_status": "not_available",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.2.1",
      "description": "NTP= \u2022 A space -separated list of NTP server host names or IP addresses. During runtime this list is combined with any per -interface NTP servers acquired from systemd -networkd.service(8). systemd -timesyncd will contact all configured system or per -interface server s in turn, until one responds. When the empty string is assigned, the list of NTP servers is reset, and all prior assignments will have no effect. This setting defaults to an empty list.\nFallbackNTP= \u2022 A space -separated list of NTP server host names or IP addresses to be used as the fallback NTP servers. Any per -interface NTP servers obtained from systemd - networkd.service(8) take precedence over this setting, as do any servers set via NTP= above. This se tting is hence only relevant if no other NTP server information is known. When the empty string is assigned, the list of NTP servers is reset, and all prior assignments will have no effect. If this option is not given, a compiled -in list of NTP servers is used.",
      "remediation": "Set NTP and/or FallbackNTP parameters to local site approved authoritative time server(s) in /etc/systemd/timesyncd.conf or a file in /etc/systemd/timesyncd.conf.d/ ending in .conf in the [Time] section:\nExample file:\n[Time] NTP=time.nist.gov # Uses the generic name for NIST's time servers FallbackNTP=time -a-g.nist.gov time -b-g.nist.gov time -c-g.nist.gov # Space separated list of NIST time servers Example script to create systemd drop -in configuration file:\n#!/usr/bin/env bash a_settings=(\"NTP=time.nist.gov\" \"FallbackNTP=time -a-g.nist.gov time -b- g.nist.gov time -c-g.nist.gov\") [ ! -d /etc/systemd/timesyncd.conf.d/ ] && mkdir /etc/systemd/timesyncd.conf.d/ if grep -Psq -- '^*\\[Time\\]' /etc/systemd/timesyncd.conf.d/60 - timesyncd.conf; then printf '%s ' \"\" \"$a_settings[@]\" >> /etc/systemd/timesyncd.conf.d/60 -timesyncd.conf else printf '%s ' \"\" \"[Time]\" \"$a_settings[@]\" >> /etc/systemd/timesyncd.conf.d/60 -timesyncd.conf fi Note: If this setting appears in a canonically later file, or later in the same file, the\nsetting will be overwritten\nRun to following command to update the parameters in the service:\n# systemctl reload -or-restart systemd -timesyncd",
      "automated": true
    },
    {
      "id": "3.2.2",
      "title": "Ensure tipc kernel module is not available",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelModule",
      "module_name": "tipc",
      "expected_status": "not_available",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.2.2",
      "description": "systemd -timesyncd is a daemon that has been added for synchronizing the system clock across the network",
      "remediation": "- IF - systemd-timesyncd is in use on the system, run the following commands:\nRun the following command to unmask systemd-timesyncd.service :\n# systemctl unmask systemd -timesyncd.service\nRun the following command to enable and start systemd-timesyncd.service :\n# systemctl --now enable systemd -timesyncd.service - OR - If another time synchronization service is in use on the system, run the following command to stop and mask systemd-timesyncd :\n# systemctl --now mask systemd -timesyncd.service Internal Only - General",
      "automated": true
    },
    {
      "id": "3.2.3",
      "title": "Ensure rds kernel module is not available",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelModule",
      "module_name": "rds",
      "expected_status": "not_available",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.2.3",
      "description": "The Reliable Datagram Sockets (RDS) protocol is a transport layer protocol designed to provide low -latency, high -bandwidth communications between cluster nodes. It was developed by the Oracle Corporation.",
      "remediation": "Unload and disable the rds kernel module.\n1. Run the following commands to unload the rds kernel module:\n# modprobe -r rds 2>/dev/null\n# rmmod rds 2>/dev/null 2. Perform the following to disable the rds kernel module:\nCreate a file ending in .conf with install rds /bin/false in the /etc/modprobe.d/ directory Example:\n# printf ' %s' \"install rds /bin/false\" >> /etc/modprobe.d/60 -rds.conf\nCreate a file ending in .conf with blacklist rds in the /etc/modprobe.d/ directory Example:\n# printf ' %s' \"blacklist rds\" >> /etc/modprobe.d/60 -rds.conf",
      "automated": true
    },
    {
      "id": "3.2.4",
      "title": "Ensure sctp kernel module is not available",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelModule",
      "module_name": "sctp",
      "expected_status": "not_available",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.2.4",
      "description": "The Stream Control Transmission Protocol (SCTP) is a transport layer protocol used to support message oriented communication, with several streams of messages in one connection. It serves a similar function as TCP and UDP, incorporating features of both.\nIt is message -oriented like UDP, and ensures reliable in -sequence transport of messages with congestion control like TCP.",
      "remediation": "Unload and disable the sctp kernel module.\n1. Run the following commands to unload the sctp kernel module:\n# modprobe -r sctp 2>/dev/null\n# rmmod sctp 2>/dev/null 2. Perform the following to disable the sctp kernel module:\nCreate a file ending in .conf with install sctp /bin/false in the /etc/modprobe.d/ directory Example:\n# printf ' %s' \"install sctp /bin/false\" >> /etc/modprobe.d/60 -sctp.conf\nCreate a file ending in .conf with blacklist sctp in the /etc/modprobe.d/ directory Example:\n# printf ' %s' \"blacklist sctp\" >> /etc/modprobe.d/60 -sctp.conf Internal Only - General",
      "automated": true
    }
  ]
}