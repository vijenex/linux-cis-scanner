{
  "milestone": "1.6",
  "title": "Configure Command Line Warning Banners",
  "description": "Configure warning banners for command line access",
  "controls": [
    {
      "id": "1.6.1",
      "title": "Ensure /etc/motd is configured",
      "profile": "Level1",
      "type": "Manual",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.6.1",
      "description": "The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.\nUnix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: - machine architecture - operating system release - operating system name - operating system version",
      "remediation": "Edit the file found in /etc/motd.d/* with the appropriate contents according to your site policy, remove any instances of , , , or references to the OS platform - OR - - IF - the motd is not used, this file can be removed.\nRun the following command to remove the motd file:\n# rm /etc/motd\nRun the following script and review and/or update all returned files' contents to:\n• Remove all system information ( , ; , ) • Remove any refence to the operating system • Ensure contents follow local site policy\n#!/usr/bin/env bash a_files=() for l_file in /etc/motd,.d/*; do if grep -Psqi -- \"(\\\\|\\\\|\\\\|\\\\|$(grep ^ID= /etc/os -release | cut -d= -f2 | sed -e 's/\"//g') )\" \"$l_file\"; then echo -e \"- File: \\\"$l_file \\\" includes system information. Edit this file to remove these entries\" else a_files+=(\"$l_file\") fi done if [ \"$#a_files[@]\" -gt 0 ]; then echo -e \"- ** Please review the following files and verify their contents follow local site policy ** \" printf '%s ' \"$a_files[@]\" fi"
    },
    {
      "id": "1.6.2",
      "title": "Ensure /etc/issue is configured",
      "profile": "Level1",
      "type": "Manual",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.6.2",
      "description": "The contents of the /etc/issue file are displayed to users prior to login for local terminals.\nUnix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: - machine architecture - operating system release - operating system name - operating system version - or the operating system's name",
      "remediation": "Edit the /etc/issue file with the appropriate contents according to your site policy,\nremove any instances of , , , or references to the OS platform Example:\n# echo \"Authorized users only. All activity may be monitored and reported.\" > /etc/issue"
    },
    {
      "id": "1.6.3",
      "title": "Ensure /etc/issue.net is configured",
      "profile": "Level1",
      "type": "Manual",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.6.3",
      "description": "The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services.\nUnix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: - machine architecture - operating system release - operating system name - operating system version",
      "remediation": "Edit the /etc/issue.net file with the appropriate contents according to your site policy,\nremove any instances of , , , or references to the OS platform Example:\n# echo \"Authorized users only. All activity may be monitored and reported.\" > /etc/issue.net"
    },
    {
      "id": "1.6.4",
      "title": "Ensure access to /etc/motd is configured",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/motd",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.6.4",
      "description": "The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.",
      "remediation": "Run the following commands to set mode, owner, and group on /etc/motd :\n# chown root:root $(readlink -e /etc/motd)\n# chmod u -x,go-wx $(readlink -e /etc/motd) - OR -\nRun the following command to remove the /etc/motd file:\n# rm /etc/motd"
    },
    {
      "id": "1.6.5",
      "title": "Ensure access to /etc/issue is configured",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/issue",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.6.5",
      "description": "The contents of the /etc/issue file are displayed to users prior to login for local terminals.",
      "remediation": "Run the following commands to set mode, owner, and group on /etc/issue :\n# chown root:root $(readlink -e /etc/issue)\n# chmod u -x,go-wx $(readlink -e /etc/issue)"
    },
    {
      "id": "1.6.6",
      "title": "Ensure access to /etc/issue.net is configured",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/issue.net",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.6.6",
      "description": "The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services.",
      "remediation": "Run the following commands to set mode, owner, and group on /etc/issue.net :\n# chown root:root $(readlink -e /etc/issue.net)\n# chmod u -x,go-wx $(readlink -e /etc/issue.net)"
    }
  ]
}