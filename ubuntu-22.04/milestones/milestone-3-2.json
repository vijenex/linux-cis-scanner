{
  "milestone": "3.3 Network Kernel Parameters",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 3.3 Configure Network Kernel Parameters",
  "controls": [
    {
      "id": "3.3.1.1",
      "title": "Ensure net.ipv4.ip_forward is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.ip_forward",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.1",
      "description": "The net.ipv4.ip_forward flag tells the system whether it can forward IPv4 packets or not.\nNote:\n• If this system is a router this recommendation is not applicable.\n• If net.ipv4.conf.all.forwarding=0 and net.ipv4.conf.default.forwarding=0 are configured, this recommendation may be skipped.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.ip_forward lines that are not net.ipv4.ip_forward=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.ip_forward\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.ip_forward = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.ip_forward = 0\" >> /etc/sysctl.d/60 - ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.1.2",
      "title": "Ensure net.ipv4.conf.all.forwarding is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.forwarding",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.2",
      "description": "ICMP Redirects are used to send routing information to other hosts. As a host itself does not act as a router (in a host only configuration), there is no need to send redirects.\nnet.ipv4.conf.all.forwarding controls forwarding of IPv4 packet on all interfaces.\nNote:\n• If this system is a router this recommendation is not applicable.\n• If net.ipv4.ip_forward=0 is configured, this recommendation may be skipped.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.all.forwarding lines that are not net.ipv4.conf.all.forwarding=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.all.forwarding\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.all.forwarding = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.all.forwarding = 0\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created a s part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system Internal Only - General"
    },
    {
      "id": "3.3.1.3",
      "title": "Ensure net.ipv4.conf.default.forwarding is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.default.forwarding",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.3",
      "description": "ICMP Redirects are used to send routing information to other hosts. As a host itself does not act as a router (in a host only configuration), there is no need to send redirects.\nnet.ipv4.conf.default.forwarding controls forwarding of IPv4 packet on newly added network interfaces.\nNote:\n• If this system is a router this recommendation is not applicable.\n• If net.ipv4.ip_forward=0 is configured, this recommendation may be skipped.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.default.forwarding lines that are not net.ipv4.conf.default.forwarding=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.default.forwarding\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.default.forwarding = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.default.forwarding = 0\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system Internal Only - General"
    },
    {
      "id": "3.3.1.4",
      "title": "Ensure net.ipv4.conf.all.send_redirects is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.send_redirects",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.4",
      "description": "ICMP Redirects are used to send routing information to other hosts. As a host itself does not act as a router (in a host only configuration), there is no need to send redirects.\nnet.ipv4.conf.all.send_redirects controls sending of all IPv4 ICMP redirected packets on all interfaces.\nNote: If this system is a router this recommendation is not applicable.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.all.send_redirects lines that are not net.ipv4.conf.all.send_redirects=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.all.send_redirects\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.all.send_redirects = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.all.send_redirects = 0\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created a s part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system Internal Only - General"
    },
    {
      "id": "3.3.1.5",
      "title": "Ensure net.ipv4.conf.default.send_redirects is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.default.send_redirects",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.5",
      "description": "ICMP Redirects are used to send routing information to other hosts. As a host itself does not act as a router (in a host only configuration), there is no need to send redirects.\nnet.ipv4.conf.default.send_redirects controls sending of all IPv4 ICMP redirected packets on a newly added network interface.\nNote: If this system is a router this recommendation is not applicable.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.default.send_redirects lines that are not net.ipv4.conf.default.send_redirects=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.default.send_redirects\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.default.send_redirects = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.default.send_redirects = 0\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system Internal Only - General"
    },
    {
      "id": "3.3.1.6",
      "title": "Ensure net.ipv4.icmp_ignore_bogus_error_responses is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.icmp_ignore_bogus_error_responses",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.6",
      "description": "net.ipv4.icmp_ignore_bogus_error_responses controls if the kernel logs bogus responses (RFC -1122 non -compliant) from broadcast reframes.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.icmp_ignore_bogus_error_responses lines that are not net.ipv4.icmp_ignore_bogus_error_responses=1 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.icmp_ignore_bogus_error_responses\" l_value=\"1\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(0|[2-9]|1[0-9]+)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.icmp_ignore_bogus_error_responses = 1 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.icmp_ignore_bogus_error_responses = 1\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created a s part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.1.7",
      "title": "Ensure net.ipv4.icmp_echo_ignore_broadcasts is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.icmp_echo_ignore_broadcasts",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.7",
      "description": "net.ipv4.icmp_echo_ignore_broadcasts controls if all ICMP echo and timestamp requests to broadcast and multicast addresses are ignored.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.icmp_echo_ignore_broadcasts lines that are not net.ipv4.icmp_echo_ignore_broadcasts=1 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.icmp_echo_ignore_broadcasts\" l_value=\"1\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(0|[2-9]|1[0-9]+)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.icmp_echo_ignore_broadcasts = 1 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.icmp_echo_ignore_broadcasts = 1\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.1.8",
      "title": "Ensure net.ipv4.conf.all.accept_redirects is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.accept_redirects",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.8",
      "description": "ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables.\nnet.ipv4.conf.all.accept_redirects controls accepting of all IPv4 ICMP redirected packets on all interfaces.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.all.accept_redirects lines that are not net.ipv4.conf.all.accept_redirects=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.all.accept_redirects\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.all.accept_redirects = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.all.accept_redirects = 0\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.1.9",
      "title": "Ensure net.ipv4.conf.default.accept_redirects is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.default.accept_redirects",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.9",
      "description": "ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables.\nnet.ipv4.conf.default.accept_redirects controls accepting of all IPv4 ICMP redirected packets on a newly added network interface.\nNote: If this system is a router this recommendation is not applicable.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.default.accept_redirects lines that are not net.ipv4.conf.default.accept_redirects=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.default.accept_redirects\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.default.accept_redirects = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.default.accept_redirects = 0\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.1.10",
      "title": "Ensure net.ipv4.conf.all.secure_redirects is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.secure_redirects",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.10",
      "description": "Secure ICMP redirects are the same as ICMP redirects, except they come from gateways listed on the default gateway list. It is assumed that these gateways are known to your system, and that they are likely to be secure.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.all.secure_redirects lines that are not net.ipv4.conf.all.secure_redirects=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.all.secure_redirects\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.all.secure_redirects = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.all.secure_redirects = 0\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.1.11",
      "title": "Ensure net.ipv4.conf.default.secure_redirects is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.default.secure_redirects",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.11",
      "description": "Secure ICMP redirects are the same as ICMP redirects, except they come from gateways listed on the default gateway list. It is assumed that these gateways are known to your system, and that they are likely to be secure.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.default.secure_redirects lines that are not net.ipv4.conf.default.secure_redirects=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.default.secure_redirects\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.default.secure_redirects = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.default.secure_redirects = 0\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.1.12",
      "title": "Ensure net.ipv4.conf.all.rp_filter is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.rp_filter",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.12",
      "description": "net.ipv4.conf.all.rp_filter controls reverse path filtering for IPv4 traffic on all network interfaces.\nReverse path filtering is a security mechanism in Linux that helps prevent IP spoofing and other network attacks. When enabled, it checks if the source IP address of an incoming packet is reachable through the same network interface it was received on. If the packet's source address is not reachable through the interface it arrived on, the packet is dropped.\nNote: If this system is a router, and uses asymmetrical routing, this recommendation is not applicable.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.all.rp_filter lines that are not net.ipv4.conf.all.rp_filter=1 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.all.rp_filter\" l_value=\"1\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(0|[2-9]|1[0-9]+)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.all.rp_filter = 1 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.all.rp_filter = 1\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.1.13",
      "title": "Ensure net.ipv4.conf.default.rp_filter is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.default.rp_filter",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.13",
      "description": "net.ipv4.conf.default.rp_filter controls reverse path filtering for IPv4 traffic on newly added network interfaces.\nReverse path filtering is a security mechanism in Linux that helps prevent IP spoofing and other network attacks. When enabled, it checks if the source IP address of an incoming packet is reachable through the same network interface it was received on. If the packet's source address is not reachable through the interface it arrived on, the packet is dropped.\nNote: If this system is a router, and uses asymmetrical routing, this recommendation is not applicable.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.default.rp_filter lines that are not net.ipv4.conf.default.rp_filter=1 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.default.rp_filter\" l_value=\"1\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(0|[2-9]|1[0-9]+)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.default.rp_filter = 1 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.default.rp_filter = 1\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.1.14",
      "title": "Ensure net.ipv4.conf.all.accept_source_route is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.accept_source_route",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.14",
      "description": "The accept_source_route option causes network interfaces to accept packets with the Strict Source Route (SSR) or Loose Source Routing (LSR) option set.\nnet.ipv4.conf.all.accept_source_route controls accepting of all IPv4 packets with the SSR or LSR option set on all interfaces.\nIn networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non -source routed packets travel a path determined by routers in the network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.all.accept_source_route lines that are not net.ipv4.conf.all.accept_source_route=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.all.accept_source_route\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.all.accept_source_route = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.all.accept_source_route = 0\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created a s part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.1.15",
      "title": "Ensure net.ipv4.conf.default.accept_source_route is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.default.accept_source_route",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.15",
      "description": "The accept_source_route option causes network interfaces to accept packets with the Strict Source Route (SSR) or Loose Source Routing (LSR) option set.\nnet.ipv4.conf.default.accept_source_route controls accepting of all IPv4 packets with the SSR or LSR option set on newly added network interfaces.\nIn networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non -source routed packets travel a path determined by routers in the network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.default.accept_source_route lines that are not net.ipv4.conf.default.accept_source_route=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.default.accept_source_route\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.default.accept_source_route = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.default.accept_source_route = 0\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.1.16",
      "title": "Ensure net.ipv4.conf.all.log_martians is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.all.log_martians",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.16",
      "description": "When enabled, this feature logs packets with un -routable source addresses to the kernel log.\nnet.ipv4.conf.all.log_martians controls if IPv4 packets with un -routable source addresses on any network interface is logged to the kernel log.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.all.log_martians lines that are not net.ipv4.conf.all.log_martians=1 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.all.log_martians\" l_value=\"1\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(0|[2-9]|1[0-9]+)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.all.log_martians = 1 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.all.log_martians = 1\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.1.17",
      "title": "Ensure net.ipv4.conf.default.log_martians is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.conf.default.log_martians",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.17",
      "description": "When enabled, this feature logs packets with un -routable source addresses to the kernel log.\nnet.ipv4.conf.default.log_martians controls if IPv4 packets with un -routable source addresses on a newly added network interface is logged to the kernel log.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.conf.default.log_martians lines that are not net.ipv4.conf.default.log_martians=1 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.conf.default.log_martians\" l_value=\"1\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(0|[2-9]|1[0-9]+)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.conf.default.log_martians = 1 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.conf.default.log_martians = 1\" \\ >> /etc/sysctl.d/60 -ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.1.18",
      "title": "Ensure net.ipv4.tcp_syncookies is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv4.tcp_syncookies",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.1.18",
      "description": "When tcp_syncookies is set, the kernel will handle TCP SYN packets normally until the half -open connection queue is full, at which time, the SYN cookie functionality kicks in. SYN cookies work by not using the SYN queue at all. Instead, the kernel simply replies to the SYN w ith a SYN/ACK, but will include a specially crafted TCP sequence number that encodes the source and destination IP address and port number and the time the packet was sent. A legitimate connection would send the ACK packet of the three w ay handshake with the specially crafted sequence number. This allows the system to verify that it has received a valid response to a SYN cookie and allow the connection, even though there is no corresponding SYN in the queue.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv4.tcp_syncookies lines that are not net.ipv4.tcp_syncookies=1 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv4.tcp_syncookies\" l_value=\"1\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(0|[2-9]|1[0-9]+)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv4.tcp_syncookies = 1 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv4.tcp_syncookies = 1\" >> /etc/sysctl.d/60 - ipv4_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.2.1",
      "title": "Ensure net.ipv6.conf.all.forwarding is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv6.conf.all.forwarding",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.2.1",
      "description": "The net.ipv6.conf.all.forwarding flag tells the system whether it can forward IPv6 packets or not.\nNote: If IPv6 has been disabled, or this system is a router, this recommendation is not applicable.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv6.conf.all.forwarding lines that are not net.ipv6.conf.all.forwarding=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv6.conf.all.forwarding\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv6.conf.all.forwarding = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv6.conf.all.forwarding = 0\" >> /etc/sysctl.d/60 - ipv6_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.2.2",
      "title": "Ensure net.ipv6.conf.default.forwarding is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv6.conf.default.forwarding",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.2.2",
      "description": "The net.ipv6.conf.all.forwarding flag tells the system whether it can forward IPv6 on the default or newly added network interface.\nNote: If IPv6 has been disabled, or this system is a router, this recommendation is not applicable.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv6.conf.default.forwarding lines that are not net.ipv6.conf.default.forwarding=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv6.conf.default.forwarding\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv6.conf.default.forwarding = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv6.conf.default.forwarding = 0\" >> /etc/sysctl.d/60 -ipv6_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.2.3",
      "title": "Ensure net.ipv6.conf.all.accept_redirects is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv6.conf.all.accept_redirects",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.2.3",
      "description": "ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables.\nnet.ipv6.conf.all.accept_redirects controls accepting of all IPv6 ICMP redirected packets on all interfaces.\nNote: If IPv6 has been disabled, or this system is a router, this recommendation is not applicable.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv6.conf.all.accept_redirects lines that are not net.ipv6.conf.all.accept_redirects=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv6.conf.all.accept_redirects\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv6.conf.all.accept_redirects = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv6.conf.all.accept_redirects = 0\" \\ >> /etc/sysctl.d/60 -ipv6_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.2.4",
      "title": "Ensure net.ipv6.conf.default.accept_redirects is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv6.conf.default.accept_redirects",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.2.4",
      "description": "ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables.\nnet.ipv6.conf.default.accept_redirects controls accepting of all IPv6 ICMP redirected packets on a newly added network interface.\nNote: If IPv6 has been disabled, or this system is a router, this recommendation is not applicable.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv6.conf.default.accept_redirects lines that are not net.ipv6.conf.default.accept_redirects=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv6.conf.default.accept_redirects\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv6.conf.default.accept_redirects = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv6.conf.default.accept_redirects = 0\" \\ >> /etc/sysctl.d/60 -ipv6_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.2.5",
      "title": "Ensure net.ipv6.conf.all.accept_source_route is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv6.conf.all.accept_source_route",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.2.5",
      "description": "The accept_source_route option causes network interfaces to accept packets with the Strict Source Route (SSR) or Loose Source Routing (LSR) option set.\nnet.ipv6.conf.all.accept_source_route controls accepting of all IPv6 packets with the SSR or LSR option set on all interfaces.\nIn networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non -source routed packets travel a path determined by routers in the network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.\nNote: If IPv6 has been disabled this recommendation is not applicable.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv6.conf.all.accept_source_route lines that are not net.ipv6.conf.all.accept_source_route=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv6.conf.all.accept_source_route\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv6.conf.all.accept_source_route = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv6.conf.all.accept_source_route = 0\" \\ >> /etc/sysctl.d/60 -ipv6_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.2.6",
      "title": "Ensure net.ipv6.conf.default.accept_source_route is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv6.conf.default.accept_source_route",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.2.6",
      "description": "The accept_source_route option causes network interfaces to accept packets with the Strict Source Route (SSR) or Loose Source Routing (LSR) option set.\nnet.ipv6.conf.default.accept_source_route controls accepting of all IPv6 packets with the SSR or LSR option set on newly added network interfaces.\nIn networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non -source routed packets travel a path determined by routers in the network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.\nNote: If IPv6 has been disabled this recommendation is not applicable.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv6.conf.default.accept_source_route lines that are not net.ipv6.conf.default.accept_source_route=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv6.conf.default.accept_source_route\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv6.conf.default.accept_source_route = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv6.conf.default.accept_source_route = 0\" \\ >> /etc/sysctl.d/60 -ipv6_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.2.7",
      "title": "Ensure net.ipv6.conf.all.accept_ra is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv6.conf.all.accept_ra",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.2.7",
      "description": "Routers periodically multicast Router Advertisement messages to announce their availability and convey information to neighboring nodes that enable them to be automatically configured on the network.\nnet.ipv6.conf.all.accept_ra controls accepting any IPv6 RA messages on any network device.\nNote: If IPv6 has been disabled, this recommendation is not applicable.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv6.conf.all.accept_ra lines that are not net.ipv6.conf.all.accept_ra=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv6.conf.all.accept_ra\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < <(\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv6.conf.all.accept_ra = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv6.conf.all.accept_ra = 0\" >> /etc/sysctl.d/60 - ipv6_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created a s part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    },
    {
      "id": "3.3.2.8",
      "title": "Ensure net.ipv6.conf.default.accept_ra is configured",
      "section": "Network Configuration",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "net.ipv6.conf.default.accept_ra",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "3.3.2.8",
      "description": "Routers periodically Multicast Router Advertisement (RA) messages to announce their availability and convey information to neighboring nodes that enable them to be automatically configured on the network.\nnet.ipv6.conf.default.accept_ra controls accepting IPv6 RA messages on newly added network devices.\nNote: If IPv6 has been disabled, this recommendation is not applicable.",
      "remediation": "1. Review all files being used by systemd sysctl and comment out or remove all net.ipv6.conf.default.accept_ra lines that are not net.ipv6.conf.default.accept_ra=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"net.ipv6.conf.default.accept_ra\" l_value=\"0\" l_grep=\"$l_option//./( \\\\.|\\\\/)\" a_files=() l_systemdsysctl=\"$(readlink -e /lib/systemd/systemd -sysctl \\ || readlink -e /usr/lib/systemd/systemd -sysctl)\" l_ufw_file=\"$([ -f /etc/default/ufw ] && \\ awk -F= '/^*IPT_SYSCTL=/ print $2' /etc/default/ufw)\" [ -f \"$(readlink -e \"$l_ufw_file\")\" ] && \\ a_files+=(\"$l_ufw_file\"); a_files+=(\"/etc/sysctl.conf\") while IFS= read -r l_fname; do l_file=\"$(readlink -e \"$l_fname//# /\")\" [ -n \"$l_file\" ] && ! grep -Psiq -- '(^|+)'\"$l_file\"' ' \\ <<< \"$a_files[*]\" && a_files+=(\"$l_file\") done < < (\"$l_systemdsysctl\" --cat-config | tac | \\ grep -Pio -- '^*#*\\/[^#]+\\.conf') for l_file in \"$a_files[@]\"; do grep -Poi -- '*'\"$l_grep\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq -- '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*'\"$l_grep\"' *=*(1[0-9]*)/s/^/# /' \"$l_file\" done Internal Only - General 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nnet.ipv6.conf.default.accept_ra = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"net.ipv6.conf.default.accept_ra = 0\" >> /etc/sysctl.d/60 - ipv6_sysctl.conf Note: If the UFW file was the first file listed in the audit, the entry will be commented out as part of the first step, however updating Uncomplicated Firewall (UFW) may update this change. In this case the updated entry will supersede the entry being created as part of this step.\n3. Run the following command to load all sysctl configuration filles:\n# sysctl --system"
    }
  ]
}