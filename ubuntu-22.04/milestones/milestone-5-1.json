{
  "milestone": "5.1 Configure SSH Server",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 5.1 Configure SSH Server",
  "controls": [
    {
      "id": "5.1.1",
      "title": "Ensure access to /etc/ssh/sshd_config is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/ssh/sshd_config",
      "expected_mode": "600",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.2",
      "title": "Ensure access to SSH private host key files is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHPrivateKeys",
      "key_pattern": "/etc/ssh/ssh_host_*_key",
      "expected_mode": "600",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.2",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.3",
      "title": "Ensure access to SSH public host key files is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHPublicKeys",
      "key_pattern": "/etc/ssh/ssh_host_*_key.pub",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.3",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.4",
      "title": "Ensure sshd access is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "AllowUsers",
        "AllowGroups",
        "DenyUsers",
        "DenyGroups"
      ],
      "expected_values": {},
      "require_one_of": true,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.4",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.5",
      "title": "Ensure sshd Banner is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "Banner"
      ],
      "expected_values": {
        "Banner": "/etc/issue.net"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.5",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.6",
      "title": "Ensure sshd Ciphers are configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "Ciphers"
      ],
      "expected_values": {
        "Ciphers": "chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr"
      },
      "require_one_of": false,
      "validate_crypto": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.6",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.7",
      "title": "Ensure sshd ClientAliveInterval and ClientAliveCountMax are configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "ClientAliveInterval",
        "ClientAliveCountMax"
      ],
      "expected_values": {
        "ClientAliveInterval": "15",
        "ClientAliveCountMax": "3"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.7",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.8",
      "title": "Ensure sshd DisableForwarding is enabled",
      "section": "Access Control",
      "profile": "Level2",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "DisableForwarding"
      ],
      "expected_values": {
        "DisableForwarding": "yes"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.8",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.9",
      "title": "Ensure sshd GSSAPIAuthentication is disabled",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "GSSAPIAuthentication"
      ],
      "expected_values": {
        "GSSAPIAuthentication": "no"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.9",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.10",
      "title": "Ensure sshd HostbasedAuthentication is disabled",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "HostbasedAuthentication"
      ],
      "expected_values": {
        "HostbasedAuthentication": "no"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.10",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.11",
      "title": "Ensure sshd IgnoreRhosts is enabled",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "IgnoreRhosts"
      ],
      "expected_values": {
        "IgnoreRhosts": "yes"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.11",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.12",
      "title": "Ensure sshd KexAlgorithms is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "KexAlgorithms"
      ],
      "expected_values": {
        "KexAlgorithms": "curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256"
      },
      "require_one_of": false,
      "validate_crypto": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.12",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.13",
      "title": "Ensure sshd LoginGraceTime is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "LoginGraceTime"
      ],
      "expected_values": {
        "LoginGraceTime": "60"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.13",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.14",
      "title": "Ensure sshd LogLevel is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "LogLevel"
      ],
      "expected_values": {
        "LogLevel": "VERBOSE"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.14",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.15",
      "title": "Ensure sshd MACs are configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "MACs"
      ],
      "expected_values": {
        "MACs": "hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256"
      },
      "require_one_of": false,
      "validate_crypto": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.15",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.16",
      "title": "Ensure sshd MaxAuthTries is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "MaxAuthTries"
      ],
      "expected_values": {
        "MaxAuthTries": "4"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.16",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.17",
      "title": "Ensure sshd MaxSessions is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "MaxSessions"
      ],
      "expected_values": {
        "MaxSessions": "10"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.17",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.18",
      "title": "Ensure sshd MaxStartups is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "MaxStartups"
      ],
      "expected_values": {
        "MaxStartups": "10:30:60"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.18",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.19",
      "title": "Ensure sshd PermitEmptyPasswords is disabled",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "PermitEmptyPasswords"
      ],
      "expected_values": {
        "PermitEmptyPasswords": "no"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.19",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.20",
      "title": "Ensure sshd PermitRootLogin is disabled",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "PermitRootLogin"
      ],
      "expected_values": {
        "PermitRootLogin": "no"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.20",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.21",
      "title": "Ensure sshd PermitUserEnvironment is disabled",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "PermitUserEnvironment"
      ],
      "expected_values": {
        "PermitUserEnvironment": "no"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.21",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.1.22",
      "title": "Ensure sshd UsePAM is enabled",
      "section": "Access Control",
      "profile": "Level1",
      "type": "SSHDConfig",
      "config_file": "/etc/ssh/sshd_config",
      "check_parameters": [
        "UsePAM"
      ],
      "expected_values": {
        "UsePAM": "yes"
      },
      "require_one_of": false,
      "validate_crypto": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.1.22",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    }
  ]
}