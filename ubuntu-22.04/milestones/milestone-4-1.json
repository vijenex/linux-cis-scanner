{
  "milestone": "4.1 Configure Uncomplicated Firewall",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 4.1 Configure Uncomplicated Firewall",
  "controls": [
    {
      "id": "4.1.1",
      "title": "Ensure ufw is installed",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "Package",
      "package_name": "ufw",
      "should_be_installed": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.1",
      "description": "The cron daemon is used to execute batch jobs on the system.",
      "remediation": "- IF - cron is installed on the system:\nRun the following commands to unmask, enable, and start cron :\n# systemctl unmask \"$(systemctl list -unit-files | awk '$1~/^crond? \\.service/print $1')\"\n# systemctl --now enable \"$(systemctl list -unit-files | awk '$1~/^crond? \\.service/print $1')\""
    },
    {
      "id": "4.1.2",
      "title": "Ensure ufw service is configured",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "UFWStatus",
      "expected_status": "active",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.2",
      "description": "The /etc/crontab file is used by cron to control its own jobs. The commands in this item make sure that root is the user and group owner of the file and that only the owner can access the file.",
      "remediation": "- IF - cron is installed on the system:\nRun the following commands to set ownership and permissions on /etc/crontab :\n# chown root:root /etc/crontab\n# chmod og -rwx /etc/crontab"
    },
    {
      "id": "4.1.3",
      "title": "Ensure ufw incoming default is configured",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "UFWDefaultPolicy",
      "expected_policies": {
        "incoming": "deny"
      },
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.3",
      "description": "This directory contains system cron jobs that need to run on an hourly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.",
      "remediation": "- IF - cron is installed on the system:\nRun the following commands to set ownership and permissions on the /etc/cron.hourly directory:\n# chown root:root /etc/cron.hourly/\n# chmod og -rwx /etc/cron.hourly/"
    },
    {
      "id": "4.1.4",
      "title": "Ensure ufw outgoing default is configured",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "UFWDefaultPolicy",
      "expected_policies": {
        "outgoing": "allow"
      },
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.4",
      "description": "The /etc/cron.daily directory contains system cron jobs that need to run on a daily basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.",
      "remediation": "- IF - cron is installed on the system:\nRun the following commands to set ownership and permissions on the /etc/cron.daily directory:\n# chown root:root /etc/cron.daily/\n# chmod og -rwx /etc/cron.daily/"
    },
    {
      "id": "4.1.5",
      "title": "Ensure ufw routed default is configured",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "UFWDefaultPolicy",
      "expected_policies": {
        "routed": "deny"
      },
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.5",
      "description": "The /etc/cron.weekly directory contains system cron jobs that need to run on a weekly basis. The files in this directory cannot be manipulated by the crontab command but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.",
      "remediation": "- IF - cron is installed on the system:\nRun the following commands to set ownership and permissions on the /etc/cron.weekly directory:\n# chown root:root /etc/cron.weekly/\n# chmod og -rwx /etc/cron.weekly/"
    },
    {
      "id": "4.1.6",
      "title": "Ensure ufw loopback traffic is configured",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "UFWLoopback",
      "expected_rules": [
        "allow in on lo",
        "allow out on lo",
        "deny in from 127.0.0.0/8",
        "deny in from ::1"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.6",
      "description": "The /etc/cron.monthly directory contains system cron jobs that need to run on a monthly basis. The files in this directory cannot be manipulated by the crontab command but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.",
      "remediation": "- IF - cron is installed on the system:\nRun the following commands to set ownership and permissions on the /etc/cron.monthly directory:\n# chown root:root /etc/cron.monthly/\n# chmod og -rwx /etc/cron.monthly/"
    },
    {
      "id": "4.1.7",
      "title": "Ensure ufw firewall rules exist for all open ports",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "UFWOpenPorts",
      "check_open_ports": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.7",
      "description": "The /etc/cron.yearly directory contains system cron jobs that need to run on an annual basis. The files in this directory cannot be manipulated by the crontab command but are instead edited by system administrators using a text editor. The commands below restrict read/write a nd search access to user and group root, preventing regular users from accessing this directory.",
      "remediation": "- IF - cron is installed on the system:\nRun the following commands to set ownership and permissions on the /etc/cron.yearly directory:\n# chown root:root /etc/cron.yearly/\n# chmod og -rwx /etc/cron.yearly/"
    }
  ]
}