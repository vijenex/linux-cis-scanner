{
  "milestone": "4.1 Configure Uncomplicated Firewall",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 4.1 Configure Uncomplicated Firewall",
  "controls": [
    {
      "id": "4.1.1",
      "title": "Ensure ufw is installed",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "Package",
      "package_name": "ufw",
      "should_be_installed": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "4.1.2",
      "title": "Ensure ufw service is configured",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "UFWStatus",
      "expected_status": "active",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.2",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "4.1.3",
      "title": "Ensure ufw incoming default is configured",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "UFWDefaultPolicy",
      "expected_policies": {
        "incoming": "deny"
      },
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.3",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "4.1.4",
      "title": "Ensure ufw outgoing default is configured",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "UFWDefaultPolicy",
      "expected_policies": {
        "outgoing": "allow"
      },
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.4",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "4.1.5",
      "title": "Ensure ufw routed default is configured",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "UFWDefaultPolicy",
      "expected_policies": {
        "routed": "deny"
      },
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.5",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "4.1.6",
      "title": "Ensure ufw loopback traffic is configured",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "UFWLoopback",
      "expected_rules": [
        "allow in on lo",
        "allow out on lo",
        "deny in from 127.0.0.0/8",
        "deny in from ::1"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.6",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "4.1.7",
      "title": "Ensure ufw firewall rules exist for all open ports",
      "section": "Host Based Firewall",
      "profile": "Level1",
      "type": "UFWOpenPorts",
      "check_open_ports": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "4.1.7",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    }
  ]
}