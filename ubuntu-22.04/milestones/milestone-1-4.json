{
  "milestone": "1.5 Process Hardening & 1.6 Warning Banners & 1.7 GNOME Display Manager",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Sections 1.5, 1.6, 1.7",
  "controls": [
    {
      "id": "1.5.1",
      "title": "Ensure randomize_va_space is configured",
      "section": "Initial Setup",
      "description": "Set the system flag to force randomized virtual memory region placement.",
      "rationale": "Randomly placing virtual memory regions will make it harder to write memory page exploits as the memory placement will be consistently shifting.",
      "impact": "Some applications may not work properly with ASLR enabled. Check with your application vendor to determine if your application is compatible with ASLR.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: kernel.randomize_va_space = 2 and run the following command to set the active kernel parameter: sysctl -w kernel.randomize_va_space=2",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "kernel.randomize_va_space",
      "expected_value": "2"
    },
    {
      "id": "1.5.2",
      "title": "Ensure ptrace_scope is configured",
      "section": "Initial Setup",
      "description": "The ptrace() system call allows a parent process to observe and control the execution of another process.",
      "rationale": "Restricting the use of ptrace to only root will help mitigate potential privilege escalation weaknesses. It will not prevent root users from exploiting privilege escalation flaws, and it will not prevent users from exploiting privilege escalation flaws via other methods.",
      "impact": "Some applications may not work properly with ptrace restrictions enabled. Check with your application vendor to determine if your application is compatible with ptrace restrictions.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: kernel.yama.ptrace_scope = 1 and run the following command to set the active kernel parameter: sysctl -w kernel.yama.ptrace_scope=1",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "kernel.yama.ptrace_scope",
      "expected_value": "1"
    },
    {
      "id": "1.5.3",
      "title": "Ensure suid_dumpable is configured",
      "section": "Initial Setup",
      "description": "This setting controls how the kernel handles core dumps for setuid or otherwise protected/tainted binaries.",
      "rationale": "Setting a hard limit on core dumps prevents users from overriding the soft variable. If core dumps are required, consider setting limits for user groups (see limits.conf(5)). In addition, setting the fs.suid_dumpable variable to 0 will prevent setuid programs from dumping core.",
      "impact": "Setting this value may interfere with troubleshooting efforts if core dumps are needed for debugging purposes.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: fs.suid_dumpable = 0 and run the following command to set the active kernel parameter: sysctl -w fs.suid_dumpable=0",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "fs.suid_dumpable",
      "expected_value": "0"
    },
    {
      "id": "1.5.4",
      "title": "Ensure core file size is configured",
      "section": "Initial Setup",
      "description": "A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean confidential information from a core file.",
      "rationale": "Setting a hard limit on core dumps prevents users from overriding the soft variable. If core dumps are required, consider setting limits for user groups (see limits.conf(5)).",
      "impact": "If core dumps are required by an application for troubleshooting or debugging purposes, consider implementing a hard limit rather than disabling core dumps entirely.",
      "remediation": "Add the following line to /etc/security/limits.conf or a /etc/security/limits.d/* file: * hard core 0. Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: fs.suid_dumpable = 0",
      "profile": "Level1",
      "type": "CoreDumpRestriction",
      "expected_setting": "* hard core 0",
      "limits_files": ["/etc/security/limits.conf", "/etc/security/limits.d/*"]
    },
    {
      "id": "1.5.5",
      "title": "Ensure prelink is not installed",
      "section": "Initial Setup",
      "description": "prelink is a program that modifies ELF shared libraries and ELF dynamically linked binaries in such a way that the time needed for the dynamic linker to perform relocations at startup significantly decreases.",
      "rationale": "The prelinking feature can interfere with the operation of AIDE, because it changes binaries. Prelinking can also increase the vulnerability of the system if a malicious user is able to compromise a common library such as libc.",
      "impact": "The system will not benefit from prelinking optimizations.",
      "remediation": "Run the following command to restore binaries to normal: prelink -ua. Run the following command to uninstall prelink: apt purge prelink",
      "profile": "Level1",
      "type": "Package",
      "package_name": "prelink",
      "should_be_installed": false
    },
    {
      "id": "1.5.6",
      "title": "Ensure Automatic Error Reporting is configured",
      "section": "Initial Setup",
      "description": "Apport collects potentially sensitive data, such as core dumps, stack traces, and log files. They can contain passwords, credit card numbers, serial numbers, and other private material.",
      "rationale": "Privacy and security concerns related to crash dumps and error reporting should be evaluated according to site policy before enabling automatic error reporting.",
      "impact": "Disabling automatic error reporting will prevent the system from automatically reporting crashes and errors to Ubuntu developers.",
      "remediation": "Edit /etc/default/apport and set enabled=0. Run the following commands to disable apport: systemctl stop apport.service, systemctl --now disable apport.service",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/default/apport",
      "pattern": "enabled=0",
      "expected_match": true
    },
    {
      "id": "1.6.1",
      "title": "Ensure /etc/motd is configured",
      "section": "Initial Setup",
      "description": "The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.",
      "rationale": "Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place.",
      "impact": "Consult with your organization's legal counsel for the appropriate text for your specific organization.",
      "remediation": "Edit the /etc/motd file with the appropriate contents according to your site policy, remove any instances of \\m, \\r, \\s, \\v or references to the OS platform",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "1.6.2",
      "title": "Ensure /etc/issue is configured",
      "section": "Initial Setup",
      "description": "The contents of the /etc/issue file are displayed to users prior to login for local terminals.",
      "rationale": "Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place.",
      "impact": "Consult with your organization's legal counsel for the appropriate text for your specific organization.",
      "remediation": "Edit the /etc/issue file with the appropriate contents according to your site policy, remove any instances of \\m, \\r, \\s, \\v or references to the OS platform",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "1.6.3",
      "title": "Ensure /etc/issue.net is configured",
      "section": "Initial Setup",
      "description": "The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services.",
      "rationale": "Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place.",
      "impact": "Consult with your organization's legal counsel for the appropriate text for your specific organization.",
      "remediation": "Edit the /etc/issue.net file with the appropriate contents according to your site policy, remove any instances of \\m, \\r, \\s, \\v or references to the OS platform",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "1.6.4",
      "title": "Ensure access to /etc/motd is configured",
      "section": "Initial Setup",
      "description": "The /etc/motd file contains the message of the day for authenticated users.",
      "rationale": "If the /etc/motd file does not have the correct ownership it could be modified by unauthorized users with incorrect information.",
      "impact": "Setting the permissions restricts the ability to modify the /etc/motd file to root users only.",
      "remediation": "Run the following commands to set permissions on /etc/motd: chown root:root /etc/motd, chmod u-x,go-wx /etc/motd",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/motd",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "1.6.5",
      "title": "Ensure access to /etc/issue is configured",
      "section": "Initial Setup",
      "description": "The /etc/issue file contains the system issue banner for local users.",
      "rationale": "If the /etc/issue file does not have the correct ownership it could be modified by unauthorized users with incorrect information.",
      "impact": "Setting the permissions restricts the ability to modify the /etc/issue file to root users only.",
      "remediation": "Run the following commands to set permissions on /etc/issue: chown root:root /etc/issue, chmod u-x,go-wx /etc/issue",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/issue",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "1.6.6",
      "title": "Ensure access to /etc/issue.net is configured",
      "section": "Initial Setup",
      "description": "The /etc/issue.net file contains the system issue banner for remote users.",
      "rationale": "If the /etc/issue.net file does not have the correct ownership it could be modified by unauthorized users with incorrect information.",
      "impact": "Setting the permissions restricts the ability to modify the /etc/issue.net file to root users only.",
      "remediation": "Run the following commands to set permissions on /etc/issue.net: chown root:root /etc/issue.net, chmod u-x,go-wx /etc/issue.net",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/issue.net",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "1.7.1",
      "title": "Ensure GDM is removed",
      "section": "Initial Setup",
      "description": "The GNOME Display Manager (GDM) is a program that manages graphical display servers and handles graphical user logins.",
      "rationale": "Unless your organization specifically requires graphical login, remove it to reduce the potential attack surface.",
      "impact": "Removing the GNOME Display Manager will prevent graphical logins to the system.",
      "remediation": "Run the following command to remove gdm3: apt purge gdm3",
      "profile": "Level1",
      "type": "Package",
      "package_name": "gdm3",
      "should_be_installed": false
    },
    {
      "id": "1.7.2",
      "title": "Ensure GDM login banner is configured",
      "section": "Initial Setup",
      "description": "GDM is the GNOME Display Manager which handles graphical login for GNOME based systems.",
      "rationale": "Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place.",
      "impact": "Not all GDM versions support login banners. Consult GDM documentation for your specific version.",
      "remediation": "Create the /etc/dconf/profile/gdm file with appropriate banner text. Create or edit the file /etc/dconf/db/gdm.d/01-banner-message",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "1.7.3",
      "title": "Ensure GDM disable-user-list option is enabled",
      "section": "Initial Setup",
      "description": "GDM can provide a list of users so users don't have to type their username manually. This setting can be disabled.",
      "rationale": "Leaving the user list enabled is a security risk since it allows for enumeration of users on the system.",
      "impact": "Users will have to manually type their username when logging in.",
      "remediation": "Create or edit the file /etc/dconf/db/gdm.d/00-login-screen and add: [org/gnome/login-screen] disable-user-list=true",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "1.7.4",
      "title": "Ensure GDM screen locks when the user is idle",
      "section": "Initial Setup",
      "description": "Idle time-outs are a method of preserving battery life in mobile devices, and security in all devices.",
      "rationale": "Setting an idle timeout value for the screen ensures that it will be locked after the specified number of seconds of inactivity. This protects the system from unauthorized access.",
      "impact": "Screen locking will activate after the configured idle time.",
      "remediation": "Create or edit the file /etc/dconf/db/local.d/00-screensaver and add appropriate idle timeout settings",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "1.7.5",
      "title": "Ensure GDM screen locks cannot be overridden",
      "section": "Initial Setup",
      "description": "GNOME desktop environments have the ability to set screen lock settings.",
      "rationale": "Ensuring that users cannot override the screen lock settings will prevent users from disabling the screen lock.",
      "impact": "Users will not be able to override screen lock settings.",
      "remediation": "Create or edit the file /etc/dconf/db/local.d/locks/00-screensaver and add appropriate lock settings",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "1.7.6",
      "title": "Ensure GDM automatic mounting of removable media is disabled",
      "section": "Initial Setup",
      "description": "By default, GNOME automatically mounts removable media when inserted.",
      "rationale": "With automounting enabled anyone with physical access could attach a USB drive or disc and have its contents available in system even if they lacked permissions to mount it themselves.",
      "impact": "Removable media will not be automatically mounted when inserted.",
      "remediation": "Create or edit the file /etc/dconf/db/local.d/00-media-automount and add: [org/gnome/desktop/media-handling] automount=false automount-open=false",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "1.7.7",
      "title": "Ensure GDM disabling automatic mounting of removable media is not overridden",
      "section": "Initial Setup",
      "description": "GNOME desktop environments have the ability to set automount settings.",
      "rationale": "Ensuring that users cannot override the automount settings will prevent users from enabling automount.",
      "impact": "Users will not be able to override automount settings.",
      "remediation": "Create or edit the file /etc/dconf/db/local.d/locks/00-media-automount and add appropriate lock settings",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "1.7.8",
      "title": "Ensure GDM autorun-never is enabled",
      "section": "Initial Setup",
      "description": "The autorun-never setting prevents automatic running of programs when removable media is inserted.",
      "rationale": "Disabling autorun will prevent the automatic execution of programs on removable media that could contain malicious code.",
      "impact": "Programs on removable media will not automatically execute when the media is inserted.",
      "remediation": "Create or edit the file /etc/dconf/db/local.d/00-media-autorun and add: [org/gnome/desktop/media-handling] autorun-never=true",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "1.7.9",
      "title": "Ensure GDM autorun-never is not overridden",
      "section": "Initial Setup",
      "description": "GNOME desktop environments have the ability to set autorun settings.",
      "rationale": "Ensuring that users cannot override the autorun settings will prevent users from enabling autorun.",
      "impact": "Users will not be able to override autorun settings.",
      "remediation": "Create or edit the file /etc/dconf/db/local.d/locks/00-media-autorun and add appropriate lock settings",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "1.7.10",
      "title": "Ensure XDMCP is not enabled",
      "section": "Initial Setup",
      "description": "X Display Manager Control Protocol (XDMCP) is designed to provide authenticated access to display management services for remote displays.",
      "rationale": "XDMCP is inherently insecure. XDMCP is not a secure protocol and traffic is not encrypted. If XDMCP is enabled, anyone who can access the network can eavesdrop on the session and steal credentials.",
      "impact": "Disabling XDMCP will prevent remote graphical logins.",
      "remediation": "Edit the file /etc/gdm3/custom.conf and remove any lines containing Enable=true in the [xdmcp] section",
      "profile": "Level1",
      "type": "Manual"
    },
    {
      "id": "1.7.11",
      "title": "Ensure Xwayland is configured",
      "section": "Initial Setup",
      "description": "Xwayland provides an X11 compatibility layer for Wayland compositors.",
      "rationale": "Disabling Xwayland will improve security by reducing the attack surface, but may break compatibility with some applications that require X11.",
      "impact": "Some applications that require X11 may not function properly if Xwayland is disabled.",
      "remediation": "Edit the file /etc/gdm3/custom.conf and add WaylandEnable=false in the [daemon] section to disable Wayland, or configure Xwayland appropriately",
      "profile": "Level2",
      "type": "Manual"
    }
  ]
}