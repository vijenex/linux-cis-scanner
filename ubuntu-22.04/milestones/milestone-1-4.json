{
  "milestone": "1.5 Process Hardening & 1.6 Warning Banners & 1.7 GNOME Display Manager",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Sections 1.5, 1.6, 1.7",
  "controls": [
    {
      "id": "1.5.1",
      "title": "Ensure randomize_va_space is configured",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "kernel.randomize_va_space",
      "expected_value": "2",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.5.1",
      "description": "Address space layout randomization (ASLR) is an exploit mitigation technique which randomly arranges the address space of key data areas of a process.",
      "remediation": "1. Review all files ending in .conf in the /etc/sysctl.d directory and comment out or remove all kernel.randomize_va_space lines that are not kernel.randomize_va_spacee=2 .\nExample script:\n#!/usr/bin/env bash l_option=\"kernel.randomize_va_space\" l_grep=\"$l_option//./ \\\\.\" l_value=\"2\" while IFS= read -r -d $'\\0' l_file; do grep -Poi '*'\"$l_option\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*kernel.yama.ptrace_scope *=/s/^/# /' \"$l_file\" done < <(find /etc/sysctl.d/ -type f -name '*.conf' -print0) 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nkernel.randomize_va_space = 2 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"kernel.randomize_va_space = 2\" >> /etc/sysctl.d/60 - kernel_sysctl.conf 3. Run the following command to load all system configuration filles:\n# sysctl --system"
    },
    {
      "id": "1.5.2",
      "title": "Ensure ptrace_scope is configured",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "kernel.yama.ptrace_scope",
      "expected_value": "1",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.5.2",
      "description": "The ptrace() system call provides a means by which one process (the \"tracer\") may observe and control the execution of another process (the \"tracee\"), and examine and change the tracee's memory and registers.\nThe sysctl settings (writable only with CAP_SYS_PTRACE) are:\n• 0 - classic ptrace permissions: a process can PTRACE_ATTACH to any other process running under the same uid, as long as it is dumpable (i.e. did not transition uids, start privileged, or have called prctl(PR_SET_DUMPABLE...) already). Similarly, PTRACE_TRAC EME is unchanged.\n• 1 - restricted ptrace: a process must have a predefined relationship with the inferior it wants to call PTRACE_ATTACH on. By default, this relationship is that of only its descendants when the above classic criteria is also met. To change the relationship, an inferior can call prctl(PR_SET_PTRACER, debugger, ...) to declare an allowed debugger PID to call PTRACE_ATTACH on the inferior.\nUsing PTRACE_TRACEME is unchanged.\n• 2 - admin -only attach: only processes with CAP_SYS_PTRACE may use ptrace with PTRACE_ATTACH, or through children calling PTRACE_TRACEME.\n• 3 - no attach: no processes may use ptrace with PTRACE_ATTACH nor via PTRACE_TRACEME. Once set, this sysctl value cannot be changed.",
      "remediation": "1. Review all files ending in .conf in the /etc/sysctl.d directory and comment out or remove all kernel.yama.ptrace_scope lines that are not kernel.yama.ptrace_scope=1 , kernel.yama.ptrace_scope=2 , or kernel.yama.ptrace_scope=3 .\nExample script:\n#!/usr/bin/env bash l_option=\"kernel.yama.ptrace_scope\" l_grep=\"$l_option//./ \\\\.\" l_value=\"(1|2|3)\" while IFS= read -r -d $'\\0' l_file; do grep -Poi '*'\"$l_option\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*kernel.yama.ptrace_scope *=/s/^/# /' \"$l_file\" done < <(find /etc/sysctl.d/ -type f -name '*.conf' -print0) 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nkernel.yama.ptrace_scope = 1 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"kernel.yama.ptrace_scope = 1\" >> /etc/sysctl.d/60 - kernel_sysctl.conf Note: The example uses kernel.yama.ptrace_scope = 1 but value may be set to 1, 2, or 3 3. Run the following command to load all system configuration filles:\n# sysctl --system"
    },
    {
      "id": "1.5.3",
      "title": "Ensure suid_dumpable is configured",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "fs.suid_dumpable",
      "expected_value": "0",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.5.3",
      "description": "fs.suid_dumpable governs whether a privileged process (with the setuid bit) can generate a core dump, regardless of other configurations.\nfs.suid_dumpable values:\n• 0 (default) - Any process that has changed privilege levels (like SUID programs) or is execute -only will not dump core.\n• 1 (debug) - All processes dump core if possible. The core dump is owned by the current user and security is not applied. This is primarily intended for system debugging.\n• 2 (suidsafe) - Any binary that normally wouldn't be dumped is dumped, but only if the core_pattern is set to a pipe handler or a fully qualified path. This mode is suitable for administrators debugging in a production environment.",
      "remediation": "1. Review all files ending in .conf in the /etc/sysctl.d directory and comment out or remove all fs.suid_dumpable lines that are not fs.suid_dumpable=0 .\nExample script:\n#!/usr/bin/env bash l_option=\"fs.suid_dumpable\" l_grep=\"$l_option//./ \\\\.\" l_value=\"0\" while IFS= read -r -d $'\\0' l_file; do grep -Poi '*'\"$l_option\"' *=*\\H+' \"$l_file\" \\ | grep -Pivq '^*'\"$l_grep\"' *=*'\"$l_value\"' ' && \\ sed -ri '/^*kernel.yama.ptrace_scope *=/s/^/# /' \"$l_file\" done < <(find /etc/sysctl.d/ -type f -name '*.conf' -print0) 2. Create or edit a file in the /etc/sysctl.d/ directory ending in .conf and edit or\nadd the following line:\nfs.suid_dumpable = 0 Example:\n# [ ! -d \"/etc/sysctl.d/\" ] && mkdir -p /etc/sysctl.d/\n# printf '%s ' \"\" \"fs.suid_dumpable = 0\" >> /etc/sysctl.d/60 - kernel_sysctl.conf 3. Run the following command to load all system configuration filles:\n# sysctl --system Internal Only - General"
    },
    {
      "id": "1.5.4",
      "title": "Ensure core file size is configured",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "CoreDumpRestriction",
      "expected_setting": "* hard core 0",
      "limits_files": [
        "/etc/security/limits.conf",
        "/etc/security/limits.d/*"
      ],
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.5.4",
      "description": "core - limits the core file size hard - for enforcing hard resource limits. These limits are set by the superuser and enforced by the Kernel. The user cannot raise their requirement of system resources above such values.",
      "remediation": "1. Run the following command to comment out any entries that include a hard value for core greater than 0 in /etc/security/limits.conf and and file in the /etc/security/limits.d/ directory.\nExample:\n# sed -ri '/^*[#]++hard+core+([1-9][0-9]*)/s/^/# /' /etc/security/limits.conf /etc/security/limits.d/* 2. Create or edit a file in /etc/security/limits.d/ and add the following line:\n* hard core 0 Example:\n# printf '%s ' \"\" \"* hard core 0\" >> /etc/security/limits.d/60 -limits.conf Internal Only - General"
    },
    {
      "id": "1.5.5",
      "title": "Ensure prelink is not installed",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "Package",
      "package_name": "prelink",
      "should_be_installed": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.5.5",
      "description": "prelink is a program that modifies ELF shared libraries and ELF dynamically linked binaries in such a way that the time needed for the dynamic linker to perform relocations at startup significantly decreases.",
      "remediation": "Run the following command to restore binaries to normal:\n# prelink -ua Uninstall prelink using the appropriate package manager or manual installation:\n# apt purge prelink"
    },
    {
      "id": "1.5.6",
      "title": "Ensure Automatic Error Reporting is configured",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/default/apport",
      "pattern": "enabled=0",
      "expected_match": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.5.6",
      "description": "The Apport Error Reporting Service automatically generates crash reports for debugging",
      "remediation": "Edit /etc/default/apport and add or edit the enabled parameter to equal 0:\nenabled=0\nRun the following commands to stop and mask the apport service\n# systemctl stop apport.service\n# systemctl mask apport.service - OR -\nRun the following command to remove the apport package:\n# apt purge apport"
    },
    {
      "id": "1.6.1",
      "title": "Ensure /etc/motd is configured",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FileContent",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.6.1",
      "description": "The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.\nUnix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: - machine architecture - operating system release - operating system name - operating system version",
      "remediation": "Edit the file found in /etc/motd.d/* with the appropriate contents according to your site policy, remove any instances of , , , or references to the OS platform - OR - - IF - the motd is not used, this file can be removed.\nRun the following command to remove the motd file:\n# rm /etc/motd\nRun the following script and review and/or update all returned files' contents to:\n• Remove all system information ( , ; , ) • Remove any refence to the operating system • Ensure contents follow local site policy\n#!/usr/bin/env bash a_files=() for l_file in /etc/motd,.d/*; do if grep -Psqi -- \"(\\\\|\\\\|\\\\|\\\\|$(grep ^ID= /etc/os -release | cut -d= -f2 | sed -e 's/\"//g') )\" \"$l_file\"; then echo -e \"- File: \\\"$l_file \\\" includes system information. Edit this file to remove these entries\" else a_files+=(\"$l_file\") fi done if [ \"$#a_files[@]\" -gt 0 ]; then echo -e \"- ** Please review the following files and verify their contents follow local site policy ** \" printf '%s ' \"$a_files[@]\" fi",
      "automated": true,
      "file_path": "/etc/motd",
      "pattern": "(Linux|Ubuntu|kernel|release|version|\\d+\\.\\d+)",
      "expected_result": "not_found"
    },
    {
      "id": "1.6.2",
      "title": "Ensure /etc/issue is configured",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FileContent",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.6.2",
      "description": "The contents of the /etc/issue file are displayed to users prior to login for local terminals.\nUnix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: - machine architecture - operating system release - operating system name - operating system version - or the operating system's name",
      "remediation": "Edit the /etc/issue file with the appropriate contents according to your site policy,\nremove any instances of , , , or references to the OS platform Example:\n# echo \"Authorized users only. All activity may be monitored and reported.\" > /etc/issue",
      "automated": true,
      "file_path": "/etc/issue",
      "pattern": "(Linux|Ubuntu|kernel|release|version|\\d+\\.\\d+)",
      "expected_result": "not_found"
    },
    {
      "id": "1.6.3",
      "title": "Ensure /etc/issue.net is configured",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FileContent",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.6.3",
      "description": "The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services.\nUnix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: - machine architecture - operating system release - operating system name - operating system version",
      "remediation": "Edit the /etc/issue.net file with the appropriate contents according to your site policy,\nremove any instances of , , , or references to the OS platform Example:\n# echo \"Authorized users only. All activity may be monitored and reported.\" > /etc/issue.net",
      "automated": true,
      "file_path": "/etc/issue.net",
      "pattern": "(Linux|Ubuntu|kernel|release|version|\\d+\\.\\d+)",
      "expected_result": "not_found"
    },
    {
      "id": "1.6.4",
      "title": "Ensure access to /etc/motd is configured",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/motd",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.6.4",
      "description": "The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.",
      "remediation": "Run the following commands to set mode, owner, and group on /etc/motd :\n# chown root:root $(readlink -e /etc/motd)\n# chmod u -x,go-wx $(readlink -e /etc/motd) - OR -\nRun the following command to remove the /etc/motd file:\n# rm /etc/motd"
    },
    {
      "id": "1.6.5",
      "title": "Ensure access to /etc/issue is configured",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/issue",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.6.5",
      "description": "The contents of the /etc/issue file are displayed to users prior to login for local terminals.",
      "remediation": "Run the following commands to set mode, owner, and group on /etc/issue :\n# chown root:root $(readlink -e /etc/issue)\n# chmod u -x,go-wx $(readlink -e /etc/issue)"
    },
    {
      "id": "1.6.6",
      "title": "Ensure access to /etc/issue.net is configured",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/etc/issue.net",
      "expected_mode": "644",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.6.6",
      "description": "The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services.",
      "remediation": "Run the following commands to set mode, owner, and group on /etc/issue.net :\n# chown root:root $(readlink -e /etc/issue.net)\n# chmod u -x,go-wx $(readlink -e /etc/issue.net)"
    },
    {
      "id": "1.7.1",
      "title": "Ensure GDM is removed",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "Package",
      "package_name": "gdm3",
      "should_be_installed": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.7.1",
      "description": "The GNOME Display Manager (GDM) is a program that manages graphical display servers and handles graphical user logins.",
      "remediation": "Run the following commands to uninstall gdm3 and remove unused dependencies:\n# apt purge gdm3\n# apt autoremove gdm3"
    },
    {
      "id": "1.7.2",
      "title": "Ensure GDM login banner is configured",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FileContent",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.7.2",
      "description": "GDM is the GNOME Display Manager which handles graphical login for GNOME based systems.",
      "remediation": "- IF - A user profile is already created run the following commands to set and enable the text banner message on the login screen:\n# gsettings set org.gnome.login -screen banner -message-text 'Authorized uses only. All activity may be monitored and reported'\n# gsettings set org.gnome.login -screen banner -message-enable true Note:\n• banner-message-text may be set in accordance with local site policy • gsettings commands in this section MUST be done from a command window on a graphical desktop or an error will be returned.\n• The system must be restarted after all gsettings configurations have been set in order for CIS -CAT Assessor to appropriately assess.\n- OR/IF - A user profile does not exist:\n1. Create or edit the gdm profile in the /etc/dconf/profile/gdm with the following lines:\nuser-db:user system-db:gdm file-db:/usr/share/gdm/greeter -dconf-defaults Note: gdm is the name of a dconf database.\n2. Create a gdm keyfile for machine -wide settings in /etc/dconf/db/gdm.d/01 - banner-message :\n[org/gnome/login -screen] banner-message-enable=true banner-message-text='Type the banner message here.' 3. Update the system databases\n# dconf update Note:\n• Users must log out and back in again before the system -wide settings take effect.\n• There is no character limit for the banner message. gnome -shell autodetects longer stretches of text and enters two column mode.\n• The banner message cannot be read from an external file.",
      "automated": true,
      "file_path": "/etc/dconf/db/gdm.d/01-banner-message /etc/dconf/profile/gdm",
      "pattern": "banner-message-enable\\s*=\\s*true",
      "expected_result": "found"
    },
    {
      "id": "1.7.3",
      "title": "Ensure GDM disable-user-list option is enabled",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FileContent",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.7.3",
      "description": "GDM is the GNOME Display Manager which handles graphical login for GNOME based systems.\nThe disable-user-list option controls if a list of users is displayed on the login screen",
      "remediation": "- IF - A user profile exists run the following command to enable the disable-user- list :\n# gsettings set org.gnome.login -screen disable -user-list true Note:\n• gsettings commands in this section MUST be done from a command window on a graphical desktop or an error will be returned.\n• The system must be restarted after all gsettings configurations have been set in order for CIS -CAT Assessor to appropriately assess.\n- OR/IF - A user profile does not exist:\n1. Create or edit the gdm profile in /etc/dconf/profile/gdm with the following lines:\nuser-db:user system-db:gdm file-db:/usr/share/gdm/greeter -dconf-defaults Note: gdm is the name of a dconf database.\n2. Create a gdm keyfile for machine -wide settings in /etc/dconf/db/gdm.d/00 - login-screen :\n[org/gnome/login -screen]\n# Do not show the user list disable-user-list=true 3. Update the system databases:\n# dconf update Note: When the user profile is created or changed, the user will need to log out and log in again before the changes will be applied.",
      "automated": true,
      "file_path": "/etc/dconf/db/gdm.d/00-login-screen",
      "pattern": "disable-user-list\\s*=\\s*true",
      "expected_result": "found"
    },
    {
      "id": "1.7.4",
      "title": "Ensure GDM screen locks when the user is idle",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FileContent",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.7.4",
      "description": "GNOME Desktop Manager can make the screen lock automatically whenever the user is idle for some amount of time.",
      "remediation": "- IF - A user profile is already created run the following commands to enable screen locks when the user is idle:\n# gsettings set org.gnome.desktop.screensaver lock -delay 5\n# gsettings set org.gnome.desktop.session idle -delay 900\n# gsettings set org.gnome.desktop.screensaver lock -enabled true Note:\n• gsettings commands in this section MUST be done from a command window on a graphical desktop or an error will be returned.\n• The system must be restarted after all gsettings configurations have been set in order for CIS -CAT Assessor to appropriately assess.\n- OR/IF - A user profile does not exist:\n1. Create or edit the user profile in the /etc/dconf/profile/ and verify it includes the following:\nuser-db:user system-db:NAME_OF_DCONF_DATABASE Note: local is the name of a dconf database used in the examples.\n2. Create the directory /etc/dconf/db/local.d/ if it doesn't already exist:\n3. Create the key file /etc/dconf/db/local.d/00 -screensaver to provide information for the local database:\nExample key file:\n# Specify the dconf path [org/gnome/desktop/session]\n# Number of seconds of inactivity before the screen goes blank\n# Set to 0 seconds if you want to deactivate the screensaver.\nidle-delay=uint32 180\n# Specify the dconf path [org/gnome/desktop/screensaver]\n# Number of seconds after the screen is blank before locking the screen lock-delay=uint32 0\n# Ensure screen locks after inactivity lock-enabled=true Note: You must include the uint32 along with the integer key values as shown.\n4. Run the following command to update the system databases:\n# dconf update Internal Only - General 5. Users must log out and back in again before the system -wide settings take effect.",
      "automated": true,
      "file_path": "/etc/dconf/db/local.d/00-screensaver",
      "pattern": "(idle-delay|lock-delay)",
      "expected_result": "found"
    },
    {
      "id": "1.7.5",
      "title": "Ensure GDM screen locks cannot be overridden",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FileContent",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.7.5",
      "description": "GNOME Desktop Manager can lock down specific settings by using the lockdown mode in dconf to prevent users from changing specific settings.\nTo lock down a dconf key or subpath, create a locks subdirectory in the keyfile directory.\nThe files inside this directory contain a list of keys or subpaths to lock. Just as with the keyfiles, you may add any number of files to this directory.",
      "remediation": "1. To prevent the user from overriding these settings, create the file /etc/dconf/db/local.d/locks/00 -screensaver with the following content:\n# Lock desktop screensaver settings /org/gnome/desktop/session/idle -delay /org/gnome/desktop/screensaver/lock -delay /org/gnome/desktop/screensaver/lock -enabled 2. Update the system databases:\n# dconf update Note:\n• A user profile must exist in order to apply locks. If a user profile does not exist review the remediation steps in the previous recommendation.\n• Users must log out and back in again before the system -wide settings take effect.",
      "automated": true,
      "file_path": "/etc/dconf/db/local.d/locks/00-screensaver",
      "pattern": "(idle-delay|lock-delay)",
      "expected_result": "found"
    },
    {
      "id": "1.7.6",
      "title": "Ensure GDM automatic mounting of removable media is disabled",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FileContent",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.7.6",
      "description": "By default GNOME automatically mounts removable media when inserted as a convenience to the user.",
      "remediation": "- IF - A user profile exists run the following commands to ensure automatic mounting is disabled:\n# gsettings set org.gnome.desktop.media -handling automount false\n# gsettings set org.gnome.desktop.media -handling automount -open false Note:\n• gsettings commands in this section MUST be done from a command window on a graphical desktop or an error will be returned.\n• The system must be restarted after all gsettings configurations have been set in order for CIS -CAT Assessor to appropriately assess.\n- OR/IF - A user profile does not exist:\n1. Create a file /etc/dconf/db/local.d/00 -media-automount with following content:\n[org/gnome/desktop/media -handling] automount=false automount -open=false 2. After creating the file, apply the changes using below command :\n# dconf update Note: Users must log out and back in again before the system -wide settings take effect.",
      "automated": true,
      "file_path": "/etc/dconf/db/local.d/00-media-automount",
      "pattern": "automount\\s*=\\s*false",
      "expected_result": "found"
    },
    {
      "id": "1.7.7",
      "title": "Ensure GDM disabling automatic mounting of removable media is not overridden",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FileContent",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.7.7",
      "description": "By default GNOME automatically mounts removable media when inserted as a convenience to the user.\nBy using the lockdown mode in dconf, you can prevent users from changing specific settings. To lock down a dconf key or subpath, create a locks subdirectory in the keyfile directory. The files inside this directory contain a list of keys or subpaths to loc k. Just as with the keyfiles, you may add any number of files to this directory.",
      "remediation": "1. To prevent the user from overriding these settings, create the file /etc/dconf/db/local.d/locks/00 -media-automount with the following content:\n[org/gnome/desktop/media -handling] automount=false automount -open=false 2. Update the systems databases:\n# dconf update Note:\n• A user profile must exist in order to apply locks. If a user profile does not exist review the remediation steps in the previous recommendation.\n• Users must log out and back in again before the system -wide settings take effect.",
      "automated": true,
      "file_path": "/etc/dconf/db/local.d/locks/00-media-automount",
      "pattern": "automount",
      "expected_result": "found"
    },
    {
      "id": "1.7.8",
      "title": "Ensure GDM autorun-never is enabled",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FileContent",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.7.8",
      "description": "The autorun-never setting allows the GNOME Desktop Display Manager to disable autorun through GDM.",
      "remediation": "- IF - A user profile exist run the following command to set autorun-never to true for GDM users:\n# gsettings set org.gnome.desktop.media -handling autorun -never true Note:\n• gsettings commands in this section MUST be done from a command window on a graphical desktop or an error will be returned.\n• The system must be restarted after all gsettings configurations have been set in order for CIS -CAT Assessor to appropriately assess.\n- OR/IF - A user profile does not exist:\n1. create the file /etc/dconf/db/local.d/locks/00 -media-autorun with the following content:\n[org/gnome/desktop/media -handling] autorun-never=true 2. Update the systems databases:\n# dconf update Note: Users must log out and back in again before the system -wide settings take effect.",
      "automated": true,
      "file_path": "/etc/dconf/db/local.d/00-media-autorun",
      "pattern": "autorun-never\\s*=\\s*true",
      "expected_result": "found"
    },
    {
      "id": "1.7.9",
      "title": "Ensure GDM autorun-never is not overridden",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FileContent",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.7.9",
      "description": "The autorun -never setting allows the GNOME Desktop Display Manager to disable autorun through GDM.\nBy using the lockdown mode in dconf, you can prevent users from changing specific settings.\nTo lock down a dconf key or subpath, create a locks subdirectory in the keyfile directory.\nThe files inside this directory contain a list of keys or subpaths to lock. Just as with the keyfiles, you may add any number of files to this directory.",
      "remediation": "1. To prevent the user from overriding these settings, create the file /etc/dconf/db/local.d/locks/00 -media-autorun with the following content:\n[org/gnome/desktop/media -handling] autorun-never=true 2. Update the systems databases:\n# dconf update Note:\n• A user profile must exist in order to apply locks. If a user profile does not exist review the remediation steps in the previous recommendation.\n• Users must log out and back in again before the system -wide settings take effect.\nInternal Only - General",
      "automated": true,
      "file_path": "/etc/dconf/db/local.d/locks/00-media-autorun",
      "pattern": "autorun-never",
      "expected_result": "found"
    },
    {
      "id": "1.7.10",
      "title": "Ensure XDMCP is not enabled",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "FileContent",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.7.10",
      "description": "X Display Manager Control Protocol (XDMCP) is designed to provide authenticated access to display management services for remote displays",
      "remediation": "Edit all files returned by the audit and remove or comment out the Enable=true line in the [xdmcp] block:\nExample file:\n# GDM configuration storage\n#\n# See /usr/share/gdm/gdm.schemas for a list of available options.\n[daemon]\n# Uncomment the line below to force the login screen to use Xorg\n#WaylandEnable=false\n# Enabling automatic login\n# AutomaticLoginEnable = true\n# AutomaticLogin = user1\n# Enabling timed login\n# TimedLoginEnable = true\n# TimedLogin = user1\n# TimedLoginDelay = 10 [security] [xdmcp]\n# Enable=true < - **This line should be removed or commented out** [chooser] [debug]\n# Uncomment the line below to turn on debugging\n# More verbose logs\n# Additionally lets the X server dump core if it crashes\n# Enable=true",
      "automated": true,
      "file_path": "/etc/gdm3/custom.conf",
      "pattern": "Enable\\s*=\\s*false",
      "expected_result": "found"
    },
    {
      "id": "1.7.11",
      "title": "Ensure Xwayland is configured",
      "section": "Initial Setup",
      "profile": "Level2",
      "type": "FileContent",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.7.11",
      "description": "Xwayland is a compatibility layer that allows legacy X11 applications to run within a Wayland environment. It's effectively an X server that runs as a Wayland client, enabling existing X11 software to be displayed on a Wayland compositor.",
      "remediation": "Edit the file /etc/gdm/custom.conf and uncomment or add the following line in the [daemon] block:\nWaylandEnable=false Example:\n# GDM configuration storage [daemon] WaylandEnable=false [security] [xdmcp] [chooser] [debug]\n# Uncomment the line below to turn on debugging\n#Enable=true",
      "automated": true,
      "file_path": "/etc/gdm3/custom.conf",
      "pattern": "WaylandEnable\\s*=\\s*false",
      "expected_result": "found"
    }
  ]
}