{
  "milestone": "5.4 User Accounts and Environment",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 5.4 User Accounts and Environment",
  "controls": [
    {
      "id": "5.4.1.1",
      "title": "Ensure password expiration is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/login.defs",
      "pattern": "PASS_MAX_DAYS\\s+([1-9]|[1-9][0-9]|[1-2][0-9][0-9]|3[0-5][0-9]|36[0-5])",
      "expected_match": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.4.1.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.4.1.3",
      "title": "Ensure password expiration warning days is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/login.defs",
      "pattern": "PASS_WARN_AGE\\s+([7-9]|[1-9][0-9])",
      "expected_match": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.4.1.3",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.4.1.4",
      "title": "Ensure strong password hashing algorithm is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/login.defs",
      "pattern": "ENCRYPT_METHOD\\s+SHA512",
      "expected_match": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.4.1.4",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.4.1.5",
      "title": "Ensure inactive password lock is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/default/useradd",
      "pattern": "INACTIVE=([1-2][0-9]|30)",
      "expected_match": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.4.1.5",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.4.2.1",
      "title": "Ensure root is the only UID 0 account",
      "section": "Access Control",
      "profile": "Level1",
      "type": "DuplicateUIDs",
      "passwd_file": "/etc/passwd",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.4.2.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.4.2.7",
      "title": "Ensure system accounts do not have a valid login shell",
      "section": "Access Control",
      "profile": "Level1",
      "type": "Manual",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.4.2.7",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.4.3.1",
      "title": "Ensure nologin is not listed in /etc/shells",
      "section": "Access Control",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/shells",
      "pattern": "/usr/sbin/nologin|/sbin/nologin",
      "expected_match": false,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.4.3.1",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.4.3.2",
      "title": "Ensure default user shell timeout is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/bash.bashrc",
      "pattern": "TMOUT=([1-8][0-9][0-9]|900)",
      "expected_match": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.4.3.2",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    },
    {
      "id": "5.4.3.3",
      "title": "Ensure default user umask is configured",
      "section": "Access Control",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/bash.bashrc",
      "pattern": "umask\\s+(0[0-2][0-7]|[0-2][0-7])",
      "expected_match": true,
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "5.4.3.3",
      "reference_note": "For detailed description, rationale, impact assessment, and remediation steps, please refer to the official CIS Ubuntu Linux 22.04 Benchmark document at the above URL."
    }
  ]
}