{
  "milestone": "1.1.2 Filesystem Partitions",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 1.1.2 Configure Filesystem Partitions",
  "controls": [
    {
      "id": "1.1.2.1.1",
      "title": "Ensure /tmp is tmpfs or a separate partition",
      "section": "Initial Setup",
      "description": "The /tmp directory is a world-writable directory used for temporary storage by all users and some applications.",
      "rationale": "Making /tmp its own file system allows an administrator to set the noexec option on the mount, making /tmp useless for an attacker to store executable code.",
      "impact": "Since the /tmp directory is intended to be world-writable, there is a risk of resource exhaustion if it is not bound to a separate partition.",
      "remediation": "Configure /tmp as tmpfs or create a separate partition for /tmp. Edit /etc/fstab and add or modify the /tmp entry.",
      "profile": "Level1",
      "type": "MountPoint",
      "mount_point": "/tmp",
      "expected_status": "separate_partition"
    },
    {
      "id": "1.1.2.1.2",
      "title": "Ensure nodev option set on /tmp partition",
      "section": "Initial Setup",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /tmp filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /tmp.",
      "impact": "Device files should not exist in /tmp. If they are required, they should be located elsewhere.",
      "remediation": "Edit /etc/fstab and add nodev to the fourth field (mounting options) for the /tmp partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/tmp",
      "required_option": "nodev"
    },
    {
      "id": "1.1.2.1.3",
      "title": "Ensure nosuid option set on /tmp partition",
      "section": "Initial Setup",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /tmp.",
      "impact": "Setuid executables should not exist in the /tmp directory.",
      "remediation": "Edit /etc/fstab and add nosuid to the fourth field (mounting options) for the /tmp partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/tmp",
      "required_option": "nosuid"
    },
    {
      "id": "1.1.2.1.4",
      "title": "Ensure noexec option set on /tmp partition",
      "section": "Initial Setup",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /tmp.",
      "impact": "Some legitimate software may require executable access to /tmp. Assess the software requirements before implementing this control.",
      "remediation": "Edit /etc/fstab and add noexec to the fourth field (mounting options) for the /tmp partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/tmp",
      "required_option": "noexec"
    },
    {
      "id": "1.1.2.2.1",
      "title": "Ensure /dev/shm is tmpfs or a separate partition",
      "section": "Initial Setup",
      "description": "/dev/shm is a traditional shared memory concept. One program will create a memory portion, which other processes (if permitted) can access.",
      "rationale": "Any user can upload and execute files inside the /dev/shm similar to the /tmp partition. Configuring /dev/shm to be its own file system allows an administrator to set the noexec option on the mount, making /dev/shm useless for an attacker to store executable code.",
      "impact": "Configuring /dev/shm as its own partition enables administrators to restrict its usage through mount options.",
      "remediation": "Configure /dev/shm as tmpfs. Edit /etc/fstab and add or modify the /dev/shm entry.",
      "profile": "Level1",
      "type": "MountPoint",
      "mount_point": "/dev/shm",
      "expected_status": "separate_partition"
    },
    {
      "id": "1.1.2.2.2",
      "title": "Ensure nodev option set on /dev/shm partition",
      "section": "Initial Setup",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /dev/shm filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create special devices in /dev/shm partitions.",
      "impact": "Device files should not exist in /dev/shm.",
      "remediation": "Edit /etc/fstab and add nodev to the fourth field (mounting options) for the /dev/shm partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/dev/shm",
      "required_option": "nodev"
    },
    {
      "id": "1.1.2.2.3",
      "title": "Ensure nosuid option set on /dev/shm partition",
      "section": "Initial Setup",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Setting this option on a file system prevents users from introducing privileged programs onto the system and allowing non-root users to run them.",
      "impact": "Setuid executables should not exist in /dev/shm.",
      "remediation": "Edit /etc/fstab and add nosuid to the fourth field (mounting options) for the /dev/shm partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/dev/shm",
      "required_option": "nosuid"
    },
    {
      "id": "1.1.2.2.4",
      "title": "Ensure noexec option set on /dev/shm partition",
      "section": "Initial Setup",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Setting this option on a file system prevents users from executing programs from shared memory. This deters users from introducing potentially malicious software on the system.",
      "impact": "Some legitimate software may require executable access to /dev/shm. Assess the software requirements before implementing this control.",
      "remediation": "Edit /etc/fstab and add noexec to the fourth field (mounting options) for the /dev/shm partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/dev/shm",
      "required_option": "noexec"
    },
    {
      "id": "1.1.2.3.1",
      "title": "Ensure separate partition exists for /home",
      "section": "Initial Setup",
      "description": "The /home directory is used to support disk storage needs of local users.",
      "rationale": "If the system is intended to support local users, create a separate partition for the /home directory to protect against resource exhaustion and restrict the type of files that can be stored under /home.",
      "impact": "Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for the purpose of resizing operations.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /home.",
      "profile": "Level2",
      "type": "MountPoint",
      "mount_point": "/home",
      "expected_status": "separate_partition"
    },
    {
      "id": "1.1.2.3.2",
      "title": "Ensure nodev option set on /home partition",
      "section": "Initial Setup",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the user partitions are not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices.",
      "impact": "Device files should not exist in /home.",
      "remediation": "Edit /etc/fstab and add nodev to the fourth field (mounting options) for the /home partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/home",
      "required_option": "nodev"
    },
    {
      "id": "1.1.2.3.3",
      "title": "Ensure nosuid option set on /home partition",
      "section": "Initial Setup",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Setting this option on a file system prevents users from introducing privileged programs onto the system and allowing non-root users to run them.",
      "impact": "Some legitimate applications may require setuid access. Assess the applications requirements before implementing this control.",
      "remediation": "Edit /etc/fstab and add nosuid to the fourth field (mounting options) for the /home partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/home",
      "required_option": "nosuid"
    },
    {
      "id": "1.1.2.4.1",
      "title": "Ensure separate partition exists for /var",
      "section": "Initial Setup",
      "description": "The /var directory is used by daemons and other system services to temporarily store dynamic data.",
      "rationale": "Since the /var directory may contain world-writable files and directories, there is a risk of resource exhaustion if it is not bound to a separate partition.",
      "impact": "Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for the purpose of resizing operations.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /var.",
      "profile": "Level2",
      "type": "MountPoint",
      "mount_point": "/var",
      "expected_status": "separate_partition"
    },
    {
      "id": "1.1.2.4.2",
      "title": "Ensure nodev option set on /var partition",
      "section": "Initial Setup",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /var filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /var.",
      "impact": "Device files should not exist in /var.",
      "remediation": "Edit /etc/fstab and add nodev to the fourth field (mounting options) for the /var partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var",
      "required_option": "nodev"
    },
    {
      "id": "1.1.2.4.3",
      "title": "Ensure nosuid option set on /var partition",
      "section": "Initial Setup",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /var filesystem is only intended for variable files, set this option to ensure that users cannot introduce setuid files into the system via the /var partition.",
      "impact": "Some legitimate applications may require setuid access. Assess the applications requirements before implementing this control.",
      "remediation": "Edit /etc/fstab and add nosuid to the fourth field (mounting options) for the /var partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var",
      "required_option": "nosuid"
    },
    {
      "id": "1.1.2.5.1",
      "title": "Ensure separate partition exists for /var/tmp",
      "section": "Initial Setup",
      "description": "The /var/tmp directory is a world-writable directory used for temporary storage by all users and some applications.",
      "rationale": "Since the /var/tmp directory is intended to be world-writable, there is a risk of resource exhaustion if it is not bound to a separate partition.",
      "impact": "Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for the purpose of resizing operations.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /var/tmp.",
      "profile": "Level2",
      "type": "MountPoint",
      "mount_point": "/var/tmp",
      "expected_status": "separate_partition"
    },
    {
      "id": "1.1.2.5.2",
      "title": "Ensure nodev option set on /var/tmp partition",
      "section": "Initial Setup",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /var/tmp filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /var/tmp.",
      "impact": "Device files should not exist in /var/tmp.",
      "remediation": "Edit /etc/fstab and add nodev to the fourth field (mounting options) for the /var/tmp partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/tmp",
      "required_option": "nodev"
    },
    {
      "id": "1.1.2.5.3",
      "title": "Ensure nosuid option set on /var/tmp partition",
      "section": "Initial Setup",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /var/tmp.",
      "impact": "Setuid executables should not exist in /var/tmp.",
      "remediation": "Edit /etc/fstab and add nosuid to the fourth field (mounting options) for the /var/tmp partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/tmp",
      "required_option": "nosuid"
    },
    {
      "id": "1.1.2.5.4",
      "title": "Ensure noexec option set on /var/tmp partition",
      "section": "Initial Setup",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Since the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /var/tmp.",
      "impact": "Some legitimate software may require executable access to /var/tmp. Assess the software requirements before implementing this control.",
      "remediation": "Edit /etc/fstab and add noexec to the fourth field (mounting options) for the /var/tmp partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/tmp",
      "required_option": "noexec"
    },
    {
      "id": "1.1.2.6.1",
      "title": "Ensure separate partition exists for /var/log",
      "section": "Initial Setup",
      "description": "The /var/log directory is used by system services to store log data.",
      "rationale": "There are two important reasons to ensure that system logs are stored on a separate partition: protection against resource exhaustion (since logs can grow quite large) and protection of audit data.",
      "impact": "Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for the purpose of resizing operations.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /var/log.",
      "profile": "Level2",
      "type": "MountPoint",
      "mount_point": "/var/log",
      "expected_status": "separate_partition"
    },
    {
      "id": "1.1.2.6.2",
      "title": "Ensure nodev option set on /var/log partition",
      "section": "Initial Setup",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /var/log filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /var/log.",
      "impact": "Device files should not exist in /var/log.",
      "remediation": "Edit /etc/fstab and add nodev to the fourth field (mounting options) for the /var/log partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/log",
      "required_option": "nodev"
    },
    {
      "id": "1.1.2.6.3",
      "title": "Ensure nosuid option set on /var/log partition",
      "section": "Initial Setup",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /var/log filesystem is only intended for log files, set this option to ensure that users cannot create setuid files in /var/log.",
      "impact": "Setuid executables should not exist in /var/log.",
      "remediation": "Edit /etc/fstab and add nosuid to the fourth field (mounting options) for the /var/log partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/log",
      "required_option": "nosuid"
    },
    {
      "id": "1.1.2.6.4",
      "title": "Ensure noexec option set on /var/log partition",
      "section": "Initial Setup",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Since the /var/log filesystem is only intended for log files, set this option to ensure that users cannot run executable binaries from /var/log.",
      "impact": "Executable files should not exist in /var/log.",
      "remediation": "Edit /etc/fstab and add noexec to the fourth field (mounting options) for the /var/log partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/log",
      "required_option": "noexec"
    },
    {
      "id": "1.1.2.7.1",
      "title": "Ensure separate partition exists for /var/log/audit",
      "section": "Initial Setup",
      "description": "The auditing daemon, auditd, stores log data in the /var/log/audit directory.",
      "rationale": "There are two important reasons to ensure that data gathered by auditd is stored on a separate partition: protection against resource exhaustion (since the audit.log file can grow quite large) and protection of audit data.",
      "impact": "Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for the purpose of resizing operations.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /var/log/audit.",
      "profile": "Level2",
      "type": "MountPoint",
      "mount_point": "/var/log/audit",
      "expected_status": "separate_partition"
    },
    {
      "id": "1.1.2.7.2",
      "title": "Ensure nodev option set on /var/log/audit partition",
      "section": "Initial Setup",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /var/log/audit filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /var/log/audit.",
      "impact": "Device files should not exist in /var/log/audit.",
      "remediation": "Edit /etc/fstab and add nodev to the fourth field (mounting options) for the /var/log/audit partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/log/audit",
      "required_option": "nodev"
    },
    {
      "id": "1.1.2.7.3",
      "title": "Ensure nosuid option set on /var/log/audit partition",
      "section": "Initial Setup",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /var/log/audit filesystem is only intended for audit log files, set this option to ensure that users cannot create setuid files in /var/log/audit.",
      "impact": "Setuid executables should not exist in /var/log/audit.",
      "remediation": "Edit /etc/fstab and add nosuid to the fourth field (mounting options) for the /var/log/audit partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/log/audit",
      "required_option": "nosuid"
    },
    {
      "id": "1.1.2.7.4",
      "title": "Ensure noexec option set on /var/log/audit partition",
      "section": "Initial Setup",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Since the /var/log/audit filesystem is only intended for audit log files, set this option to ensure that users cannot run executable binaries from /var/log/audit.",
      "impact": "Executable files should not exist in /var/log/audit.",
      "remediation": "Edit /etc/fstab and add noexec to the fourth field (mounting options) for the /var/log/audit partition.",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/log/audit",
      "required_option": "noexec"
    }
  ]
}