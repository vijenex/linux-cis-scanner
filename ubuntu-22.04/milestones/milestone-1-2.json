{
  "milestone": "1.1.2 Filesystem Partitions",
  "version": "1.0.0",
  "description": "Ubuntu 22.04 LTS CIS Benchmark - Section 1.1.2 Configure Filesystem Partitions",
  "controls": [
    {
      "id": "1.1.2.1.1",
      "title": "Ensure /tmp is tmpfs or a separate partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountPoint",
      "mount_point": "/tmp",
      "expected_status": "separate_partition",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.1.1",
      "description": "The /tmp directory is a world -writable directory used for temporary storage by all users and some applications.\nNote: If an entry for /tmp exists in /etc/fstab it will take precedence over entries in a systemd unit file. There is an exception to this when a system is diskless and connected to iSCSI, entries in /etc/fstab may not take precedence over a systemd unit file.",
      "remediation": "First ensure that systemd is correctly configured to ensure that /tmp will be mounted at boot time.\n# systemctl unmask tmp.mount For specific configuration requirements of the /tmp mount for your environment, modify /etc/fstab .\nExample of using tmpfs with specific mount options:\ntmpfs /tmp tmpfs defaults,rw,nosuid,nodev,noexec,relatime,size=2G 0 0 Note: the size=2G is an example of setting a specific size for tmpfs .\nExample of using a volume or disk with specific mount options. The source location of the volume or disk will vary depending on your environment:\n<device> /tmp <fstype> defaults,nodev,nosuid,noexec 0 0",
      "automated": true
    },
    {
      "id": "1.1.2.1.2",
      "title": "Ensure nodev option set on /tmp partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/tmp",
      "required_option": "nodev",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.1.2",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "remediation": "- IF - a separate partition exists for /tmp .\nEdit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /tmp partition.\nExample:\n<device> /tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /tmp with the configured options:\n# mount -o remount /tmp",
      "automated": true
    },
    {
      "id": "1.1.2.1.3",
      "title": "Ensure nosuid option set on /tmp partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/tmp",
      "required_option": "nosuid",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.1.3",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "remediation": "- IF - a separate partition exists for /tmp .\nEdit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /tmp partition.\nExample:\n<device> /tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /tmp with the configured options:\n# mount -o remount /tmp",
      "automated": true
    },
    {
      "id": "1.1.2.1.4",
      "title": "Ensure noexec option set on /tmp partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/tmp",
      "required_option": "noexec",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.1.4",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "remediation": "- IF - a separate partition exists for /tmp .\nEdit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /tmp partition.\nExample:\n<device> /tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /tmp with the configured options:\n# mount -o remount /tmp Internal Only - General",
      "automated": true
    },
    {
      "id": "1.1.2.2.1",
      "title": "Ensure /dev/shm is tmpfs or a separate partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountPoint",
      "mount_point": "/dev/shm",
      "expected_status": "separate_partition",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.2.1",
      "description": "The /dev/shm directory is a world -writable directory that can function as shared memory that facilitates inter process communication (IPC).",
      "remediation": "For specific configuration requirements of the /dev/shm mount for your environment,\nmodify /etc/fstab .\nExample:\ntmpfs /dev/shm tmpfs defaults,rw,nosuid,nodev,noexec,relatime,size=2G 0 0",
      "automated": true
    },
    {
      "id": "1.1.2.2.2",
      "title": "Ensure nodev option set on /dev/shm partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/dev/shm",
      "required_option": "nodev",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.2.2",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "remediation": "- IF - a separate partition exists for /dev/shm .\nEdit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /dev/shm partition. See the fstab(5) manual page for more information.\nExample:\ntmpfs /dev/shm tmpfs defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /dev/shm with the configured options:\n# mount -o remount /dev/shm Note: It is recommended to use tmpfs as the device/filesystem type as /dev/shm is used as shared memory space by applications.",
      "automated": true
    },
    {
      "id": "1.1.2.2.3",
      "title": "Ensure nosuid option set on /dev/shm partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/dev/shm",
      "required_option": "nosuid",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.2.3",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "remediation": "- IF - a separate partition exists for /dev/shm .\nEdit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /dev/shm partition. See the fstab(5) manual page for more information.\nExample:\ntmpfs /dev/shm tmpfs defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /dev/shm with the configured options:\n# mount -o remount /dev/shm Note: It is recommended to use tmpfs as the device/filesystem type as /dev/shm is used as shared memory space by applications.",
      "automated": true
    },
    {
      "id": "1.1.2.2.4",
      "title": "Ensure noexec option set on /dev/shm partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/dev/shm",
      "required_option": "noexec",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.2.4",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "remediation": "- IF - a separate partition exists for /dev/shm .\nEdit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /dev/shm partition.\nExample:\ntmpfs /dev/shm tmpfs defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /dev/shm with the configured options:\n# mount -o remount /dev/shm Note: It is recommended to use tmpfs as the device/filesystem type as /dev/shm is used as shared memory space by applications.",
      "automated": true
    },
    {
      "id": "1.1.2.3.1",
      "title": "Ensure separate partition exists for /home",
      "section": "Initial Setup",
      "profile": "Level2",
      "type": "MountPoint",
      "mount_point": "/home",
      "expected_status": "separate_partition",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.3.1",
      "description": "The /home directory is used to support disk storage needs of local users.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /home .\nFor systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.\nInternal Only - General",
      "automated": true
    },
    {
      "id": "1.1.2.3.2",
      "title": "Ensure nodev option set on /home partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/home",
      "required_option": "nodev",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.3.2",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "remediation": "- IF - a separate partition exists for /home .\nEdit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /home partition.\nExample:\n<device> /home <fstype> defaults,rw,nosuid,nodev,relatime 0 0\nRun the following command to remount /home with the configured options:\n# mount -o remount /home",
      "automated": true
    },
    {
      "id": "1.1.2.3.3",
      "title": "Ensure nosuid option set on /home partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/home",
      "required_option": "nosuid",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.3.3",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "remediation": "- IF - a separate partition exists for /home .\nEdit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /home partition.\nExample:\n<device> /home <fstype> defaults,rw,nosuid,nodev,relatime 0 0\nRun the following command to remount /home with the configured options:\n# mount -o remount /home",
      "automated": true
    },
    {
      "id": "1.1.2.4.1",
      "title": "Ensure separate partition exists for /var",
      "section": "Initial Setup",
      "profile": "Level2",
      "type": "MountPoint",
      "mount_point": "/var",
      "expected_status": "separate_partition",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.4.1",
      "description": "The /var directory is used by daemons and other system services to temporarily store dynamic data. Some directories created by these processes may be world -writable.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /var .\nFor systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.",
      "automated": true
    },
    {
      "id": "1.1.2.4.2",
      "title": "Ensure nodev option set on /var partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var",
      "required_option": "nodev",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.4.2",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "remediation": "- IF - a separate partition exists for /var .\nEdit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var partition.\nExample:\n<device> /var <fstype> defaults,rw,nosuid,nodev,relatime 0 0\nRun the following command to remount /var with the configured options:\n# mount -o remount /var",
      "automated": true
    },
    {
      "id": "1.1.2.4.3",
      "title": "Ensure nosuid option set on /var partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var",
      "required_option": "nosuid",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.4.3",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "remediation": "- IF - a separate partition exists for /var .\nEdit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var partition.\nExample:\n<device> /var <fstype> defaults,rw,nosuid,nodev,relatime 0 0\nRun the following command to remount /var with the configured options:\n# mount -o remount /var",
      "automated": true
    },
    {
      "id": "1.1.2.5.1",
      "title": "Ensure separate partition exists for /var/tmp",
      "section": "Initial Setup",
      "profile": "Level2",
      "type": "MountPoint",
      "mount_point": "/var/tmp",
      "expected_status": "separate_partition",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.5.1",
      "description": "The /var/tmp directory is a world -writable directory used for temporary storage by all users and some applications. Temporary files residing in /var/tmp are to be preserved between reboots.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /var/tmp .\nFor systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.\nInternal Only - General",
      "automated": true
    },
    {
      "id": "1.1.2.5.2",
      "title": "Ensure nodev option set on /var/tmp partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/tmp",
      "required_option": "nodev",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.5.2",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "remediation": "- IF - a separate partition exists for /var/tmp .\nEdit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var/tmp partition.\nExample:\n<device> /var/tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /var/tmp with the configured options:\n# mount -o remount /var/tmp",
      "automated": true
    },
    {
      "id": "1.1.2.5.3",
      "title": "Ensure nosuid option set on /var/tmp partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/tmp",
      "required_option": "nosuid",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.5.3",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "remediation": "- IF - a separate partition exists for /var/tmp .\nEdit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var/tmp partition.\nExample:\n<device> /var/tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /var/tmp with the configured options:\n# mount -o remount /var/tmp",
      "automated": true
    },
    {
      "id": "1.1.2.5.4",
      "title": "Ensure noexec option set on /var/tmp partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/tmp",
      "required_option": "noexec",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.5.4",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "remediation": "- IF - a separate partition exists for /var/tmp .\nEdit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /var/tmp partition.\nExample:\n<device> /var/tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /var/tmp with the configured options:\n# mount -o remount /var/tmp",
      "automated": true
    },
    {
      "id": "1.1.2.6.1",
      "title": "Ensure separate partition exists for /var/log",
      "section": "Initial Setup",
      "profile": "Level2",
      "type": "MountPoint",
      "mount_point": "/var/log",
      "expected_status": "separate_partition",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.6.1",
      "description": "The /var/log directory is used by system services to store log data.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /var/log .\nFor systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.\nInternal Only - General",
      "automated": true
    },
    {
      "id": "1.1.2.6.2",
      "title": "Ensure nodev option set on /var/log partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/log",
      "required_option": "nodev",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.6.2",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "remediation": "- IF - a separate partition exists for /var/log .\nEdit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var/log partition.\nExample:\n<device> /var/log <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /var/log with the configured options:\n# mount -o remount /var/log",
      "automated": true
    },
    {
      "id": "1.1.2.6.3",
      "title": "Ensure nosuid option set on /var/log partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/log",
      "required_option": "nosuid",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.6.3",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "remediation": "- IF - a separate partition exists for /var/log .\nEdit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var/log partition.\nExample:\n<device> /var/log <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /var/log with the configured options:\n# mount -o remount /var/log",
      "automated": true
    },
    {
      "id": "1.1.2.6.4",
      "title": "Ensure noexec option set on /var/log partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/log",
      "required_option": "noexec",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.6.4",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "remediation": "- IF - a separate partition exists for /var/log .\nEdit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /var/log partition.\nExample:\n<device> /var/log <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /var/log with the configured options:\n# mount -o remount /var/log",
      "automated": true
    },
    {
      "id": "1.1.2.7.1",
      "title": "Ensure separate partition exists for /var/log/audit",
      "section": "Initial Setup",
      "profile": "Level2",
      "type": "MountPoint",
      "mount_point": "/var/log/audit",
      "expected_status": "separate_partition",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.7.1",
      "description": "The auditing daemon, auditd , stores log data in the /var/log/audit directory.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /var/log/audit .\nFor systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.",
      "automated": true
    },
    {
      "id": "1.1.2.7.2",
      "title": "Ensure nodev option set on /var/log/audit partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/log/audit",
      "required_option": "nodev",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.7.2",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "remediation": "- IF - a separate partition exists for /var/log/audit .\nEdit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var/log/audit partition.\nExample:\n<device> /var/log/audit <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /var/log/audit with the configured options:\n# mount -o remount /var/log/audit",
      "automated": true
    },
    {
      "id": "1.1.2.7.3",
      "title": "Ensure nosuid option set on /var/log/audit partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/log/audit",
      "required_option": "nosuid",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.7.3",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "remediation": "- IF - a separate partition exists for /var/log/audit .\nEdit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var/log/audit partition.\nExample:\n<device> /var/log/audit <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /var/log/audit with the configured options:\n# mount -o remount /var/log/audit",
      "automated": true
    },
    {
      "id": "1.1.2.7.4",
      "title": "Ensure noexec option set on /var/log/audit partition",
      "section": "Initial Setup",
      "profile": "Level1",
      "type": "MountOption",
      "mount_point": "/var/log/audit",
      "required_option": "noexec",
      "cis_reference": "https://www.cisecurity.org/benchmark/ubuntu_linux",
      "cis_control_id": "1.1.2.7.4",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "remediation": "- IF - a separate partition exists for /var/log/audit .\nEdit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /var/log/audit partition.\nExample:\n<device> /var/log/audit <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\nRun the following command to remount /var/log/audit with the configured options:\n# mount -o remount /var/log/audit",
      "automated": true
    }
  ]
}