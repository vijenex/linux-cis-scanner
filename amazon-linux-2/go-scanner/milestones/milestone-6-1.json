{
  "milestone": "6.1",
  "version": "1.0.0",
  "description": "Amazon Linux 2 CIS Benchmark v3.0.0 - Section 6.1 System File Permissions",
  "section": "6 System Maintenance",
  "controls": [
    {
      "id": "6.1.1",
      "title": "Ensure permissions on /etc/passwd are configured",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.1 | Level1",
      "description": "The /etc/passwd file contains user account information that is used by many system utilities.",
      "remediation": "Run: chmod 644 /etc/passwd && chown root:root /etc/passwd",
      "file_path": "/etc/passwd",
      "expected_permissions": "0644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "6.1.2",
      "title": "Ensure permissions on /etc/passwd- are configured",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.2 | Level1",
      "description": "The /etc/passwd- file is a backup of /etc/passwd.",
      "remediation": "Run: chmod 644 /etc/passwd- && chown root:root /etc/passwd-",
      "file_path": "/etc/passwd-",
      "expected_permissions": "0644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "6.1.3",
      "title": "Ensure permissions on /etc/group are configured",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.3 | Level1",
      "description": "The /etc/group file contains group information.",
      "remediation": "Run: chmod 644 /etc/group && chown root:root /etc/group",
      "file_path": "/etc/group",
      "expected_permissions": "0644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "6.1.4",
      "title": "Ensure permissions on /etc/group- are configured",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.4 | Level1",
      "description": "The /etc/group- file is a backup of /etc/group.",
      "remediation": "Run: chmod 644 /etc/group- && chown root:root /etc/group-",
      "file_path": "/etc/group-",
      "expected_permissions": "0644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "6.1.5",
      "title": "Ensure permissions on /etc/shadow are configured",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.5 | Level1",
      "description": "The /etc/shadow file contains encrypted password information.",
      "remediation": "Run: chmod 0000 /etc/shadow && chown root:root /etc/shadow",
      "file_path": "/etc/shadow",
      "expected_permissions": "0000",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "6.1.6",
      "title": "Ensure permissions on /etc/shadow- are configured",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.6 | Level1",
      "description": "The /etc/shadow- file is a backup of /etc/shadow.",
      "remediation": "Run: chmod 0000 /etc/shadow- && chown root:root /etc/shadow-",
      "file_path": "/etc/shadow-",
      "expected_permissions": "0000",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "6.1.7",
      "title": "Ensure permissions on /etc/gshadow are configured",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.7 | Level1",
      "description": "The /etc/gshadow file contains encrypted group password information.",
      "remediation": "Run: chmod 0000 /etc/gshadow && chown root:root /etc/gshadow",
      "file_path": "/etc/gshadow",
      "expected_permissions": "0000",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "6.1.8",
      "title": "Ensure permissions on /etc/gshadow- are configured",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.8 | Level1",
      "description": "The /etc/gshadow- file is a backup of /etc/gshadow.",
      "remediation": "Run: chmod 0000 /etc/gshadow- && chown root:root /etc/gshadow-",
      "file_path": "/etc/gshadow-",
      "expected_permissions": "0000",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "6.1.9",
      "title": "Ensure permissions on /etc/shells are configured",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.9 | Level1",
      "description": "The /etc/shells file contains valid login shells. It should be protected from unauthorized modification.",
      "remediation": "Run: chmod 644 /etc/shells && chown root:root /etc/shells",
      "file_path": "/etc/shells",
      "expected_permissions": "0644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "6.1.10",
      "title": "Ensure permissions on /etc/security/opasswd are configured",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.10 | Level1",
      "description": "The /etc/security/opasswd file stores old passwords. It should be protected from unauthorized access.",
      "remediation": "Run: chmod 600 /etc/security/opasswd && chown root:root /etc/security/opasswd",
      "file_path": "/etc/security/opasswd",
      "expected_permissions": "0600",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "6.1.11",
      "title": "Ensure world writable files and directories are secured",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": true,
      "type": "CommandOutputEmpty",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.11 | Level1",
      "description": "World writable files can be modified by any user on the system.",
      "remediation": "Run: find / -xdev -type f -perm -0002 -exec chmod o-w {} \\;",
      "audit_command": "find / -xdev -type f -perm -0002 ! -path '/proc/*' ! -path '/sys/*' ! -path '/dev/*'"
    },
    {
      "id": "6.1.12",
      "title": "Ensure no unowned or ungrouped files or directories exist",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": true,
      "type": "CommandOutputEmpty",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.12 | Level1",
      "description": "Files not owned by a valid user or group can be modified by anyone.",
      "remediation": "Run: find / -xdev -nouser -exec chown root {} \\; && find / -xdev -nogroup -exec chgrp root {} \\;",
      "audit_command": "find / -xdev -nouser -o -nogroup"
    },
    {
      "id": "6.1.13",
      "title": "Ensure SUID and SGID files are reviewed",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.13 | Level1",
      "description": "SUID and SGID files can be security risks if not properly managed.",
      "remediation": "Review all SUID and SGID files: find / -xdev -type f -perm -4000 -o -perm -2000. Remove unnecessary setuid/setgid bits."
    },
    {
      "id": "6.1.14",
      "title": "Audit system file permissions",
      "section": "6.1 System File Permissions",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "cis_reference": "CIS Amazon Linux 2 - 6.1.14 | Level1",
      "description": "Regularly audit system file permissions to detect unauthorized changes.",
      "remediation": "Use tools like AIDE or tripwire to regularly audit system file permissions."
    }
  ]
}