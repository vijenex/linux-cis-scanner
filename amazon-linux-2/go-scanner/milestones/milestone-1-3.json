{
  "milestone": "1.3",
  "version": "1.0.0",
  "description": "Amazon Linux 2 CIS Benchmark v3.0.0 - Section 1.2 Configure Software and Patch Management",
  "section": "1 Initial Setup",
  "controls": [
    {
      "id": "1.2.1",
      "title": "Ensure GPG keys are configured",
      "section": "1.2 Configure Software and Patch Management",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "cis_reference": "CIS Amazon Linux 2 - 1.2.1 | Level1",
      "description": "The RPM Package Manager implements GPG key signing to verify package integrity during and after installation. It is important to ensure that updates are obtained from a valid source to protect against spoofing that could lead to the inadvertent installation of malware on the system.",
      "remediation": "Update your package manager GPG keys in accordance with site policy."
    },
    {
      "id": "1.2.2",
      "title": "Ensure gpgcheck is globally activated",
      "section": "1.2 Configure Software and Patch Management",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "cis_reference": "CIS Amazon Linux 2 - 1.2.2 | Level1",
      "description": "The gpgcheck option controls verifying package signatures after download. It is important to ensure that an RPM's package signature is always checked prior to installation to ensure that the software is obtained from a trusted source.",
      "remediation": "Edit /etc/yum.conf and set gpgcheck=1 in the [main] section. Edit any failing files in /etc/yum.repos.d/* and set all instances starting with gpgcheck to 1.",
      "file_path": "/etc/yum.conf",
      "pattern": "^gpgcheck\\s*=\\s*1",
      "expected_result": "found"
    },
    {
      "id": "1.2.3",
      "title": "Ensure repo_gpgcheck is globally activated",
      "section": "1.2 Configure Software and Patch Management",
      "profile": "Level2",
      "automated": false,
      "type": "Manual",
      "cis_reference": "CIS Amazon Linux 2 - 1.2.3 | Level2",
      "description": "The repo_gpgcheck option, found in the main section of the /etc/yum.conf and individual /etc/yum.repos.d/* files, will perform a GPG signature check on the repodata.",
      "remediation": "Global configuration: Edit /etc/yum.conf and set repo_gpgcheck=1 in the [main] section. Per repository configuration: Edit any failing files in /etc/yum.repos.d/* and set all instances starting with repo_gpgcheck to 1."
    },
    {
      "id": "1.2.4",
      "title": "Ensure package manager repositories are configured",
      "section": "1.2 Configure Software and Patch Management",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "cis_reference": "CIS Amazon Linux 2 - 1.2.4 | Level1",
      "description": "Systems need to have the respective package manager repositories configured to ensure that the system is able to receive the latest patches and updates.",
      "remediation": "Configure your package manager repositories according to site policy."
    },
    {
      "id": "1.2.5",
      "title": "Ensure updates, patches, and additional security software are installed",
      "section": "1.2 Configure Software and Patch Management",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "cis_reference": "CIS Amazon Linux 2 - 1.2.5 | Level1",
      "description": "Periodically patches are released for included software either due to security flaws or to include additional functionality.",
      "remediation": "Run the following command to update all packages: # yum update"
    }
  ]
}