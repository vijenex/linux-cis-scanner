{
  "milestone": "4.2",
  "version": "1.0.0",
  "description": "Amazon Linux 2 CIS Benchmark v3.0.0 - Section 4.2 Configure SSH Server",
  "section": "4 Access, Authentication and Authorization",
  "controls": [
    {
      "id": "4.2.1",
      "title": "Ensure permissions on /etc/ssh/sshd_config are configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.1 | Level1",
      "description": "The sshd_config file contains configuration specifications for sshd. The file needs to be protected from unauthorized changes.",
      "remediation": "Run: chown root:root /etc/ssh/sshd_config && chmod 0600 /etc/ssh/sshd_config",
      "file_path": "/etc/ssh/sshd_config",
      "expected_permissions": "0600",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "4.2.2",
      "title": "Ensure permissions on SSH private host key files are configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.2 | Level1",
      "description": "SSH private keys should be protected from unauthorized access.",
      "remediation": "Run: find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chmod u-x,go-rwx {} \\; && find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chown root:root {} \\;",
      "file_path": "/etc/ssh/ssh_host_*_key",
      "expected_permissions": "0600",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "4.2.3",
      "title": "Ensure permissions on SSH public host key files are configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.3 | Level1",
      "description": "SSH public keys should be world-readable.",
      "remediation": "Run: find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chmod u-x,go-wx {} \\; && find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chown root:root {} \\;",
      "file_path": "/etc/ssh/ssh_host_*_key.pub",
      "expected_permissions": "0644",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "4.2.4",
      "title": "Ensure sshd access is configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.4 | Level1",
      "description": "Configure AllowUsers, AllowGroups, DenyUsers, DenyGroups in sshd_config to restrict access.",
      "remediation": "Edit /etc/ssh/sshd_config and configure access restrictions: AllowUsers <user_list> or AllowGroups <group_list>",
      "parameter": "AllowUsers",
      "expected_value": "configured"
    },
    {
      "id": "4.2.5",
      "title": "Ensure sshd Banner is configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.5 | Level1",
      "description": "Banners are used to warn connecting users of the particular site's policy regarding connection.",
      "remediation": "Edit /etc/ssh/sshd_config and set Banner /etc/issue.net",
      "parameter": "Banner",
      "expected_value": "/etc/issue.net"
    },
    {
      "id": "4.2.6",
      "title": "Ensure sshd Ciphers are configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.6 | Level1",
      "description": "Weak ciphers should not be used. Only strong ciphers should be allowed.",
      "remediation": "Edit /etc/ssh/sshd_config and configure strong ciphers: Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr",
      "parameter": "Ciphers",
      "expected_value": "strong"
    },
    {
      "id": "4.2.7",
      "title": "Ensure sshd ClientAliveInterval and ClientAliveCountMax are configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.7 | Level1",
      "description": "Idle SSH sessions should timeout after a period of inactivity.",
      "remediation": "Edit /etc/ssh/sshd_config: ClientAliveInterval 300, ClientAliveCountMax 0",
      "parameter": "ClientAliveInterval",
      "expected_value": "300"
    },
    {
      "id": "4.2.8",
      "title": "Ensure sshd DisableForwarding is enabled",
      "section": "4.2 Configure SSH Server",
      "profile": "Level2",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.8 | Level2",
      "description": "SSH port forwarding should be disabled unless required.",
      "remediation": "Edit /etc/ssh/sshd_config and set DisableForwarding yes",
      "parameter": "DisableForwarding",
      "expected_value": "yes"
    },
    {
      "id": "4.2.9",
      "title": "Ensure sshd GSSAPIAuthentication is disabled",
      "section": "4.2 Configure SSH Server",
      "profile": "Level2",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.9 | Level2",
      "description": "GSSAPI authentication should be disabled to reduce the attack surface.",
      "remediation": "Edit /etc/ssh/sshd_config and set GSSAPIAuthentication no",
      "parameter": "GSSAPIAuthentication",
      "expected_value": "no"
    },
    {
      "id": "4.2.10",
      "title": "Ensure sshd HostbasedAuthentication is disabled",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.10 | Level1",
      "description": "Host-based authentication should be disabled.",
      "remediation": "Edit /etc/ssh/sshd_config and set HostbasedAuthentication no",
      "parameter": "HostbasedAuthentication",
      "expected_value": "no"
    },
    {
      "id": "4.2.11",
      "title": "Ensure sshd IgnoreRhosts is enabled",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.11 | Level1",
      "description": "SSH should ignore .rhosts files.",
      "remediation": "Edit /etc/ssh/sshd_config and set IgnoreRhosts yes",
      "parameter": "IgnoreRhosts",
      "expected_value": "yes"
    },
    {
      "id": "4.2.12",
      "title": "Ensure sshd KexAlgorithms is configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.12 | Level1",
      "description": "Weak key exchange algorithms should not be used.",
      "remediation": "Edit /etc/ssh/sshd_config and configure strong key exchange algorithms.",
      "parameter": "KexAlgorithms",
      "expected_value": "strong"
    },
    {
      "id": "4.2.13",
      "title": "Ensure sshd LoginGraceTime is configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.13 | Level1",
      "description": "The LoginGraceTime parameter specifies the time allowed for successful authentication to the SSH server.",
      "remediation": "Edit /etc/ssh/sshd_config and set LoginGraceTime 60",
      "parameter": "LoginGraceTime",
      "expected_value": "60"
    },
    {
      "id": "4.2.14",
      "title": "Ensure sshd LogLevel is configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.14 | Level1",
      "description": "SSH provides several logging levels. VERBOSE or INFO level is recommended.",
      "remediation": "Edit /etc/ssh/sshd_config and set LogLevel VERBOSE or LogLevel INFO",
      "parameter": "LogLevel",
      "expected_value": "VERBOSE"
    },
    {
      "id": "4.2.15",
      "title": "Ensure sshd MACs are configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.15 | Level1",
      "description": "Weak MAC algorithms should not be used.",
      "remediation": "Edit /etc/ssh/sshd_config and configure strong MAC algorithms.",
      "parameter": "MACs",
      "expected_value": "strong"
    },
    {
      "id": "4.2.16",
      "title": "Ensure sshd MaxAuthTries is configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.16 | Level1",
      "description": "The MaxAuthTries parameter specifies the maximum number of authentication attempts permitted per connection.",
      "remediation": "Edit /etc/ssh/sshd_config and set MaxAuthTries 4",
      "parameter": "MaxAuthTries",
      "expected_value": "4"
    },
    {
      "id": "4.2.17",
      "title": "Ensure sshd MaxSessions is configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.17 | Level1",
      "description": "The MaxSessions parameter specifies the maximum number of open sessions permitted from a given connection.",
      "remediation": "Edit /etc/ssh/sshd_config and set MaxSessions 10",
      "parameter": "MaxSessions",
      "expected_value": "10"
    },
    {
      "id": "4.2.18",
      "title": "Ensure sshd MaxStartups is configured",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.18 | Level1",
      "description": "The MaxStartups parameter specifies the maximum number of concurrent unauthenticated connections to the SSH daemon.",
      "remediation": "Edit /etc/ssh/sshd_config and set MaxStartups 10:30:60",
      "parameter": "MaxStartups",
      "expected_value": "10:30:60"
    },
    {
      "id": "4.2.19",
      "title": "Ensure sshd PermitEmptyPasswords is disabled",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.19 | Level1",
      "description": "The PermitEmptyPasswords parameter specifies if the SSH server allows login to accounts with empty password strings.",
      "remediation": "Edit /etc/ssh/sshd_config and set PermitEmptyPasswords no",
      "parameter": "PermitEmptyPasswords",
      "expected_value": "no"
    },
    {
      "id": "4.2.20",
      "title": "Ensure sshd PermitRootLogin is disabled",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.20 | Level1",
      "description": "The PermitRootLogin parameter specifies if the root user can log in using SSH.",
      "remediation": "Edit /etc/ssh/sshd_config and set PermitRootLogin no",
      "parameter": "PermitRootLogin",
      "expected_value": "no"
    },
    {
      "id": "4.2.21",
      "title": "Ensure sshd PermitUserEnvironment is disabled",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.21 | Level1",
      "description": "The PermitUserEnvironment option allows users to present environment options to the SSH daemon.",
      "remediation": "Edit /etc/ssh/sshd_config and set PermitUserEnvironment no",
      "parameter": "PermitUserEnvironment",
      "expected_value": "no"
    },
    {
      "id": "4.2.22",
      "title": "Ensure sshd UsePAM is enabled",
      "section": "4.2 Configure SSH Server",
      "profile": "Level1",
      "automated": true,
      "type": "SSHConfig",
      "cis_reference": "CIS Amazon Linux 2 - 4.2.22 | Level1",
      "description": "The UsePAM directive enables the Pluggable Authentication Module (PAM) interface.",
      "remediation": "Edit /etc/ssh/sshd_config and set UsePAM yes",
      "parameter": "UsePAM",
      "expected_value": "yes"
    }
  ]
}