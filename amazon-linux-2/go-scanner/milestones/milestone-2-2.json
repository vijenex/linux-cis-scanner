{
  "milestone": "2.2",
  "version": "1.0.0",
  "description": "Amazon Linux 2 CIS Benchmark v3.0.0 - Section 2.2 Configure Special Purpose Services",
  "section": "2 Services",
  "controls": [
    {
      "id": "2.2.1",
      "title": "Ensure autofs services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level2",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.1 | Level2",
      "description": "autofs allows automatic mounting of devices, typically including CD/DVDs and USB drives. With automounting enabled anyone with physical access could attach a USB drive or disc and have its contents available in system even if they lacked permissions to mount it themselves.",
      "remediation": "Run the following commands to stop autofs.service and remove autofs package: # systemctl stop autofs.service && yum remove autofs",
      "service_name": "autofs",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.2",
      "title": "Ensure avahi daemon services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level2",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.2 | Level2",
      "description": "Avahi is a free zeroconf implementation, including a system for multicast DNS/DNS-SD service discovery. Automatic discovery of network services is not normally required for system functionality.",
      "remediation": "Run the following commands to stop avahi-daemon.socket avahi-daemon.service, and remove the avahi package: # systemctl stop avahi-daemon.socket avahi-daemon.service && yum remove avahi",
      "service_name": "avahi-daemon",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.3",
      "title": "Ensure dhcp server services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.3 | Level1",
      "description": "The Dynamic Host Configuration Protocol (DHCP) is a service that allows machines to be dynamically assigned IP addresses. Unless a system is specifically set up to act as a DHCP server, it is recommended that the dhcp-server package be removed.",
      "remediation": "Run the following commands to stop dhcpd.service and dhcpd6.service and remove dhcp-server package: # systemctl stop dhcpd.service dhcpd6.service && yum remove dhcp-server",
      "service_name": "dhcpd",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.4",
      "title": "Ensure dns server services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.4 | Level1",
      "description": "The Domain Name System (DNS) is a hierarchical naming system that maps names to IP addresses for computers, services and other resources connected to a network. Unless a system is specifically designated to act as a DNS server, it is recommended that the package be removed.",
      "remediation": "Run the following commands to stop named.service and remove bind package: # systemctl stop named.service && yum remove bind",
      "service_name": "named",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.5",
      "title": "Ensure dnsmasq services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.5 | Level1",
      "description": "dnsmasq is a lightweight tool that provides DNS caching, DNS forwarding and DHCP (Dynamic Host Configuration Protocol) services. Unless a system is specifically designated to act as a DNS caching, DNS forwarding and/or DHCP server, it is recommended that the package be removed.",
      "remediation": "Run the following commands to stop dnsmasq.service and remove dnsmasq package: # systemctl stop dnsmasq.service && yum remove dnsmasq",
      "service_name": "dnsmasq",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.6",
      "title": "Ensure samba file server services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.6 | Level1",
      "description": "The Samba daemon allows system administrators to configure their Linux systems to share file systems and directories with Windows desktops. If there is no need to mount directories and file systems to Windows systems, then this package can be removed.",
      "remediation": "Run the following command to stop smb.service and remove samba package: # systemctl stop smb.service && yum remove samba",
      "service_name": "smb",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.7",
      "title": "Ensure ftp server services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.7 | Level1",
      "description": "FTP (File Transfer Protocol) is a traditional and widely used standard tool for transferring files between a server and clients over a network. Unless there is a need to run the system as a FTP server, it is recommended that the package be removed.",
      "remediation": "Run the following commands to stop vsftpd.service and remove vsftpd package: # systemctl stop vsftpd.service && yum remove vsftpd",
      "service_name": "vsftpd",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.8",
      "title": "Ensure message access server services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.8 | Level1",
      "description": "dovecot and cyrus-imapd are open source IMAP and POP3 server packages for Linux based systems. Unless POP3 and/or IMAP servers are to be provided by this system, it is recommended that the package be removed.",
      "remediation": "Run the following commands to stop dovecot.socket dovecot.service, and remove dovecot cyrus-imapd packages: # systemctl stop dovecot.socket dovecot.service && yum remove dovecot cyrus-imapd",
      "service_name": "dovecot",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.9",
      "title": "Ensure network file system services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.9 | Level1",
      "description": "The Network File System (NFS) is one of the first and most widely distributed file systems in the UNIX environment. If the system does not require access to network shares or the ability to provide network file system services for other host's network shares, it is recommended that the nfs-utils package be removed.",
      "remediation": "Run the following command to stop nfs-server.service and remove nfs-utils package: # systemctl stop nfs-server.service && yum remove nfs-utils",
      "service_name": "nfs-server",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.10",
      "title": "Ensure nis server services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.10 | Level1",
      "description": "The Network Information Service (NIS) is a client-server directory service protocol used to distribute system configuration files. The NIS service is inherently an insecure system that has been vulnerable to DOS attacks, buffer overflows and has poor authentication.",
      "remediation": "Run the following commands to stop ypserv.service and remove ypserv package: # systemctl stop ypserv.service && yum remove ypserv",
      "service_name": "ypserv",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.11",
      "title": "Ensure print server services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.11 | Level1",
      "description": "The Common Unix Print System (CUPS) provides the ability to print to both local and network printers. If the system does not need to print jobs or accept print jobs from other systems, it is recommended that CUPS be removed.",
      "remediation": "Run the following commands to stop cups.socket cups.service, and remove the cups package: # systemctl stop cups.socket cups.service && yum remove cups",
      "service_name": "cups",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.12",
      "title": "Ensure rpcbind services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.12 | Level1",
      "description": "The rpcbind utility maps RPC services to the ports on which they listen. A small request sent to the Portmapper generates a large response, which makes it a suitable tool for DDoS attacks.",
      "remediation": "Run the following commands to stop rpcbind.socket rpcbind.service, and remove the rpcbind package: # systemctl stop rpcbind.socket rpcbind.service && yum remove rpcbind",
      "service_name": "rpcbind",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.13",
      "title": "Ensure rsync services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.13 | Level1",
      "description": "The rsyncd.service can be used to synchronize files between systems over network links. Unless required, the rsync-daemon package should be removed to reduce the potential attack surface.",
      "remediation": "Run the following commands to stop rsyncd.socket rsyncd.service, and remove the rsync-daemon package: # systemctl stop rsyncd.socket rsyncd.service && yum remove rsync-daemon",
      "service_name": "rsyncd",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.14",
      "title": "Ensure snmp services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.14 | Level1",
      "description": "Simple Network Management Protocol (SNMP) is a widely used protocol for monitoring the health and welfare of network equipment. If the SNMP service is not required, the net-snmp package should be removed.",
      "remediation": "Run the following commands to stop snmpd.service and remove net-snmp package: # systemctl stop snmpd.service && yum remove net-snmp",
      "service_name": "snmpd",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.15",
      "title": "Ensure telnet server services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.15 | Level1",
      "description": "The telnet-server package contains the telnet daemon, which accepts connections from users from other systems via the telnet protocol. The telnet protocol is insecure and unencrypted.",
      "remediation": "Run the following commands to stop telnet.socket and remove the telnet-server package: # systemctl stop telnet.socket && yum remove telnet-server",
      "service_name": "telnet",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.16",
      "title": "Ensure tftp server services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.16 | Level1",
      "description": "Trivial File Transfer Protocol (TFTP) is a simple protocol for exchanging files between two TCP/IP machines. Unless there is a need to run the system as a TFTP server, it is recommended that the package be removed.",
      "remediation": "Run the following commands to stop tftp.socket tftp.service, and remove the tftp-server package: # systemctl stop tftp.socket tftp.service && yum remove tftp-server",
      "service_name": "tftp",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.17",
      "title": "Ensure web proxy server services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.17 | Level1",
      "description": "Squid is a standard proxy server used in many distributions and environments. Unless a system is specifically set up to act as a proxy server, it is recommended that the squid package be removed.",
      "remediation": "Run the following commands to stop squid.service and remove the squid package: # systemctl stop squid.service && yum remove squid",
      "service_name": "squid",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.18",
      "title": "Ensure web server services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.18 | Level1",
      "description": "Web servers provide the ability to host web site content. Unless there is a local site approved requirement to run a web server service on the system, web server packages should be removed.",
      "remediation": "Run the following commands to stop httpd.socket httpd.service, and remove httpd nginx packages: # systemctl stop httpd.socket httpd.service && yum remove httpd nginx",
      "service_name": "httpd",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.19",
      "title": "Ensure xinetd services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.19 | Level1",
      "description": "The eXtended InterNET Daemon (xinetd) is an open source super daemon that replaced the original inetd daemon. If there are no xinetd services required, it is recommended that the package be removed.",
      "remediation": "Run the following commands to stop xinetd.service, and remove the xinetd package: # systemctl stop xinetd.service && yum remove xinetd",
      "service_name": "xinetd",
      "expected_status": "disabled"
    },
    {
      "id": "2.2.20",
      "title": "Ensure X window server services are not in use",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level2",
      "automated": true,
      "type": "PackageNotInstalled",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.20 | Level2",
      "description": "The X Window System provides a Graphical User Interface (GUI) where users can have multiple windows in which to run programs. Unless your organization specifically requires graphical login access via X Windows, remove it.",
      "remediation": "Run the following command to remove the X Windows Server packages: # yum remove xorg-x11-server-common",
      "package_name": "xorg-x11-server-common",
      "expected_status": "not_installed"
    },
    {
      "id": "2.2.21",
      "title": "Ensure mail transfer agents are configured for local-only mode",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.21 | Level1",
      "description": "Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to listen for incoming mail and transfer the messages to the appropriate user or mail server. If the system is not intended to be a mail server, it is recommended that the MTA be configured to only process local mail.",
      "remediation": "Edit /etc/postfix/main.cf and add the following line: inet_interfaces = localhost",
      "file_path": "/etc/postfix/main.cf",
      "pattern": "^inet_interfaces\\s*=\\s*localhost",
      "expected_result": "found"
    },
    {
      "id": "2.2.22",
      "title": "Ensure only approved services are listening on a network interface",
      "section": "2.2 Configure Special Purpose Services",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "cis_reference": "CIS Amazon Linux 2 - 2.2.22 | Level1",
      "description": "Services listening on network interfaces provide potential attack vectors. It is important to ensure that only approved services are listening on network interfaces.",
      "remediation": "Review the output of 'netstat -tuln' or 'ss -tuln' and ensure that only approved services are listening on network interfaces."
    }
  ]
}