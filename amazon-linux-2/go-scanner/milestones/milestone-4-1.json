{
  "milestone": "4.1",
  "version": "1.0.0",
  "description": "Amazon Linux 2 CIS Benchmark v3.0.0 - Section 4.1 Configure job schedulers",
  "section": "4 Access, Authentication and Authorization",
  "controls": [
    {
      "id": "4.1.1.1",
      "title": "Ensure cron daemon is enabled and active",
      "section": "4.1.1 Configure cron",
      "profile": "Level1",
      "automated": true,
      "type": "ServiceStatus",
      "cis_reference": "CIS Amazon Linux 2 - 4.1.1.1 | Level1",
      "description": "The cron daemon is used to execute scheduled commands. It should be enabled to support automated system maintenance.",
      "remediation": "Run the following command to enable and start crond: # systemctl --now enable crond",
      "service_name": "crond",
      "expected_status": "enabled"
    },
    {
      "id": "4.1.1.2",
      "title": "Ensure permissions on /etc/crontab are configured",
      "section": "4.1.1 Configure cron",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 4.1.1.2 | Level1",
      "description": "The /etc/crontab file contains system-wide cron jobs. It should be protected from unauthorized modification.",
      "remediation": "Run: chmod 600 /etc/crontab && chown root:root /etc/crontab",
      "file_path": "/etc/crontab",
      "expected_permissions": "0600",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "4.1.1.3",
      "title": "Ensure permissions on /etc/cron.hourly are configured",
      "section": "4.1.1 Configure cron",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 4.1.1.3 | Level1",
      "description": "The /etc/cron.hourly directory contains scripts that are executed hourly. It should be protected from unauthorized modification.",
      "remediation": "Run: chmod 700 /etc/cron.hourly && chown root:root /etc/cron.hourly",
      "file_path": "/etc/cron.hourly",
      "expected_permissions": "0700",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "4.1.1.4",
      "title": "Ensure permissions on /etc/cron.daily are configured",
      "section": "4.1.1 Configure cron",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 4.1.1.4 | Level1",
      "description": "The /etc/cron.daily directory contains scripts that are executed daily. It should be protected from unauthorized modification.",
      "remediation": "Run: chmod 700 /etc/cron.daily && chown root:root /etc/cron.daily",
      "file_path": "/etc/cron.daily",
      "expected_permissions": "0700",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "4.1.1.5",
      "title": "Ensure permissions on /etc/cron.weekly are configured",
      "section": "4.1.1 Configure cron",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 4.1.1.5 | Level1",
      "description": "The /etc/cron.weekly directory contains scripts that are executed weekly. It should be protected from unauthorized modification.",
      "remediation": "Run: chmod 700 /etc/cron.weekly && chown root:root /etc/cron.weekly",
      "file_path": "/etc/cron.weekly",
      "expected_permissions": "0700",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "4.1.1.6",
      "title": "Ensure permissions on /etc/cron.monthly are configured",
      "section": "4.1.1 Configure cron",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 4.1.1.6 | Level1",
      "description": "The /etc/cron.monthly directory contains scripts that are executed monthly. It should be protected from unauthorized modification.",
      "remediation": "Run: chmod 700 /etc/cron.monthly && chown root:root /etc/cron.monthly",
      "file_path": "/etc/cron.monthly",
      "expected_permissions": "0700",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "4.1.1.7",
      "title": "Ensure permissions on /etc/cron.d are configured",
      "section": "4.1.1 Configure cron",
      "profile": "Level1",
      "automated": true,
      "type": "FilePermissions",
      "cis_reference": "CIS Amazon Linux 2 - 4.1.1.7 | Level1",
      "description": "The /etc/cron.d directory contains additional cron job files. It should be protected from unauthorized modification.",
      "remediation": "Run: chmod 700 /etc/cron.d && chown root:root /etc/cron.d",
      "file_path": "/etc/cron.d",
      "expected_permissions": "0700",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "4.1.1.8",
      "title": "Ensure crontab is restricted to authorized users",
      "section": "4.1.1 Configure cron",
      "profile": "Level1",
      "automated": true,
      "type": "FileExists",
      "cis_reference": "CIS Amazon Linux 2 - 4.1.1.8 | Level1",
      "description": "Restricting access to crontab helps prevent unauthorized users from scheduling jobs.",
      "remediation": "Remove /etc/cron.deny if it exists. Ensure /etc/cron.allow exists and contains only authorized users.",
      "file_path": "/etc/cron.deny",
      "expected_status": "not_exists"
    },
    {
      "id": "4.1.2.1",
      "title": "Ensure at is restricted to authorized users",
      "section": "4.1.2 Configure at",
      "profile": "Level1",
      "automated": true,
      "type": "FileExists",
      "cis_reference": "CIS Amazon Linux 2 - 4.1.2.1 | Level1",
      "description": "Restricting access to the at command helps prevent unauthorized users from scheduling jobs.",
      "remediation": "Remove /etc/at.deny if it exists. Ensure /etc/at.allow exists and contains only authorized users.",
      "file_path": "/etc/at.deny",
      "expected_status": "not_exists"
    }
  ]
}