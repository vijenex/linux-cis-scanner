{
  "milestone": "1.6",
  "version": "1.0.0",
  "description": "Amazon Linux 2 CIS Benchmark v3.0.0 - Section 1.5 Mandatory Access Control",
  "section": "1 Initial Setup",
  "controls": [
    {
      "id": "1.5.1.1",
      "title": "Ensure SELinux is installed",
      "section": "1.5.1 Configure SELinux",
      "profile": "Level1",
      "automated": true,
      "type": "PackageInstalled",
      "cis_reference": "CIS Amazon Linux 2 - 1.5.1.1 | Level1",
      "description": "SELinux provides Mandatory Access Control. Without a Mandatory Access Control system installed only the default Discretionary Access Control system will be available.",
      "remediation": "Run the following command to install SELinux: # yum install libselinux",
      "package_name": "libselinux",
      "expected_status": "installed"
    },
    {
      "id": "1.5.1.2",
      "title": "Ensure SELinux is not disabled in bootloader configuration",
      "section": "1.5.1 Configure SELinux",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "cis_reference": "CIS Amazon Linux 2 - 1.5.1.2 | Level1",
      "description": "Configure SELINUX to be enabled at boot time and verify that it has not been overwritten by the grub boot parameters.",
      "remediation": "Remove any instances of selinux=0 or enforcing=0 from /etc/default/grub and run: # grub2-mkconfig -o /boot/grub2/grub.cfg",
      "file_path": "/etc/default/grub",
      "pattern": "selinux=0|enforcing=0",
      "expected_result": "not_found"
    },
    {
      "id": "1.5.1.3",
      "title": "Ensure SELinux policy is configured",
      "section": "1.5.1 Configure SELinux",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "cis_reference": "CIS Amazon Linux 2 - 1.5.1.3 | Level1",
      "description": "Configure SELinux to meet or exceed the default targeted policy, which constrains daemons and system software only.",
      "remediation": "Edit /etc/selinux/config and add set the SELINUXTYPE line to targeted or mls: SELINUXTYPE=targeted",
      "file_path": "/etc/selinux/config",
      "pattern": "SELINUXTYPE=(targeted|mls)",
      "expected_result": "found"
    },
    {
      "id": "1.5.1.4",
      "title": "Ensure the SELinux mode is not disabled",
      "section": "1.5.1 Configure SELinux",
      "profile": "Level1",
      "automated": true,
      "type": "FileContent",
      "cis_reference": "CIS Amazon Linux 2 - 1.5.1.4 | Level1",
      "description": "SELinux can run in one of three modes: disabled, permissive, or enforcing. Running SELinux in disabled mode is strongly discouraged.",
      "remediation": "Edit /etc/selinux/config and update the SELINUX parameter to either SELINUX=enforcing or SELINUX=permissive",
      "file_path": "/etc/selinux/config",
      "pattern": "SELINUX=(enforcing|permissive)",
      "expected_result": "found"
    },
    {
      "id": "1.5.1.5",
      "title": "Ensure the SELinux mode is enforcing",
      "section": "1.5.1 Configure SELinux",
      "profile": "Level2",
      "automated": true,
      "type": "FileContent",
      "cis_reference": "CIS Amazon Linux 2 - 1.5.1.5 | Level2",
      "description": "SELinux can run in one of three modes: disabled, permissive, or enforcing. Enforcing mode is the default, and recommended, mode of operation.",
      "remediation": "Edit /etc/selinux/config and update the SELINUX parameter to SELINUX=enforcing",
      "file_path": "/etc/selinux/config",
      "pattern": "SELINUX=enforcing",
      "expected_result": "found"
    },
    {
      "id": "1.5.1.6",
      "title": "Ensure no unconfined services exist",
      "section": "1.5.1 Configure SELinux",
      "profile": "Level2",
      "automated": false,
      "type": "Manual",
      "cis_reference": "CIS Amazon Linux 2 - 1.5.1.6 | Level2",
      "description": "Unconfined processes run in unconfined domains. For unconfined processes, SELinux policy rules are applied, but policy rules exist that allow processes running in unconfined domains almost all access.",
      "remediation": "Investigate any unconfined processes found during the audit action. If necessary create a customize SELinux policy to allow necessary actions for the service."
    },
    {
      "id": "1.5.1.7",
      "title": "Ensure the MCS Translation Service (mcstrans) is not installed",
      "section": "1.5.1 Configure SELinux",
      "profile": "Level1",
      "automated": true,
      "type": "PackageNotInstalled",
      "cis_reference": "CIS Amazon Linux 2 - 1.5.1.7 | Level1",
      "description": "The mcstransd daemon provides category label information to client processes requesting information. Since this service is not used very often, remove it to reduce the amount of potentially vulnerable code running on the system.",
      "remediation": "Run the following command to uninstall mcstrans: # yum remove mcstrans",
      "package_name": "mcstrans",
      "expected_status": "not_installed"
    },
    {
      "id": "1.5.1.8",
      "title": "Ensure SETroubleshoot is not installed",
      "section": "1.5.1 Configure SELinux",
      "profile": "Level1",
      "automated": true,
      "type": "PackageNotInstalled",
      "cis_reference": "CIS Amazon Linux 2 - 1.5.1.8 | Level1",
      "description": "The SETroubleshoot service notifies desktop users of SELinux denials through a user-friendly interface. The SETroubleshoot service is an unnecessary daemon to have running on a server, especially if X Windows is disabled.",
      "remediation": "Run the following command to uninstall setroubleshoot: # yum remove setroubleshoot",
      "package_name": "setroubleshoot",
      "expected_status": "not_installed"
    }
  ]
}