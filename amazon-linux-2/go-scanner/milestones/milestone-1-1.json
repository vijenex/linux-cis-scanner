{
  "milestone": "1.1",
  "version": "1.0.0",
  "description": "Amazon Linux 2 CIS Benchmark - Section 1.1 Filesystem Kernel Modules",
  "section": "1 Initial Setup",
  "controls": [
    {
      "id": "1.1.1.1",
      "title": "Ensure cramfs kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "cramfs",
      "expected_status": "not_available",
      "cis_reference": "CIS Amazon Linux 2 - 1.1.1.1 | Level 1",
      "description": "The cramfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems. Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "remediation": "Run the following commands to unload and disable the cramfs kernel module:\n# modprobe -r cramfs 2>/dev/null\n# rmmod cramfs 2>/dev/null\n# printf '%s\\n' '' 'install cramfs /bin/false' >> /etc/modprobe.d/60-cramfs.conf\n# printf '%s\\n' '' 'blacklist cramfs' >> /etc/modprobe.d/60-cramfs.conf"
    },
    {
      "id": "1.1.1.2",
      "title": "Ensure freevxfs kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "freevxfs",
      "expected_status": "not_available",
      "cis_reference": "CIS Amazon Linux 2 - 1.1.1.2 | Level 1",
      "description": "The freevxfs filesystem type is a free version of the Veritas type filesystem. This is the primary filesystem type for HP-UX operating systems. Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "remediation": "Run the following commands to unload and disable the freevxfs kernel module:\n# modprobe -r freevxfs 2>/dev/null\n# rmmod freevxfs 2>/dev/null\n# printf '%s\\n' '' 'install freevxfs /bin/false' >> /etc/modprobe.d/60-freevxfs.conf\n# printf '%s\\n' '' 'blacklist freevxfs' >> /etc/modprobe.d/60-freevxfs.conf"
    },
    {
      "id": "1.1.1.3",
      "title": "Ensure hfs kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "hfs",
      "expected_status": "not_available",
      "cis_reference": "CIS Amazon Linux 2 - 1.1.1.3 | Level 1",
      "description": "The hfs filesystem type is a hierarchical filesystem that allows you to mount Mac OS filesystems. Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "remediation": "Run the following commands to unload and disable the hfs kernel module:\n# modprobe -r hfs 2>/dev/null\n# rmmod hfs 2>/dev/null\n# printf '%s\\n' '' 'install hfs /bin/false' >> /etc/modprobe.d/60-hfs.conf\n# printf '%s\\n' '' 'blacklist hfs' >> /etc/modprobe.d/60-hfs.conf"
    },
    {
      "id": "1.1.1.4",
      "title": "Ensure hfsplus kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "hfsplus",
      "expected_status": "not_available",
      "cis_reference": "CIS Amazon Linux 2 - 1.1.1.4 | Level 1",
      "description": "The hfsplus filesystem type is a hierarchical filesystem designed to replace hfs that allows you to mount Mac OS filesystems. Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "remediation": "Run the following commands to unload and disable the hfsplus kernel module:\n# modprobe -r hfsplus 2>/dev/null\n# rmmod hfsplus 2>/dev/null\n# printf '%s\\n' '' 'install hfsplus /bin/false' >> /etc/modprobe.d/60-hfsplus.conf\n# printf '%s\\n' '' 'blacklist hfsplus' >> /etc/modprobe.d/60-hfsplus.conf"
    },
    {
      "id": "1.1.1.5",
      "title": "Ensure jffs2 kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "jffs2",
      "expected_status": "not_available",
      "cis_reference": "CIS Amazon Linux 2 - 1.1.1.5 | Level 1",
      "description": "The jffs2 (journaling flash filesystem 2) filesystem type is a log-structured filesystem used in flash memory devices. Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "remediation": "Run the following commands to unload and disable the jffs2 kernel module:\n# modprobe -r jffs2 2>/dev/null\n# rmmod jffs2 2>/dev/null\n# printf '%s\\n' '' 'install jffs2 /bin/false' >> /etc/modprobe.d/60-jffs2.conf\n# printf '%s\\n' '' 'blacklist jffs2' >> /etc/modprobe.d/60-jffs2.conf"
    },
    {
      "id": "1.1.1.6",
      "title": "Ensure squashfs kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "squashfs",
      "expected_status": "not_available",
      "cis_reference": "CIS Amazon Linux 2 - 1.1.1.6 | Level 1",
      "description": "The squashfs filesystem type is a compressed read-only Linux filesystem. Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "remediation": "Run the following commands to unload and disable the squashfs kernel module:\n# modprobe -r squashfs 2>/dev/null\n# rmmod squashfs 2>/dev/null\n# printf '%s\\n' '' 'install squashfs /bin/false' >> /etc/modprobe.d/60-squashfs.conf\n# printf '%s\\n' '' 'blacklist squashfs' >> /etc/modprobe.d/60-squashfs.conf"
    },
    {
      "id": "1.1.1.7",
      "title": "Ensure udf kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "udf",
      "expected_status": "not_available",
      "cis_reference": "CIS Amazon Linux 2 - 1.1.1.7 | Level 1",
      "description": "The udf (Universal Disk Format) filesystem type is used to implement the ISO/IEC 13346 and ECMA-167 specifications. Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "remediation": "Run the following commands to unload and disable the udf kernel module:\n# modprobe -r udf 2>/dev/null\n# rmmod udf 2>/dev/null\n# printf '%s\\n' '' 'install udf /bin/false' >> /etc/modprobe.d/60-udf.conf\n# printf '%s\\n' '' 'blacklist udf' >> /etc/modprobe.d/60-udf.conf"
    },
    {
      "id": "1.1.1.8",
      "title": "Ensure usb-storage kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "usb-storage",
      "expected_status": "not_available",
      "cis_reference": "CIS Amazon Linux 2 - 1.1.1.8 | Level 1",
      "description": "USB storage provides a means to access removable storage devices. Disabling USB storage on systems that do not require it reduces the attack surface.",
      "remediation": "Run the following commands to unload and disable the usb-storage kernel module:\n# modprobe -r usb-storage 2>/dev/null\n# rmmod usb-storage 2>/dev/null\n# printf '%s\\n' '' 'install usb-storage /bin/false' >> /etc/modprobe.d/60-usb-storage.conf\n# printf '%s\\n' '' 'blacklist usb-storage' >> /etc/modprobe.d/60-usb-storage.conf"
    }
  ]
}