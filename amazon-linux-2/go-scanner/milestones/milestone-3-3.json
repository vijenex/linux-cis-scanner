{
  "milestone": "3.3",
  "version": "1.0.0",
  "description": "Amazon Linux 2 CIS Benchmark v3.0.0 - Section 3.3 Configure Network Kernel Parameters",
  "section": "3 Network",
  "controls": [
    {
      "id": "3.3.1",
      "title": "Ensure ip forwarding is disabled",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "cis_reference": "CIS Amazon Linux 2 - 3.3.1 | Level1",
      "description": "IP forwarding permits the kernel to forward packets from one network interface to another. The ability to forward packets between two networks is only appropriate for systems acting as routers.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.ip_forward = 0",
      "parameter_name": "net.ipv4.ip_forward",
      "expected_value": "0"
    },
    {
      "id": "3.3.2",
      "title": "Ensure packet redirect sending is disabled",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "cis_reference": "CIS Amazon Linux 2 - 3.3.2 | Level1",
      "description": "ICMP redirects are used to send routing information to other hosts. As a host itself does not act as a router, there is no need to send redirects.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.conf.all.send_redirects = 0",
      "parameter_name": "net.ipv4.conf.all.send_redirects",
      "expected_value": "0"
    },
    {
      "id": "3.3.3",
      "title": "Ensure bogus icmp responses are ignored",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "cis_reference": "CIS Amazon Linux 2 - 3.3.3 | Level1",
      "description": "Ignoring bogus ICMP error responses reduces log size, although some activity would not be logged.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.icmp_ignore_bogus_error_responses = 1",
      "parameter_name": "net.ipv4.icmp_ignore_bogus_error_responses",
      "expected_value": "1"
    },
    {
      "id": "3.3.4",
      "title": "Ensure broadcast icmp requests are ignored",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "cis_reference": "CIS Amazon Linux 2 - 3.3.4 | Level1",
      "description": "Accepting ICMP echo and timestamp requests with broadcast or multicast destinations for your network could be used to trick your host into starting (or participating) in a Smurf attack.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.icmp_echo_ignore_broadcasts = 1",
      "parameter_name": "net.ipv4.icmp_echo_ignore_broadcasts",
      "expected_value": "1"
    },
    {
      "id": "3.3.5",
      "title": "Ensure icmp redirects are not accepted",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "cis_reference": "CIS Amazon Linux 2 - 3.3.5 | Level1",
      "description": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages contain unauthenticated data and could potentially be used to lure a host into sending traffic to an attacker controlled destination.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.conf.all.accept_redirects = 0",
      "parameter_name": "net.ipv4.conf.all.accept_redirects",
      "expected_value": "0"
    },
    {
      "id": "3.3.6",
      "title": "Ensure secure icmp redirects are not accepted",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "cis_reference": "CIS Amazon Linux 2 - 3.3.6 | Level1",
      "description": "Accepting secure ICMP redirects (from those gateways listed as default gateways) has few legitimate uses. It should be disabled unless it is absolutely required.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.conf.all.secure_redirects = 0",
      "parameter_name": "net.ipv4.conf.all.secure_redirects",
      "expected_value": "0"
    },
    {
      "id": "3.3.7",
      "title": "Ensure reverse path filtering is enabled",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "cis_reference": "CIS Amazon Linux 2 - 3.3.7 | Level1",
      "description": "Reverse Path Filtering protects against IP spoofing by ensuring packets are only accepted if the system would route a response packet back to the source through the same interface.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.conf.all.rp_filter = 1",
      "parameter_name": "net.ipv4.conf.all.rp_filter",
      "expected_value": "1"
    },
    {
      "id": "3.3.8",
      "title": "Ensure source routed packets are not accepted",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "cis_reference": "CIS Amazon Linux 2 - 3.3.8 | Level1",
      "description": "Source routed packets allow the sender to partially or completely specify the route packets take through the network. Accepting source routed packets can make the system vulnerable to attacks.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.conf.all.accept_source_route = 0",
      "parameter_name": "net.ipv4.conf.all.accept_source_route",
      "expected_value": "0"
    },
    {
      "id": "3.3.9",
      "title": "Ensure suspicious packets are logged",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "cis_reference": "CIS Amazon Linux 2 - 3.3.9 | Level1",
      "description": "When enabled, the system logs packets with un-routable source addresses to the kernel log. This helps detect potential attacks or misconfigurations.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.conf.all.log_martians = 1",
      "parameter_name": "net.ipv4.conf.all.log_martians",
      "expected_value": "1"
    },
    {
      "id": "3.3.10",
      "title": "Ensure tcp syn cookies is enabled",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "cis_reference": "CIS Amazon Linux 2 - 3.3.10 | Level1",
      "description": "TCP SYN cookies help protect against SYN flood attacks by enabling the system to continue responding to legitimate traffic even when under attack.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv4.tcp_syncookies = 1",
      "parameter_name": "net.ipv4.tcp_syncookies",
      "expected_value": "1"
    },
    {
      "id": "3.3.11",
      "title": "Ensure ipv6 router advertisements are not accepted",
      "section": "3.3 Configure Network Kernel Parameters",
      "profile": "Level1",
      "automated": true,
      "type": "SysctlParameter",
      "cis_reference": "CIS Amazon Linux 2 - 3.3.11 | Level1",
      "description": "Router advertisements can be used to configure IPv6 clients. Disabling acceptance of router advertisements helps prevent unauthorized network configuration.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: net.ipv6.conf.all.accept_ra = 0",
      "parameter_name": "net.ipv6.conf.all.accept_ra",
      "expected_value": "0"
    }
  ]
}