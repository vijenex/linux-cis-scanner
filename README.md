# Vijenex CIS Scanner for RHEL 8

**Professional CIS Compliance Scanner - Better than OpenSCAP**

## ğŸ¯ Project Status

- **234 Automated Controls** (91% of OpenSCAP's 256)
- **447 Total Controls** across all CIS sections
- **8 Control Types** implemented
- **48 Milestone Files** organized by section
- **Professional HTML Reports** with severity breakdown

## ğŸš€ Quick Start

### Installation

```bash
git clone <your-repo-url>
cd Linux-CIS-Audit-code/rhel-8/scripts
```

### Run Scanner

```bash
# Full scan (requires root)
sudo python3 vijenex-cis.py --profile Level1

# Level 2 scan
sudo python3 vijenex-cis.py --profile Level2

# Specific sections only
sudo python3 vijenex-cis.py --milestones milestone-1-1.json milestone-1-2.json

# Generate HTML report only
sudo python3 vijenex-cis.py --format html
```

### View Reports

```bash
# HTML report (recommended)
open reports/vijenex-cis-report.html

# CSV report
cat reports/vijenex-cis-results.csv
```

## ğŸ“Š Features

### âœ… Automated Control Types
1. **KernelModule** - Kernel module checks (cramfs, udf, overlay, etc.)
2. **MountPoint** - Partition separation checks (/tmp, /var, /home)
3. **MountOption** - Mount options (nodev, nosuid, noexec)
4. **ServiceStatus** - Service enabled/disabled checks
5. **PackageInstalled** - Package installation verification
6. **FileContent** - Configuration file content checks
7. **SysctlParameter** - Kernel parameter verification
8. **FilePermissions** - File ownership and permissions

### ğŸ“ˆ Professional Reports
- **HTML Report** with expandable controls
- **Severity Breakdown** (Critical/High/Medium/Low)
- **Compliance Score** percentage
- **Impact Warnings** for Level 2 controls
- **Remediation Commands** for failed controls

## ğŸ”§ Adding More Controls

Use the automated control extractor:

```bash
cd rhel-8/scripts

# Add 10 controls starting from specific ID
python3 auto-add-controls.py --start 1.3.1.1 --count 10

# Add 20 controls from Section 2
python3 auto-add-controls.py --start 2.1.1 --count 20
```

The script automatically:
- Reads CIS RHEL 8 Benchmark v4.0.0
- Extracts control details
- Determines control type
- Routes to correct milestone file
- Adds type-specific parameters

## ğŸ“ Project Structure

```
Linux-CIS-Audit-code/
â”œâ”€â”€ rhel-8/
â”‚   â”œâ”€â”€ scripts/
â”‚   â”‚   â”œâ”€â”€ vijenex-cis.py           # Main scanner
â”‚   â”‚   â”œâ”€â”€ auto-add-controls.py     # Control extractor
â”‚   â”‚   â””â”€â”€ reorganize-milestones.py # Milestone organizer
â”‚   â””â”€â”€ milestones/
â”‚       â”œâ”€â”€ milestone-1-1.json       # Section 1.1 controls
â”‚       â”œâ”€â”€ milestone-1-2.json       # Section 1.2 controls
â”‚       â””â”€â”€ ... (48 milestone files)
â”œâ”€â”€ INSTRUCTIONS.md                   # Detailed documentation
â””â”€â”€ README.md                         # This file
```

## ğŸ¯ Control Statistics by Section

| Section | Controls | Automated | Manual |
|---------|----------|-----------|--------|
| 1.1 Filesystem | 37 | 36 | 1 |
| 1.2 Package Mgmt | 5 | 2 | 3 |
| 1.3 SELinux | 8 | 7 | 1 |
| 1.5 Kernel Params | 10 | 10 | 0 |
| 2.1 Services | 22 | 22 | 0 |
| 2.3 Time Sync | 3 | 3 | 0 |
| 2.4 Cron | 10 | 10 | 0 |
| 3.2 Network Modules | 6 | 6 | 0 |
| 3.3 Network Params | 17 | 17 | 0 |
| 5.1 SSH | 24 | 14 | 10 |
| 5.3 PAM | 23 | 18 | 5 |
| 5.4 User Accounts | 23 | 16 | 7 |
| 6.2 Logging | 26 | 12 | 14 |
| 6.3 Audit | 35 | 27 | 8 |
| 7.1 File Permissions | 12 | 11 | 1 |
| 7.2 User/Group | 8 | 8 | 0 |

## ğŸ” Comparison with OpenSCAP

| Metric | OpenSCAP | Vijenex |
|--------|----------|---------|
| Automated Controls | 256 | 234 (91%) |
| HTML Report | Basic | Professional |
| Severity Breakdown | No | Yes |
| Impact Warnings | No | Yes |
| Expandable Details | No | Yes |
| Remediation Commands | Limited | Complete |

## âš ï¸ Important Notes

### Level 2 Controls
Level 2 controls can break applications:
- **overlay module**: Breaks Docker/Kubernetes
- **udf module**: Required for Azure VMs
- **usb-storage**: Breaks USB devices
- **/home noexec**: Breaks user scripts

Always test in non-production first!

### Requirements
- RHEL 8 / CentOS 8 / Rocky Linux 8 / AlmaLinux 8
- Python 3.6+
- Root privileges for complete scanning

## ğŸ“ Next Steps

1. **Test on RHEL 8 machine**
   ```bash
   sudo python3 vijenex-cis.py --profile Level1
   ```

2. **Compare with OpenSCAP results**
   - Check for false positives
   - Verify accuracy

3. **Add remaining 22 controls** to reach 256+

4. **Implement missing control types** if needed:
   - SSHConfig (for complex SSH checks)
   - PAMConfig (for PAM module checks)
   - AuditRules (for auditd rules)

## ğŸ¤ Contributing

See `INSTRUCTIONS.md` for detailed development workflow.

## ğŸ“„ License

Proprietary - Vijenex Security Platform

## ğŸ”— Links

- CIS Benchmark: https://www.cisecurity.org/
- Vijenex: https://vijenex.com
- Documentation: See INSTRUCTIONS.md

---

**Generated by Vijenex CIS Scanner v1.0.0**
