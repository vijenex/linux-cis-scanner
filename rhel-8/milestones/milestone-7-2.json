{
  "milestone": "7.2",
  "version": "1.0.0",
  "description": "RHEL 8 CIS Benchmark v4.0.0 - Section 7.2",
  "controls": [
    {
      "id": "7.2.1",
      "title": "Ensure accounts in /etc/passwd use shadowed passwords\\",
      "automated": true,
      "profile": "Level1",
      "section": "7.2",
      "description": "\\\n\n\\f2\\b0 Local accounts can use shadowed passwords. With shadowed passwords, the\\\npasswords are saved in shadow password file, \n\\f0 \\cf4 /etc/shadow\n\\f2 \\cf2 , encrypted by a salted\\\none-way hash. Accounts with a shadowed password have an \n\\f0 \\cf4 x\n\\f2 \\cf2  in the second field in\\\n\n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2 .\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2  file also contains information like user ID's and group ID's that are\\\nused by many system programs. Therefore, the \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2  file must remain world\\\nreadable. In spite of encoding the password with a randomly-generated one-way hash\\\nfunction, an attacker could still break the system if they got access to the \n\\f0 \\cf4 /etc/passwd\\\n\n\\f2 \\cf2 file. This can be mitigated by using shadowed passwords, thus moving the passwords in\\\nt",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command and verify that no output is returned:\\\n\n\\f4\\fs20\\fsmilli10080 # awk -F: '($2 != \"x\" ) \\{ print \"User: \\\\\"\" $1 \"\\\\\" is not set to shadowed\\\npasswords \"\\}' /etc/passwd\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to set accounts to use shadowed passwords and migrate\\\npasswords in \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2  to \n\\f0 \\cf4 /etc/shadow\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # pwconv\\\n\n\\f2\\fs24 Investigate to determine if the account is logged in and what it is being used for, to\\\ndetermine if it needs to be forced off.\n\\fs20\\fsmilli10080 Page 1035\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: IA-5\\\n2. PWCONV(8)\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/passwd\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.2.1 | Level1"
    },
    {
      "id": "7.2.2",
      "title": "Ensure /etc/shadow password fields are not empty\\",
      "automated": true,
      "profile": "Level1",
      "section": "7.2",
      "description": "\\\n\n\\f2\\b0 An account with an empty password field means that anybody may log in as that user\\\nwithout providing a password.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 All accounts must have passwords or be locked to prevent the account from being used\\\nby an unauthorized user.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command and verify that no output is returned:\\\n\n\\f4\\fs20\\fsmilli10080 # awk -F: '($2 == \"\" ) \\{ print $1 \" does not have a password \"\\}' /etc/shadow\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 If any accounts in the \n\\f0 \\cf4 /etc/shadow\n\\f2 \\cf2  file do not have a password, run the following\\\ncommand to lock the account until it can be determined why it does not have a\\\npassword:\\\n\n\\f4\\fs20\\fsmilli10080 # passwd -l <username>\\\n\n\\f2\\fs24 Also, check to see if the account is logged in and investigate what it is being used for to\\\ndetermine if it needs to be forced off.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: CM-6 b\\\n2. NIST SP 800-53A :: CM-6.1 (iv)\\\n3. RHEL 8 STIG Vul ID: V-251706\\\n4. RHEL 8 STIG Rule ID: SV-251706r809342\n\\fs20\\fsmilli10080 Page 1038\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/shadow\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.2.2 | Level1"
    },
    {
      "id": "7.2.3",
      "title": "Ensure all groups in /etc/passwd exist in /etc/group\\",
      "automated": true,
      "profile": "Level1",
      "section": "7.2",
      "description": "\\\n\n\\f2\\b0 Over time, system administration errors and changes can lead to groups being defined\\\nin \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2  but not in \n\\f0 \\cf4 /etc/group\n\\f2 \\cf2  .\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Groups defined in the \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2  file but not in the \n\\f0 \\cf4 /etc/group\n\\f2 \\cf2  file pose a threat to\\\nsystem security since group permissions are not properly managed.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify all GIDs in \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2  exist in \n\\f0 \\cf4 /etc/group\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\na_passwd_group_gid=(\"$(awk -F: '\\{print $4\\}' /etc/passwd | sort -u)\")\\\na_group_gid=(\"$(awk -F: '\\{print $3\\}' /etc/group | sort -u)\")\\\na_passwd_group_diff=(\"$(printf '%s\\\\n' \"$\\{a_group_gid[@]\\}\"\\\n\"$\\{a_passwd_group_gid[@]\\}\" | sort | uniq -u)\")\\\nwhile IFS= read -r l_gid; do\\\nawk -F: '($4 == '\"$l_gid\"') \\{print \" - Use",
      "remediation": "\\\n\n\\f2\\b0 Analyze the output of the Audit step above and perform the appropriate action to correct\\\nany discrepancies found.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\n\\fs20\\fsmilli10080 Page 1040\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/passwd",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.2.3 | Level1"
    },
    {
      "id": "7.2.4",
      "title": "Ensure no duplicate UIDs exist",
      "automated": true,
      "profile": "Level1",
      "section": "7.2",
      "description": "\\\n\n\\f2\\b0 Although the \n\\f0 \\cf4 useradd\n\\f2 \\cf2  program will not let you create a duplicate User ID (UID), it is\\\npossible for an administrator to manually edit the \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2  file and change the UID\\\nfield.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Users must be assigned unique UIDs for accountability and to ensure appropriate\\\naccess protections.\\\nSatisfies: SRG-OS-000104-GPOS-00051, SRG-OS-000121-GPOS-00062, SRG-OS-\\\n000042-GPOS-00020\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script and verify no results are returned:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nwhile read -r l_count l_uid; do\\\nif [ \"$l_count\" -gt 1 ]; then\\\necho -e \"Duplicate UID: \\\\\"$l_uid\\\\\" Users: \\\\\"$(awk -F: '($3 == n) \\{\\\nprint $1 \\}' n=$l_uid /etc/passwd | xargs)\\\\\"\"\\\nfi\\\ndone < <(cut -f3 -d\":\" /etc/passwd | sort -n | uniq -c)\\\n\\}\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Based on the results of the audit script, establish unique UIDs and review all files owned\\\nby the shared UIDs to determine which UID they are supposed to belong to.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: IA-2\\\n2. NIST SP 800-53A :: IA-2.1\\\n3. RHEL 8 STIG Vul ID: V-230371\\\n4. RHEL 8 STIG Rule ID: SV-230371r627750\n\\fs20\\fsmilli10080 Page 1042\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/passwd",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.2.4 | Level1"
    },
    {
      "id": "7.2.5",
      "title": "Ensure no duplicate GIDs exist",
      "automated": true,
      "profile": "Level1",
      "section": "7.2",
      "description": "\\\n\n\\f2\\b0 Although the \n\\f0 \\cf4 groupadd\n\\f2 \\cf2  program will not let you create a duplicate Group ID (GID), it is\\\npossible for an administrator to manually edit the \n\\f0 \\cf4 /etc/group\n\\f2 \\cf2  file and change the GID\\\nfield.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 User groups must be assigned unique GIDs for accountability and to ensure appropriate\\\naccess protections.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script and verify no results are returned:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nwhile read -r l_count l_gid; do\\\nif [ \"$l_count\" -gt 1 ]; then\\\necho -e \"Duplicate GID: \\\\\"$l_gid\\\\\" Groups: \\\\\"$(awk -F: '($3 == n) \\{\\\nprint $1 \\}' n=$l_gid /etc/group | xargs)\\\\\"\"\\\nfi\\\ndone < <(cut -f3 -d\":\" /etc/group | sort -n | uniq -c)\\\n\\}\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Based on the results of the audit script, establish unique GIDs and review all files\\\nowned by the shared GID to determine which group they are supposed to belong to.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/group",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.2.5 | Level1"
    },
    {
      "id": "7.2.6",
      "title": "Ensure no duplicate user names exist",
      "automated": true,
      "profile": "Level1",
      "section": "7.2",
      "description": "\\\n\n\\f2\\b0 Although the \n\\f0 \\cf4 useradd\n\\f2 \\cf2  program will not let you create a duplicate user name, it is\\\npossible for an administrator to manually edit the \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2  file and change the\\\nusername.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 If a user is assigned a duplicate user name, it will create and have access to files with\\\nthe first UID for that username in \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2  . For example, if \"test4\" has a UID of\\\n1000 and a subsequent \"test4\" entry has a UID of 2000, logging in as \"test4\" will use\\\nUID 1000. Effectively, the UID is shared, which is a security problem.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script and verify no results are returned:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nwhile read -r l_count l_user; do\\\nif [ \"$l_count\" -gt 1 ]; then\\\necho -e \"Duplicate User: \\\\\"$l_user\\\\\" Users: \\\\\"$(awk -F: '($1 == n) \\{\\\nprint $1 \\}' n=$l_user /etc/passwd | xargs)\\\\\"\"\\\nfi\\\ndone < <(cut -f1 -d\":\" /etc/passwd | sort -n | uniq -c)\\\n\\}\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Based on the results of the audit script, establish unique user names for the users. File\\\nownerships will automatically reflect the change as long as the users have unique UIDs.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\n\\fs20\\fsmilli10080 Page 1046\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/passwd",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.2.6 | Level1"
    },
    {
      "id": "7.2.7",
      "title": "Ensure no duplicate group names exist",
      "automated": true,
      "profile": "Level1",
      "section": "7.2",
      "description": "\\\n\n\\f2\\b0 Although the \n\\f0 \\cf4 groupadd\n\\f2 \\cf2  program will not let you create a duplicate group name, it is\\\npossible for an administrator to manually edit the \n\\f0 \\cf4 /etc/group\n\\f2 \\cf2  file and change the group\\\nname.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 If a group is assigned a duplicate group name, it will create and have access to files\\\nwith the first GID for that group in \n\\f0 \\cf4 /etc/group\n\\f2 \\cf2  . Effectively, the GID is shared, which is\\\na security problem.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script and verify no results are returned:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nwhile read -r l_count l_group; do\\\nif [ \"$l_count\" -gt 1 ]; then\\\necho -e \"Duplicate Group: \\\\\"$l_group\\\\\" Groups: \\\\\"$(awk -F: '($1 ==\\\nn) \\{ print $1 \\}' n=$l_group /etc/group | xargs)\\\\\"\"\\\nfi\\\ndone < <(cut -f1 -d\":\" /etc/group | sort -n | uniq -c)\\\n\\}\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Based on the results of the audit script, establish unique names for the user groups. File\\\ngroup ownerships will automatically reflect the change as long as the groups have\\\nunique GIDs.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\n\\fs20\\fsmilli10080 Page 1048\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/group",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.2.7 | Level1"
    },
    {
      "id": "7.2.9",
      "title": "Ensure local interactive user dot files access is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "7.2",
      "description": "\\\n\n\\f2\\b0 While the system administrator can establish secure permissions for users' \"dot\" files,\\\nthe users can easily override these.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 .forward\n\\f2 \\cf2  file specifies an email address to forward the user's mail to.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 .rhost\n\\f2 \\cf2  file provides the \"remote authentication\" database for the rcp, rlogin, and\\\nrsh commands and the rcmd() function. These files bypass the standard\\\npassword-based user",
      "rationale": "\\\n\n\\f2\\b0 User configuration files with excessive or incorrect access may enable malicious users\\\nto steal or modify other users' data or to gain another user's system privileges.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify local interactive user dot files:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Don't include \n\\f0 \\cf4 .forward\n\\f2 \\cf2 , \n\\f0 \\cf4 .rhost\n\\f2 \\cf2 , or \n\\f0 \\cf4 .netrc\n\\f2 \\cf2  files\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Are mode 0644 or more restrictive\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Are owned by the local interactive user\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Are group owned by the user's primary group\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f",
      "remediation": "\\\n\n\\f2\\b0 Making global modifications to users' files without alerting the user community can result\\\nin unexpected outages and unhappy users. Therefore, it is recommended that a\\\nmonitoring policy be established to report user dot file permissions and determine the\\\naction to be taken in accordance with site policy.\\\nThe following script will:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 remove excessive permissions on \n\\f0 \\cf4 dot\n\\f2 \\cf2  files within interactive users' home\\\ndirectories\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 change ownership of \n\\f0 \\cf4 dot\n\\f2 \\cf2  files within interactive users' home directories to the\\\nuser\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 change group ownership of \n\\f0 \\cf4 dot\n\\f2 \\cf2  files within interactive users' home directories to\\\nthe user's prim",
      "references": "",
      "type": "FileContent",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.2.9 | Level1",
      "file_path": "/etc/profile"
    }
  ]
}