{
  "milestone": "1.8",
  "title": "GNOME Display Manager",
  "controls": [
    {
      "control_id": "1.8.1",
      "title": "Ensure GNOME Display Manager is removed",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server",
      "description": "The GNOME Display Manager (GDM) is a program that manages graphical display servers and handles graphical user logins.",
      "rationale": "If a graphical login is not required, it is recommended that GDM be removed to reduce the attack surface of the system.",
      "audit": "Run the following command to verify gdm is not installed:\n# rpm -q gdm\npackage gdm is not installed",
      "remediation": "Run the following command to remove gdm:\n# dnf remove gdm",
      "impact": "Removing the GNOME Display Manager will prevent graphical logins to the system.",
      "default_value": "N/A",
      "references": "1. https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/",
      "cis_controls": "v8: 4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software\nv7: 9.2 Ensure Only Approved Ports, Protocols and Services Are Running",
      "check_type": "PackageNotInstalled",
      "check_value": "gdm"
    },
    {
      "control_id": "1.8.2",
      "title": "Ensure GDM login banner is configured",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Workstation",
      "description": "GDM is the GNOME Display Manager which handles graphical login for GNOME based systems.",
      "rationale": "Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place.",
      "audit": "If GDM is installed on the system verify the banner-message-enable and banner-message-text options are configured:\n# grep banner-message /etc/dconf/db/gdm.d/*\nbanner-message-enable=true\nbanner-message-text='Authorized uses only. All activity may be monitored and reported.'",
      "remediation": "Edit or create the file /etc/dconf/profile/gdm and add:\nuser-db:user\nsystem-db:gdm\nfile-db:/usr/share/gdm/greeter-dconf-defaults\nCreate or edit the banner message in /etc/dconf/db/gdm.d/01-banner-message:\n[org/gnome/login-screen]\nbanner-message-enable=true\nbanner-message-text='Authorized uses only. All activity may be monitored and reported.'\nRun the following command to update the system databases:\n# dconf update",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/",
      "cis_controls": "v8: 4.1 Establish and Maintain a Secure Configuration Process\nv7: 5.1 Establish Secure Configurations",
      "check_type": "Manual",
      "check_value": ""
    },
    {
      "control_id": "1.8.3",
      "title": "Ensure GDM disable-user-list option is enabled",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Workstation",
      "description": "The GNOME Display Manager (GDM) can allow users to be selected from a list, which can be convenient for systems with a small number of users.",
      "rationale": "Disabling the user list prevents system information from being displayed to unauthorized users.",
      "audit": "If GDM is installed on the system verify the disable-user-list option is enabled:\n# grep disable-user-list /etc/dconf/db/gdm.d/*\ndisable-user-list=true",
      "remediation": "Edit or create the file /etc/dconf/db/gdm.d/00-login-screen and add:\n[org/gnome/login-screen]\ndisable-user-list=true\nRun the following command to update the system databases:\n# dconf update",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/",
      "cis_controls": "v8: 4.1 Establish and Maintain a Secure Configuration Process\nv7: 5.1 Establish Secure Configurations",
      "check_type": "Manual",
      "check_value": ""
    },
    {
      "control_id": "1.8.4",
      "title": "Ensure GDM screen locks when the user is idle",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Workstation",
      "description": "The idle-delay setting controls the amount of time a session can be idle before the screen is locked.",
      "rationale": "Setting the idle-delay to an appropriate value helps protect the system from unauthorized access.",
      "audit": "If GDM is installed on the system verify the idle-delay setting is configured:\n# grep -E 'idle-delay|lock-delay' /etc/dconf/db/local.d/*\nidle-delay=uint32 900\nlock-delay=uint32 5",
      "remediation": "Create or edit a file in /etc/dconf/db/local.d/ and add:\n[org/gnome/desktop/session]\nidle-delay=uint32 900\n[org/gnome/desktop/screensaver]\nlock-delay=uint32 5\nRun the following command to update the system databases:\n# dconf update",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/",
      "cis_controls": "v8: 4.3 Configure Automatic Session Locking on Enterprise Assets\nv7: 16.11 Lock Workstation Sessions After Inactivity",
      "check_type": "Manual",
      "check_value": ""
    },
    {
      "control_id": "1.8.5",
      "title": "Ensure GDM screen locks cannot be overridden",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Workstation",
      "description": "The idle and lock settings can be locked to prevent users from changing them.",
      "rationale": "Locking the settings prevents users from disabling the screen lock.",
      "audit": "If GDM is installed verify the locks are configured:\n# grep -E 'idle-delay|lock-delay' /etc/dconf/db/local.d/locks/*\n/org/gnome/desktop/session/idle-delay\n/org/gnome/desktop/screensaver/lock-delay",
      "remediation": "Create or edit a file in /etc/dconf/db/local.d/locks/ and add:\n/org/gnome/desktop/session/idle-delay\n/org/gnome/desktop/screensaver/lock-delay\nRun the following command to update the system databases:\n# dconf update",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/",
      "cis_controls": "v8: 4.3 Configure Automatic Session Locking on Enterprise Assets\nv7: 16.11 Lock Workstation Sessions After Inactivity",
      "check_type": "Manual",
      "check_value": ""
    },
    {
      "control_id": "1.8.6",
      "title": "Ensure GDM automatic mounting of removable media is disabled",
      "level": 1,
      "scored": false,
      "profile_applicability": "Level 1 - Workstation",
      "description": "By default, GNOME automatically mounts removable media when inserted as a convenience to the user.",
      "rationale": "With automounting enabled anyone with physical access could attach a USB drive or disc and have its contents available in system even if they lacked permissions to mount it themselves.",
      "audit": "If GDM is installed verify automount is disabled:\n# grep -E 'automount|automount-open' /etc/dconf/db/local.d/*\nautomount=false\nautomount-open=false",
      "remediation": "Create or edit a file in /etc/dconf/db/local.d/ and add:\n[org/gnome/desktop/media-handling]\nautomount=false\nautomount-open=false\nRun the following command to update the system databases:\n# dconf update",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/",
      "cis_controls": "v8: 4.1 Establish and Maintain a Secure Configuration Process\nv7: 8.4 Configure Anti-Malware Scanning of Removable Devices",
      "check_type": "Manual",
      "check_value": ""
    },
    {
      "id": "1.8.7",
      "title": "Ensure Xwayland is configured",
      "automated": true,
      "profile": "Level2",
      "section": "1.8",
      "description": "\\\n\n\\f2\\b0 Xwayland is a compatibility layer that allows legacy X11 applications to run within a\\\nWayland environment. It's effectively an X server that runs as a Wayland client,\\\nenabling existing X11 software to be displayed on a Wayland compositor.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Wayland's security benefits from not relying on X11's network listener. Without X11,\\\nthere's no network listener, making it harder for malicious actors to exploit vulnerabilities\\\nin X11. However, enabling Xwayland (running X11 applications on Wayland) introduces\\\nX11's security concerns.\\\nAll X vulnerabilities apply to Xwayland, including keylogging, but they only affect X\\\nwindows and interactions with them.\\\nMalware can potentially exploit Xwayland vulnerabilities to keylog or inte",
      "impact": "\\\n\n\\f2\\b0 Many applications haven't been ported to Wayland yet, and Xwayland makes it possible\\\nto run these applications without requiring a full switch back to X11. Disabling Xwayland\\\nfunctionality may cause these applications to fail.\\\n\n\\f1\\b",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify Xwayland is not enabled:\\\n\n\\f4\\fs20\\fsmilli10080 # sed -n '/\\\\[daemon\\\\]/,/\\\\[/p' /etc/gdm/custom.conf | grep -Psi\\\n'^\\\\h*waylandenable\\\\b'\\\n\n\\f2\\fs24 Verify output includes:\\\n\n\\f4\\fs20\\fsmilli10080 WaylandEnable=false\n\\f2 Page 285\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Edit the file \n\\f0 \\cf4 /etc/gdm/custom.conf\n\\f2 \\cf2  and uncomment or add the following line in the\\\n\n\\f0 \\cf4 [daemon]\n\\f2 \\cf2  block:\\\n\n\\f4\\fs20\\fsmilli10080 WaylandEnable=false\\\n\n\\f3\\i\\fs24 Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # GDM configuration storage\\\n[daemon]\\\nWaylandEnable=false\\\n[security]\\\n[xdmcp]\\\n[chooser]\\\n[debug]\\\n# Uncomment the line below to turn on debugging\\\n#Enable=true\\\n\n\\f1\\b\\fs24",
      "references": "",
      "type": "FileContent",
      "file_path": "/etc/gdm/custom.conf",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.8.7 | Level2"
    }
  ]
}