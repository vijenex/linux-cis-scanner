{
  "milestone": "2-1",
  "section": "2.1 Time Synchronization",
  "description": "Configure time synchronization services",
  "controls": [
    {
      "id": "2.1.1",
      "title": "Ensure time synchronization is in use",
      "section": "2.1 Time Synchronization",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.1.1",
      "description": "System time should be synchronized between all systems. This is typically done by establishing an authoritative time server or set of servers and having all systems synchronize their clocks to them.",
      "remediation": "Install chrony or ntp: yum install chrony"
    },
    {
      "id": "2.1.2",
      "title": "Ensure chrony is configured",
      "section": "2.1 Time Synchronization",
      "type": "ServiceConfig",
      "profile": "Level1",
      "service_name": "chronyd",
      "config_file": "/etc/chrony.conf",
      "expected_status": "configured",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.1.2",
      "description": "chrony is a daemon which implements the Network Time Protocol (NTP). It is designed to synchronize system clocks across a variety of systems and use a source that is highly accurate.",
      "remediation": "Configure /etc/chrony.conf with appropriate time servers and restart chronyd service"
    },
    {
      "id": "2.1.3",
      "title": "Ensure chrony is running as user _chrony",
      "section": "2.1 Time Synchronization",
      "type": "ServiceUser",
      "profile": "Level1",
      "service_name": "chronyd",
      "expected_user": "_chrony",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.1.3",
      "description": "The chronyd service should run as a dedicated user account to minimize security risks.",
      "remediation": "Edit /etc/sysconfig/chronyd and ensure OPTIONS includes -u _chrony"
    },
    {
      "id": "2.1.4",
      "title": "Ensure chrony is enabled and running",
      "section": "2.1 Time Synchronization",
      "type": "ServiceStatus",
      "profile": "Level1",
      "service_name": "chronyd",
      "expected_status": "enabled",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.1.4",
      "description": "chronyd should be enabled and running to ensure time synchronization.",
      "remediation": "Run: systemctl --now enable chronyd"
    }
  ]
}
