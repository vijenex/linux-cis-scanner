{
  "milestone": "1.3",
  "section": "1.2-1.3 Package Management & Filesystem Integrity",
  "title": "Configure Package Management and Filesystem Integrity Checking",
  "controls": [
    {
      "id": "1.2.1",
      "title": "Ensure GPG keys are configured",
      "section": "1.2 Package Management",
      "profile": "Level1",
      "type": "Manual",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.2.1",
      "remediation": "Run: rpm -q gpg-pubkey --qf '%{name}-%{version}-%{release} --> %{summary}\\n'",
      "description": "Verify GPG keys are properly configured for package verification"
    },
    {
      "id": "1.2.2",
      "title": "Ensure gpgcheck is globally activated",
      "section": "1.2 Package Management",
      "profile": "Level1",
      "type": "Manual",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.2.2",
      "remediation": "Edit /etc/dnf/dnf.conf and set gpgcheck=1",
      "description": "Verify gpgcheck is enabled in /etc/dnf/dnf.conf"
    },
    {
      "id": "1.2.3",
      "title": "Ensure repo_gpgcheck is globally activated",
      "section": "1.2 Package Management",
      "profile": "Level2",
      "type": "Manual",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.2.3",
      "remediation": "Edit /etc/dnf/dnf.conf and set repo_gpgcheck=1",
      "description": "Verify repo_gpgcheck is enabled for repository metadata verification"
    },
    {
      "id": "1.3.1",
      "title": "Ensure AIDE is installed",
      "section": "1.3 Filesystem Integrity",
      "profile": "Level1",
      "type": "Manual",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.3.1",
      "remediation": "Run: dnf install aide && aide --init && mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz",
      "description": "Verify AIDE (Advanced Intrusion Detection Environment) is installed"
    },
    {
      "id": "1.3.2",
      "title": "Ensure filesystem integrity is regularly checked",
      "section": "1.3 Filesystem Integrity",
      "profile": "Level1",
      "type": "Manual",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.3.2",
      "remediation": "Configure cron job: 0 5 * * * /usr/sbin/aide --check",
      "description": "Verify AIDE runs regularly via cron or systemd timer"
    },
    {
      "id": "1.3.3",
      "title": "Ensure cryptographic mechanisms are used to protect the integrity of audit tools",
      "section": "1.3 Filesystem Integrity",
      "profile": "Level1",
      "type": "Manual",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.3.3",
      "remediation": "Add audit tools to AIDE configuration: /sbin/auditctl, /sbin/auditd, /sbin/ausearch, /sbin/aureport, /sbin/autrace, /sbin/augenrules",
      "description": "Verify audit tools are monitored by AIDE for integrity"
    }
  ]
}
