{
  "milestone": "1.3",
  "version": "1.0.0",
  "description": "RHEL 8 CIS Benchmark v4.0.0 - Section 1.3",
  "controls": [
    {
      "id": "1.3.1.1",
      "title": "Ensure SELinux is installed",
      "automated": true,
      "profile": "Level1",
      "section": "1.3",
      "description": "\\\n\n\\f2\\b0 SELinux provides Mandatory Access Control.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Without a Mandatory Access Control system installed only the default Discretionary\\\nAccess Control system will be available.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Verify SELinux is installed.\\\nRun the following command:\\\n\n\\f4\\fs20\\fsmilli10080 # rpm -q libselinux\\\nlibselinux-<version>\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to install \n\\f0 \\cf4 SELinux\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # dnf install libselinux\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 145\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.3.1.1 | Level1",
      "package_name": "libselinux"
    },
    {
      "id": "1.3.1.2",
      "title": "Ensure SELinux is not disabled in bootloader configuration\\",
      "automated": true,
      "profile": "Level1",
      "section": "1.3",
      "description": "\\\n\n\\f2\\b0 Configure SELINUX to be enabled at boot time and verify that it has not been\\\noverwritten by the grub boot parameters.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 SELinux must be enabled at boot time in your grub configuration to ensure that the\\\ncontrols it provides are not overridden.\\\n\n\\f1\\b",
      "impact": "\\\n\n\\f2\\b0 Files created while SELinux is disabled are not labeled at all. This behavior causes\\\nproblems when changing to enforcing mode because files are labeled incorrectly or are\\\nnot labeled at all. To prevent incorrectly labeled and unlabeled files from causing\\\nproblems, file systems are autom",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that neither the \n\\f0 \\cf4 selinux=0\n\\f2 \\cf2  or \n\\f0 \\cf4 enforcing=0\\\n\n\\f2 \\cf2 parameters have been set:\\\n\n\\f4\\fs20\\fsmilli10080 # grubby --info=ALL | grep -Po '(selinux|enforcing)=0\\\\b'\\\n\n\\f2\\fs24 Nothing should be returned\\\nRun the following command to verify the \n\\f0 \\cf4 selinux=0\n\\f2 \\cf2  and \n\\f0 \\cf4 enforcing=0\n\\f2 \\cf2  parameters\\\nwere not configured by the deprecated \n\\f0 \\cf4 grub2-mkconfig\n\\f2 \\cf2  command:\\\n\n\\f4\\fs20\\fsmilli10080 ",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to remove the \n\\f0 \\cf4 selinux=0\n\\f2 \\cf2  and \n\\f0 \\cf4 enforcing=0\n\\f2 \\cf2  parameters:\\\n\n\\f4\\fs20\\fsmilli10080 grubby --update-kernel ALL --remove-args \"selinux=0 enforcing=0\"\\\n\n\\f2\\fs24 Run the following command to remove the \n\\f0 \\cf4 selinux=0\n\\f2 \\cf2  and \n\\f0 \\cf4 enforcing=0\n\\f2 \\cf2  parameters if\\\nthey were created by the deprecated \n\\f0 \\cf4 grub2-mkconfig\n\\f2 \\cf2  command:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Prsq --\\\n'^\\\\h*([^#\\\\n\\\\r]+\\\\h+)?kernelopts=([^#\\\\n\\\\r]+\\\\h+)?(selinux|enforcing)=0\\\\b'\\\n/boot/grub2 /boot/efi && grub2-mkconfig -o \"$(grep -Prl --\\\n'\\\\h*([^#\\\\n\\\\r]+\\\\h+)?kernelopts=([^#\\\\n\\\\r]+\\\\h+)?(selinux|enforcing)=0\\\\b'\\\n/boot/grub2 /boot/efi)\"\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\\\n\n\\f1\\b",
      "type": "FileContent",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.3.1.2 | Level1",
      "file_path": "/etc/cron.d/aide"
    },
    {
      "id": "1.3.1.3",
      "title": "Ensure SELinux policy is configured",
      "automated": true,
      "profile": "Level1",
      "section": "1.3",
      "description": "\\\n\n\\f2\\b0 Configure SELinux to meet or exceed the default targeted policy, which constrains\\\ndaemons and system software only.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Security configuration requirements vary from site to site. Some sites may mandate a\\\npolicy that is stricter than the default policy, which is perfectly acceptable. This item is\\\nintended to ensure that at least the default recommendations are met.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify SELinux policy is set to \n\\f0 \\cf4 targeted\n\\f2 \\cf2  or \n\\f0 \\cf4 mls\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Psi --\\\n'^\\\\h*SELINUXTYPE\\\\h*=\\\\h*(targeted|mls)\\\\b' /etc/selinux/config\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 SELINUXTYPE=targeted\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Edit \n\\f0 \\cf4 /etc/selinux/config\n\\f2 \\cf2  and add set the SELINUXTYPE line to \n\\f0 \\cf4 targeted\n\\f2 \\cf2  or \n\\f0 \\cf4 mls\n\\f2 \\cf2 :\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 SELINUXTYPE=targeted\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/selinux/config\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.3.1.3 | Level1"
    },
    {
      "id": "1.3.1.4",
      "title": "Ensure the SELinux mode is not disabled",
      "automated": true,
      "profile": "Level1",
      "section": "1.3",
      "description": "\\\n\n\\f2\\b0 SELinux can run in one of three modes: disabled, permissive, or enforcing:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 Enforcing\n\\f2 \\cf2  - Is the default, and recommended, mode of operation; in enforcing\\\nmode SELinux operates normally, enforcing the loaded security policy on the\\\nentire system.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 Permissive\n\\f2 \\cf2  - The system acts as if SELinux is enforcing the loaded security\\\npolicy, including labeling objects and emitting ac",
      "rationale": "\\\n\n\\f2\\b0 Running SELinux in disabled mode is strongly discouraged; not only does the system\\\navoid enforcing the SELinux policy, it also avoids labeling any persistent objects such\\\nas files, making it difficult to enable SELinux in the future.\n\\fs20\\fsmilli10080 Page 152\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 1. Run the following command to verify SELinux's configured mode:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Pi --\\\n'^\\\\h*SELINUX=(enforcing|permissive)\\\\b' /etc/selinux/config\\\n\n\\f2\\fs24 Verify the output is:\\\n\n\\f4\\fs20\\fsmilli10080 SELINUX=enforcing\\\n-OR-\\\nSELINUX=permissive\\\n\n\\f2\\fs24 2. Run the following command to verify SELinux's current running mode:\\\n\n\\f4\\fs20\\fsmilli10080 # getenforce\\\n\n\\f2\\fs24 Verify the output is:\\\n\n\\f4\\fs20\\fsmilli10080 Enforcing\\\n-OR-\\\nPermissive\n\\f2 Page 153\\\n\n\\f0 ",
      "remediation": "\\\n\n\\f2\\b0 1. Edit \n\\f0 \\cf4 /etc/selinux/config\n\\f2 \\cf2  and update the SELINUX parameter to either\\\n\n\\f0 \\cf4 SELINUX=enforcing\n\\f2 \\cf2  or \n\\f0 \\cf4 SELINUX=permissive\n\\f2 \\cf2 :\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 SELINUX=enforcing\\\n\n\\f2\\fs24 2. Update the SELinux running state to either \n\\f0 \\cf4 enforcing\n\\f2 \\cf2  or \n\\f0 \\cf4 permissive\n\\f2 \\cf2 :\\\n\n\\f1\\b If SELinux is currently disabled:\\\n\n\\f2\\b0 Run the following command to create \n\\f0 \\cf4 /.autorelabel\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # touch /.autorelabel\\\n\n\\f2\\fs24 Run the following command to reboot the system:\\\n\n\\f4\\fs20\\fsmilli10080 # reboot\\\n\n\\f1\\b\\fs24 WARNING:\n\\f2\\b0  The \n\\f0 \\cf4 autorelabel\n\\f2 \\cf2  may be a long running process and require significant\\\ndowntime. This should be planed for before executing",
      "references": "\\\n\n\\f2\\b0 1. \\cf7 https://access.redhat.com/documentation/en-\\\nus/red_hat_enterprise_linux/7/html/selinux_users_and_administrators_guide/sect\\\n-security-enhanced_linux-introduction-selinux_modes\\\n\\cf2 2. NIST SP 800-53 :: SC-3\\\n3. NIST SP 800-53A :: SC-3.1 (ii)\n\\fs20\\fsmilli10080 Page 154\\\n\n\\f0 Inte",
      "type": "FileContent",
      "file_path": "/etc/selinux/config\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.3.1.4 | Level1"
    },
    {
      "id": "1.3.1.5",
      "title": "Ensure the SELinux mode is enforcing",
      "automated": true,
      "profile": "Level2",
      "section": "1.3",
      "description": "\\\n\n\\f2\\b0 SELinux can run in one of three modes: disabled, permissive, or enforcing:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 Enforcing\n\\f2 \\cf2  - Is the default, and recommended, mode of operation; in enforcing\\\nmode SELinux operates normally, enforcing the loaded security policy on the\\\nentire system.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 Permissive\n\\f2 \\cf2  - The system acts as if SELinux is enforcing the loaded security\\\npolicy, including labeling objects and emitting ac",
      "rationale": "\\\n\n\\f2\\b0 Running SELinux in disabled mode the system not only avoids enforcing the SELinux\\\npolicy, it also avoids labeling any persistent objects such as files, making it difficult to\\\nenable SELinux in the future.\\\nRunning SELinux in Permissive mode, though helpful for developing SELinux policy,\\\nonly logs access denial entries, but does not deny any operations.\\\nSatisfies: SRG-OS-000445-GPOS-00199, SRG-OS-000134-GPOS-00068\\\n\n\\f1\\b",
      "impact": "\\\n\n\\f2\\b0 Running SELinux in Enforcing mode may block intended access to files or processes if\\\nthe SELinux policy is not correctly configured. If this occurs, review the system logs for\\\ndetails and update labels or policy as appropriate.\n\\fs20\\fsmilli10080 Page 156\\\n\n\\f0 Internal Only - General\\\n\n",
      "audit_command": "\\\n\n\\f2\\b0 1. Run the following command to verify SELinux's configured mode:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Pi --\\\n'^\\\\h*SELINUX=enforcing\\\\b' /etc/selinux/config\\\nSELINUX=enforcing\\\n\n\\f2\\fs24 2. Run the following command to verify SELinux's current running mode:\\\n\n\\f4\\fs20\\fsmilli10080 # getenforce\\\nEnforcing\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 1. Edit \n\\f0 \\cf4 /etc/selinux/config\n\\f2 \\cf2  and update the SELINUX parameter to\\\n\n\\f0 \\cf4 SELINUX=enforcing\\\n\n\\f3\\i \\cf2 Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 SELINUX=enforcing\\\n\n\\f2\\fs24 2. Update the SELinux running state to \n\\f0 \\cf4 enforcing\n\\f2 \\cf2 :\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f1\\b\\fs24 If SELinux is currently disabled:\\\n\n\\f2\\b0 Run the following command to create \n\\f0 \\cf4 /.autorelabel\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # touch /.autorelabel\\\n\n\\f2\\fs24 Run the following command to reboot the system:\\\n\n\\f4\\fs20\\fsmilli10080 # reboot\\\n\n\\f1\\b\\fs24 WARNING:\n\\f2\\b0  The \n\\f0 \\cf4 autorelabel\n\\f2 \\cf2  may be a long running process and require significant\\\ndowntime. This should be planed for before executing the reboot!\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. \\cf7 https://access.redhat.com/documentation/en-\\\nus/red_hat_enterprise_linux/7/html/selinux_users_and_administrators_guide/sect\\\n-security-enhanced_linux-introduction-selinux_modes\\\n\\cf2 2. CCI-001084 | CCI-002696\\\n3. NIST SP 800-53 :: SC-3 | NIST SP 800-53 :: SI-6 a\\\n4. NIST SP 800-53",
      "type": "FileContent",
      "file_path": "/etc/selinux/config\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.3.1.5 | Level2"
    },
    {
      "id": "1.3.1.6",
      "title": "Ensure no unconfined services exist",
      "automated": false,
      "profile": "Level2",
      "section": "1.3",
      "description": "\\\n\n\\f2\\b0 Unconfined processes run in unconfined domains\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 For unconfined processes, SELinux policy rules are applied, but policy rules exist that\\\nallow processes running in unconfined domains almost all access. Processes running in\\\nunconfined domains fall back to using DAC rules exclusively. If an unconfined process\\\nis compromised, SELinux does not prevent an attacker from gaining access to system\\\nresources and data, but of course, DAC rules are still used. SELinux is a security\\\nenhancement on top of DAC rules \\'96 it does not replace th",
      "impact": "\\\n\n\\f2\\b0 Confining a service that inherently requires unconfined access to function may disrupt\\\nits intended operations. This restriction may lead to downtime, degraded performance,\\\nor loss in functionality. It is crucial to analyze and adjust SELinux policies in accordance\\\nwith site security po",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command and verify no output is produced:\\\n\n\\f4\\fs20\\fsmilli10080 # ps -eZ | grep unconfined_service_t\n\\f2 Page 159\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Investigate any unconfined processes found during the audit action. If necessary create\\\na customize SELinux policy to allow necessary actions for the service.\\\n\n\\f1\\b Warning:\n\\f2\\b0  Knowledge about creating and configuring SELinux policies is needed. A\\\nBasic example on how to create a policy is included below.\\\n1. Identify the unconfined service: determine the name and process of the service\\\n2. Identify the functionality: determine if the functionality is required for operations\\\n3. Create or add to the custom allow list in the SELinux policy configuration\\\n\n\\f3\\i Example SELinux policy configuration: service_allowlist_policy.te\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # Example SELinux policy configuration for allowing access to specific\\\nactions and resources for a service\\\nmodule my_se",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\\\n2. \\cf7 https://nb.fedorapeople.org/cvsfedora/web/html/docs/selinux-guide/f10/en-\\\nUS/sect-Security-Enhanced_Linux-Targeted_Policy-Unconfined_Processes.html\\\n\\cf2 3. \\cf7 https://access.redhat.com/documentation/en-\\\nus/red_hat_enterprise_linux/9/html/u",
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.3.1.6 | Level2"
    },
    {
      "id": "1.3.1.7",
      "title": "Ensure the MCS Translation Service",
      "automated": true,
      "profile": "Level1",
      "section": "1.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 mcstransd\n\\f2 \\cf2  daemon provides category label information to client processes\\\nrequesting information. The label translations are defined in\\\n\n\\f0 \\cf4 /etc/selinux/targeted/setrans.conf\\\n\n\\f1\\b \\cf2",
      "rationale": "\\\n\n\\f2\\b0 Since this service is not used very often, remove it to reduce the amount of potentially\\\nvulnerable code running on the system.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command and verify \n\\f0 \\cf4 mcstrans\n\\f2 \\cf2  is not installed.\\\n\n\\f4\\fs20\\fsmilli10080 # rpm -q mcstrans\\\npackage mcstrans is not installed\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to uninstall \n\\f0 \\cf4 mcstrans\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # dnf remove mcstrans\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 162\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.3.1.7 | Level1",
      "package_name": "grub2-efi-x64"
    },
    {
      "id": "1.3.1.8",
      "title": "Ensure SETroubleshoot is not installed",
      "automated": true,
      "profile": "Level1",
      "section": "1.3",
      "description": "\\\n\n\\f2\\b0 The SETroubleshoot service notifies desktop users of SELinux denials through a user-\\\nfriendly interface. The service provides important information around configuration\\\nerrors, unauthorized intrusions, and other potential errors.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 The SETroubleshoot service is an unnecessary daemon to have running on a server,\\\nespecially if X Windows is disabled.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Verify \n\\f0 \\cf4 setroubleshoot\n\\f2 \\cf2  is not installed.\\\nRun the following command:\\\n\n\\f4\\fs20\\fsmilli10080 # rpm -q setroubleshoot\\\npackage setroubleshoot is not installed\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to uninstall \n\\f0 \\cf4 setroubleshoot\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # dnf remove setroubleshoot\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 164\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.3.1.8 | Level1",
      "package_name": "shim-x64"
    }
  ]
}