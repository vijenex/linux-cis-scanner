{
  "milestone": "1.7",
  "title": "Mandatory Access Controls",
  "controls": [
    {
      "control_id": "1.7.1",
      "title": "Ensure SELinux is installed",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "SELinux provides Mandatory Access Controls.",
      "rationale": "Without a Mandatory Access Control system installed only the default Discretionary Access Control system will be available.",
      "audit": "Run the following command to verify libselinux is installed:\n# rpm -q libselinux\nlibselinux-<version>",
      "remediation": "Run the following command to install SELinux:\n# dnf install libselinux",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/using_selinux/index",
      "cis_controls": "v8: 4.1 Establish and Maintain a Secure Configuration Process\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "PackageInstalled",
      "check_value": "libselinux"
    },
    {
      "control_id": "1.7.2",
      "title": "Ensure SELinux is not disabled in bootloader configuration",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "Configure SELinux to be enabled at boot time and verify that it has not been overwritten by the grub boot parameters.",
      "rationale": "SELinux must be enabled at boot time in your grub configuration to ensure that the controls it provides are not overridden.",
      "audit": "Run the following command and verify that no linux lines have the selinux=0 or enforcing=0 parameters set:\n# grubby --info=ALL | grep -Po '(selinux|enforcing)=0'\nNothing should be returned",
      "remediation": "Edit /etc/default/grub and remove all instances of selinux=0 and enforcing=0 from all CMDLINE_LINUX parameters:\nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet\"\nGRUB_CMDLINE_LINUX=\"\"\nRun the following command to update the grub2 configuration:\n# grub2-mkconfig -o /boot/grub2/grub.cfg",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/using_selinux/changing-selinux-states-and-modes_using-selinux",
      "cis_controls": "v8: 4.1 Establish and Maintain a Secure Configuration Process\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "Manual",
      "check_value": ""
    },
    {
      "control_id": "1.7.3",
      "title": "Ensure SELinux policy is configured",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "Configure SELinux to meet or exceed the default targeted policy, which constrains daemons and system software only.",
      "rationale": "Security configuration requirements vary from site to site. Some sites may mandate a policy that is stricter than the default policy, which is perfectly acceptable. This item is intended to ensure that at least the default recommendations are met.",
      "audit": "Run the following command and verify output matches either targeted or mls:\n# sestatus | grep 'Loaded policy name'\nLoaded policy name:             targeted\nOR\nLoaded policy name:             mls",
      "remediation": "Edit the /etc/selinux/config file to set the SELINUXTYPE parameter:\nSELINUXTYPE=targeted",
      "impact": "None",
      "default_value": "SELINUXTYPE=targeted",
      "references": "1. https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/using_selinux/changing-selinux-states-and-modes_using-selinux",
      "cis_controls": "v8: 4.1 Establish and Maintain a Secure Configuration Process\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "Manual",
      "check_value": ""
    },
    {
      "control_id": "1.7.4",
      "title": "Ensure the SELinux mode is enforcing or permissive",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "SELinux can run in one of three modes: disabled, permissive, or enforcing.",
      "rationale": "Running SELinux in disabled mode is strongly discouraged; it is equivalent to not running SELinux at all. SELinux can provide valuable information when run in permissive mode, but provides no security benefit.",
      "audit": "Run the following command and verify output matches:\n# getenforce\nEnforcing\nOR\nPermissive",
      "remediation": "Edit the /etc/selinux/config file to set the SELINUX parameter:\nSELINUX=enforcing",
      "impact": "None",
      "default_value": "SELINUX=enforcing",
      "references": "1. https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/using_selinux/changing-selinux-states-and-modes_using-selinux",
      "cis_controls": "v8: 4.1 Establish and Maintain a Secure Configuration Process\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "Manual",
      "check_value": ""
    }
  ]
}
