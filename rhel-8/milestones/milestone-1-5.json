{
  "milestone": "1.5",
  "version": "1.0.0",
  "description": "RHEL 8 CIS Benchmark v4.0.0 - Section 1.5",
  "controls": [
    {
      "id": "1.5.1",
      "title": "Ensure core file size is configured",
      "automated": true,
      "profile": "Level1",
      "section": "1.5",
      "description": "\\\n\n\\f0\\b0 \\cf4 core\n\\f2 \\cf2  - limits the core file size\\\n\n\\f0 \\cf4 hard\n\\f2 \\cf2  - for enforcing hard resource limits. These limits are set by the superuser and\\\nenforced by the Kernel. The user cannot raise their requirement of system resources\\\nabove such values.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Setting a hard limit on core dumps prevents users from overriding the soft variable.\\\nA core dump includes a memory image taken at the time the operating system\\\nterminates an application. The memory image could contain sensitive data and is\\\ngenerally useful only for developers trying to debug problems.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify a hard limit for \n\\f0 \\cf4 core\n\\f2 \\cf2  is set to \n\\f0 \\cf4 0\n\\f2 \\cf2  for all users \n\\f0 \\cf4 *\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Psi --\\\n'^\\\\h*\\\\*\\\\h+hard\\\\h+core\\\\b' /etc/security/limits.conf\\\n/etc/security/limits.d/*\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 /etc/security/limits.d/60-limits.conf:* hard core 0\\\n\n\\f2\\fs24 Verify no line are returned with a value greater than \n\\f0 \\cf4 0\n\\f2 \\cf2 .\n\\fs20\\fsmilli10080 Page 1",
      "remediation": "\\\n\n\\f2\\b0 1. Run the following command to comment out any entries that include a \n\\f0 \\cf4 hard\\\n\n\\f2 \\cf2 value for \n\\f0 \\cf4 core\n\\f2 \\cf2  greater than \n\\f0 \\cf4 0\n\\f2 \\cf2  in \n\\f0 \\cf4 /etc/security/limits.conf\n\\f2 \\cf2  and any file(s) in\\\nthe \n\\f0 \\cf4 /etc/security/limits.d/\n\\f2 \\cf2  directory.\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # sed -ri '/^\\\\s*[^#\\\\n\\\\r]+\\\\s+hard\\\\s+core\\\\s+([1-9][0-9]*)/s/^/# /'\\\n/etc/security/limits.conf /etc/security/limits.d/*\\\n\n\\f2\\fs24 2. Create or edit a file in \n\\f0 \\cf4 /etc/security/limits.d/\n\\f2 \\cf2  and add the following line:\\\n\n\\f4\\fs20\\fsmilli10080 * hard core 0\\\n\n\\f3\\i\\fs24 Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # printf '%s\\\\n' \"\" \"* hard core 0\" >> /etc/security/limits.d/60-limits.conf\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. limits.conf(5)\\\n2. CCI-000366\\\n3. NIST SP 800-53 :: CM-6 b\\\n4. NIST SP 800-53A :: CM-6.1 (iv)\\\n5. STIG ID: RHEL-08-010673 | RULE ID: SV-230313r1069304 | CAT II\\\n6. STIG ID: RHEL-09-213095 | RULE ID: SV-257814r991589 | CAT II\\\n7. STIG ID: ALMA-09-044900 | RULE ID: SV-269452r1050335 | CAT",
      "type": "FileContent",
      "file_path": "/etc/security/limits.conf\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.5.1 | Level1"
    },
    {
      "id": "1.5.2",
      "title": "Ensure fs.protected_hardlinks is configured",
      "automated": true,
      "profile": "Level1",
      "section": "1.5",
      "description": "\\\n\n\\f0\\b0 \\cf4 fs.protected_hardlinks\n\\f2 \\cf2  Controls the creation of hard links to files.\\\nBy enabling the \n\\f0 \\cf4 fs.protected_hardlinks\n\\f2 \\cf2  kernel parameter, users can no longer\\\ncreate soft or hard links to files they do not own.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Disallowing hardlinks mitigates vulnerabilities based on unsecure file systems accessed\\\nby privileged programs. This reduces the risk of an exploitation vector exploiting unsafe\\\nuse of \n\\f0 \\cf4 open\n\\f2 \\cf2  or \n\\f0 \\cf4 creat\n\\f2 \\cf2 .\n\\fs20\\fsmilli10080 Page 176\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Verify \n\\f0 \\cf4 fs.protected_hardlinks\n\\f2 \\cf2  is set to \n\\f0 \\cf4 1\n\\f2 \\cf2 .\\\n1. Run the following command to verify \n\\f0 \\cf4 fs.protected_hardlinks\n\\f2 \\cf2  is set to \n\\f0 \\cf4 1\n\\f2 \\cf2  in the\\\nrunning configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # sysctl fs.protected_hardlinks\\\n\n\\f2\\fs24 Verify output is:\\\n\n\\f4\\fs20\\fsmilli10080 fs.protected_hardlinks = 1\\\n\n\\f2\\fs24 2. Run the following script to verify \n\\f0 \\cf4 fs.protected_hardlinks = 1\n\\f2 \\cf2  is set in a file\\\nbeing used ",
      "remediation": "procedure to create a \n\\f0 \\cf4 .conf\n\\f2 \\cf2  file in the \n\\f0 \\cf4 /etc/sysctl.d/\\\n\n\\f2 \\cf2 directory with the correct setting to prevent a potential change due to an\\\nupdate to the system.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Any files in the \n\\f0 \\cf4 /etc/sysctl.d/\n\\f2 \\cf2  directory that include an incorrect value should\\\nbe modified to comment out or change the incorrect value to minimize the\\\npotential of the incorrect value being used by \n\\f0 \\cf4 systemd sysctl\n\\f2 \\cf2  due to system\\\nconfiguration changes.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f1\\b\\fs24 SYSTEM FILE PRECEDENCE\\\n\n\\f4\\b0\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 When using the \n\\f0 \\cf4 --system\n\\f2 \\cf2  option, \n\\f0 \\cf4 sysctl\n\\f2 \\cf2  will read files from directories in\\\nthe following list in given order from top ",
      "references": "\\\n\n\\f2\\b0 1. CCI-002165 | CCI-002235\\\n2. NIST SP 800-53 :: AC-3 (4) | NIST SP 800-53 :: AC-6 (10)\\\n3. STIG ID: RHEL-08-010374 | RULE ID: SV-230268r1017086 | CAT II\\\n4. STIG ID: OL08-00-010374 | RULE ID: SV-248578r958702 | CAT II\\\n5. STIG ID: RHEL-09-213030 | RULE ID: SV-257801r958702 | CAT II\\\n6. ST",
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.5.2 | Level1"
    },
    {
      "id": "1.5.3",
      "title": "Ensure fs.protected_symlinks is configured",
      "automated": true,
      "profile": "Level2",
      "section": "1.5",
      "description": "\\\n\n\\f0\\b0 \\cf4 fs.protected_symlinks\n\\f2 \\cf2  Controls how the kernel handles symbolic links\\\nBy enabling the \n\\f0 \\cf4 fs.protected_symlinks\n\\f2 \\cf2  kernel parameter, symbolic links are\\\npermitted to be followed only when outside a sticky world-writable directory, or when the\\\nuser identifier (UID) of the link and follower match, or when the directory owner matches\\\nthe symlink's owner.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Disallowing symlinks mitigates vulnerabilities based on unsecure file systems accessed\\\nby privileged programs. This reduces the risk of an exploitation vector exploiting unsafe\\\nuse of \n\\f0 \\cf4 open\n\\f2 \\cf2  or \n\\f0 \\cf4 creat\n\\f2 \\cf2 .\n\\fs20\\fsmilli10080 Page 181\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Verify \n\\f0 \\cf4 fs.protected_symlinks\n\\f2 \\cf2  is set to \n\\f0 \\cf4 1\n\\f2 \\cf2 .\\\n1. Run the following command to verify \n\\f0 \\cf4 fs.protected_symlinks\n\\f2 \\cf2  is set to \n\\f0 \\cf4 1\n\\f2 \\cf2  in the\\\nrunning configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # sysctl fs.protected_symlinks\\\n\n\\f2\\fs24 Verify output is:\\\n\n\\f4\\fs20\\fsmilli10080 fs.protected_symlinks = 1\\\n\n\\f2\\fs24 2. Run the following script to verify \n\\f0 \\cf4 fs.protected_symlinks = 1\n\\f2 \\cf2  is set in a file\\\nbeing used by sy",
      "remediation": "procedure to create a \n\\f0 \\cf4 .conf\n\\f2 \\cf2  file in the \n\\f0 \\cf4 /etc/sysctl.d/\\\n\n\\f2 \\cf2 directory with the correct setting to prevent a potential change due to an\\\nupdate to the system.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Any files in the \n\\f0 \\cf4 /etc/sysctl.d/\n\\f2 \\cf2  directory that include an incorrect value should\\\nbe modified to comment out or change the incorrect value to minimize the\\\npotential of the incorrect value being used by \n\\f0 \\cf4 systemd sysctl\n\\f2 \\cf2  due to system\\\nconfiguration changes.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f1\\b\\fs24 SYSTEM FILE PRECEDENCE\\\n\n\\f4\\b0\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 When using the \n\\f0 \\cf4 --system\n\\f2 \\cf2  option, \n\\f0 \\cf4 sysctl\n\\f2 \\cf2  will read files from directories in\\\nthe following list in given order from top ",
      "references": "\\\n\n\\f2\\b0 1. CCI-002165 | CCI-002235\\\n2. NIST SP 800-53 :: AC-3 (4) | NIST SP 800-53 :: AC-6 (10)\\\n3. STIG ID: RHEL-08-010374 | RULE ID: SV-230268r1017086 | CAT II\\\n4. STIG ID: OL08-00-010373 | RULE ID: SV-248577r958702 | CAT II\\\n5. STIG ID: RHEL-09-213030 | RULE ID: SV-257801r958702 | CAT II\\\n6. ST",
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.5.3 | Level2"
    },
    {
      "id": "1.5.4",
      "title": "Ensure fs.suid_dumpable is configured",
      "automated": true,
      "profile": "Level1",
      "section": "1.5",
      "description": "\\\n\n\\f0\\b0 \\cf4 fs.suid_dumpable\n\\f2 \\cf2  governs whether a privileged process (with the setuid bit) can\\\ngenerate a core dump, regardless of other configurations.\\\n\n\\f0 \\cf4 fs.suid_dumpable\n\\f2 \\cf2  values:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 0\n\\f2 \\cf2  (default) - Any process that has changed privilege levels (like SUID programs)\\\nor is execute-only will not dump core.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 1\n\\f2 \\cf2  (debug) - All processes dump core if possible. Th",
      "rationale": "\\\n\n\\f2\\b0 core dumps may contain sensitive in-memory data like password hashes or keys. An\\\nattacker could potentially exploit this to gain access to such data.\n\\fs20\\fsmilli10080 Page 186\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Verify \n\\f0 \\cf4 fs.suid_dumpable\n\\f2 \\cf2  is set to \n\\f0 \\cf4 0\n\\f2 \\cf2 .\\\n1. Run the following command to verify \n\\f0 \\cf4 fs.suid_dumpable\n\\f2 \\cf2  is set to \n\\f0 \\cf4 0\n\\f2 \\cf2  in the\\\nrunning configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # sysctl fs.suid_dumpable\\\n\n\\f2\\fs24 Verify output is:\\\n\n\\f4\\fs20\\fsmilli10080 fs.suid_dumpable = 0\\\n\n\\f2\\fs24 2. Run the following script to verify \n\\f0 \\cf4 fs.suid_dumpable = 0\n\\f2 \\cf2  is set in a file being\\\nused by systemd sysctl to configure",
      "remediation": "procedure to create a \n\\f0 \\cf4 .conf\n\\f2 \\cf2  file in the \n\\f0 \\cf4 /etc/sysctl.d/\\\n\n\\f2 \\cf2 directory with the correct setting to prevent a potential change due to an\\\nupdate to the system.\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 Any files in the \n\\f0 \\cf4 /etc/sysctl.d/\n\\f2 \\cf2  directory that include an incorrect value\\\nshould be modified to comment out or change the incorrect value to\\\nminimize the potential of the incorrect value being used by \n\\f0 \\cf4 systemd\\\nsysctl\n\\f2 \\cf2  due to system configuration changes.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f1\\b\\fs24 SYSTEM FILE PRECEDENCE\\\n\n\\f4\\b0\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 When using the \n\\f0 \\cf4 --system\n\\f2 \\cf2  option, \n\\f0 \\cf4 sysctl\n\\f2 \\cf2  will read files from directories in\\\nthe following list in given order from top to ",
      "references": "",
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.5.4 | Level1"
    },
    {
      "id": "1.5.5",
      "title": "Ensure kernel.dmesg_restrict is configured",
      "automated": true,
      "profile": "Level1",
      "section": "1.5",
      "description": "\\\n\n\\f0\\b0 \\cf4 kernel.dmesg_restrict\n\\f2 \\cf2  can be used to configure the Linux kernel and prevent\\\nunprivileged users access to information from the kernel's log buffer.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Restricting access to the kernel message buffer limits access to only root. This prevents\\\nattackers from gaining additional system information as a non-privileged user.\n\\fs20\\fsmilli10080 Page 191\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Verify \n\\f0 \\cf4 kernel.dmesg_restrict\n\\f2 \\cf2  is set to \n\\f0 \\cf4 1\n\\f2 \\cf2 .\\\n1. Run the following command to verify \n\\f0 \\cf4 kernel.dmesg_restrict\n\\f2 \\cf2  is set to \n\\f0 \\cf4 1\n\\f2 \\cf2  in the\\\nrunning configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # sysctl kernel.dmesg_restrict\\\n\n\\f2\\fs24 Verify output is:\\\n\n\\f4\\fs20\\fsmilli10080 kernel.dmesg_restrict = 1\\\n\n\\f2\\fs24 2. Run the following script to verify \n\\f0 \\cf4 kernel.dmesg_restrict = 1\n\\f2 \\cf2  is set in a file\\\nbeing used by sy",
      "remediation": "procedure to create a \n\\f0 \\cf4 .conf\n\\f2 \\cf2  file in the \n\\f0 \\cf4 /etc/sysctl.d/\\\n\n\\f2 \\cf2 directory with the correct setting to prevent a potential change due to an\\\nupdate to the system.\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 Any files in the \n\\f0 \\cf4 /etc/sysctl.d/\n\\f2 \\cf2  directory that include an incorrect value\\\nshould be modified to comment out or change the incorrect value to\\\nminimize the potential of the incorrect value being used by \n\\f0 \\cf4 systemd\\\nsysctl\n\\f2 \\cf2  due to system configuration changes.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f1\\b\\fs24 SYSTEM FILE PRECEDENCE\\\n\n\\f4\\b0\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 When using the \n\\f0 \\cf4 --system\n\\f2 \\cf2  option, \n\\f0 \\cf4 sysctl\n\\f2 \\cf2  will read files from directories in\\\nthe following list in given order from top to ",
      "references": "\\\n\n\\f2\\b0 1. CCI-001082 | CCI-001090\\\n2. NIST SP 800-53 :: SC-2 | NIST SP 800-53 :: SC-4\\\n3. NIST SP 800-53A :: SC-2.1 | NIST SP 800-53A :: SC-4.1\\\n4. STIG ID: RHEL-08-010375 | RULE ID: SV-230269r1017087 | CAT III\\\n5. STIG ID: OL08-00-010375 | RULE ID: SV-248579r958524 | CAT III\\\n6. STIG ID: RHEL-09",
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.5.5 | Level1"
    },
    {
      "id": "1.5.6",
      "title": "Ensure kernel.kptr_restrict is configured",
      "automated": true,
      "profile": "Level1",
      "section": "1.5",
      "description": "\\\n\n\\f0\\b0 \\cf4 kernel.kptr_restrict\n\\f2 \\cf2  sets whether restrictions are placed on exposing kernel\\\naddresses via /proc and other interfaces.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 kptr_restrict = 0\n\\f2 \\cf2  - The address is hashed before printing. (equivalent to %p.)\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 kptr_restrict = 1\n\\f2 \\cf2  - kernel pointers printed using the %pK format specifier will\\\nbe replaced with \n\\f0 \\cf4 0\n\\f2 \\cf2 's.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n",
      "rationale": "\\\n\n\\f2\\b0 Masking the kernel symbols in \n\\f0 \\cf4 /proc/kallsyms\n\\f2 \\cf2  reduces the ability of an attacker using\\\nthem to learn more about what to attack on your system.\n\\fs20\\fsmilli10080 Page 196\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Verify \n\\f0 \\cf4 kernel.kptr_restrict\n\\f2 \\cf2  is set to a value of: \n\\f0 \\cf4 1\n\\f2 \\cf2  or \n\\f0 \\cf4 2\n\\f2 \\cf2 .\\\n1. Run the following command to verify \n\\f0 \\cf4 kernel.kptr_restrict\n\\f2 \\cf2  is set to a value\\\nof: \n\\f0 \\cf4 1\n\\f2 \\cf2  or \n\\f0 \\cf4 2\n\\f2 \\cf2  in the running configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # sysctl kernel.kptr_restrict\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 kernel.kptr_restrict = 2\\\n\n\\f2\\fs24 2. Run the following script to verify \n\\f0 \\c",
      "remediation": "procedure to create a \n\\f0 \\cf4 .conf\n\\f2 \\cf2  file in the \n\\f0 \\cf4 /etc/sysctl.d/\\\n\n\\f2 \\cf2 directory with the correct setting to prevent a potential change due to an\\\nupdate to the system.\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 Any files in the \n\\f0 \\cf4 /etc/sysctl.d/\n\\f2 \\cf2  directory that include an incorrect value\\\nshould be modified to comment out or change the incorrect value to\\\nminimize the potential of the incorrect value being used by \n\\f0 \\cf4 systemd\\\nsysctl\n\\f2 \\cf2  due to system configuration changes.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f1\\b\\fs24 SYSTEM FILE PRECEDENCE\\\n\n\\f4\\b0\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 When using the \n\\f0 \\cf4 --system\n\\f2 \\cf2  option, \n\\f0 \\cf4 sysctl\n\\f2 \\cf2  will read files from directories in\\\nthe following list in given order from top to ",
      "references": "\\\n\n\\f2\\b0 1. CCI-000366\\\n2. NIST SP 800-53 :: CM-6 b\\\n3. NIST SP 800-53A :: CM-6.1 (iv)\\\n4. STIG ID: RHEL-08-040283 | RULE ID: SV-230547r1017309 | CAT II\\\n5. STIG ID: OL08-00-040283 | RULE ID: SV-248891r991589 | CAT II\\\n6. STIG ID: RHEL-09-213025 | RULE ID: SV-257800r1044851 | CAT II\\\n7. STIG ID: AL",
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.5.6 | Level1"
    },
    {
      "id": "1.5.7",
      "title": "Ensure kernel.yama.ptrace_scope is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "1.5",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 ptrace()\n\\f2 \\cf2  system call provides a means by which one process (the \"tracer\") may\\\nobserve and control the execution of another process (the \"tracee\"), and examine and\\\nchange the tracee's memory and registers.\\\nThe sysctl settings (writable only with CAP_SYS_PTRACE) are:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 0\n\\f2 \\cf2  - classic ptrace permissions: a process can PTRACE_ATTACH to any other\\\nprocess running under the same uid, as long as it is dumpable (i",
      "rationale": "\\\n\n\\f2\\b0 If one application is compromised, it would be possible for an attacker to attach to other\\\nrunning processes (e.g. Bash, Firefox, SSH sessions, GPG agent, etc) to extract\\\nadditional credentials and continue to expand the scope of their attack.\\\nEnabling restricted mode will limit the ability of a compromised process to\\\nPTRACE_ATTACH on other processes running under the same user. With restricted\\\nmode, ptrace will continue to work with root user.\n\\fs20\\fsmilli10080 Page 201\\\n\n\\f0 In",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Verify \n\\f0 \\cf4 kernel.yama.ptrace_scope\n\\f2 \\cf2  is set to a value of: \n\\f0 \\cf4 1\n\\f2 \\cf2 , \n\\f0 \\cf4 2\n\\f2 \\cf2 , or \n\\f0 \\cf4 3\n\\f2 \\cf2 .\\\n1. Run the following command to verify \n\\f0 \\cf4 kernel.yama.ptrace_scope\n\\f2 \\cf2  is set to a\\\nvalue of: \n\\f0 \\cf4 1\n\\f2 \\cf2 , \n\\f0 \\cf4 2\n\\f2 \\cf2 , or \n\\f0 \\cf4 3\n\\f2 \\cf2  in the running configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # sysctl kernel.yama.ptrace_scope\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 kernel.yama.ptrace_sc",
      "remediation": "procedure to create a \n\\f0 \\cf4 .conf\n\\f2 \\cf2  file in the \n\\f0 \\cf4 /etc/sysctl.d/\\\n\n\\f2 \\cf2 directory with the correct setting to prevent a potential change due to an\\\nupdate to the system.\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 Any files in the \n\\f0 \\cf4 /etc/sysctl.d/\n\\f2 \\cf2  directory that include an incorrect value\\\nshould be modified to comment out or change the incorrect value to\\\nminimize the potential of the incorrect value being used by \n\\f0 \\cf4 systemd\\\nsysctl\n\\f2 \\cf2  due to system configuration changes.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f1\\b\\fs24 SYSTEM FILE PRECEDENCE\\\n\n\\f4\\b0\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 When using the \n\\f0 \\cf4 --system\n\\f2 \\cf2  option, \n\\f0 \\cf4 sysctl\n\\f2 \\cf2  will read files from directories in\\\nthe following list in given order from top to ",
      "references": "\\\n\n\\f2\\b0 1. CCI-000366\\\n2. NIST SP 800-53 :: CM-6 b\\\n3. NIST SP 800-53A :: CM-6.1 (iv)\\\n4. STIG ID: RHEL-08-040282 | RULE ID: SV-230546r1017308 | CAT II\\\n5. STIG ID: OL08-00-040282 | RULE ID: SV-248890r991589 | CAT II\\\n6. STIG ID: RHEL-09-213080 | RULE ID: SV-257811r1044872 | CAT II\\\n7. STIG ID: AL",
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.5.7 | Level1"
    },
    {
      "id": "1.5.8",
      "title": "Ensure kernel.randomize_va_space is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "1.5",
      "description": "\\\n\n\\f2\\b0 Address space layout randomization (ASLR) is an exploit mitigation technique which\\\nrandomly arranges the address space of key data areas of a process.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Randomly placing virtual memory regions will make it difficult to write memory page\\\nexploits as the memory placement will be consistently shifting.\n\\fs20\\fsmilli10080 Page 206\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Verify \n\\f0 \\cf4 kernel.randomize_va_space\n\\f2 \\cf2  is set to \n\\f0 \\cf4 2\n\\f2 \\cf2 .\\\n1. Run the following command to verify \n\\f0 \\cf4 kernel.randomize_va_space\n\\f2 \\cf2  is set to \n\\f0 \\cf4 2\n\\f2 \\cf2  in\\\nthe running configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # sysctl kernel.randomize_va_space\\\n\n\\f2\\fs24 Verify output is:\\\n\n\\f4\\fs20\\fsmilli10080 kernel.randomize_va_space = 2\\\n\n\\f2\\fs24 2. Run the following script to verify \n\\f0 \\cf4 kernel.randomize_va_space = 2\n\\f2 \\cf2  is set in a\\\nf",
      "remediation": "procedure to create a \n\\f0 \\cf4 .conf\n\\f2 \\cf2  file in the \n\\f0 \\cf4 /etc/sysctl.d/\\\n\n\\f2 \\cf2 directory with the correct setting to prevent a potential change due to an\\\nupdate to the system.\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 Any files in the \n\\f0 \\cf4 /etc/sysctl.d/\n\\f2 \\cf2  directory that include an incorrect value\\\nshould be modified to comment out or change the incorrect value to\\\nminimize the potential of the incorrect value being used by \n\\f0 \\cf4 systemd\\\nsysctl\n\\f2 \\cf2  due to system configuration changes.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f1\\b\\fs24 SYSTEM FILE PRECEDENCE\\\n\n\\f4\\b0\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 When using the \n\\f0 \\cf4 --system\n\\f2 \\cf2  option, \n\\f0 \\cf4 sysctl\n\\f2 \\cf2  will read files from directories in\\\nthe following list in given order from top to ",
      "references": "\\\n\n\\f2\\b0 1. CCI-002824\\\n2. NIST SP 800-53 :: SI-16\\\n3. STIG ID: RHEL-08-010430 | RULE ID: SV-230280r1017093 | CAT II\\\n4. STIG ID: OL08-00-010430 | RULE ID: SV-248594r958928 | CAT II\\\n5. STIG ID: RHEL-09-213070 | RULE ID: SV-257809r1044866 | CAT II\\\n6. STIG ID: ALMA-09-044900 | RULE ID: SV-269452r10",
      "type": "SysctlParameter",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.5.8 | Level1"
    },
    {
      "id": "1.5.9",
      "title": "Ensure systemd-coredump ProcessSizeMax is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "1.5",
      "description": "\\\n\n\\f2\\b0 A core dump is the memory of an executable program. It is generally used to determine\\\nwhy a program aborted. It can also be used to glean confidential information from a core\\\nfile.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 A core dump includes a memory image taken at the time the operating system\\\nterminates an application. The memory image could contain sensitive data and is\\\ngenerally useful only for developers trying to debug problems, increasing the risk to the\\\nsystem.\n\\fs20\\fsmilli10080 Page 211\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify \n\\f0 \\cf4 systemd-coredump\n\\f2 \\cf2  \n\\f0 \\cf4 ProcessSizeMax\n\\f2 \\cf2  is set to \n\\f0 \\cf4 0\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_analyze_cmd=\"$(readlink -e /bin/systemd-analyze || \\\\\\\nreadlink -e /usr/bin/systemd-analyze)\"\\\nl_conf_file=\"systemd/coredump.conf\" l_block=\"Coredump\"\\\nl_option=\"ProcessSizeMax\" l_option_value=\"\" a_output=()\\\nwhile IFS= read -r l_file; do\\\nl_file=\"$\\{l_file//# /\\}\"\\\nl_opt=\"$(awk '/\\\\['\"$l_block\"'\\\\]",
      "remediation": "procedure\\\nto mitigate the potential of a system update changing the",
      "references": "\\\n\n\\f2\\b0 1. COREDUMP.CONF(5)\\\n2. CCI-000366\\\n3. NIST SP 800-53 :: CM-6 b\\\n4. NIST SP 800-53A :: CM-6.1 (iv)\\\n5. STIG ID: RHEL-08-010675 | RULE ID: SV-230315r1017126 | CAT II\\\n6. STIG ID: OL08-00-010675 | RULE ID: SV-248633r991589 | CAT II\\\n7. STIG ID: RHEL-09-213085 | RULE ID: SV-257812r1051005 | C",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.5.9 | Level1"
    },
    {
      "id": "1.5.10",
      "title": "Ensure systemd-coredump Storage is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "1.5",
      "description": "\\\n\n\\f2\\b0 A core dump is the memory of an executable program. It is generally used to determine\\\nwhy a program aborted. It can also be used to glean confidential information from a core\\\nfile.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 A core dump includes a memory image taken at the time the operating system\\\nterminates an application. The memory image could contain sensitive data and is\\\ngenerally useful only for developers trying to debug problems.\n\\fs20\\fsmilli10080 Page 216\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify \n\\f0 \\cf4 systemd-coredump\n\\f2 \\cf2  \n\\f0 \\cf4 Storage\n\\f2 \\cf2  is set to \n\\f0 \\cf4 none\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_analyze_cmd=\"$(readlink -e /bin/systemd-analyze || \\\\\\\nreadlink -e /usr/bin/systemd-analyze)\"\\\nl_conf_file=\"systemd/coredump.conf\" l_block=\"Coredump\"\\\nl_option=\"Storage\" l_option_value=\"\" a_output=()\\\nwhile IFS= read -r l_file; do\\\nl_file=\"$\\{l_file//# /\\}\"\\\nl_opt=\"$(awk '/\\\\['\"$l_block\"'\\\\]/\\{a=1;next",
      "remediation": "procedure\\\nto mitigate the potential of a system update changing the",
      "references": "\\\n\n\\f2\\b0 1. COREDUMP.CONF(5)\\\n2. CCI-000366\\\n3. NIST SP 800-53 :: CM-6 b\\\n4. NIST SP 800-53A :: CM-6.1 (iv)\\\n5. STIG ID: RHEL-08-010674 | RULE ID: SV-230314r1017125 | CAT II\\\n6. STIG ID: OL08-00-010674 | RULE ID: SV-248632r991589 | CAT II\\\n7. STIG ID: RHEL-09-213090 | RULE ID: SV-257813r991589 | CA",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.5.10 | Level1"
    }
  ]
}