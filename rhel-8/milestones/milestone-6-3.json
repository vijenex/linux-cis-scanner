{
  "milestone": "6.3",
  "title": "System File Permissions",
  "controls": [
    {
      "title": "Ensure permissions on /etc/passwd- are configured",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The /etc/passwd- file contains backup user account information.",
      "rationale": "It is critical to ensure that the /etc/passwd- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "audit": "Run the following command and verify Uid and Gid are both 0/root and Access is 644 or more restrictive:\n# stat /etc/passwd-\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)",
      "remediation": "Run the following commands to set permissions on /etc/passwd-:\n# chown root:root /etc/passwd-\n# chmod u-x,go-wx /etc/passwd-",
      "impact": "None",
      "default_value": "0644 root root",
      "references": "1. See the passwd(5) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "FilePermissions",
      "check_value": "/etc/passwd-:0644:root:root",
      "id": "6.3.1"
    },
    {
      "id": "6.3.1.1",
      "title": "Ensure auditd packages are installed",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f0\\b0 \\cf4 auditd\n\\f2 \\cf2  is the userspace component to the Linux Auditing System. It's responsible for\\\nwriting audit records to the disk.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 The capturing of system events provides system administrators with information to allow\\\nthem to determine if unauthorized access to their system is occurring.\\\nSatisfies: SRG-OS-000062-GPOS-00031, SRG-OS-000037-GPOS-00015, SRG-OS-\\\n000038-GPOS-00016, SRG-OS-000039-GPOS-00017, SRG-OS-000040-GPOS-00018,\\\nSRG-OS-000041-GPOS-00019, SRG-OS-000042-GPOS-00021, SRG-OS-000051-\\\nGPOS-00024, SRG-OS-000054-GPOS-00025, SRG-OS-000122-GPOS-00063, SRG-\\\nOS-000254-GPOS-00095, SRG-OS-000255-GPOS-00096,",
      "impact": "None",
      "audit_command": "records to the disk.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 The capturing of system events provides system administrators with information to allow\\\nthem to determine if unauthorized access to their system is occurring.\\\nSatisfies: SRG-OS-000062-GPOS-00031, SRG-OS-000037-GPOS-00015, SRG-OS-\\\n000038-GPOS-00016, SRG-OS-000039-GPOS-00017, SRG-OS-000040-GPOS-00018,\\\nSRG-OS-000041-GPOS-00019, SRG-OS-000042-GPOS-00021, SRG-OS-000051-\\\nGPOS-00024, SRG-OS-000054-GPOS-00025, SRG-OS-000122-GPOS-00063, SRG-\\\nOS-00025",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to install \n\\f0 \\cf4 audit\n\\f2 \\cf2  and \n\\f0 \\cf4 audit-libs\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # dnf install audit audit-libs\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AU-2, AU-3, AU-3(1), AU-12, SI-5\\\n2. NIST SP 800-53A :: AU-12.1 (ii)\\\n3. RHEL 8 STIG Vul ID: V-230411\\\n4. RHEL 8 STIG Rule ID: SV-230411r744000\n\\fs20\\fsmilli10080 Page 873\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.1.1 | Level2"
    },
    {
      "id": "6.3.1.3",
      "title": "Ensure audit_backlog_limit is configured",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 audit_backlog_limit\n\\f2 \\cf2  parameter determines how auditd records can be held in\\\nthe auditd backlog. The default setting of 64 may be insufficient to store all audit events\\\nduring boot.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 During boot if \n\\f0 \\cf4",
      "impact": "None",
      "audit_command": "events\\\nduring boot.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 During boot if \n\\f0 \\cf4 audit=1\n\\f2 \\cf2 , then the backlog will hold 64 records. If more than 64 records\\\nare created during boot, auditd records will be lost and potential malicious activity could\\\ngo undetected.\\\n\n\\f1\\b Audit:\\\nNote:\n\\f2\\b0  \n\\f0 \\cf4 /etc/default/grub\n\\f2 \\cf2  should be checked because the \n\\f0 \\cf4 grub2-mkconfig -o\\\n\n\\f2 \\cf2 command will overwrite \n\\f0 \\cf4 grub.cfg\n\\f2 \\cf2  with parameters listed in \n\\f0 \\cf4 /etc/defau",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to add \n\\f0 \\cf4 audit_backlog_limit=<BACKLOG SIZE>\n\\f2 \\cf2  to\\\nGRUB_CMDLINE_LINUX:\\\n\n\\f4\\fs20\\fsmilli10080 # grubby --update-kernel ALL --args 'audit_backlog_limit=<BACKLOG SIZE>'\\\n\n\\f3\\i\\fs24 Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # grubby --update-kernel ALL --args 'audit_backlog_limit=8192'\\\n\n\\f2\\fs24 Edit \n\\f0 \\cf4 /etc/",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AU-2, AU-12, SI-5\n\\fs20\\fsmilli10080 Page 879\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/default/grub",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.1.3 | Level2"
    },
    {
      "id": "6.3.1.4",
      "title": "Ensure auditd service is enabled and active",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Turn on the \n\\f0 \\cf4 auditd\n\\f2 \\cf2  daemon to record system events.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 The capturing of system events provides system administrators with information to allow\\\nthem to determine if unauthorized access to their system is occurring.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify \n\\f0 \\cf4 auditd\n\\f2 \\cf2  is enabled:\\\n\n\\f4\\fs20\\fsmilli10080 # systemctl is-enabled auditd | grep '^enabled'\\\nenabled\\\n\n\\f2\\fs24 Verify result is \"enabled\".\\\nRun the following command to verify \n\\f0 \\cf4 auditd\n\\f2 \\cf2  is active:\\\n\n\\f4\\fs20\\fsmilli10080 # systemctl is-active auditd | grep '^active'\\\nactive\\\n\n\\f2\\fs24 Verify result is active\\\n\n\\f1\\b",
      "remediation": "\\\n\n\\f2\\b0 Run the following commands to unmask, enable and start \n\\f0 \\cf4 auditd\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # systemctl unmask auditd\\\n# systemctl enable auditd\\\n# systemctl start auditd\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: AU-12 a\\\n2. NIST SP 800-53A :: AU-12.1 (ii)\\\n3. RHEL 8 STIG Vul ID: V-244542\\\n4. RHEL 8 STIG Rule ID: SV-244542r818838\n\\fs20\\fsmilli10080 Page 881\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "ServiceStatus",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.1.4 | Level2"
    },
    {
      "title": "Ensure permissions on /etc/group- are configured",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The /etc/group- file contains a backup list of all the valid groups defined in the system.",
      "rationale": "It is critical to ensure that the /etc/group- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "audit": "Run the following command and verify Uid and Gid are both 0/root and Access is 644 or more restrictive:\n# stat /etc/group-\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)",
      "remediation": "Run the following commands to set permissions on /etc/group-:\n# chown root:root /etc/group-\n# chmod u-x,go-wx /etc/group-",
      "impact": "None",
      "default_value": "0644 root root",
      "references": "1. See the group(5) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "FilePermissions",
      "check_value": "/etc/group-:0644:root:root",
      "id": "6.3.2"
    },
    {
      "id": "6.3.2.1",
      "title": "Ensure audit log storage size is configured",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Configure the maximum size of the audit log file. Once the log reaches the maximum\\\nsize, it will be rotated and a new log file will be started.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 It is important that an appropriate size is determined for log files so that they do not\\",
      "impact": "the system and",
      "audit_command": "log storage size is configured (Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 Configure the maximum size of the audit log file. Once the log reaches the maximum\\\nsize, it will be rotated and a new log file will be started.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 It is important that an appropriate size is determined for log files so that they do not\\\nimpact the system and audit data is not lost.\\",
      "remediation": "\\\n\n\\f2\\b0 Set the following parameter in \n\\f0 \\cf4 /etc/audit/auditd.conf\n\\f2 \\cf2  in accordance with site\\\npolicy:\\\n\n\\f4\\fs20\\fsmilli10080 max_log_file = <MB>\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AU-8\\\n\n\\f1\\b",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.2.1 | Level2"
    },
    {
      "id": "6.3.2.2",
      "title": "Ensure audit logs are not automatically deleted\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 max_log_file_action\n\\f2 \\cf2  setting determines how to handle the audit log file reaching\\\nthe max file size. A value of \n\\f0 \\cf4 keep_logs\n\\f2 \\cf2  will rotate the logs but never delete old logs.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 In high security contexts, the benefits of maintaining a long",
      "impact": "None",
      "audit_command": "logs are not automatically deleted\\\n(Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 The \n\\f0 \\cf4 max_log_file_action\n\\f2 \\cf2  setting determines how to handle the audit log file reaching\\\nthe max file size. A value of \n\\f0 \\cf4 keep_logs\n\\f2 \\cf2  will rotate the logs but never delete old logs.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 In high security contexts, the benefits of maintaining a long ",
      "remediation": "\\\n\n\\f2\\b0 Set the following parameter in \n\\f0 \\cf4 /etc/audit/auditd.conf:\\\n\n\\f4\\fs20\\fsmilli10080 \\cf2 max_log_file_action = keep_logs\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AU-8\n\\fs20\\fsmilli10080 Page 886\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.2.2 | Level2"
    },
    {
      "id": "6.3.2.3",
      "title": "Ensure system is disabled when audit logs are full\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 auditd\n\\f2 \\cf2  daemon can be configured to halt the system or put the system in single\\\nuser mode, if no free space is available or an error is detected on the partition that holds\\\nthe audit log files.\\\nThe \n\\f0 \\cf4 disk_full_action\n\\f2 \\cf2  parameter tells the system what action to take when no free\\\nspace is available on the partition that holds the audit log files. Valid values are \n\\f0 \\cf4 ignore\n\\f2 \\cf2 ,\\\n\n\\f0 \\cf4 syslog\n\\f2 \\cf2 , \n\\f0 \\cf4 rotate\n\\f2 \\cf2 ",
      "rationale": "\\\n\n\\f2\\b0 In high security contexts, the risk of detecting unauthorized access or nonrepudiation\\\nexceeds the benefit of the system's availability.\\\n\n\\f1\\b",
      "impact": "\\\n\n\\f0\\b0 \\cf4 disk_full_action\n\\f2 \\cf2  parameter:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Set to \n\\f0 \\cf4 halt\n\\f2 \\cf2  - the \n\\f0 \\cf4",
      "audit_command": "logs are full\\\n(Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 The \n\\f0 \\cf4 auditd\n\\f2 \\cf2  daemon can be configured to halt the system or put the system in single\\\nuser mode, if no free space is available or an error is detected on the partition that holds\\\nthe audit log files.\\\nThe \n\\f0 \\cf4 disk_full_action\n\\f2 \\cf2  parameter tells the system what action to take when no free\\\nspa",
      "remediation": "\\\n\n\\f2\\b0 Set one of the following parameters in \n\\f0 \\cf4 /etc/audit/auditd.conf\n\\f2 \\cf2  depending on your\\\nlocal security policies.\\\n\n\\f4\\fs20\\fsmilli10080 disk_full_action = <halt|single>\\\ndisk_error_action = <syslog|single|halt>\\\n\n\\f3\\i\\fs24 Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 disk_full_action = halt\\\ndisk_error_action = halt\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. AUDITD.CONF(5)\\\n2. \\cf7 https://access.redhat.com/documentation/en-\\\nus/red_hat_enterprise_linux/8/html/security_hardening/auditing-the-\\\nsystem_security-hardening#configuring-auditd-for-a-secure-\\\nenvironment_auditing-the-system\\\n\\cf2 3. NIST SP 800-53 :: AU-5 b\\\n4. NIST SP 800-53A :: ",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.2.3 | Level2"
    },
    {
      "id": "6.3.2.4",
      "title": "Ensure system warns when audit logs are low on space\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 auditd\n\\f2 \\cf2  daemon can be configured to halt the system, put the system in single user\\\nmode or send a warning message, if the partition that holds the audit log files is low on\\\nspace.\\\nThe \n\\f0 \\cf4 space_left_action\n\\f2 \\cf2  parameter tells the system what action to take when the\\\nsystem has detected that it is starting to get low on disk space. Valid values are \n\\f0 \\cf4 ignore\n\\f2 \\cf2 ,\\\n\n\\f0 \\cf4 syslog\n\\f2 \\cf2 , \n\\f0 \\cf4 rotate\n\\f2 \\cf2 , \n\\f0 \\cf4 email\n\\",
      "rationale": "\\\n\n\\f2\\b0 In high security contexts, the risk of detecting unauthorized access or nonrepudiation\\\nexceeds the benefit of the system's availability.\\\n\n\\f1\\b",
      "impact": "\\\n\n\\f2\\b0 If the \n\\f0 \\cf4 admin_space_left_action\n\\f2 \\cf2  is set to \n\\f0 \\cf4 single\n\\f2 \\cf2  the",
      "audit_command": "logs are low on space\\\n(Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 The \n\\f0 \\cf4 auditd\n\\f2 \\cf2  daemon can be configured to halt the system, put the system in single user\\\nmode or send a warning message, if the partition that holds the audit log files is low on\\\nspace.\\\nThe \n\\f0 \\cf4 space_left_action\n\\f2 \\cf2  parameter tells the system what action to take when the\\\nsystem has d",
      "remediation": "\\\n\n\\f2\\b0 Set the \n\\f0 \\cf4 space_left_action\n\\f2 \\cf2  parameter in \n\\f0 \\cf4 /etc/audit/auditd.conf\n\\f2 \\cf2  to \n\\f0 \\cf4 email\n\\f2 \\cf2 , \n\\f0 \\cf4 exec\n\\f2 \\cf2 ,\\\n\n\\f0 \\cf4 single\n\\f2 \\cf2 , or \n\\f0 \\cf4 halt\n\\f2 \\cf2 :\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 space_left_action = email\\\n\n\\f2\\fs24 Set the \n\\f0 \\cf4 admin_space_left_action\n\\f2 \\cf2  parameter in \n\\f0 \\cf4 /etc/audit/auditd.conf\n\\f2 \\cf2  to\\\n\n\\f0 \\cf4 single\n\\f2 \\cf2  or \n\\f0 \\cf4 halt\n\\f2 \\cf2 :\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 admin_space_left_action = single\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  A Mail Transfer Agent (MTA) must be installed and configured properly to set\\\n\n\\f0 \\cf4 space_left_action = email\n\\f2\\fs20\\fsmilli10080 \\cf2 Page 892\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AU-2, AU-8, AU-12, SI-5\\\n2. AUDITD.CONF(5)\\\n3. \\cf7 https://access.redhat.com/documentation/en-\\\nus/red_hat_enterprise_linux/8/html/security_hardening/auditing-the-\\\nsystem_security-hardening#configuring-auditd-for-a-secure-\\\nenvironment_auditing-the-system\\\n\n\\f1\\",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.2.4 | Level2"
    },
    {
      "title": "Ensure permissions on /etc/shadow- are configured",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The /etc/shadow- file is used to store backup information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.",
      "rationale": "It is critical to ensure that the /etc/shadow- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "audit": "Run the following command and verify Uid is 0/root, Gid is 0/root, and Access is 0000 or more restrictive:\n# stat /etc/shadow-\nAccess: (0000/----------) Uid: ( 0/ root) Gid: ( 0/ root)",
      "remediation": "Run the following commands to set permissions on /etc/shadow-:\n# chown root:root /etc/shadow-\n# chmod 0000 /etc/shadow-",
      "impact": "None",
      "default_value": "0000 root root",
      "references": "1. See the shadow(5) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "FilePermissions",
      "check_value": "/etc/shadow-:0000:root:root",
      "id": "6.3.3"
    },
    {
      "id": "6.3.3.1",
      "title": "Ensure changes to system administration scope",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Monitor scope changes for system administrators. If the system has been properly\\\nconfigured to force system administrators to log in as themselves first and then use the\\\n\n\\f0 \\cf4 sudo\n\\f2 \\cf2  command to execute privileged commands, it is possible to monitor changes in\\\nscope. The file \n\\f0 \\cf4 /etc/sudoers\n\\f2 \\cf2 , or files in \n\\f0 \\cf4 /etc/sudoers.d\n\\f2 \\cf2 , will be written to when the\\\nfile(s) or related attributes have changed. The audit records will be tagged with the\\\ni",
      "rationale": "\\\n\n\\f2\\b0 Changes in the \n\\f0 \\cf4 /etc/sudoers\n\\f2 \\cf2  and \n\\f0 \\cf4 /etc/sudoers.d\n\\f2 \\cf2  files can indicate that an\\\nunauthorized change has been made to the scope of system administrator activity.\\\nSatisfies: SRG-OS-000062-GPOS-00031, SRG-OS-000004-GPOS-00004, SRG-OS-\\\n000037-GPOS-00015, SRG-OS-000042-GPOS-00020, SRG-OS-000062-GPOS-00031,\\\nSRG-OS-000304-GPOS-00121, SRG-OS-000392-GPOS-00172, SRG-OS-000462-\\\nGPOS-00206, SRG-OS-000470-GPOS-00214, SRG-OS-000471-GPOS-00215, SRG-\\\nOS-000239-G",
      "impact": "None",
      "audit_command": "records will be tagged with the\\\nidentifier \"scope\".\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Changes in the \n\\f0 \\cf4 /etc/sudoers\n\\f2 \\cf2  and \n\\f0 \\cf4 /etc/sudoers.d\n\\f2 \\cf2  files can indicate that an\\\nunauthorized change has been made to the scope of system administrator activity.\\\nSatisfies: SRG-OS-000062-GPOS-00031, SRG-OS-000004-GPOS-00004, SRG-OS-\\\n000037-GPOS-00015, SRG-OS-000042-GPOS-00020, SRG-OS-000062-GPOS-00031,\\\nSRG-OS-000304-GPOS-00121, SRG-OS-000392-GPOS-00172, SRG-OS-000462-\\\nGPOS-00206",
      "remediation": "\\\n\n\\f2\\b0 Edit or create a file in the \n\\f0 \\cf4 /etc/audit/rules.d/\n\\f2 \\cf2  directory, ending in \n\\f0 \\cf4 .rules\n\\f2 \\cf2  extension,\\\nwith the relevant rules to monitor scope changes for system administrators.\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # printf '%s\\\\n' \"-w /etc/sudoers -p wa -k scope\" \"-w /etc/sudoers.d -p wa -k\\\nscope\" >> /etc/audit/rules.d/50-scope.rules\\\n\n\\f2\\fs24 Merge and load the rules into active configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # augenrules --load\\\n\n\\f2\\fs24 Check if reboot is required.\\\n\n\\f4\\fs20\\fsmilli10080 # if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot\\\nrequired to load rules\\\\n\"; fi\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: AU-12 a\\\n2. NIST SP 800-53A :: AU-12.1 (ii)\\\n3. RHEL 8 STIG Vul ID: V-230409\\\n4. RHEL 8 STIG Rule ID: SV-230409r627750_rule\\\n5. RHEL 8 STIG Vul ID: V-230410\\\n6. RHEL 8 STIG Rule ID: SV-230410r627750\n\\fs20\\fsmilli10080 Page 896\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/sudoers",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.3.1 | Level2"
    },
    {
      "id": "6.3.3.2",
      "title": "Ensure actions as another user are always logged\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f0\\b0 \\cf4 sudo\n\\f2 \\cf2  provides users with temporary elevated privileges to perform operations, either as\\\nthe superuser or another user.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Creating an",
      "impact": "None",
      "audit_command": "log of users with temporary elevated privileges and the operation(s)\\\nthey performed is essential to reporting. Administrators will want to correlate the events\\\nwritten to the audit trail with the records written to \n\\f0 \\cf4 sudo\n\\f2 \\cf2 's logfile to verify if unauthorized\\\ncommands have been executed.\\\nSatisfies: SRG-OS-000326-GPOS-00126, SRG-OS-000327-GPOS-00127\n\\fs20\\fsmilli10080 Page 898\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 Audit:\\\nOn disk configuration\\\n\n\\f2\\b0 Run the following c",
      "remediation": "\\\nCreate audit rules\\\n\n\\f2\\b0 Edit or create a file in the \n\\f0 \\cf4 /etc/audit/rules.d/\n\\f2 \\cf2  directory, ending in \n\\f0 \\cf4 .rules\n\\f2 \\cf2  extension,\\\nwith the relevant rules to monitor elevated privileges.\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # printf \"\\\n-a always,exit -F arch=b64 -C euid!=uid -F auid!=unset -S execve -k\\\nuser_emulation\\\n-a always,exit -F arch=b32 -C euid!=uid -F auid!=unset -S execve -k\\\nuser_emulation\\\n\" >> /etc/audit/rules.d/50-user_emulation.rules\\\n\n\\f1\\b\\fs24 Load audit rules\\\n\n\\f2\\b0 Merge and load the rules into active configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # augenrules --load\\\n\n\\f2\\fs24 Check if reboot is required.\\\n\n\\f4\\fs20\\fsmilli10080 # if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot\\\nrequired to load rules\\\\n\"; fi\\\n\n\\f1\\b\\f",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Revision 5 :: AC-6 (8)\\\n2. RHEL 8 STIG Vul ID: V-230386\\\n3. RHEL 8 STIG Rule ID: SV-230386r854037\\\n\n\\f1\\b",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.3.2 | Level2"
    },
    {
      "id": "6.3.3.3",
      "title": "Ensure events that modify the sudo log file are collected\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Monitor the \n\\f0 \\cf4 sudo\n\\f2 \\cf2  log file. If the system has been properly configured to disable the use\\\nof the \n\\f0 \\cf4 su\n\\f2 \\cf2  command and force all administrators to have to log in first and then use \n\\f0 \\cf4 sudo\\\n\n\\f2 \\cf2 to execute privileged commands, then all administrator commands will be logged to\\\n\n\\f0 \\cf4 /var/log/sudo.log\n\\f2 \\cf2  . Any time a command is executed, an audit event will be\\\ntriggered as the \n\\f0 \\cf4 /var/log/sudo.log\n\\f2 \\cf2  file will be ope",
      "rationale": "\\\n\n\\f2\\b0 Changes in \n\\f0 \\cf4 /var/log/sudo.log\n\\f2 \\cf2  indicate that an administrator has executed a\\\ncommand or the log file itself has been tampered with. Administrators will want to\\\ncorrelate the events written to the",
      "impact": "None",
      "audit_command": "event will be\\\ntriggered as the \n\\f0 \\cf4 /var/log/sudo.log\n\\f2 \\cf2  file will be opened for write and the executed\\\nadministration command will be written to the log.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Changes in \n\\f0 \\cf4 /var/log/sudo.log\n\\f2 \\cf2  indicate that an administrator has executed a\\\ncommand or the log file itself has been tampered with. Administrators will want to\\\ncorrelate the events written to the audit trail with the records written to\\\n\n\\f0 \\cf4 /var/log/sudo.log\n\\f2 \\cf2  to verif",
      "remediation": "\\\nNote:\n\\f2\\b0  This recommendation requires that the sudo logfile is configured. See guidance\\\nprovided in the recommendation \"Ensure sudo log file exists\"\\\nEdit or create a file in the \n\\f0 \\cf4 /etc/audit/rules.d/\n\\f2 \\cf2  directory, ending in \n\\f0 \\cf4 .rules\n\\f2 \\cf2  extension,\\\nwith the relevant rules to monitor events that modify the sudo log file.\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # \\{\\\nSUDO_LOG_FILE=$(grep -r logfile /etc/sudoers* | sed -e 's/.*logfile=//;s/,?\\\n.*//' -e 's/\"//g')\\\n[ -n \"$\\{SUDO_LOG_FILE\\}\" ] && printf \"\\\n-w $\\{SUDO_LOG_FILE\\} -p wa -k sudo_log_file\\\n\" >> /etc/audit/rules.d/50-sudo.rules || printf \"ERROR: Variable\\\n'SUDO_LOG_FILE' is unset.\\\\n\"\\\n\\}\\\n\n\\f2\\fs24 Merge and load the rules into active configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # augenrules --load",
      "references": "",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.3.3 | Level2"
    },
    {
      "id": "6.3.3.6",
      "title": "Ensure use of privileged commands are collected\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Monitor privileged programs, those that have the \n\\f0 \\cf4 setuid\n\\f2 \\cf2  and/or \n\\f0 \\cf4 setgid\n\\f2 \\cf2  bit set on\\\nexecution, to determine if unprivileged users are running these commands.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Execution of privileged commands by non-privileged users could be an indication of\\\nsomeone trying to gain unauthorized access to the system.\\\n\n\\f1\\b",
      "impact": "\\\n\n\\f2\\b0 Both the",
      "audit_command": "and",
      "remediation": "section of this recommendation will traverse all mounted\\\nfile systems that is not mounted with either \n\\f0 \\cf4 noexec\n\\f2 \\cf2  or \n\\f0 \\cf4 nosuid\n\\f2 \\cf2  mount options. If there\\\nare large file systems without these mount options, \n\\f1\\b such traversal will be significantly\\\ndetrimental to the performance of the system.\\\n\n\\f2\\b0 Before running either the audit or remediation section, inspect the output of the following\\\ncommand to determine exactly which file systems will be traversed:\\\n\n\\f4\\fs20\\fsmilli10080 # findmnt -n -l -k -it $(awk '/nodev/ \\{ print $2 \\}' /proc/filesystems | paste\\\n-sd,) | grep -Pv \"noexec|nosuid\"\\\n\n\\f2\\fs24 To exclude a particular file system due to adverse performance impacts, update the\\\naudit and remediation sections by adding a sufficiently unique string ",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AU-3, AU-3(1)\n\\fs20\\fsmilli10080 Page 917\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.3.6 | Level2"
    },
    {
      "id": "6.3.3.7",
      "title": "Ensure unsuccessful file access attempts are collected\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Monitor for unsuccessful attempts to access files. The following parameters are\\\nassociated with system calls that control files:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 creation - \n\\f0 \\cf4 creat\\\n\n\\fs20\\fsmilli10080 \\cf2 \\'95\n\\f2  \n\\fs24 opening - \n\\f0 \\cf4 open\n\\f2 \\cf2  , \n\\f0 \\cf4 openat\\\n\n\\fs20\\fsmilli10080 \\cf2 \\'95\n\\f2  \n\\fs24 truncation - \n\\f0 \\cf4 truncate\n\\f2 \\cf2  , \n\\f0 \\cf4 ftruncate\\\n\n\\f2 \\cf2 An audit log record will only be written if all of the following criteria is ",
      "rationale": "\\\n\n\\f2\\b0 Failed attempts to open, create or truncate files could be an indication that an individual\\\nor process is trying to gain unauthorized access to the system.\\\nSatisfies: SRG-OS-000062-GPOS-00031, SRG-OS-000037-GPOS-00015, SRG-OS-\\\n000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000462-GPOS-00206,\\\nSRG-OS-000471-GPOS-00215, SRG-OS-000064-GPOS-00033\n\\fs20\\fsmilli10080 Page 919\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "log record will only be written if all of the following criteria is met for the user\\\nwhen trying to access a file:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 a non-privileged user (auid>=UID_MIN)\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 is not a Daemon event (auid=4294967295/unset/-1)\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 if the system call returned EACCES (permission denied) or EPERM (some other\\\npermanent error associated with the specific system call)\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Failed atte",
      "remediation": "\\\nCreate audit rules\\\n\n\\f2\\b0 Edit or create a file in the \n\\f0 \\cf4 /etc/audit/rules.d/\n\\f2 \\cf2  directory, ending in \n\\f0 \\cf4 .rules\n\\f2 \\cf2  extension,\\\nwith the relevant rules to monitor unsuccessful file access attempts.\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # \\{\\\nUID_MIN=$(awk '/^\\\\s*UID_MIN/\\{print $2\\}' /etc/login.defs)\\\n[ -n \"$\\{UID_MIN\\}\" ] && printf \"\\\n-a always,exit -F arch=b64 -S creat,open,openat,truncate,ftruncate -F exit=-\\\nEACCES -F auid>=$\\{UID_MIN\\} -F auid!=unset -k access\\\n-a always,exit -F arch=b64 -S creat,open,openat,truncate,ftruncate -F exit=-\\\nEPERM -F auid>=$\\{UID_MIN\\} -F auid!=unset -k access\\\n-a always,exit -F arch=b32 -S creat,open,openat,truncate,ftruncate -F exit=-\\\nEACCES -F auid>=$\\{UID_MIN\\} -F auid!=unset -k access\\\n-a always,exit -F arch=b32 ",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: AU-12 a\\\n2. NIST SP 800-53A :: AU-12.1 (ii)\\\n3. RHEL 8 STIG Vul ID: V-230449\\\n4. RHEL 8 STIG Rule ID: SV-230449r810455\n\\fs20\\fsmilli10080 Page 922\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.3.7 | Level2"
    },
    {
      "id": "6.3.3.10",
      "title": "Ensure successful file system mounts are collected\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Monitor the use of the \n\\f0 \\cf4 mount\n\\f2 \\cf2  system call. The \n\\f0 \\cf4 mount\n\\f2 \\cf2  (and \n\\f0 \\cf4 umount\n\\f2 \\cf2  ) system call controls\\\nthe mounting and unmounting of file systems. The parameters below configure the\\\nsystem to create an audit record when the mount system call is used by a non-\\\nprivileged user\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 It is highly unusual for a non privileged user to \n\\f0 \\cf4 mount\n\\f2 \\cf2  file systems to the system. While\\\ntracking \n\\f0 \\cf4 mount\n\\f2 \\cf2  commands gives the system administrator evidence that external media\\\nmay have been mounted (based on a review of the source of the mount and confirming\\\nit's an external media type), it does not conclusively indicate that data was exported to\\\nthe media. System administrators who wish to determine if data were exported, would\\\nalso have to t",
      "impact": "None",
      "audit_command": "record when the mount system call is used by a non-\\\nprivileged user\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 It is highly unusual for a non privileged user to \n\\f0 \\cf4 mount\n\\f2 \\cf2  file systems to the system. While\\\ntracking \n\\f0 \\cf4 mount\n\\f2 \\cf2  commands gives the system administrator evidence that external media\\\nmay have been mounted (based on a review of the source of the mount and confirming\\\nit's an external media type), it does not conclusively indicate that data was exported to\\\nthe media. S",
      "remediation": "\\\nCreate audit rules\\\n\n\\f2\\b0 Edit or create a file in the \n\\f0 \\cf4 /etc/audit/rules.d/\n\\f2 \\cf2  directory, ending in \n\\f0 \\cf4 .rules\n\\f2 \\cf2  extension,\\\nwith the relevant rules to monitor successful file system mounts.\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # \\{\\\nUID_MIN=$(awk '/^\\\\s*UID_MIN/\\{print $2\\}' /etc/login.defs)\\\n[ -n \"$\\{UID_MIN\\}\" ] && printf \"\\\n-a always,exit -F arch=b32 -S mount -F auid>=$UID_MIN -F auid!=unset -k\\\nmounts\\\n-a always,exit -F arch=b64 -S mount -F auid>=$UID_MIN -F auid!=unset -k\\\nmounts\\\n\" >> /etc/audit/rules.d/50-mounts.rules || printf \"ERROR: Variable 'UID_MIN'\\\nis unset.\\\\n\"\\\n\\}\\\n\n\\f1\\b\\fs24 Load audit rules\\\n\n\\f2\\b0 Merge and load the rules into active configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # augenrules --load\\\n\n\\f2\\fs24 Check if reboot is requir",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: AU-12 a\\\n2. NIST SP 800-53A :: AU-12.1 (ii)\\\n3. RHEL 8 STIG GROUP ID: V-230425\\\n4. RHEL 8 STIG RULE ID: SV-230425r627750\\\n\n\\f1\\b",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.3.10 | Level2"
    },
    {
      "id": "6.3.3.11",
      "title": "Ensure session initiation information is collected\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Monitor session initiation events. The parameters in this section track changes to the\\\nfiles associated with session events.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 /var/run/utmp\n\\f2 \\cf2  - tracks all currently logged in users.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 /var/log/wtmp\n\\f2 \\cf2  - file tracks logins, logouts, shutdown, and reboot events.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 /var/log/btmp\n\\f2 \\cf2  - keeps track of failed login attempts and ca",
      "rationale": "\\\n\n\\f2\\b0 Monitoring these files for changes could alert a system administrator to logins occurring\\\nat unusual hours, which could indicate intruder activity (i.e. a user logging in at a time\\\nwhen they do not normally log in).\n\\fs20\\fsmilli10080 Page 937\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "records will be tagged with the identifier \"session.\"\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Monitoring these files for changes could alert a system administrator to logins occurring\\\nat unusual hours, which could indicate intruder activity (i.e. a user logging in at a time\\\nwhen they do not normally log in).\n\\fs20\\fsmilli10080 Page 937\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 Audit:\\\nOn disk configuration\\\n\n\\f2\\b0 Run the following command to check the on disk rules:\\\n\n\\f4\\fs20\\fsmilli10080 # awk '/^ *-",
      "remediation": "\\\n\n\\f2\\b0 Edit or create a file in the \n\\f0 \\cf4 /etc/audit/rules.d/\n\\f2 \\cf2  directory, ending in \n\\f0 \\cf4 .rules\n\\f2 \\cf2  extension,\\\nwith the relevant rules to monitor session initiation information.\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # printf \"\\\n-w /var/run/utmp -p wa -k session\\\n-w /var/log/wtmp -p wa -k session\\\n-w /var/log/btmp -p wa -k session\\\n\" >> /etc/audit/rules.d/50-session.rules\\\n\n\\f2\\fs24 Merge and load the rules into active configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # augenrules --load\\\n\n\\f2\\fs24 Check if reboot is required.\\\n\n\\f4\\fs20\\fsmilli10080 # if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot\\\nrequired to load rules\\\\n\"; fi\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AU-3, AU-3\\\n\n\\f1\\b",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.3.11 | Level2"
    },
    {
      "id": "6.3.3.12",
      "title": "Ensure login and logout events are collected\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Monitor login and logout events. The parameters below track changes to files\\\nassociated with login/logout events.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 /var/log/lastlog\n\\f2 \\cf2  - maintain records of the last time a user successfully logged\\\nin.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 /var/run/faillock\n\\f2 \\cf2  - directory maintains records of login failures via the\\\n\n\\f0 \\cf4 pam_faillock\n\\f2 \\cf2  module.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Monitoring login/logout events could provide a system administrator with information\\\nassociated with brute force attacks against user logins.\\\nSatisfies: SRG-OS-000062-GPOS-00031, SRG-OS-000037-GPOS-00015, SRG-OS-\\\n000042-GPOS-00020, SRG-OS-000062-GPOS-00031, SRG-OS-000392-GPOS-00172,\\\nSRG-OS-000462-GPOS-00206, SRG-OS-000471-GPOS-00215, SRG-OS-000473-\\\nGPOS-00218\n\\fs20\\fsmilli10080 Page 941\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\nOn disk configuration\\\n\n\\f2\\b0 Run the following command to check the on disk rules:\\\n\n\\f4\\fs20\\fsmilli10080 # awk '/^ *-w/ \\\\\\\n&&(/\\\\/var\\\\/log\\\\/lastlog/ \\\\\\\n||/\\\\/var\\\\/run\\\\/faillock/) \\\\\\\n&&/ +-p *wa/ \\\\\\\n&&(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules\\\n\n\\f2\\fs24 Verify the output matches:\\\n\n\\f4\\fs20\\fsmilli10080 -w /var/log/lastlog -p wa -k logins\\\n-w /var/run/faillock -p wa -k logins\\\n\n\\f1\\b\\fs24 Running configuration\\\n\n\\f2\\b0 Run the following command to check load",
      "remediation": "\\\n\n\\f2\\b0 Edit or create a file in the \n\\f0 \\cf4 /etc/audit/rules.d/\n\\f2 \\cf2  directory, ending in \n\\f0 \\cf4 .rules\n\\f2 \\cf2  extension,\\\nwith the relevant rules to monitor login and logout events.\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # printf \"\\\n-w /var/log/lastlog -p wa -k logins\\\n-w /var/run/faillock -p wa -k logins\\\n\" >> /etc/audit/rules.d/50-login.rules\\\n\n\\f2\\fs24 Merge and load the rules into active configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # augenrules --load\\\n\n\\f2\\fs24 Check if reboot is required.\\\n\n\\f4\\fs20\\fsmilli10080 # if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot\\\nrequired to load rules\\\\n\"; fi\n\\f2 Page 942\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: AU-12 a\\\n2. NIST SP 800-53A :: AU-12.1 (ii)\\\n3. RHEL 8 STIG Vul ID: V-230467\\\n4. RHEL 8 STIG Rule ID: SV-230467r627750\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/audit/rules.d/*.rules\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.3.12 | Level2"
    },
    {
      "id": "6.3.3.13",
      "title": "Ensure file deletion events by users are collected\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Monitor the use of system calls associated with the deletion or renaming of files and file\\\nattributes. This configuration statement sets up monitoring for:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 unlink\n\\f2 \\cf2  - remove a file\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 unlinkat\n\\f2 \\cf2  - remove a file attribute\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 rename\n\\f2 \\cf2  - rename a file\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 renameat\n\\f2 \\cf2  rename ",
      "rationale": "\\\n\n\\f2\\b0 Monitoring these calls from non-privileged users could provide a system administrator\\\nwith evidence that inappropriate removal of files and file attributes associated with\\\nprotected files is occurring. While this",
      "impact": "None",
      "audit_command": "option will look at all events, system\\\nadministrators will want to look for specific privileged files that are being deleted or\\\naltered.\\\nSatisfies: SRG-OS-000062-GPOS-00031, SRG-OS-000037-GPOS-00015, SRG-OS-\\\n000042-GPOS-00020, SRG-OS-000392-GPOS-00172, SRG-OS-000462-GPOS-00206,\\\nSRG-OS-000471-GPOS-00215\n\\fs20\\fsmilli10080 Page 944\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 Audit:\\\nOn disk configuration\\\n\n\\f2\\b0 Run the following command to check the on disk rules:\\\n\n\\f4\\fs20\\fsmilli10080 # \\",
      "remediation": "\\\nCreate audit rules\\\n\n\\f2\\b0 Edit or create a file in the \n\\f0 \\cf4 /etc/audit/rules.d/\n\\f2 \\cf2  directory, ending in \n\\f0 \\cf4 .rules\n\\f2 \\cf2  extension,\\\nwith the relevant rules to monitor file deletion events by users.\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # \\{\\\nUID_MIN=$(awk '/^\\\\s*UID_MIN/\\{print $2\\}' /etc/login.defs)\\\n[ -n \"$\\{UID_MIN\\}\" ] && printf \"\\\n-a always,exit -F arch=b64 -S rename,unlink,unlinkat,renameat -F\\\nauid>=$\\{UID_MIN\\} -F auid!=unset -F key=delete\\\n-a always,exit -F arch=b32 -S rename,unlink,unlinkat,renameat -F\\\nauid>=$\\{UID_MIN\\} -F auid!=unset -F key=delete\\\n\" >> /etc/audit/rules.d/50-delete.rules || printf \"ERROR: Variable 'UID_MIN'\\\nis unset.\\\\n\"\\\n\\}\\\n\n\\f1\\b\\fs24 Load audit rules\\\n\n\\f2\\b0 Merge and load the rules into active configuration:\\\n\n\\f4\\fs20\\f",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: AU-12 a\\\n2. NIST SP 800-53A :: AU-12.1 (ii)\\\n3. RHEL 8 STIG Vul ID: V-230439\\\n4. RHEL 8 STIG Rule ID: SV-230439r810465\\\n\n\\f1\\b",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.3.13 | Level2"
    },
    {
      "id": "6.3.3.21",
      "title": "Ensure the audit configuration is immutable",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Set system audit so that audit rules cannot be modified with \n\\f0 \\cf4 auditctl\n\\f2 \\cf2  . Setting the flag\\\n\"\\\n-e 2\" forces audit to be put in immutable mode. Audit changes can only be made on\\\nsystem reboot.\\\n\n\\f1\\b Note:\n\\f2\\b0  This setting will require the system to be rebooted to update the active \n\\f0 \\cf4 auditd\\\n\n\\f2 \\cf2 configuration settings.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 In immutable mode, unauthorized users cannot execute changes to the",
      "impact": "None",
      "audit_command": "configuration is immutable (Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 Set system audit so that audit rules cannot be modified with \n\\f0 \\cf4 auditctl\n\\f2 \\cf2  . Setting the flag\\\n\"\\\n-e 2\" forces audit to be put in immutable mode. Audit changes can only be made on\\\nsystem reboot.\\\n\n\\f1\\b Note:\n\\f2\\b0  This setting will require the system to be rebooted to update the active \n\\f0 \\c",
      "remediation": "\\\n\n\\f2\\b0 Edit or create the file \n\\f0 \\cf4 /etc/audit/rules.d/99-finalize.rules\n\\f2 \\cf2  and add the line \n\\f0 \\cf4 -e\\\n2\n\\f2 \\cf2  at the end of the file:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # printf '%s\\\\n' \"\" \"-e 2\" >> /etc/audit/rules.d/99-finalize.rules\\\n\n\\f1\\b\\fs24 Load audit rules\\\n\n\\f2\\b0 Merge and load the rules into active configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # augenrules --load\\\n\n\\f2\\fs24 Check if reboot is required.\\\n\n\\f4\\fs20\\fsmilli10080 # if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot\\\nrequired to load rules\\\\n\"; fi\n\\f2 Page 974\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: AU-9\\\n2. NIST SP 800-53A :: AU-9.1\\\n3. RHEL 8 STIG Vul ID: V-230402\\\n4. RHEL 8 STIG Rule ID: SV-230402r627750\\\n\n\\f1\\b",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.3.21 | Level2"
    },
    {
      "id": "6.3.3.22",
      "title": "Ensure the running and on disk configuration is the same\\",
      "automated": false,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 The Audit system have both on disk and running configuration. It is possible for these\\\nconfiguration settings to differ.\\\n\n\\f1\\b Note:\n\\f2\\b0  Due to the limitations of \n\\f0 \\cf4 augenrules\n\\f2 \\cf2  and \n\\f0 \\cf4 auditctl\n\\f2 \\cf2 , it is not absolutely\\\nguaranteed that loading the rule sets via \n\\f0 \\cf4 augenrules --load\n\\f2 \\cf2  will result in all rules\\\nbeing loaded or even that the user will be informed if there was a problem loading the\\\nrules.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Configuration differences between what is currently running and what is on disk could\\\ncause unexpected problems or may give a false impression of compliance\\\nrequirements.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "system have both on disk and running configuration. It is possible for these\\\nconfiguration settings to differ.\\\n\n\\f1\\b Note:\n\\f2\\b0  Due to the limitations of \n\\f0 \\cf4 augenrules\n\\f2 \\cf2  and \n\\f0 \\cf4 auditctl\n\\f2 \\cf2 , it is not absolutely\\\nguaranteed that loading the rule sets via \n\\f0 \\cf4 augenrules --load\n\\f2 \\cf2  will result in all rules\\\nbeing loaded or even that the user will be informed if there was a problem loading the\\\nrules.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Configuration difference",
      "remediation": "\\\n\n\\f2\\b0 If the rules are not aligned across all three () areas, run the following command to\\\nmerge and load all rules:\\\n\n\\f4\\fs20\\fsmilli10080 # augenrules --load\\\n\n\\f2\\fs24 Check if reboot is required.\\\n\n\\f4\\fs20\\fsmilli10080 if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then echo \"Reboot required\\\nto load rules\"; fi\n\\f2 Page 976\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AU-3\\\n\n\\f1\\b",
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.3.22 | Level2"
    },
    {
      "title": "Ensure permissions on /etc/gshadow- are configured",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The /etc/gshadow- file is used to store backup information about groups that is critical to the security of those accounts, such as the hashed password and other security information.",
      "rationale": "It is critical to ensure that the /etc/gshadow- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "audit": "Run the following command and verify Uid is 0/root, Gid is 0/root, and Access is 0000 or more restrictive:\n# stat /etc/gshadow-\nAccess: (0000/----------) Uid: ( 0/ root) Gid: ( 0/ root)",
      "remediation": "Run the following commands to set permissions on /etc/gshadow-:\n# chown root:root /etc/gshadow-\n# chmod 0000 /etc/gshadow-",
      "impact": "None",
      "default_value": "0000 root root",
      "references": "1. See the gshadow(5) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "FilePermissions",
      "check_value": "/etc/gshadow-:0000:root:root",
      "id": "6.3.4"
    },
    {
      "id": "6.3.4.1",
      "title": "Ensure the audit log file directory mode is configured\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 The audit log directory contains audit log files.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0",
      "impact": "None",
      "audit_command": "log file directory mode is configured\\\n(Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 The audit log directory contains audit log files.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Audit information includes all information including: audit records, audit settings and\\\naudit reports. This information is needed to successfully audit system activity. This\\\ninformation must be protected from unauthorized",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to configure the audit log directory to have a mode of\\\n\"0750\" or less permissive:\\\n\n\\f4\\fs20\\fsmilli10080 # chmod g-w,o-rwx \"$(dirname \"$(awk -F= '/^\\\\s*log_file\\\\s*/\\{print $2\\}'\\\n/etc/audit/auditd.conf | xargs)\")\"\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AU-3\n\\fs20\\fsmilli10080 Page 980\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.4.1 | Level2"
    },
    {
      "id": "6.3.4.2",
      "title": "Ensure audit log files mode is configured",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Audit log files contain information about the system and system activity.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Access to",
      "impact": "None",
      "audit_command": "log files mode is configured (Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 Audit log files contain information about the system and system activity.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Access to audit records can reveal system and configuration data to attackers,\\\npotentially compromising its confidentiality.\n\\fs20\\fsmilli10080 Page 982\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 Audit:\\\n\n\\f2",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to remove more permissive mode than \n\\f0 \\cf4 0640\n\\f2 \\cf2  from audit log\\\nfiles:\\\n\n\\f4\\fs20\\fsmilli10080 # [ -f /etc/audit/auditd.conf ] && find \"$(dirname $(awk -F \"=\"\\\n'/^\\\\s*log_file/ \\{print $2\\}' /etc/audit/auditd.conf | xargs))\" -type f -perm\\\n/0137 -exec chmod u-x,g-wx,o-rwx \\{\\} +\\\n\n\\f1\\b\\fs24 CIS Controls:\\\nControls\\\nVersion Control IG 1 IG 2 IG 3\\\n\n\\f2\\b0 v8\\\n3.3 Configure Data Access Control Lists\\\n\n\\fs16\\fsmilli8400 Configure data access control lists based on a user\\'92s need to know. Apply data\\\naccess control lists, also known as access permissions, to local and remote file\\\nsystems, databases, and applications.\\\n\n\\fs27\\fsmilli13920 \\cf8 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf5 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf6 \\u",
      "references": "",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.4.2 | Level2"
    },
    {
      "id": "6.3.4.3",
      "title": "Ensure audit log files owner is configured",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Audit log files contain information about the system and system activity.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Access to",
      "impact": "None",
      "audit_command": "log files owner is configured (Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 Audit log files contain information about the system and system activity.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Access to audit records can reveal system and configuration data to attackers,\\\npotentially compromising its confidentiality.\\\n\n\\f1\\b Audit:\\\n\n\\f2\\b0 Run the following script to verify audit log files are own",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to configure the audit log files to be owned by the \n\\f0 \\cf4 root\\\n\n\\f2 \\cf2 user:\\\n\n\\f4\\fs20\\fsmilli10080 # [ -f /etc/audit/auditd.conf ] && find \"$(dirname $(awk -F \"=\"\\\n'/^\\\\s*log_file/ \\{print $2\\}' /etc/audit/auditd.conf | xargs))\" -type f ! -user\\\nroot -exec chown root \\{\\} +\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: CM-7\\\n2. NIST SP 800-53A :: CM-7.1 (ii)\\\n3. RHEL 8 STIG Vul ID: V-230397\\\n4. RHEL 8 STIG Rule ID: SV-230397r627750\\\n\n\\f1\\b",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.4.3 | Level2"
    },
    {
      "id": "6.3.4.4",
      "title": "Ensure audit log files group owner is configured\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Audit log files contain information about the system and system activity.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Access to",
      "impact": "None",
      "audit_command": "log files group owner is configured\\\n(Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 Audit log files contain information about the system and system activity.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Access to audit records can reveal system and configuration data to attackers,\\\npotentially compromising its confidentiality.\n\\fs20\\fsmilli10080 Page 987\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 Audi",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to configure the audit log files to be owned by \n\\f0 \\cf4 adm\n\\f2 \\cf2  group:\\\n\n\\f4\\fs20\\fsmilli10080 # find $(dirname $(awk -F\"=\" '/^\\\\s*log_file\\\\s*=\\\\s*/ \\{print $2\\}'\\\n/etc/audit/auditd.conf | xargs)) -type f \\\\( ! -group adm -a ! -group root \\\\)\\\n-exec chgrp adm \\{\\} +\\\n\n\\f2\\fs24 Run the following command to configure the audit log files to be owned by the \n\\f0 \\cf4 adm\\\n\n\\f2 \\cf2 group:\\\n\n\\f4\\fs20\\fsmilli10080 # chgrp adm /var/log/audit/\\\n\n\\f2\\fs24 Run the following command to set the \n\\f0 \\cf4 log_group\n\\f2 \\cf2  parameter in the audit configuration\\\nfile to \n\\f0 \\cf4 log_group = adm\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # sed -ri 's/^\\\\s*#?\\\\s*log_group\\\\s*=\\\\s*\\\\S+(\\\\s*#.*)?.*$/log_group = adm\\\\1/'\\\n/etc/audit/auditd.conf\\\n\n\\f2\\fs24 Run the follow",
      "references": "",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.4.4 | Level2"
    },
    {
      "id": "6.3.4.5",
      "title": "Ensure audit configuration files mode is configured\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Audit configuration files control auditd and what events are audited.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Access to the",
      "impact": "the system's performance by overwhelming the",
      "audit_command": "configuration files mode is configured\\\n(Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 Audit configuration files control auditd and what events are audited.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Access to the audit configuration files could allow unauthorized personnel to prevent the\\\nauditing of critical events.\\\nMisconfigured audit configuration files may prevent the auditing of critical even",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to remove more permissive mode than 0640 from the audit\\\nconfiguration files:\\\n\n\\f4\\fs20\\fsmilli10080 # find /etc/audit/ -type f \\\\( -name '*.conf' -o -name '*.rules' \\\\) -exec\\\nchmod u-x,g-wx,o-rwx \\{\\} +\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: AU-12 b\\\n2. NIST SP 800-53A :: AU-12.1 (iii)\\\n3. RHEL 8 STIG Vul ID: V-230471\\\n4. RHEL 8 STIG Rule ID: SV-230471r627750\\\n\n\\f1\\b",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.4.5 | Level2"
    },
    {
      "id": "6.3.4.6",
      "title": "Ensure audit configuration files owner is configured\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Audit configuration files control auditd and what events are audited.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Access to the",
      "impact": "the system's performance by overwhelming the",
      "audit_command": "configuration files owner is configured\\\n(Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 Audit configuration files control auditd and what events are audited.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Access to the audit configuration files could allow unauthorized personnel to prevent the\\\nauditing of critical events.\\\nMisconfigured audit configuration files may prevent the auditing of critical eve",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to change ownership to \n\\f0 \\cf4 root\n\\f2 \\cf2  user:\\\n\n\\f4\\fs20\\fsmilli10080 # find /etc/audit/ -type f \\\\( -name '*.conf' -o -name '*.rules' \\\\) ! -user\\\nroot -exec chown root \\{\\} +\n\\f2 Page 992\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 CIS Controls:\\\nControls\\\nVersion Control IG 1 IG 2 IG 3\\\n\n\\f2\\b0 v8\\\n3.3 Configure Data Access Control Lists\\\n\n\\fs16\\fsmilli8400 Configure data access control lists based on a user\\'92s need to know. Apply data\\\naccess control lists, also known as access permissions, to local and remote file\\\nsystems, databases, and applications.\\\n\n\\fs27\\fsmilli13920 \\cf8 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf5 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf6 \\uc0\\u9679 \\\n\n\\fs24 \\cf2 v7\\\n14.6 Protect Information through Acces",
      "references": "",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.4.6 | Level2"
    },
    {
      "id": "6.3.4.7",
      "title": "Ensure audit configuration files group owner is configured\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Audit configuration files control auditd and what events are audited.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Access to the",
      "impact": "the system's performance by overwhelming the",
      "audit_command": "configuration files group owner is configured\\\n(Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 Audit configuration files control auditd and what events are audited.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Access to the audit configuration files could allow unauthorized personnel to prevent the\\\nauditing of critical events.\\\nMisconfigured audit configuration files may prevent the auditing of critic",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to change group to \n\\f0 \\cf4 root\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # find /etc/audit/ -type f \\\\( -name '*.conf' -o -name '*.rules' \\\\) ! -group\\\nroot -exec chgrp root \\{\\} +\n\\f2 Page 994\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 CIS Controls:\\\nControls\\\nVersion Control IG 1 IG 2 IG 3\\\n\n\\f2\\b0 v8\\\n3.3 Configure Data Access Control Lists\\\n\n\\fs16\\fsmilli8400 Configure data access control lists based on a user\\'92s need to know. Apply data\\\naccess control lists, also known as access permissions, to local and remote file\\\nsystems, databases, and applications.\\\n\n\\fs27\\fsmilli13920 \\cf8 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf5 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf6 \\uc0\\u9679 \\\n\n\\fs24 \\cf2 v7\\\n14.6 Protect Information through Access Contro",
      "references": "",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.4.7 | Level2"
    },
    {
      "id": "6.3.4.8",
      "title": "Ensure audit tools mode is configured",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Audit tools include, but are not limited to, vendor-provided and open source audit tools\\\nneeded to successfully view and manipulate audit information system activity and\\\nrecords. Audit tools include custom queries and report generators.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Protecting",
      "impact": "None",
      "audit_command": "tools mode is configured (Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 Audit tools include, but are not limited to, vendor-provided and open source audit tools\\\nneeded to successfully view and manipulate audit information system activity and\\\nrecords. Audit tools include custom queries and report generators.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Protecting audit information includes identifyin",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to remove more permissive mode from the audit tools:\\\n\n\\f4\\fs20\\fsmilli10080 # chmod go-w /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace\\\n/sbin/auditd /sbin/augenrules\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AU-3\\\n\n\\f1\\b",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.4.8 | Level2"
    },
    {
      "id": "6.3.4.9",
      "title": "Ensure audit tools owner is configured",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Audit tools include, but are not limited to, vendor-provided and open source audit tools\\\nneeded to successfully view and manipulate audit information system activity and\\\nrecords. Audit tools include custom queries and report generators.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Protecting",
      "impact": "None",
      "audit_command": "tools owner is configured (Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 Audit tools include, but are not limited to, vendor-provided and open source audit tools\\\nneeded to successfully view and manipulate audit information system activity and\\\nrecords. Audit tools include custom queries and report generators.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Protecting audit information includes identifyi",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to change the owner of the audit tools to the \n\\f0 \\cf4 root\n\\f2 \\cf2  user:\\\n\n\\f4\\fs20\\fsmilli10080 # chown root /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace\\\n/sbin/auditd /sbin/augenrules\n\\f2 Page 998\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 CIS Controls:\\\nControls\\\nVersion Control IG 1 IG 2 IG 3\\\n\n\\f2\\b0 v8\\\n3.3 Configure Data Access Control Lists\\\n\n\\fs16\\fsmilli8400 Configure data access control lists based on a user\\'92s need to know. Apply data\\\naccess control lists, also known as access permissions, to local and remote file\\\nsystems, databases, and applications.\\\n\n\\fs27\\fsmilli13920 \\cf8 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf5 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf6 \\uc0\\u9679 \\\n\n\\fs24 \\cf2 v7\\\n14.6 Protect Inform",
      "references": "",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.4.9 | Level2"
    },
    {
      "id": "6.3.4.10",
      "title": "Ensure audit tools group owner is configured\\",
      "automated": true,
      "profile": "Level2",
      "section": "6.3",
      "description": "\\\n\n\\f2\\b0 Audit tools include, but are not limited to, vendor-provided and open source audit tools\\\nneeded to successfully view and manipulate audit information system activity and\\\nrecords. Audit tools include custom queries and report generators.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Protecting",
      "impact": "None",
      "audit_command": "tools group owner is configured\\\n(Automated)\\\n\n\\f1\\i0\\b\\fs24 \\cf2 Profile Applicability:\\\n\n\\f0\\b0 \\'95\n\\f2  Level 2 - Server\\\n\n\\f0 \\'95\n\\f2  Level 2 - Workstation\\\n\n\\f1\\b Description:\\\n\n\\f2\\b0 Audit tools include, but are not limited to, vendor-provided and open source audit tools\\\nneeded to successfully view and manipulate audit information system activity and\\\nrecords. Audit tools include custom queries and report generators.\\\n\n\\f1\\b Rationale:\\\n\n\\f2\\b0 Protecting audit information includes id",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to change group ownership to the group \n\\f0 \\cf4 root\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # chgrp root /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace\\\n/sbin/auditd /sbin/augenrules\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AU-3\n\\fs20\\fsmilli10080 Page 1000\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.3.4.10 | Level2"
    },
    {
      "title": "Ensure no world writable files exist",
      "level": 1,
      "scored": false,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "Unix-based systems support variable settings to control access to files. World writable files are the least secure.",
      "rationale": "Data in world-writable files can be modified and compromised by any user on the system. World writable files may also indicate an incorrectly written script or program that could potentially be the cause of a larger compromise to the system's integrity.",
      "audit": "Run the following command and verify no files are returned:\n# df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type f -perm -0002",
      "remediation": "Removing write access for the \"other\" category (chmod o-w <filename>) is advisable, but always consult relevant vendor documentation to avoid breaking any application dependencies on a given file.",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the chmod(1) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "Manual",
      "check_value": "",
      "id": "6.3.5"
    },
    {
      "title": "Ensure no unowned files or directories exist",
      "level": 1,
      "scored": false,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "Sometimes when administrators delete users from the password file they neglect to remove all files owned by those users from the system.",
      "rationale": "A new user who is assigned the deleted user's user ID or group ID may then end up \"owning\" these files, and thus have more access on the system than was intended.",
      "audit": "Run the following command and verify no files are returned:\n# df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -nouser",
      "remediation": "Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate.",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the find(1) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "Manual",
      "check_value": "",
      "id": "6.3.6"
    },
    {
      "title": "Ensure no ungrouped files or directories exist",
      "level": 1,
      "scored": false,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "Sometimes when administrators delete groups from the password file they neglect to remove all files owned by those groups from the system.",
      "rationale": "A new group that is assigned the deleted group's group ID may then end up \"owning\" these files, and thus have more access on the system than was intended.",
      "audit": "Run the following command and verify no files are returned:\n# df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -nogroup",
      "remediation": "Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active group on the system as appropriate.",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the find(1) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "Manual",
      "check_value": "",
      "id": "6.3.7"
    }
  ]
}