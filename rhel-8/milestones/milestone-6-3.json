{
  "milestone": "6.3",
  "title": "System File Permissions",
  "controls": [
    {
      "control_id": "6.3.1",
      "title": "Ensure permissions on /etc/passwd- are configured",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The /etc/passwd- file contains backup user account information.",
      "rationale": "It is critical to ensure that the /etc/passwd- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "audit": "Run the following command and verify Uid and Gid are both 0/root and Access is 644 or more restrictive:\n# stat /etc/passwd-\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)",
      "remediation": "Run the following commands to set permissions on /etc/passwd-:\n# chown root:root /etc/passwd-\n# chmod u-x,go-wx /etc/passwd-",
      "impact": "None",
      "default_value": "0644 root root",
      "references": "1. See the passwd(5) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "FilePermissions",
      "check_value": "/etc/passwd-:0644:root:root"
    },
    {
      "control_id": "6.3.2",
      "title": "Ensure permissions on /etc/group- are configured",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The /etc/group- file contains a backup list of all the valid groups defined in the system.",
      "rationale": "It is critical to ensure that the /etc/group- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "audit": "Run the following command and verify Uid and Gid are both 0/root and Access is 644 or more restrictive:\n# stat /etc/group-\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)",
      "remediation": "Run the following commands to set permissions on /etc/group-:\n# chown root:root /etc/group-\n# chmod u-x,go-wx /etc/group-",
      "impact": "None",
      "default_value": "0644 root root",
      "references": "1. See the group(5) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "FilePermissions",
      "check_value": "/etc/group-:0644:root:root"
    },
    {
      "control_id": "6.3.3",
      "title": "Ensure permissions on /etc/shadow- are configured",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The /etc/shadow- file is used to store backup information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.",
      "rationale": "It is critical to ensure that the /etc/shadow- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "audit": "Run the following command and verify Uid is 0/root, Gid is 0/root, and Access is 0000 or more restrictive:\n# stat /etc/shadow-\nAccess: (0000/----------) Uid: ( 0/ root) Gid: ( 0/ root)",
      "remediation": "Run the following commands to set permissions on /etc/shadow-:\n# chown root:root /etc/shadow-\n# chmod 0000 /etc/shadow-",
      "impact": "None",
      "default_value": "0000 root root",
      "references": "1. See the shadow(5) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "FilePermissions",
      "check_value": "/etc/shadow-:0000:root:root"
    },
    {
      "control_id": "6.3.4",
      "title": "Ensure permissions on /etc/gshadow- are configured",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The /etc/gshadow- file is used to store backup information about groups that is critical to the security of those accounts, such as the hashed password and other security information.",
      "rationale": "It is critical to ensure that the /etc/gshadow- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
      "audit": "Run the following command and verify Uid is 0/root, Gid is 0/root, and Access is 0000 or more restrictive:\n# stat /etc/gshadow-\nAccess: (0000/----------) Uid: ( 0/ root) Gid: ( 0/ root)",
      "remediation": "Run the following commands to set permissions on /etc/gshadow-:\n# chown root:root /etc/gshadow-\n# chmod 0000 /etc/gshadow-",
      "impact": "None",
      "default_value": "0000 root root",
      "references": "1. See the gshadow(5) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "FilePermissions",
      "check_value": "/etc/gshadow-:0000:root:root"
    },
    {
      "control_id": "6.3.5",
      "title": "Ensure no world writable files exist",
      "level": 1,
      "scored": false,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "Unix-based systems support variable settings to control access to files. World writable files are the least secure.",
      "rationale": "Data in world-writable files can be modified and compromised by any user on the system. World writable files may also indicate an incorrectly written script or program that could potentially be the cause of a larger compromise to the system's integrity.",
      "audit": "Run the following command and verify no files are returned:\n# df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type f -perm -0002",
      "remediation": "Removing write access for the \"other\" category (chmod o-w <filename>) is advisable, but always consult relevant vendor documentation to avoid breaking any application dependencies on a given file.",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the chmod(1) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "Manual",
      "check_value": ""
    },
    {
      "control_id": "6.3.6",
      "title": "Ensure no unowned files or directories exist",
      "level": 1,
      "scored": false,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "Sometimes when administrators delete users from the password file they neglect to remove all files owned by those users from the system.",
      "rationale": "A new user who is assigned the deleted user's user ID or group ID may then end up \"owning\" these files, and thus have more access on the system than was intended.",
      "audit": "Run the following command and verify no files are returned:\n# df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -nouser",
      "remediation": "Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate.",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the find(1) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "Manual",
      "check_value": ""
    },
    {
      "control_id": "6.3.7",
      "title": "Ensure no ungrouped files or directories exist",
      "level": 1,
      "scored": false,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "Sometimes when administrators delete groups from the password file they neglect to remove all files owned by those groups from the system.",
      "rationale": "A new group that is assigned the deleted group's group ID may then end up \"owning\" these files, and thus have more access on the system than was intended.",
      "audit": "Run the following command and verify no files are returned:\n# df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -nogroup",
      "remediation": "Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active group on the system as appropriate.",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the find(1) man page for more information.",
      "cis_controls": "v8: 3.3 Configure Data Access Control Lists\nv7: 14.6 Protect Information through Access Control Lists",
      "check_type": "Manual",
      "check_value": ""
    }
  ]
}
