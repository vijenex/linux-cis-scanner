{
  "milestone": "4.1.3",
  "title": "Configure auditd Rules",
  "controls": [
    {
      "id": "4.1.3",
      "title": "Ensure firewalld.service is configured",
      "automated": true,
      "profile": "Level1",
      "section": "4.1",
      "description": "\\\n\n\\f0\\b0 \\cf4 firewalld.service\n\\f2 \\cf2  is a firewall service daemon that provides a dynamic,\\\ncustomizable firewall with a D-Bus interface.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f0\\b0 \\cf4 firewalld.service\n\\f2 \\cf2  must be active to enforce rules configured through FirewallD.\\\n\n\\f0 \\cf4 firewalld.service\n\\f2 \\cf2  must be enabled to start automatically after a system reboot.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify \n\\f0 \\cf4 firewalld.service\n\\f2 \\cf2  is enabled:\\\n\n\\f4\\fs20\\fsmilli10080 # systemctl is-enabled firewalld.service\\\nenabled\\\n\n\\f2\\fs24 Run the following command to verify \n\\f0 \\cf4 firewalld.service\n\\f2 \\cf2  is active:\\\n\n\\f4\\fs20\\fsmilli10080 # systemctl is-active firewalld.service\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following commands to unmask, enable, and start \n\\f0 \\cf4 firewalld.service\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # systemctl unmask firewalld.service\\\n# systemctl --now enable firewalld.service\\\n\n\\f1\\b\\fs24 CIS Controls:\\\nControls\\\nVersion Control IG 1 IG 2 IG 3\\\n\n\\f2\\b0 v8\\\n4.4 Implement and Manage a Firewall on Servers\\\n\n\\fs16\\fsmilli8400 Implement and manage a firewall on servers, where supported. Example\\\nimplementations include a virtual firewall, operating system firewall, or a third-\\\nparty firewall agent.\\\n\n\\fs27\\fsmilli13920 \\cf8 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf5 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf6 \\uc0\\u9679 \\\n\n\\fs24 \\cf2 v7\\\n9.4 Apply Host-based Firewalls or Port Filtering\\\n\n\\fs16\\fsmilli8400 Apply host-based firewalls or port filterin",
      "references": "",
      "type": "ServiceStatus",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 4.1.3 | Level1"
    },
    {
      "title": "Ensure changes to system administration scope (sudoers) is collected",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "Monitor scope changes for system administrations. If the system has been properly configured to force system administrators to log in as themselves first and then use the sudo command to execute privileged commands, it is possible to monitor changes in scope.",
      "rationale": "Changes in the /etc/sudoers file can indicate that an unauthorized change has been made to scope of system administrator activity.",
      "audit": "Run the following command and verify output matches:\n# auditctl -l | grep scope\n-w /etc/sudoers -p wa -k scope\n-w /etc/sudoers.d/ -p wa -k scope",
      "remediation": "Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/scope.rules\nAdd the following lines:\n-w /etc/sudoers -p wa -k scope\n-w /etc/sudoers.d/ -p wa -k scope",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the auditctl(8) and auditd(8) man pages for more information.",
      "cis_controls": "v8: 8.5 Collect Detailed Audit Logs\nv7: 4.9 Log and Alert on Unsuccessful Administrative Account Login",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.1.3.1"
    },
    {
      "title": "Ensure actions as another user are always logged",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "sudo provides users with temporary elevated privileges to perform operations, either as the superuser or another user.",
      "rationale": "Creating an audit log of users with temporary elevated privileges and the operation(s) they performed is essential to reporting. Administrators will want to correlate the events written to the audit trail with the records written to sudo's logfile to verify if unauthorized commands have been executed.",
      "audit": "Run the following command and verify output matches:\n# auditctl -l | grep actions\n-a always,exit -F arch=b64 -C euid!=uid -F auid!=unset -S execve -k actions\n-a always,exit -F arch=b32 -C euid!=uid -F auid!=unset -S execve -k actions",
      "remediation": "Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/actions.rules\nAdd the following lines:\n-a always,exit -F arch=b64 -C euid!=uid -F auid!=unset -S execve -k actions\n-a always,exit -F arch=b32 -C euid!=uid -F auid!=unset -S execve -k actions",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the auditctl(8) and auditd(8) man pages for more information.",
      "cis_controls": "v8: 8.5 Collect Detailed Audit Logs\nv7: 4.9 Log and Alert on Unsuccessful Administrative Account Login",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.1.3.2"
    },
    {
      "title": "Ensure events that modify date and time information are collected",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "Capture events where the system date and/or time has been modified. The parameters in this section are set to determine if the adjtimex (tune kernel clock), settimeofday (Set time, using timeval and timezone structures) stime (using seconds since 1/1/1970) or clock_settime (allows for the setting of several internal clocks and timers) system calls have been executed and always write an audit record to the /var/log/audit.log file upon exit, tagging the records with the identifier \"time-change\"",
      "rationale": "Unexpected changes in system date and/or time could be a sign of malicious activity on the system.",
      "audit": "Run the following command and verify output matches:\n# auditctl -l | grep time-change\n-a always,exit -F arch=b64 -S adjtimex,settimeofday,clock_settime -k time-change\n-a always,exit -F arch=b32 -S adjtimex,settimeofday,clock_settime -k time-change\n-w /etc/localtime -p wa -k time-change",
      "remediation": "Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/time-change.rules\nAdd the following lines:\n-a always,exit -F arch=b64 -S adjtimex,settimeofday,clock_settime -k time-change\n-a always,exit -F arch=b32 -S adjtimex,settimeofday,clock_settime -k time-change\n-w /etc/localtime -p wa -k time-change",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the auditctl(8) and auditd(8) man pages for more information.",
      "cis_controls": "v8: 8.5 Collect Detailed Audit Logs\nv7: 5.5 Implement Automated Configuration Monitoring Systems",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.1.3.3"
    },
    {
      "title": "Ensure events that modify the system's network environment are collected",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre-login), /etc/hosts (file containing host names and associated IP addresses), /etc/sysconfig/network (directory containing network interface scripts and configurations) and /etc/sysconfig/network-scripts/ (directory containing network interface scripts and configurations) files.",
      "rationale": "Monitoring sethostname and setdomainname will identify potential unauthorized changes to host and domainname of a system. The changing of these names could potentially break security parameters that are set based on those names. The /etc/hosts file is monitored for changes in the file that can indicate an unauthorized intruder is trying to change machine associations with IP addresses and trick users and processes into connecting to unintended machines. Monitoring /etc/issue and /etc/issue.net is important, as intruders could put disinformation into those files and trick users into providing information to the intruder. Monitoring /etc/sysconfig/network and /etc/sysconfig/network-scripts/ is important as it can show if network interfaces or scripts are being modified in a way that can lead to the machine becoming unavailable or compromised. All audit records will be tagged with the identifier \"system-locale.\"",
      "audit": "Run the following command and verify output matches:\n# auditctl -l | grep system-locale\n-a always,exit -F arch=b64 -S sethostname,setdomainname -k system-locale\n-a always,exit -F arch=b32 -S sethostname,setdomainname -k system-locale\n-w /etc/issue -p wa -k system-locale\n-w /etc/issue.net -p wa -k system-locale\n-w /etc/hosts -p wa -k system-locale\n-w /etc/sysconfig/network -p wa -k system-locale\n-w /etc/sysconfig/network-scripts/ -p wa -k system-locale",
      "remediation": "Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/system-locale.rules\nAdd the following lines:\n-a always,exit -F arch=b64 -S sethostname,setdomainname -k system-locale\n-a always,exit -F arch=b32 -S sethostname,setdomainname -k system-locale\n-w /etc/issue -p wa -k system-locale\n-w /etc/issue.net -p wa -k system-locale\n-w /etc/hosts -p wa -k system-locale\n-w /etc/sysconfig/network -p wa -k system-locale\n-w /etc/sysconfig/network-scripts/ -p wa -k system-locale",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the auditctl(8) and auditd(8) man pages for more information.",
      "cis_controls": "v8: 8.5 Collect Detailed Audit Logs\nv7: 5.5 Implement Automated Configuration Monitoring Systems",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.1.3.4"
    },
    {
      "title": "Ensure events that modify the system's Mandatory Access Controls are collected",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "Monitor SELinux mandatory access controls. The parameters below monitor any write access (potential additional, deletion or modification of files in the directory) or attribute changes to the /etc/selinux directory.",
      "rationale": "Changes to files in this directory could indicate that an unauthorized user is attempting to modify access controls and change security contexts, leading to a compromise of the system.",
      "audit": "Run the following command and verify output matches:\n# auditctl -l | grep MAC-policy\n-w /etc/selinux/ -p wa -k MAC-policy\n-w /usr/share/selinux/ -p wa -k MAC-policy",
      "remediation": "Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/MAC-policy.rules\nAdd the following lines:\n-w /etc/selinux/ -p wa -k MAC-policy\n-w /usr/share/selinux/ -p wa -k MAC-policy",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the auditctl(8) and auditd(8) man pages for more information.",
      "cis_controls": "v8: 8.5 Collect Detailed Audit Logs\nv7: 5.5 Implement Automated Configuration Monitoring Systems",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.1.3.5"
    },
    {
      "title": "Ensure login and logout events are collected",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "Monitor login and logout events. The parameters below track changes to files associated with login/logout events. The file /var/log/lastlog maintain records of the last time a user successfully logged in. The /var/run/faillock directory maintains records of login failures via the pam_faillock module.",
      "rationale": "Monitoring login/logout events could provide a system administrator with information associated with brute force attacks against user logins.",
      "audit": "Run the following command and verify output matches:\n# auditctl -l | grep logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/faillock/ -p wa -k logins",
      "remediation": "Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/logins.rules\nAdd the following lines:\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/faillock/ -p wa -k logins",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the auditctl(8) and auditd(8) man pages for more information.",
      "cis_controls": "v8: 8.5 Collect Detailed Audit Logs\nv7: 4.9 Log and Alert on Unsuccessful Administrative Account Login",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.1.3.6"
    },
    {
      "title": "Ensure session initiation information is collected",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "Monitor session initiation events. The parameters in this section track changes to the files associated with session events. The file /var/run/utmp file tracks all currently logged in users. The /var/log/wtmp file tracks logins, logouts, shutdown and reboot events. All audit records will be tagged with the identifier \"session.\" The file /var/log/btmp keeps track of failed login attempts and can be read by entering the command /usr/bin/last -f /var/log/btmp. All audit records will be tagged with the identifier \"logins.\"",
      "rationale": "Monitoring these files for changes could alert a system administrator to logins occurring at unusual hours, which could indicate intruder activity (i.e. a user logging in at a time when they do not normally log in).",
      "audit": "Run the following command and verify output matches:\n# auditctl -l | grep -E '(session|logins)'\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k logins\n-w /var/log/btmp -p wa -k logins",
      "remediation": "Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/session.rules\nAdd the following lines:\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k logins\n-w /var/log/btmp -p wa -k logins",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the auditctl(8) and auditd(8) man pages for more information.",
      "cis_controls": "v8: 8.5 Collect Detailed Audit Logs\nv7: 4.9 Log and Alert on Unsuccessful Administrative Account Login",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.1.3.7"
    },
    {
      "title": "Ensure discretionary access control permission modification events are collected",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "Monitor changes to file permissions, attributes, ownership and group. The parameters in this section track changes for system calls that affect file permissions and attributes. The chmod, fchmod and fchmodat system calls affect the permissions associated with a file. The chown, fchown, fchownat and lchown system calls affect owner and group attributes on a file. The setxattr, lsetxattr, fsetxattr (set extended file attributes) and removexattr, lremovexattr, fremovexattr (remove extended file attributes) control extended file attributes. In all cases, an audit record will only be written for non-system user ids (auid >= 1000) and will ignore Daemon events (auid = 4294967295). All audit records will be tagged with the identifier \"perm_mod.\"",
      "rationale": "Monitoring for changes in file attributes could alert a system administrator to activity that could indicate intruder activity or policy violation.",
      "audit": "Run the following command and verify output matches:\n# auditctl -l | grep perm_mod\n-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid>=1000 -F auid!=unset -k perm_mod\n-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid>=1000 -F auid!=unset -k perm_mod\n-a always,exit -F arch=b64 -S chown,fchown,fchownat,lchown -F auid>=1000 -F auid!=unset -k perm_mod\n-a always,exit -F arch=b32 -S chown,fchown,fchownat,lchown -F auid>=1000 -F auid!=unset -k perm_mod\n-a always,exit -F arch=b64 -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid>=1000 -F auid!=unset -k perm_mod\n-a always,exit -F arch=b32 -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid>=1000 -F auid!=unset -k perm_mod",
      "remediation": "Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/perm_mod.rules\nAdd the following lines:\n-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid>=1000 -F auid!=unset -k perm_mod\n-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid>=1000 -F auid!=unset -k perm_mod\n-a always,exit -F arch=b64 -S chown,fchown,fchownat,lchown -F auid>=1000 -F auid!=unset -k perm_mod\n-a always,exit -F arch=b32 -S chown,fchown,fchownat,lchown -F auid>=1000 -F auid!=unset -k perm_mod\n-a always,exit -F arch=b64 -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid>=1000 -F auid!=unset -k perm_mod\n-a always,exit -F arch=b32 -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid>=1000 -F auid!=unset -k perm_mod",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the auditctl(8) and auditd(8) man pages for more information.",
      "cis_controls": "v8: 8.5 Collect Detailed Audit Logs\nv7: 5.5 Implement Automated Configuration Monitoring Systems",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.1.3.8"
    }
  ]
}