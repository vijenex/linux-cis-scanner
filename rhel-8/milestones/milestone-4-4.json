{
  "milestone": "4.4",
  "title": "Additional Logging Configuration",
  "controls": [
    {
      "title": "Ensure rsyslog is installed",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The rsyslog software is a recommended replacement to the original syslogd daemon. rsyslog provides improvements over syslogd, including connection-oriented (i.e. TCP) transmission of logs, the option to log to database formats, and the encryption of log data en route to a central logging server.",
      "rationale": "The security enhancements of rsyslog such as connection-oriented (i.e. TCP) transmission of logs, the option to log to database formats, and the encryption of log data en route to a central logging server justify installing and configuring the package.",
      "audit": "Run the following command to verify rsyslog is installed:\n# rpm -q rsyslog\nrsyslog-<version>",
      "remediation": "Run the following command to install rsyslog:\n# dnf install rsyslog",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the rsyslog(8) man page for more information.",
      "cis_controls": "v8: 8.2 Collect Audit Logs\nv7: 6.2 Activate audit logging",
      "check_type": "PackageInstalled",
      "check_value": "rsyslog",
      "id": "4.4.1"
    },
    {
      "title": "Ensure journald is configured to send logs to rsyslog",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "Data from journald may be stored in volatile memory or persisted locally on the server. Utilities exist to accept remote export of journald logs.",
      "rationale": "Storing log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.",
      "audit": "Review /etc/systemd/journald.conf and verify that logs are forwarded to syslog:\n# grep -E '^\\s*ForwardToSyslog' /etc/systemd/journald.conf\nForwardToSyslog=yes",
      "remediation": "Edit the /etc/systemd/journald.conf file and add the following line:\nForwardToSyslog=yes",
      "impact": "None",
      "default_value": "ForwardToSyslog=yes",
      "references": "1. See the journald.conf(5) man page for more information.",
      "cis_controls": "v8: 8.2 Collect Audit Logs\nv7: 6.2 Activate audit logging",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.4.2"
    },
    {
      "title": "Ensure journald is configured to compress large log files",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The journald system can compress large log files to save space on the system.",
      "rationale": "Uncompressed large files may unexpectedly fill a filesystem leading to the system being unable to write to the filesystem. Compressing logs prior to write can prevent sudden, unexpected filesystem impacts.",
      "audit": "Review /etc/systemd/journald.conf and verify that large files are compressed:\n# grep -E '^\\s*Compress' /etc/systemd/journald.conf\nCompress=yes",
      "remediation": "Edit the /etc/systemd/journald.conf file and add the following line:\nCompress=yes",
      "impact": "None",
      "default_value": "Compress=yes",
      "references": "1. See the journald.conf(5) man page for more information.",
      "cis_controls": "v8: 8.3 Ensure Adequate Audit Log Storage\nv7: 6.4 Ensure adequate storage for logs",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.4.3"
    },
    {
      "title": "Ensure journald is configured to write logfiles to persistent disk",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "Data from journald may be stored in volatile memory or persisted locally on the server.",
      "rationale": "Writing log data to disk will provide the ability to forensically reconstruct events which may have impacted the operations or security of a system even after a system crash or reboot.",
      "audit": "Review /etc/systemd/journald.conf and verify logs are persistent:\n# grep -E '^\\s*Storage' /etc/systemd/journald.conf\nStorage=persistent",
      "remediation": "Edit the /etc/systemd/journald.conf file and add the following line:\nStorage=persistent",
      "impact": "None",
      "default_value": "Storage=auto",
      "references": "1. See the journald.conf(5) man page for more information.",
      "cis_controls": "v8: 8.3 Ensure Adequate Audit Log Storage\nv7: 6.4 Ensure adequate storage for logs",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.4.4"
    }
  ]
}