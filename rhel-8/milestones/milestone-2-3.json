{
  "milestone": "2.3",
  "version": "1.0.0",
  "description": "RHEL 8 CIS Benchmark v4.0.0 - Section 2.3",
  "controls": [
    {
      "id": "2.3.1",
      "title": "Ensure time synchronization is in use",
      "automated": true,
      "profile": "Level1",
      "section": "2.3",
      "description": "\\\n\n\\f2\\b0 System time should be synchronized between all systems in an environment. This is\\\ntypically done by establishing an authoritative time server or set of servers and having\\\nall systems synchronize their clocks to them.\\\n\n\\f1\\b Note:\n\\f2\\b0  If another method for time synchronization is being used, this section may be\\\nskipped.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Time synchronization is important to support time sensitive security mechanisms like\\\nKerberos and also ensures log files have consistent time records across the enterprise,\\\nwhich aids in forensic investigations.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following commands to verify that \n\\f0 \\cf4 chrony\n\\f2 \\cf2  is installed:\\\n\n\\f4\\fs20\\fsmilli10080 # rpm -q chrony\\\nchrony-<version>\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to install \n\\f0 \\cf4 chrony\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # dnf install chrony\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AU-3, AU-12\\\n\n\\f1\\b",
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.3.1 | Level1",
      "package_name": "ypbind"
    },
    {
      "id": "2.3.2",
      "title": "Ensure chrony is configured",
      "automated": true,
      "profile": "Level1",
      "section": "2.3",
      "description": "\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 server\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 The server directive specifies an NTP server which can be used as a time\\\nsource. The client-server relationship is strictly hierarchical: a client might\\\nsynchronize its system time to that of the server, but the server\\'92s system\\\ntime will never be influenced by that of a client.\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 This directive can be used multiple times to specify multiple servers.\\\n\n\\f4\\fs20\\fsmil",
      "rationale": "\\\n\n\\f2\\b0 Time synchronization is important to support time sensitive security mechanisms and to\\\nensure log files have consistent time records across the enterprise to aid in forensic\\\ninvestigations\n\\fs20\\fsmilli10080 Page 373\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to ensure \n\\f0 \\cf4 chrony\n\\f2 \\cf2  is configured with an authorized timeserver:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\na_output=() a_output2=() a_config_files=(\"/etc/chrony.conf\")\\\nl_include='(confdir|sourcedir)' l_parameter_name='(server|pool)'\\\nl_parameter_value='.+'\\\nwhile IFS= read -r l_conf_loc; do\\\nl_dir=\"\" l_ext=\"\"\\\nif [ -d \"$l_conf_loc\" ]; then\\\nl_dir=\"$l_conf_loc\" l_ext=\"*\"\\\nelif grep -Psq '\\\\/\\\\*\\\\.([^#/\\\\n\\\\r]+)?\\\\h*$' <<< \"$l_conf_loc\" |",
      "remediation": "\\\n\n\\f2\\b0 Edit \n\\f0 \\cf4 /etc/chrony.conf\n\\f2 \\cf2  or a file ending in \n\\f0 \\cf4 .sources\n\\f2 \\cf2  in \n\\f0 \\cf4 /etc/sources.d/\n\\f2 \\cf2  and add or\\\nedit server or pool lines as appropriate according to local site policy:\\\nEdit the \n\\f0 \\cf4 Chrony\n\\f2 \\cf2  configuration and add or edit the server and/or pool lines returned by\\\nthe Audit Procedure as appropriate according to local site policy\\\n\n\\f4\\fs20\\fsmilli10080 <[server|pool]> <[remote-server|remote-pool]>\\\n\n\\f3\\i\\fs24 Example script to add a drop-in configuration for the \n\\f0\\i0 \\cf4 pool\n\\f3\\i \\cf2  directive:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\n[ ! -d \"/etc/sources.d/\" ] && mkdir /etc/sources.d/\\\nprintf '%s\\\\n' \"\" \"#The maxsources option is unique to the pool directive\"\\\n\\\\\\\n\"pool time.nist.gov iburst maxsources",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AU-3, AU-12\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/chrony.conf\")\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.3.2 | Level1"
    },
    {
      "id": "2.3.3",
      "title": "Ensure chrony is not run as the root user",
      "automated": true,
      "profile": "Level1",
      "section": "2.3",
      "description": "\\\n\n\\f2\\b0 The file \n\\f0 \\cf4 /etc/sysconfig/chronyd\n\\f2 \\cf2  allows configuration of options for \n\\f0 \\cf4 chrony\n\\f2 \\cf2  to include\\\nthe user \n\\f0 \\cf4 chrony\n\\f2 \\cf2  is run as. By default, this is set to the user \n\\f0 \\cf4 chrony\\\n\n\\f1\\b \\cf2",
      "rationale": "\\\n\n\\f2\\b0 Services should not be set to run as the root user\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that \n\\f0 \\cf4 chrony\n\\f2 \\cf2  isn't configured to run as the \n\\f0 \\cf4 root\\\n\n\\f2 \\cf2 user:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Psi --\\\n'^\\\\h*OPTIONS=\\\\\"?\\\\h*([^#\\\\n\\\\r]+\\\\h+)?-u\\\\h+root\\\\b'\\\n/etc/sysconfig/chronyd\\\nNothing should be returned\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Edit the file \n\\f0 \\cf4 /etc/sysconfig/chronyd\n\\f2 \\cf2  and add or modify the following line to remove\\\n\"\\\n\n\\f0 \\cf4 -u root\n\\f2 \\cf2 \" from any \n\\f0 \\cf4 OPTIONS=\n\\f2 \\cf2  argument:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 OPTIONS=\"-F 2\"\\\n\n\\f2\\fs24 Run the following command to reload the \n\\f0 \\cf4 chronyd.service\n\\f2 \\cf2  configuration:\\\n\n\\f4\\fs20\\fsmilli10080 # systemctl reload-or-restart chronyd.service\\\n\n\\f1\\b\\fs24",
      "references": "",
      "type": "FileContent",
      "file_path": "/etc/sysconfig/chronyd\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.3.3 | Level1"
    }
  ]
}