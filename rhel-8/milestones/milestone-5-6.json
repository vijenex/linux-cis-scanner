{
  "milestone": "5.6",
  "title": "User Authentication and Authorization",
  "controls": [
    {
      "control_id": "5.6.1",
      "title": "Ensure access to the su command is restricted",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The su command allows a user to run a command or shell as another user. The program has been superseded by sudo, which allows for more granular control over privileged access. Normally, the su command can be executed by any user. By uncommenting the pam_wheel.so statement in /etc/pam.d/su, the su command will only allow users in a specific group to execute su.",
      "rationale": "Restricting the use of su, and using sudo in its place, provides system administrators better control of the escalation of user privileges to execute privileged commands. The sudo utility also provides a better logging and audit mechanism, as it can log each command executed via sudo, whereas su can only record that a user executed the su program.",
      "audit": "Run the following command and verify output includes matching line:\n# grep pam_wheel.so /etc/pam.d/su\nauth required pam_wheel.so use_uid",
      "remediation": "Create a comma separated list of users in the wheel group as follows:\n# groupadd sugroup\n# usermod -aG sugroup <username>\nAdd the following line to the /etc/pam.d/su file:\nauth required pam_wheel.so use_uid group=sugroup",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the pam(8) man page for more information.",
      "cis_controls": "v8: 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts\nv7: 4.3 Ensure the Use of Dedicated Administrative Accounts",
      "check_type": "Manual",
      "check_value": ""
    }
  ]
}
