{
  "milestone": "4.1.2",
  "title": "Configure Data Retention",
  "controls": [
    {
      "id": "4.1.2",
      "title": "Ensure firewalld backend is configured",
      "automated": true,
      "profile": "Level1",
      "section": "4.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 FirewallBackend\n\\f2 \\cf2  option selects the firewall backend implementation.\\\nChoices are:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 nftables (default)\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 iptables (iptables, ip6tables, ebtables and ipset)\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 IPTables are deprecated.\\\n\n\\f1\\b",
      "impact": "\\\n\n\\f2\\b0 Verifying the proper backend configuration insures the critical functionality of the\\\nfirewall.\\\n\n\\f1\\b",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify \n\\f0 \\cf4 NFTables\n\\f2 \\cf2  is set as the backend for \n\\f0 \\cf4 firewalld\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Psi -- 'FirewallBackend\\\\h*=\\\\h*nftables\\\\b'\\\n/etc/firewalld/firewalld.conf\\\nFirewallBackend=nftables\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Edit the file \n\\f0 \\cf4 /etc/firewalld/firewalld.conf\n\\f2 \\cf2  and add or modify the following line:\\\n\n\\f4\\fs20\\fsmilli10080 FirewallBackend=nftables\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. GRID #\\\n2. NIST SP 800-53 Rev. 5: CA-9\n\\fs20\\fsmilli10080 Page 576\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/firewalld/firewalld.conf\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 4.1.2 | Level1"
    },
    {
      "title": "Ensure audit log storage size is configured",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "Configure the maximum size of the audit log file. Once the log reaches the maximum size, it will be rotated and a new log file will be started.",
      "rationale": "It is important that an appropriate size is determined for log files so that they do not impact the system and audit data is not lost.",
      "audit": "Run the following command and verify output is in compliance with site policy:\n# grep max_log_file /etc/audit/auditd.conf\nmax_log_file = <MB>",
      "remediation": "Set the following parameter in /etc/audit/auditd.conf in accordance with site policy:\nmax_log_file = <MB>",
      "impact": "None",
      "default_value": "max_log_file = 8",
      "references": "1. See the auditd.conf(5) man page for more information.",
      "cis_controls": "v8: 8.3 Ensure Adequate Audit Log Storage\nv7: 6.4 Ensure adequate storage for logs",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.1.2.1"
    },
    {
      "title": "Ensure audit logs are not automatically deleted",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "The max_log_file_action setting determines how to handle the audit log file reaching the max file size. A value of keep_logs will rotate the logs but never delete old logs.",
      "rationale": "In high security contexts, the benefits of maintaining a long audit history exceed the cost of storing the audit history.",
      "audit": "Run the following command and verify output matches:\n# grep max_log_file_action /etc/audit/auditd.conf\nmax_log_file_action = keep_logs",
      "remediation": "Set the following parameter in /etc/audit/auditd.conf:\nmax_log_file_action = keep_logs",
      "impact": "None",
      "default_value": "max_log_file_action = rotate",
      "references": "1. See the auditd.conf(5) man page for more information.",
      "cis_controls": "v8: 8.3 Ensure Adequate Audit Log Storage\nv7: 6.4 Ensure adequate storage for logs",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.1.2.2"
    },
    {
      "title": "Ensure system is disabled when audit logs are full",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "The auditd daemon can be configured to halt the system when the audit logs are full.",
      "rationale": "In high security contexts, the risk of detecting unauthorized access or nonrepudiation exceeds the benefit of the system's availability.",
      "audit": "Run the following commands and verify output matches:\n# grep space_left_action /etc/audit/auditd.conf\nspace_left_action = email\n# grep action_mail_acct /etc/audit/auditd.conf\naction_mail_acct = root\n# grep admin_space_left_action /etc/audit/auditd.conf\nadmin_space_left_action = halt",
      "remediation": "Set the following parameters in /etc/audit/auditd.conf:\nspace_left_action = email\naction_mail_acct = root\nadmin_space_left_action = halt",
      "impact": "If the system is configured to halt when the audit logs are full, the system will be unavailable until the logs are rotated or deleted.",
      "default_value": "space_left_action = syslog\nadmin_space_left_action = suspend",
      "references": "1. See the auditd.conf(5) man page for more information.",
      "cis_controls": "v8: 8.3 Ensure Adequate Audit Log Storage\nv7: 6.4 Ensure adequate storage for logs",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.1.2.3"
    }
  ]
}