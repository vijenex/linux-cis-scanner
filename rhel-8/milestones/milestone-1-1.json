{
  "milestone": "1.1",
  "version": "1.0.0",
  "description": "RHEL 8 CIS Benchmark v4.0.0 - Section 1.1 Filesystem Configuration",
  "controls": [
    {
      "id": "1.1.1.1",
      "title": "Ensure cramfs kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "cramfs",
      "expected_status": "not_available",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.1.1 | Level 1 - Server | Level 1 - Workstation",
      "description": "The cramfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems. A cramfs image can be used without having to first decompress the image.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "remediation": "Run the following commands to unload and disable the cramfs kernel module:\n# modprobe -r cramfs 2>/dev/null\n# rmmod cramfs 2>/dev/null\n# printf '%s\\n' '' 'install cramfs /bin/false' >> /etc/modprobe.d/60-cramfs.conf\n# printf '%s\\n' '' 'blacklist cramfs' >> /etc/modprobe.d/60-cramfs.conf",
      "impact": "None - cramfs is rarely used in modern systems",
      "references": "CCI-000381 | NIST SP 800-53: CM-7 a | NIST SP 800-53A: CM-7.1 (ii) | STIG ID: RHEL-08-040025",
      "audit_command": "lsmod | grep cramfs; modprobe --showconfig | grep -P '\\b(install|blacklist)\\h+cramfs\\b'"
    },
    {
      "id": "1.1.1.2",
      "title": "Ensure freevxfs kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "freevxfs",
      "expected_status": "not_available",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.1.2 | Level 1 - Server | Level 1 - Workstation",
      "description": "The freevxfs filesystem type is a free version of the Veritas type filesystem. This is the primary filesystem type for HP-UX operating systems.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "remediation": "Run the following commands to unload and disable the freevxfs kernel module:\n# modprobe -r freevxfs 2>/dev/null\n# rmmod freevxfs 2>/dev/null\n# printf '%s\\n' '' 'install freevxfs /bin/false' >> /etc/modprobe.d/60-freevxfs.conf\n# printf '%s\\n' '' 'blacklist freevxfs' >> /etc/modprobe.d/60-freevxfs.conf",
      "impact": "None - freevxfs is only needed for HP-UX filesystem compatibility",
      "references": "CCI-000381 | NIST SP 800-53: CM-7 | NIST SP 800-53A: CM-7.1 (ii)",
      "audit_command": "lsmod | grep freevxfs; modprobe --showconfig | grep -P '\\b(install|blacklist)\\h+freevxfs\\b'"
    },
    {
      "id": "1.1.1.3",
      "title": "Ensure hfs kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "hfs",
      "expected_status": "not_available",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.1.3 | Level 1 - Server | Level 1 - Workstation",
      "description": "The hfs filesystem type is a hierarchical filesystem that allows you to mount Mac OS filesystems.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "remediation": "Run the following commands to unload and disable the hfs kernel module:\n# modprobe -r hfs 2>/dev/null\n# rmmod hfs 2>/dev/null\n# printf '%s\\n' '' 'install hfs /bin/false' >> /etc/modprobe.d/60-hfs.conf\n# printf '%s\\n' '' 'blacklist hfs' >> /etc/modprobe.d/60-hfs.conf",
      "impact": "None - hfs is only needed for Mac OS filesystem compatibility",
      "references": "CCI-000381 | NIST SP 800-53: CM-7 | NIST SP 800-53A: CM-7.1 (ii)",
      "audit_command": "lsmod | grep hfs; modprobe --showconfig | grep -P '\\b(install|blacklist)\\h+hfs\\b'"
    },
    {
      "id": "1.1.1.4",
      "title": "Ensure hfsplus kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "hfsplus",
      "expected_status": "not_available",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.1.4 | Level 1 - Server | Level 1 - Workstation",
      "description": "The hfsplus filesystem type is a hierarchical filesystem designed to replace hfs that allows you to mount Mac OS filesystems.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "remediation": "Run the following commands to unload and disable the hfsplus kernel module:\n# modprobe -r hfsplus 2>/dev/null\n# rmmod hfsplus 2>/dev/null\n# printf '%s\\n' '' 'install hfsplus /bin/false' >> /etc/modprobe.d/60-hfsplus.conf\n# printf '%s\\n' '' 'blacklist hfsplus' >> /etc/modprobe.d/60-hfsplus.conf",
      "impact": "None - hfsplus is only needed for Mac OS filesystem compatibility",
      "references": "CCI-000381 | NIST SP 800-53: CM-7 | NIST SP 800-53A: CM-7.1 (ii)",
      "audit_command": "lsmod | grep hfsplus; modprobe --showconfig | grep -P '\\b(install|blacklist)\\h+hfsplus\\b'"
    },
    {
      "id": "1.1.1.5",
      "title": "Ensure jffs2 kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "jffs2",
      "expected_status": "not_available",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.1.5 | Level 1 - Server | Level 1 - Workstation",
      "description": "The jffs2 (journaling flash filesystem 2) filesystem type is a log-structured filesystem used in flash memory devices.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "remediation": "Run the following commands to unload and disable the jffs2 kernel module:\n# modprobe -r jffs2 2>/dev/null\n# rmmod jffs2 2>/dev/null\n# printf '%s\\n' '' 'install jffs2 /bin/false' >> /etc/modprobe.d/60-jffs2.conf\n# printf '%s\\n' '' 'blacklist jffs2' >> /etc/modprobe.d/60-jffs2.conf",
      "impact": "None - jffs2 is only needed for flash memory devices",
      "references": "CCI-000381 | NIST SP 800-53: CM-7 | NIST SP 800-53A: CM-7.1 (ii)",
      "audit_command": "lsmod | grep jffs2; modprobe --showconfig | grep -P '\\b(install|blacklist)\\h+jffs2\\b'"
    },
    {
      "id": "1.1.1.6",
      "title": "Ensure overlay kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level2",
      "automated": true,
      "type": "KernelModule",
      "module_name": "overlay",
      "expected_status": "not_available",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.1.6 | Level 2 - Server | Level 2 - Workstation",
      "description": "The Linux overlay kernel module, commonly referred to as Overlayfs, is a union mount filesystem. It allows the user to overlay one file system on top of another, and creates a single, unified view.",
      "rationale": "The overlay kernel module has known CVEs: CVE-2023-32629, CVE-2023-2640, and CVE-2023-0386. Disabling the overlay kernel module reduces the local attack surface by removing support for unnecessary filesystem types and mitigates potential risks associated with unauthorized execution of setuid files, enhancing the overall system security.",
      "remediation": "Run the following commands to unload and disable the overlay kernel module:\n# modprobe -r overlay 2>/dev/null\n# rmmod overlay 2>/dev/null\n# printf '%s\\n' '' 'install overlay /bin/false' >> /etc/modprobe.d/60-overlay.conf\n# printf '%s\\n' '' 'blacklist overlay' >> /etc/modprobe.d/60-overlay.conf",
      "impact": "\u26a0\ufe0f WARNING - LEVEL 2: If Container applications such as Docker, Kubernetes, Podman, Linux Containers (LXC), etc. are in use proceed with caution. Disabling overlay may severely disrupt containerization. TEST IN NON-PROD BEFORE APPLYING.",
      "references": "CCI-000381 | NIST SP 800-53: CM-7 | CVE-2023-32629 | CVE-2023-2640 | CVE-2023-0386",
      "audit_command": "lsmod | grep overlay; modprobe --showconfig | grep -P '\\b(install|blacklist)\\h+overlay\\b'"
    },
    {
      "id": "1.1.1.7",
      "title": "Ensure squashfs kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level2",
      "automated": true,
      "type": "KernelModule",
      "module_name": "squashfs",
      "expected_status": "not_available",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.1.7 | Level 2 - Server | Level 2 - Workstation",
      "description": "The squashfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems. A squashfs image can be used without having to first decompress the image.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "remediation": "Run the following commands to unload and disable the squashfs kernel module:\n# modprobe -r squashfs 2>/dev/null\n# rmmod squashfs 2>/dev/null\n# printf '%s\\n' '' 'install squashfs /bin/false' >> /etc/modprobe.d/60-squashfs.conf\n# printf '%s\\n' '' 'blacklist squashfs' >> /etc/modprobe.d/60-squashfs.conf",
      "impact": "\u26a0\ufe0f WARNING - LEVEL 2: Disabling squashfs will cause Snap packages to fail. Snap packages are self-contained applications. TEST IN NON-PROD BEFORE APPLYING.",
      "references": "CCI-000381 | NIST SP 800-53: CM-7 | STIG ID: ALMA-09-030160",
      "audit_command": "lsmod | grep squashfs; modprobe --showconfig | grep -P '\\b(install|blacklist)\\h+squashfs\\b'"
    },
    {
      "id": "1.1.1.8",
      "title": "Ensure udf kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level2",
      "automated": true,
      "type": "KernelModule",
      "module_name": "udf",
      "expected_status": "not_available",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.1.8 | Level 2 - Server | Level 2 - Workstation",
      "description": "The udf filesystem type is the universal disk format used to implement ISO/IEC 13346 and ECMA-167 specifications. This is an open vendor filesystem type for data storage on a broad range of media. This filesystem type is necessary to support writing DVDs and newer optical disc formats.",
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
      "remediation": "Run the following commands to unload and disable the udf kernel module:\n# modprobe -r udf 2>/dev/null\n# rmmod udf 2>/dev/null\n# printf '%s\\n' '' 'install udf /bin/false' >> /etc/modprobe.d/60-udf.conf\n# printf '%s\\n' '' 'blacklist udf' >> /etc/modprobe.d/60-udf.conf",
      "impact": "\u26a0\ufe0f WARNING - LEVEL 2: Microsoft Azure requires the usage of udf. DO NOT disable on Azure systems. TEST IN NON-PROD BEFORE APPLYING.",
      "references": "CCI-000381 | NIST SP 800-53: CM-7 | STIG ID: ALMA-09-030380",
      "audit_command": "lsmod | grep udf; modprobe --showconfig | grep -P '\\b(install|blacklist)\\h+udf\\b'"
    },
    {
      "id": "1.1.1.9",
      "title": "Ensure firewire-core kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "firewire-core",
      "expected_status": "not_available",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.1.9 | Level 1 - Server | Level 1 - Workstation",
      "description": "The IEEE 1394 (FireWire) is a serial bus standard for high-speed real-time communication.",
      "rationale": "Disabling FireWire protects the system against exploitation of any flaws in its implementation.",
      "remediation": "Run the following commands to unload and disable the firewire-core kernel module:\n# modprobe -r firewire-core 2>/dev/null\n# rmmod firewire-core 2>/dev/null\n# printf '%s\\n' '' 'install firewire-core /bin/false' >> /etc/modprobe.d/60-firewire-core.conf\n# printf '%s\\n' '' 'blacklist firewire-core' >> /etc/modprobe.d/60-firewire-core.conf",
      "impact": "None - FireWire is rarely used in modern server environments",
      "references": "CCI-000381 | NIST SP 800-53: CM-7 | STIG ID: RHEL-08-040026 | STIG ID: RHEL-09-213055",
      "audit_command": "lsmod | grep -P 'firewire(_|-)core'; modprobe --showconfig | grep -P '\\b(install|blacklist)\\h+firewire(_|-)core\\b'"
    },
    {
      "id": "1.1.1.10",
      "title": "Ensure usb-storage kernel module is not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": true,
      "type": "KernelModule",
      "module_name": "usb-storage",
      "expected_status": "not_available",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.1.10 | Level 1 - Server | Level 2 - Workstation",
      "description": "USB storage provides a means to transfer and store files ensuring persistence and availability of the files independent of network connection status. Its popularity and utility has led to USB-based malware being a simple and common means for network infiltration and a first step to establishing a persistent threat within a networked environment.",
      "rationale": "Restricting USB access on the system will decrease the physical attack surface for a device and diminish the possible vectors to introduce malware.",
      "remediation": "Run the following commands to unload and disable the usb-storage kernel module:\n# modprobe -r usb-storage 2>/dev/null\n# rmmod usb-storage 2>/dev/null\n# printf '%s\\n' '' 'install usb_storage /bin/false' >> /etc/modprobe.d/60-usb-storage.conf\n# printf '%s\\n' '' 'blacklist usb_storage' >> /etc/modprobe.d/60-usb-storage.conf",
      "impact": "Disabling usb-storage will disable any usage of USB storage devices. If requirements allow USB devices, consider using USBGuard instead for policy-based USB device authorization.",
      "references": "CCI-000778 | CCI-001958 | NIST SP 800-53: IA-3, CM-7 (9) (b) | STIG ID: RHEL-08-040080 | STIG ID: RHEL-09-291010",
      "audit_command": "lsmod | grep -P 'usb(_|-)storage'; modprobe --showconfig | grep -P '\\b(install|blacklist)\\h+usb_storage\\b'"
    },
    {
      "id": "1.1.1.11",
      "title": "Ensure unused filesystems kernel modules are not available",
      "section": "1.1.1 Filesystem Kernel Modules",
      "profile": "Level1",
      "automated": false,
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.1.11 | Level 1 - Server | Level 1 - Workstation",
      "description": "Filesystem kernel modules are pieces of code that can be dynamically loaded into the Linux kernel to extend its filesystem capabilities. The following filesystem kernel modules have known CVEs and should be made unavailable if no dependencies exist: ceph (CVE-2022-0670), cifs (CVE-2022-29869), exfat (CVE-2022-29973), ext (CVE-2022-1184), fat (CVE-2022-22043), fscache (CVE-2022-3630), fuse (CVE-2023-0386), gfs2 (CVE-2023-3212), nfs_common (CVE-2023-6660), nfsd (CVE-2022-43945), smbfs_common (CVE-2022-2585).",
      "rationale": "While loadable filesystem kernel modules are a convenient method of modifying the running kernel, this can be abused by attackers on a compromised system to prevent detection of their processes or files, allowing them to maintain control over the system. Many rootkits make use of loadable filesystem kernel modules in this way. Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "remediation": "MANUAL REVIEW REQUIRED:\n1. Run: findmnt -Dkerno fstype | sort -u (to see mounted filesystems)\n2. Run: lsmod (to see loaded modules)\n3. Run: modprobe --showconfig | grep -Pi '^\\h*(blacklist|install)\\h+' (to see disabled modules)\n4. For each unused module, run:\n   # modprobe -r <module> 2>/dev/null\n   # rmmod <module> 2>/dev/null\n   # printf '%s\\n' '' 'blacklist <module>' 'install <module> /bin/false' >> /etc/modprobe.d/<module>.conf\n\n\u26a0\ufe0f WARNING: Disabling filesystem modules that are in use may be FATAL. Thoroughly review before disabling.",
      "impact": "\u26a0\ufe0f CRITICAL: This list may be extensive and covering all edge cases is difficult. Carefully consider implications and dependencies before making changes. Disabling in-use filesystem modules can render the system unbootable.",
      "references": "CVE-2022-0670 | CVE-2022-29869 | CVE-2022-29973 | CVE-2022-1184 | CVE-2023-0386 | CVE-2023-3212",
      "audit_command": "findmnt -Dkerno fstype | sort -u; lsmod; modprobe --showconfig | grep -Pi '^\\h*(blacklist|install)\\h+'"
    },
    {
      "id": "1.1.2.1.1",
      "title": "Ensure /tmp is tmpfs or a separate partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountPoint",
      "mount_point": "/tmp",
      "expected_status": "separate_partition",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.1.1 | Level 1 - Server | Level 1 - Workstation",
      "description": "The /tmp directory is a world-writable directory used for temporary storage by all users and some applications.",
      "rationale": "Making /tmp its own file system allows an administrator to set additional mount options such as the noexec option on the mount, making /tmp useless for an attacker to install executable code. It would also prevent an attacker from establishing a hard link to a system setuid program and wait for it to be updated.",
      "remediation": "First ensure systemd is configured:\n# systemctl unmask tmp.mount\n\nFor tmpfs configuration, add to /etc/fstab:\ntmpfs /tmp tmpfs defaults,rw,nosuid,nodev,noexec,relatime,size=2G 0 0\n\nFor separate partition, add to /etc/fstab:\n<device> /tmp <fstype> defaults,nodev,nosuid,noexec 0 0\n\nThen run:\n# systemctl daemon-reload\n# systemctl enable tmp.mount",
      "impact": "By design, files saved to /tmp should have no expectation of surviving a reboot. tmpfs is RAM-based and all files will be lost on reboot. If files need persistence, use /var/tmp instead.",
      "references": "CCI-000366 | NIST SP 800-53: CM-6 b | STIG ID: RHEL-08-010543 | STIG ID: RHEL-09-231015",
      "audit_command": "findmnt -kn /tmp; systemctl is-enabled tmp.mount"
    },
    {
      "id": "1.1.2.1.2",
      "title": "Ensure nodev option set on /tmp partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/tmp",
      "required_option": "nodev",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.1.2 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /tmp filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /tmp.",
      "remediation": "Edit /etc/fstab and add nodev to the fourth field (mounting options) for /tmp:\n<device> /tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\n\nRun the following command to remount /tmp:\n# mount -o remount /tmp",
      "impact": "None - /tmp should not contain device files",
      "references": "CCI-001764 | NIST SP 800-53: CM-7 (2) | STIG ID: RHEL-08-040123 | STIG ID: RHEL-09-231125",
      "audit_command": "findmnt -kn /tmp | grep -v nodev"
    },
    {
      "id": "1.1.2.1.3",
      "title": "Ensure nosuid option set on /tmp partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/tmp",
      "required_option": "nosuid",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.1.3 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /tmp.",
      "remediation": "Edit /etc/fstab and add nosuid to the fourth field (mounting options) for /tmp:\n<device> /tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\n\nRun the following command to remount /tmp:\n# mount -o remount /tmp",
      "impact": "None - /tmp should not contain setuid files",
      "references": "CCI-001764 | NIST SP 800-53: CM-7 (2) | STIG ID: RHEL-08-040124 | STIG ID: RHEL-09-231135",
      "audit_command": "findmnt -kn /tmp | grep -v nosuid"
    },
    {
      "id": "1.1.2.1.4",
      "title": "Ensure noexec option set on /tmp partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/tmp",
      "required_option": "noexec",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.1.4 | Level 1 - Server | Level 1 - Workstation",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /tmp.",
      "remediation": "Edit /etc/fstab and add noexec to the fourth field (mounting options) for /tmp:\n<device> /tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0\n\nRun the following command to remount /tmp:\n# mount -o remount /tmp",
      "impact": "Setting noexec on /tmp may prevent installation and/or updating of some 3rd party software that uses /tmp for installation scripts.",
      "references": "CCI-001764 | NIST SP 800-53: CM-7 (2) | STIG ID: RHEL-08-040125 | STIG ID: RHEL-09-231130",
      "audit_command": "findmnt -kn /tmp | grep -v noexec"
    },
    {
      "id": "1.1.2.2.1",
      "title": "Ensure /dev/shm is tmpfs",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountPoint",
      "mount_point": "/dev/shm",
      "expected_status": "separate_partition",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.2.1 | Level 1 - Server | Level 1 - Workstation",
      "description": "The /dev/shm directory is a world-writable directory that can function as shared memory that facilitates inter process communication (IPC).",
      "rationale": "Making /dev/shm its own file system as tmpfs allows an administrator to set additional mount options such as the noexec option on the mount, making /dev/shm useless for an attacker to install executable code. It would also prevent an attacker from establishing a hard link to a system setuid program and wait for it to be updated.",
      "remediation": "For specific configuration requirements of /dev/shm, modify /etc/fstab:\ntmpfs /dev/shm tmpfs defaults,rw,nosuid,nodev,noexec,relatime,size=2G 0 0\n\nRun the following command to remount:\n# mount -o remount /dev/shm",
      "impact": "Since /dev/shm is intended to be world-writable, there is a risk of resource exhaustion if not bound to a separate partition. /dev/shm utilizing tmpfs can be resized using the size={size} parameter in /etc/fstab.",
      "references": "NIST SP 800-53 Rev. 5: CM-7",
      "audit_command": "findmnt -kn /dev/shm"
    },
    {
      "id": "1.1.2.2.2",
      "title": "Ensure nodev option set on /dev/shm partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/dev/shm",
      "required_option": "nodev",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.2.2 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /dev/shm filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create special devices in /dev/shm partitions.",
      "remediation": "Edit /etc/fstab and add nodev to the fourth field (mounting options) for /dev/shm:\ntmpfs /dev/shm tmpfs defaults,rw,nosuid,nodev,noexec,relatime 0 0\n\nRun the following command to remount /dev/shm:\n# mount -o remount /dev/shm\n\nNote: It is recommended to use tmpfs as the device/filesystem type as /dev/shm is used as shared memory space by applications.",
      "impact": "None - /dev/shm should not contain device files",
      "references": "CCI-001764 | NIST SP 800-53: CM-7 (2) | STIG ID: RHEL-08-040120 | STIG ID: RHEL-09-231110",
      "audit_command": "findmnt -kn /dev/shm | grep -v nodev"
    },
    {
      "id": "1.1.2.2.3",
      "title": "Ensure nosuid option set on /dev/shm partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/dev/shm",
      "required_option": "nosuid",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.2.3 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Setting this option on a file system prevents users from introducing privileged programs onto the system and allowing non-root users to execute them.",
      "remediation": "Edit /etc/fstab and add nosuid to the fourth field (mounting options) for /dev/shm:\ntmpfs /dev/shm tmpfs defaults,rw,nosuid,nodev,noexec,relatime 0 0\n\nRun the following command to remount /dev/shm:\n# mount -o remount /dev/shm\n\nNote: It is recommended to use tmpfs as the device/filesystem type as /dev/shm is used as shared memory space by applications.",
      "impact": "None - /dev/shm should not contain setuid files",
      "references": "CCI-001764 | NIST SP 800-53: CM-7 (2) | STIG ID: RHEL-08-040121 | STIG ID: RHEL-09-231120",
      "audit_command": "findmnt -kn /dev/shm | grep -v nosuid"
    },
    {
      "id": "1.1.2.2.4",
      "title": "Ensure noexec option set on /dev/shm partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/dev/shm",
      "required_option": "noexec",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.2.4 | Level 1 - Server | Level 1 - Workstation",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Setting this option on a file system prevents users from executing programs from shared memory. This deters users from introducing potentially malicious software on the system.",
      "remediation": "Edit /etc/fstab and add noexec to the fourth field (mounting options) for /dev/shm:\ntmpfs /dev/shm tmpfs defaults,rw,nosuid,nodev,noexec,relatime 0 0\n\nRun the following command to remount /dev/shm:\n# mount -o remount /dev/shm\n\nNote: It is recommended to use tmpfs as the device/filesystem type as /dev/shm is used as shared memory space by applications.",
      "impact": "None - /dev/shm should not contain executable files",
      "references": "CCI-001764 | NIST SP 800-53: CM-7 (2) | STIG ID: RHEL-08-040122 | STIG ID: RHEL-09-231115",
      "audit_command": "findmnt -kn /dev/shm | grep -v noexec"
    },
    {
      "id": "1.1.2.3.1",
      "title": "Ensure separate partition exists for /home",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level2",
      "automated": true,
      "type": "MountPoint",
      "mount_point": "/home",
      "expected_status": "separate_partition",
      "severity": "low",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.3.1 | Level 2 - Server | Level 2 - Workstation",
      "description": "The /home directory is used to support disk storage needs of local users.",
      "rationale": "The default installation only creates a single / partition. Since the /home directory contains user generated data, there is a risk of resource exhaustion. Configuring /home as its own file system allows an administrator to set additional mount options such as noexec/nosuid/nodev. These options limit an attacker's ability to create exploits on the system.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /home.\n\nFor systems that were previously installed, create a new partition and configure /etc/fstab:\n<device> /home <fstype> defaults,rw,nosuid,nodev,relatime 0 0\n\nRun the following command to mount:\n# mount /home",
      "impact": "\u26a0\ufe0f LEVEL 2: Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing or may require installation of additional tools. When modifying /home, bring system to emergency mode, rename existing directory, mount new filesystem, and migrate data before returning to multi-user mode.",
      "references": "NIST SP 800-53 Rev. 5: CM-7 | LVM HOWTO: http://tldp.org/HOWTO/LVM-HOWTO/",
      "audit_command": "findmnt -kn /home"
    },
    {
      "id": "1.1.2.3.2",
      "title": "Ensure nodev option set on /home partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/home",
      "required_option": "nodev",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.3.2 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /home filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /home.",
      "remediation": "Edit /etc/fstab and add nodev to the fourth field (mounting options) for /home:\n<device> /home <fstype> defaults,rw,nosuid,nodev,relatime 0 0\n\nRun the following command to remount /home:\n# mount -o remount /home",
      "impact": "None - /home should not contain device files",
      "references": "NIST SP 800-53 Rev. 5: AC-3, MP-2",
      "audit_command": "findmnt -kn /home | grep -v nodev"
    },
    {
      "id": "1.1.2.3.3",
      "title": "Ensure nosuid option set on /home partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/home",
      "required_option": "nosuid",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.3.3 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /home filesystem is only intended for user file storage, set this option to ensure that users cannot create setuid files in /home.",
      "remediation": "Edit /etc/fstab and add nosuid to the fourth field (mounting options) for /home:\n<device> /home <fstype> defaults,rw,nosuid,nodev,relatime 0 0\n\nRun the following command to remount /home:\n# mount -o remount /home",
      "impact": "None - /home should not contain setuid files",
      "references": "NIST SP 800-53 Rev. 5: AC-3, MP-2",
      "audit_command": "findmnt -kn /home | grep -v nosuid"
    },
    {
      "id": "1.1.2.4.1",
      "title": "Ensure separate partition exists for /var",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level2",
      "automated": true,
      "type": "MountPoint",
      "mount_point": "/var",
      "expected_status": "separate_partition",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.4.1 | Level 2 - Server | Level 2 - Workstation",
      "description": "The /var directory is used by daemons and other system services to temporarily store dynamic data. Some directories created by these processes may be world-writable.",
      "rationale": "The reasoning for mounting /var on a separate partition is as follows. The default installation only creates a single / partition. Since the /var directory may contain world writable files and directories, there is a risk of resource exhaustion. It will essentially have the whole disk available to fill up and impact the system. In addition, other operations on the system could fill up the disk unrelated to /var and cause unintended behavior across the system as the disk is full. Configuring /var as its own file system allows an administrator to set additional mount options such as noexec/nosuid/nodev. These options limit an attacker's ability to create exploits on the system. An example of exploiting /var may be an attacker establishing a hard-link to a system setuid program and waiting for it to be updated. Once the program is updated, the hard-link can be broken and the attacker would have their own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /var. For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.",
      "impact": "\u26a0\ufe0f LEVEL 2: Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing or may require the installation of additional tools solely for the purpose of resizing operations. The use of these additional tools may introduce their own security considerations.",
      "references": "AJ Lewis, LVM HOWTO, http://tldp.org/HOWTO/LVM-HOWTO/ | NIST SP 800-53 Rev. 5: CM-7 | RHEL 8 STIG Vul ID: V-244529 | RHEL 8 STIG Rule ID: SV-244529r902737 | CIS Controls v8 3.3: Configure Data Access Control Lists | CIS Controls v7 14.6: Protect Information through Access Control Lists",
      "audit_command": "findmnt -kn /var"
    },
    {
      "id": "1.1.2.4.2",
      "title": "Ensure nodev option set on /var partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/var",
      "required_option": "nodev",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.4.2 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /var filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var.",
      "remediation": "IF a separate partition exists for /var: Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var partition. Example: <device> /var <fstype> defaults,rw,nosuid,nodev,relatime 0 0. Run the following command to remount /var with the configured options: # mount -o remount /var",
      "impact": "None",
      "references": "fstab(5) manual page | NIST SP 800-53 Rev. 5: AC-3, MP-2 | CIS Controls v8 3.3: Configure Data Access Control Lists | CIS Controls v7 14.6: Protect Information through Access Control Lists",
      "audit_command": "findmnt -kn /var | grep -v nodev"
    },
    {
      "id": "1.1.2.4.3",
      "title": "Ensure nosuid option set on /var partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/var",
      "required_option": "nosuid",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.4.3 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /var filesystem is only intended for variable files such as logs, set this option to ensure that users cannot create setuid files in /var.",
      "remediation": "IF a separate partition exists for /var: Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var partition. Example: <device> /var <fstype> defaults,rw,nosuid,nodev,relatime 0 0. Run the following command to remount /var with the configured options: # mount -o remount /var",
      "impact": "None",
      "references": "fstab(5) manual page | NIST SP 800-53 Rev. 5: AC-3, MP-2 | CIS Controls v8 3.3: Configure Data Access Control Lists | CIS Controls v7 14.6: Protect Information through Access Control Lists",
      "audit_command": "findmnt -kn /var | grep -v nosuid"
    },
    {
      "id": "1.1.2.5.1",
      "title": "Ensure separate partition exists for /var/tmp",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level2",
      "automated": true,
      "type": "MountPoint",
      "mount_point": "/var/tmp",
      "expected_status": "separate_partition",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.5.1 | Level 2 - Server | Level 2 - Workstation",
      "description": "The /var/tmp directory is a world-writable directory used for temporary storage by all users and some applications. Temporary files residing in /var/tmp are to be preserved between reboots.",
      "rationale": "The default installation only creates a single / partition. Since the /var/tmp directory is world-writable, there is a risk of resource exhaustion. In addition, other operations on the system could fill up the disk unrelated to /var/tmp and cause potential disruption to daemons as the disk is full. Configuring /var/tmp as its own file system allows an administrator to set additional mount options such as noexec/nosuid/nodev. These options limit an attacker's ability to create exploits on the system.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /var/tmp. For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.",
      "impact": "\u26a0\ufe0f LEVEL 2: Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing or may require the installation of additional tools solely for the purpose of resizing operations. The use of these additional tools may introduce their own security considerations.",
      "references": "AJ Lewis, LVM HOWTO, http://tldp.org/HOWTO/LVM-HOWTO/ | NIST SP 800-53 Rev. 5: CM-7 | NIST SP 800-53A :: CM-6.1 (iv) | RHEL 8 STIG Vul ID: V-244529 | RHEL 8 STIG Rule ID: SV-244529r902737 | CIS Controls v8 3.3: Configure Data Access Control Lists | CIS Controls v7 14.6: Protect Information through Access Control Lists",
      "audit_command": "findmnt -kn /var/tmp"
    },
    {
      "id": "1.1.2.5.2",
      "title": "Ensure nodev option set on /var/tmp partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/var/tmp",
      "required_option": "nodev",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.5.2 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /var/tmp filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var/tmp.",
      "remediation": "IF a separate partition exists for /var/tmp: Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var/tmp partition. Example: <device> /var/tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0. Run the following command to remount /var/tmp with the configured options: # mount -o remount /var/tmp",
      "impact": "None",
      "references": "fstab(5) manual page | NIST SP 800-53 Rev. 5: AC-3, MP-2 | NIST SP 800-53 Revision 5 :: CM-7 (2) | RHEL 8 STIG Vul ID: V-230520 | RHEL 8 STIG Rule ID: SV-230520r854061 | CIS Controls v8 3.3: Configure Data Access Control Lists | CIS Controls v7 14.6: Protect Information through Access Control Lists",
      "audit_command": "findmnt -kn /var/tmp | grep -v nodev"
    },
    {
      "id": "1.1.2.5.3",
      "title": "Ensure nosuid option set on /var/tmp partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/var/tmp",
      "required_option": "nosuid",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.5.3 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /var/tmp.",
      "remediation": "IF a separate partition exists for /var/tmp: Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var/tmp partition. Example: <device> /var/tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0. Run the following command to remount /var/tmp with the configured options: # mount -o remount /var/tmp",
      "impact": "None",
      "references": "fstab(5) manual page | NIST SP 800-53 Rev. 5: AC-3, MP-2 | NIST SP 800-53 Revision 5 :: CM-7 (2) | RHEL 8 STIG Vul ID: V-230521 | RHEL 8 STIG STIG ID: RHEL-08-040133 | CIS Controls v8 3.3: Configure Data Access Control Lists | CIS Controls v7 14.6: Protect Information through Access Control Lists",
      "audit_command": "findmnt -kn /var/tmp | grep -v nosuid"
    },
    {
      "id": "1.1.2.5.4",
      "title": "Ensure noexec option set on /var/tmp partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/var/tmp",
      "required_option": "noexec",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.5.4 | Level 1 - Server | Level 1 - Workstation",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Since the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /var/tmp.",
      "remediation": "IF a separate partition exists for /var/tmp: Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /var/tmp partition. Example: <device> /var/tmp <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0. Run the following command to remount /var/tmp with the configured options: # mount -o remount /var/tmp",
      "impact": "None",
      "references": "fstab(5) manual page | NIST SP 800-53 Rev. 5: AC-3, MP-2 | NIST SP 800-53 Revision 5 :: CM-7 (2) | RHEL 8 STIG Vul ID: V-230522 | RHEL 8 STIG Rule ID: SV-230522r854063 | CIS Controls v8 3.3: Configure Data Access Control Lists | CIS Controls v7 14.6: Protect Information through Access Control Lists",
      "audit_command": "findmnt -kn /var/tmp | grep -v noexec"
    },
    {
      "id": "1.1.2.6.1",
      "title": "Ensure separate partition exists for /var/log",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level2",
      "automated": true,
      "type": "MountPoint",
      "mount_point": "/var/log",
      "expected_status": "separate_partition",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.6.1 | Level 2 - Server | Level 2 - Workstation",
      "description": "The /var/log directory is used by system services to store log data.",
      "rationale": "The default installation only creates a single / partition. Since the /var/log directory contains log files which can grow quite large, there is a risk of resource exhaustion. It will essentially have the whole disk available to fill up and impact the system as a whole. Configuring /var/log as its own file system allows an administrator to set additional mount options such as noexec/nosuid/nodev. These options limit an attackers ability to create exploits on the system. As /var/log contains log files, care should be taken to ensure the security and integrity of the data and mount point.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /var/log. For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.",
      "impact": "\u26a0\ufe0f LEVEL 2: Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing, or may require the installation of additional tools solely for the purpose of resizing operations. The use of these additional tools may introduce their own security considerations.",
      "references": "AJ Lewis, LVM HOWTO, http://tldp.org/HOWTO/LVM-HOWTO/ | NIST SP 800-53 Rev. 5:: CM-6 b CM-7 | NIST SP 800-53A :: CM-6.1 (iv) | RHEL 8 STIG Vul ID: V-230293 | RHEL 8 STIG Rule ID: SV-230293r902720 | CIS Controls v8 8.3: Ensure Adequate Audit Log Storage | CIS Controls v7 6.4: Ensure adequate storage for logs",
      "audit_command": "findmnt -kn /var/log"
    },
    {
      "id": "1.1.2.6.2",
      "title": "Ensure nodev option set on /var/log partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/var/log",
      "required_option": "nodev",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.6.2 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /var/log filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var/log.",
      "remediation": "IF a separate partition exists for /var/log: Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var/log partition. Example: <device> /var/log <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0. Run the following command to remount /var/log with the configured options: # mount -o remount /var/log",
      "impact": "None",
      "references": "fstab(5) manual page | NIST SP 800-53 Rev. 5: AC-3, MP-2 | NIST SP 800-53 Revision 5 :: CM-7 (2) | RHEL 8 STIG Vul ID: V-230514 | RHEL 8 STIG Rule ID: SV-230514r854055 | CIS Controls v8 3.3: Configure Data Access Control Lists | CIS Controls v7 14.6: Protect Information through Access Control Lists",
      "audit_command": "findmnt -kn /var/log | grep -v nodev"
    },
    {
      "id": "1.1.2.6.3",
      "title": "Ensure nosuid option set on /var/log partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/var/log",
      "required_option": "nosuid",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.6.3 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /var/log filesystem is only intended for log files, set this option to ensure that users cannot create setuid files in /var/log.",
      "remediation": "IF a separate partition exists for /var/log: Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var/log partition. Example: <device> /var/log <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0. Run the following command to remount /var/log with the configured options: # mount -o remount /var/log",
      "impact": "None",
      "references": "fstab(5) manual page | NIST SP 800-53 Rev. 5: AC-3, MP-2 | NIST SP 800-53 Revision 5 :: CM-7 (2) | RHEL 8 STIG Vul ID: V-230515 | RHEL 8 STIG Rule ID: SV-230515r854056 | CIS Controls v8 3.3: Configure Data Access Control Lists | CIS Controls v7 14.6: Protect Information through Access Control Lists",
      "audit_command": "findmnt -kn /var/log | grep -v nosuid"
    },
    {
      "id": "1.1.2.6.4",
      "title": "Ensure noexec option set on /var/log partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/var/log",
      "required_option": "noexec",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.6.4 | Level 1 - Server | Level 1 - Workstation",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Since the /var/log filesystem is only intended for log files, set this option to ensure that users cannot run executable binaries from /var/log.",
      "remediation": "IF a separate partition exists for /var/log: Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /var/log partition. Example: <device> /var/log <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0. Run the following command to remount /var/log with the configured options: # mount -o remount /var/log",
      "impact": "None",
      "references": "fstab(5) manual page | NIST SP 800-53 Rev. 5: AC-3, MP-2 | NIST SP 800-53 Revision 5 :: CM-7 (2) | RHEL 8 STIG Vul ID: V-230516 | RHEL 8 STIG Rule ID: SV-230516r854057 | CIS Controls v8 3.3: Configure Data Access Control Lists | CIS Controls v7 14.6: Protect Information through Access Control Lists",
      "audit_command": "findmnt -kn /var/log | grep -v noexec"
    },
    {
      "id": "1.1.2.7.1",
      "title": "Ensure separate partition exists for /var/log/audit",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level2",
      "automated": true,
      "type": "MountPoint",
      "mount_point": "/var/log/audit",
      "expected_status": "separate_partition",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.7.1 | Level 2 - Server | Level 2 - Workstation",
      "description": "The auditing daemon, auditd, stores log data in the /var/log/audit directory.",
      "rationale": "The default installation only creates a single / partition. Since the /var/log/audit directory contains the audit.log file which can grow quite large, there is a risk of resource exhaustion. It will essentially have the whole disk available to fill up and impact the system as a whole. In addition, other operations on the system could fill up the disk unrelated to /var/log/audit and cause auditd to trigger its space_left_action as the disk is full. Configuring /var/log/audit as its own file system allows an administrator to set additional mount options such as noexec/nosuid/nodev. These options limit an attacker's ability to create exploits on the system. As /var/log/audit contains audit logs, care should be taken to ensure the security and integrity of the data and mount point.",
      "remediation": "For new installations, during installation create a custom partition setup and specify a separate partition for /var/log/audit. For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.",
      "impact": "\u26a0\ufe0f LEVEL 2: Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem partitions may prevent successful resizing or may require the installation of additional tools solely for the purpose of resizing operations. The use of these additional tools may introduce their own security considerations.",
      "references": "AJ Lewis, LVM HOWTO, http://tldp.org/HOWTO/LVM-HOWTO/ | NIST SP 800-53 Rev. 5: CM-7 CM-6 b | NIST SP 800-53A :: CM-6.1 (iv) | RHEL 8 STIG Vul ID: V-230294 | RHEL 8 STIG Rule ID: SV-230294r627750 | CIS Controls v8 8.3: Ensure Adequate Audit Log Storage | CIS Controls v7 6.4: Ensure adequate storage for logs",
      "audit_command": "findmnt -kn /var/log/audit"
    },
    {
      "id": "1.1.2.7.2",
      "title": "Ensure nodev option set on /var/log/audit partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/var/log/audit",
      "required_option": "nodev",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.7.2 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "rationale": "Since the /var/log/audit filesystem is not intended to support devices, set this option to ensure that users cannot create a block or character special devices in /var/log/audit.",
      "remediation": "IF a separate partition exists for /var/log/audit: Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var/log/audit partition. Example: <device> /var/log/audit <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0. Run the following command to remount /var/log/audit with the configured options: # mount -o remount /var/log/audit",
      "impact": "None",
      "references": "fstab(5) manual page | NIST SP 800-53 Revision 5 :: CM-7 (2) | STIG ID: RHEL-08-040129 | RULE ID: SV-230517r958804 | STIG ID: RHEL-09-231175 | RULE ID: SV-257876r958804 | STIG ID: ALMA-09-027190 | RULE ID: SV-269320r1050202 | CIS Controls v8 3.3: Configure Data Access Control Lists | CIS Controls v7 14.6: Protect Information through Access Control Lists",
      "audit_command": "findmnt -kn /var/log/audit | grep -v nodev"
    },
    {
      "id": "1.1.2.7.3",
      "title": "Ensure nosuid option set on /var/log/audit partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/var/log/audit",
      "required_option": "nosuid",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.7.3 | Level 1 - Server | Level 1 - Workstation",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "rationale": "Since the /var/log/audit filesystem is only intended for variable files such as logs, set this option to ensure that users cannot create setuid files in /var/log/audit.",
      "remediation": "IF a separate partition exists for /var/log/audit: Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var/log/audit partition. Example: <device> /var/log/audit <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0. Run the following command to remount /var/log/audit with the configured options: # mount -o remount /var/log/audit",
      "impact": "None",
      "references": "fstab(5) manual page | NIST SP 800-53 Rev. 5: AC-3, MP-2 | NIST SP 800-53 Revision 5 :: CM-7 (2) | STIG ID: RHEL-08-040130 | RULE ID: SV-230518r958804 | STIG ID: RHEL-09-231170 | RULE ID: SV-257875r958804 | CIS Controls v8 3.3: Configure Data Access Control Lists | CIS Controls v7 14.6: Protect Information through Access Control Lists",
      "audit_command": "findmnt -kn /var/log/audit | grep -v nosuid"
    },
    {
      "id": "1.1.2.7.4",
      "title": "Ensure noexec option set on /var/log/audit partition",
      "section": "1.1.2 Filesystem Partitions",
      "profile": "Level1",
      "automated": true,
      "type": "MountOption",
      "mount_point": "/var/log/audit",
      "required_option": "noexec",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.1.2.7.4 | Level 1 - Server | Level 1 - Workstation",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "rationale": "Since the /var/log/audit filesystem is only intended for audit logs, set this option to ensure that users cannot run executable binaries from /var/log/audit.",
      "remediation": "IF a separate partition exists for /var/log/audit: Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /var/log/audit partition. Example: <device> /var/log/audit <fstype> defaults,rw,nosuid,nodev,noexec,relatime 0 0. Run the following command to remount /var/log/audit with the configured options: # mount -o remount /var/log/audit",
      "impact": "None",
      "references": "fstab(5) manual page | NIST SP 800-53 Rev. 5: AC-3, MP-2 | NIST SP 800-53 Revision 5 :: CM-7 (2) | CIS Controls v8 3.3: Configure Data Access Control Lists | CIS Controls v7 14.6: Protect Information through Access Control Lists",
      "audit_command": "findmnt -kn /var/log/audit | grep -v noexec"
    }
  ]
}