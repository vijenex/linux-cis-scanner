{
  "milestone": "5-3",
  "section": "5.3 Configure PAM",
  "description": "Configure Pluggable Authentication Modules",
  "controls": [
    {
      "id": "5.3.1",
      "title": "Ensure password creation requirements are configured",
      "section": "5.3 PAM",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.1",
      "description": "Password complexity requirements should be enforced",
      "remediation": "Edit /etc/security/pwquality.conf and set minlen, dcredit, ucredit, ocredit, lcredit"
    },
    {
      "id": "5.3.1.1",
      "title": "Ensure latest version of pam is installed",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 Updated versions of PAM include additional functionality\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 To ensure the system has full functionality and access to the options covered by this\\\nBenchmark, pam-1.3.1-25 or latter is required\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify the version of \n\\f0 \\cf4 PAM\n\\f2 \\cf2  on the system:\\\n\n\\f4\\fs20\\fsmilli10080 # rpm -q pam\\\n\n\\f2\\fs24 The output should be similar to:\\\n\n\\f4\\fs20\\fsmilli10080 pam-1.3.1-25.el8.x86_64\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n- IF -\n\\f2\\b0  the version of \n\\f0 \\cf4 PAM\n\\f2 \\cf2  on the system is less that version \n\\f0 \\cf4 pam-1.3.1-25\n\\f2 \\cf2 :\\\nRun the following command to update to the latest version of \n\\f0 \\cf4 PAM\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # dnf upgrade pam\n\\f2 Page 678\\\n\n\\f0 Internal Only - General\\\n\n\\f3\\i\\fs32\\fsmilli16080 \\cf3",
      "references": "",
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.1.1 | Level1"
    },
    {
      "id": "5.3.1.2",
      "title": "Ensure latest version of authselect is installed\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 Authselect is a utility that simplifies the configuration of user authentication. Authselect\\\noffers ready-made profiles that can be universally used with all modern identity\\\nmanagement systems\\\nYou can create and deploy a custom profile by customizing one of the default profiles,\\\nthe sssd, winbind, or the nis profile. This is particularly useful if Modifying a ready-made\\\nauthselect profile is not enough for your needs. When you deploy a custom profile, the\\\nprofile is applied to ev",
      "rationale": "\\\n\n\\f2\\b0 Authselect makes testing and troubleshooting easy because it only modifies files in\\\nthese directories:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 /etc/nsswitch.conf\\\n\n\\fs20\\fsmilli10080 \\cf2 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 /etc/pam.d/*\\\n\n\\fs20\\fsmilli10080 \\cf2 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 /etc/dconf/db/distro.d/*\\\n\n\\f2 \\cf2 To ensure the system has full functionality and access to the options covered by this\\\nBenchmark, \n\\f0 \\cf4 authselect-1.2.6-1\n\\f2 \\cf2  or latter is required\\\n\n\\f1\\b",
      "impact": "\\\n\n\\f2\\b0 If local site customizations have been made to an authselect default or custom profile\\\ncreated with the \n\\f0 \\cf4 --symlink-pam\n\\f2 \\cf2  option, these customizations may be over-written by\\\nupdating authselect.\n\\fs20\\fsmilli10080 Page 679\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 WARNIN",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify the version of \n\\f0 \\cf4 authselect\n\\f2 \\cf2  on the system:\\\n\n\\f4\\fs20\\fsmilli10080 # rpm -q authselect\\\n\n\\f2\\fs24 The output should be similar to:\\\n\n\\f4\\fs20\\fsmilli10080 authselect-1.2.6-1.el8.x86_64\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to install \n\\f0 \\cf4 authselect\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # dnf install authselect\\\n\n\\f1\\b\\fs24 - IF -\n\\f2\\b0  the version of \n\\f0 \\cf4 authselect\n\\f2 \\cf2  on the system is less that version \n\\f0 \\cf4 authselect-1.2.6-\\\n1\n\\f2 \\cf2 :\\\nRun the following command to update to the latest version of \n\\f0 \\cf4 authselect\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # dnf upgrade authselect\n\\f2 Page 680\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs27\\fsmilli13920 \\cf3 5.3.2 Configure authselect\\\n\n\\f2\\b0\\fs24 \\cf2 Authselect is a utility that simplifies the configuration of user authentication. Authselect\\\noffers ready-made profiles that can be universally used with all modern identity\\\nmanagement systems\\\nAuthselect makes testing and troubleshooting easy because it o",
      "references": "",
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.1.2 | Level1"
    },
    {
      "id": "5.3.2",
      "title": "Ensure lockout for failed password attempts is configured",
      "section": "5.3 PAM",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.2",
      "description": "Account lockout after failed login attempts prevents brute force attacks",
      "remediation": "Configure pam_faillock in /etc/pam.d/system-auth and /etc/pam.d/password-auth"
    },
    {
      "id": "5.3.2.1",
      "title": "Ensure active authselect profile includes pam modules\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 A custom profile can be created by copying and customizing one of the default profiles.\\\nThe default profiles include: local, sssd, and winbind. These profile can be customized\\\nto follow site specific requirements.\\\nYou can select a profile for the authselect utility for a specific host. The profile will be\\\napplied to every user logging into the host.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 A custom profile is required to customize many of the pam options.\\\nModifications made to a default profile may be overwritten during an update.\\\nWhen you deploy a profile, the profile is applied to every user logging into the given host\\\n\n\\f1\\b",
      "impact": "\\\n\n\\f2\\b0 If local site customizations have been made to the authselect template or files in\\\n\n\\f0 \\cf4 /etc/pam.d\n\\f2 \\cf2  these custom entries should be added to the newly created custom profile\\\nbefore it's applied to the system.\\\n\n\\f1\\b Note:\n\\f2\\b0  The order within the pam stacks is important",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify the active authselect profile includes lines for the\\\n\n\\f0 \\cf4 pwquality\n\\f2 \\cf2 , \n\\f0 \\cf4 pwhistory\n\\f2 \\cf2 , \n\\f0 \\cf4 faillock\n\\f2 \\cf2 , and \n\\f0 \\cf4 unix\n\\f2 \\cf2  modules:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -P --\\\n'\\\\b(pam_pwquality\\\\.so|pam_pwhistory\\\\.so|pam_faillock\\\\.so|pam_unix\\\\.so)\\\\b'\\\n/etc/authselect/\"$(head -1\\\n/etc/authselect/authselect.conf)\"/\\{system,password\\}-auth\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs19\\fsmilli9600 /etc/auth",
      "remediation": "\\\n\n\\f2\\b0 Perform the following to create a custom authselect profile, with the modules covered in\\\nthis Benchmark correctly included in the custom profile template files\\\nRun the following command to create a custom authselect profile:\\\n\n\\f4\\fs20\\fsmilli10080 # authselect create-profile <custom-profile name> <options>\\\n\n\\f3\\i\\fs24 Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # authselect create-profile custom-profile -b local\\\n\n\\f2\\fs24 Run the following command to select a custom authselect profile:\\\n\n\\f4\\fs20\\fsmilli10080 # authselect select custom/<CUSTOM PROFILE NAME> \\{with-<OPTIONS>\\} \\{--force\\}\\\n\n\\f3\\i\\fs24 Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # authselect select custom/custom-profile --backup=PAM_CONFIG_BACKUP --force\\\n\n\\f1\\b\\fs24 Notes:\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 The PAM ",
      "references": "\\\n\n\\f2\\b0 1. authselect(8)\\\n2. \\cf7 https://access.redhat.com/documentation/en-\\\nus/red_hat_enterprise_linux/9/html/configuring_authentication_and_authorization\\\n_in_rhel/configuring-user-authentication-using-authselect_configuring-\\\nauthentication-and-authorization-in-rhel#creating-and-deploying-yo",
      "type": "FileContent",
      "file_path": "/etc/authselect/\"$(head",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.2.1 | Level1"
    },
    {
      "id": "5.3.2.2",
      "title": "Ensure pam_faillock module is enabled",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 pam_faillock.so\n\\f2 \\cf2  module maintains a list of failed authentication attempts per\\\nuser during a specified interval and locks the account in case there were more than the\\\nconfigured number of consecutive failed authentications (this is defined by the \n\\f0 \\cf4 deny\\\n\n\\f2 \\cf2 parameter in the faillock configuration). It stores the failure records into per-user files in\\\nthe tally directory.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Locking out user IDs after n unsuccessful consecutive login attempts mitigates brute\\\nforce password attacks against your systems.\\\n\n\\f1\\b",
      "impact": "this Safeguard.\\\n\n\\fs27\\fsmilli13920 \\cf8 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf5 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf6 \\uc0\\u9679 \\\n\n\\fs24 \\cf2 v7\\\n16.7 Establish Process for Revoking Access\\\n\n\\fs16\\fsmilli8400 Establish and follow an automated process for revoking system access",
      "audit_command": "\\\n\n\\f2\\b0 Run the following commands to verify that \n\\f0 \\cf4 pam_faillock\n\\f2 \\cf2  is enabled\\\n\n\\f4\\fs20\\fsmilli10080 # grep -P --\\\n'\\\\bpam_faillock.so\\\\b' /etc/pam.d/\\{password,system\\}-auth\\\n\n\\f2\\fs24 Output should be similar to:\\\n\n\\f4\\fs20\\fsmilli10080 /etc/pam.d/password-auth:auth required pam_faillock.so preauth\\\nsilent\\\n/etc/pam.d/password-auth:auth required pam_faillock.so authfail\\\n/etc/pam.d/password-auth:account required pam_faillock.so\\\n/etc/pam.d/system-auth:auth required pam_faill",
      "remediation": "\\\n\n\\f2\\b0 Run the following script to verify the \n\\f0 \\cf4 pam_faillock.so\n\\f2 \\cf2  lines exist in the profile\\\ntemplates:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_module_name=\"faillock\"\\\nl_pam_profile=\"$(head -1 /etc/authselect/authselect.conf)\"\\\nif grep -Pq -- '^custom\\\\/' <<< \"$l_pam_profile\"; then\\\nl_pam_profile_path=\"/etc/authselect/$l_pam_profile\"\\\nelse\\\nl_pam_profile_path=\"/usr/share/authselect/",
      "references": "\\\n\n\\f2\\b0 1. faillock(8) - Linux man page\\\n2. pam_faillock(8) - Linux man page\\\n3. NIST SP 800-53 :: AC-7 a\\\n4. NIST SP 800-53A :: AC-7.1 (ii)\\\n5. RHEL 8 STIG GROUP ID: V-244533\\\n6. RHEL 8 STIG RULE ID: SV-244533r743848\\\n7. RHEL 8 STIG GROUP ID: V-244534\\\n8. RHEL 8 STIG RULE ID: SV-244534r743851\\\n\n\\",
      "type": "FileContent",
      "file_path": "/etc/pam.d/\\{password,system\\}-auth\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.2.2 | Level1"
    },
    {
      "id": "5.3.2.3",
      "title": "Ensure pam_pwquality module is enabled",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 pam_pwquality.so\n\\f2 \\cf2  module performs password quality checking. This module can\\\nbe plugged into the password stack of a given service to provide strength-checking for\\\npasswords. The code was originally based on pam_cracklib module and the module is\\\nbackwards compatible with its options.\\\nThe action of this module is to prompt the user for a password and check its strength\\\nagainst a system dictionary and a set of rules for identifying poor choices.\\\nThe first act",
      "rationale": "\\\n\n\\f2\\b0 Use of a unique, complex passwords helps to increase the time and resources required\\\nto compromise the password.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following commands to verify that \n\\f0 \\cf4 pam_pwquality\n\\f2 \\cf2  is enabled:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -P --\\\n'\\\\bpam_pwquality\\\\.so\\\\b' /etc/pam.d/\\{password,system\\}-auth\\\n\n\\f2\\fs24 Output should be similar to:\\\n\n\\f4\\fs20\\fsmilli10080 /etc/pam.d/password-auth:password requisite pam_pwquality.so\\\nlocal_users_only\\\n/etc/pam.d/system-auth:password requisite pam_pwquality.so\\\nlocal_users_only\n\\f2 Page 691\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Review the authselect profile templates:\\\nRun the following script to verify the \n\\f0 \\cf4 pam_pwquality.so\n\\f2 \\cf2  lines exist in the active profile\\\ntemplates:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_module_name=\"pwquality\"\\\nl_pam_profile=\"$(head -1 /etc/authselect/authselect.conf)\"\\\nif grep -Pq -- '^custom\\\\/' <<< \"$l_pam_profile\"; then\\\nl_pam_profile_path=\"/etc/authselect/$l_pam_profile\"\\\nelse\\\nl_pam_profile_path=\"/usr/share/authselect/",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: CM-6 b\\\n2. NIST SP 800-53A :: CM-6.1 (iv)\\\n3. RHEL 8 STIG GROUP ID: V-230356\\\n4. RHEL 8 STIG RULE ID: SV-230356r902728\\\n5. RHEL 8 STIG GROUP ID: V-251713\n\\fs20\\fsmilli10080 Page 692\\\n\n\\f0 Internal Only - General\\\n\n\\f2\\fs24 6. RHEL 8 STIG RULE ID: SV-251713r902740\\\n\n\\f1",
      "type": "FileContent",
      "file_path": "/etc/pam.d/\\{password,system\\}-auth\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.2.3 | Level1"
    },
    {
      "id": "5.3.2.4",
      "title": "Ensure pam_pwhistory module is enabled",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 pam_history.so\n\\f2 \\cf2  module saves the last passwords for each user in order to force\\\npassword change history and keep the user from alternating between the same\\\npassword too frequently.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Requiring users not to reuse their passwords make it less likely that an attacker will be\\\nable to guess the password or use a compromised password.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following commands to verify that \n\\f0 \\cf4 pam_pwhistory\n\\f2 \\cf2  is enabled:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -P --\\\n'\\\\bpam_pwhistory\\\\.so\\\\b' /etc/pam.d/\\{password,system\\}-auth\\\n\n\\f2\\fs24 Output should be similar to:\\\n\n\\f4\\fs20\\fsmilli10080 /etc/pam.d/password-auth:password required pam_pwhistory.so use_authtok\\\n/etc/pam.d/system-auth:password required pam_pwhistory.so use_authtok\n\\f2 Page 694\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following script to verify the \n\\f0 \\cf4 pam_pwhistory.so\n\\f2 \\cf2  lines exist in the profile\\\ntemplates:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_module_name=\"pwhistory\"\\\nl_pam_profile=\"$(head -1 /etc/authselect/authselect.conf)\"\\\nif grep -Pq -- '^custom\\\\/' <<< \"$l_pam_profile\"; then\\\nl_pam_profile_path=\"/etc/authselect/$l_pam_profile\"\\\nelse\\\nl_pam_profile_path=\"/usr/share/authselect/",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: IA-5(1)\n\\fs20\\fsmilli10080 Page 695\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/pam.d/\\{password,system\\}-auth\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.2.4 | Level1"
    },
    {
      "id": "5.3.2.5",
      "title": "Ensure pam_unix module is enabled",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 pam_unix.so\n\\f2 \\cf2  module is the standard Unix authentication module. It uses standard\\\ncalls from the system's libraries to retrieve and set account information as well as\\\nauthentication. Usually this is obtained from the \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2  and the \n\\f0 \\cf4 /etc/shadow\n\\f2 \\cf2  file\\\nas well if shadow is enabled.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Requiring users to use authentication make it less likely that an attacker will be able to\\\naccess the system.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following commands to verify that \n\\f0 \\cf4 pam_unix\n\\f2 \\cf2  is enabled:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -P --\\\n'\\\\bpam_unix\\\\.so\\\\b' /etc/pam.d/\\{password,system\\}-auth\\\n\n\\f2\\fs24 Output should be similar to:\\\n\n\\f4\\fs20\\fsmilli10080 /etc/pam.d/password-auth:auth sufficient pam_unix.so\\\n/etc/pam.d/password-auth:account required pam_unix.so\\\n/etc/pam.d/password-auth:password sufficient pam_unix.so sha512 shadow\\\nuse_authtok\\\n/etc/pam.d/password-auth:session required pam_unix.so",
      "remediation": "\\\n\n\\f2\\b0 Run the following script to verify the \n\\f0 \\cf4 pam_unix.so\n\\f2 \\cf2  lines exist in the profile templates:\n\\fs20\\fsmilli10080 Page 697\\\n\n\\f0 Internal Only - General\\\n\n\\f4 #!/usr/bin/env bash\\\n\\{\\\nl_module_name=\"unix\"\\\nl_pam_profile=\"$(head -1 /etc/authselect/authselect.conf)\"\\\nif grep -Pq -- '^custom\\\\/' <<< \"$l_pam_profile\"; then\\\nl_pam_profile_path=\"/etc/authselect/$l_pam_profile\"\\\nelse\\\nl_pam_profile_path=\"/usr/share/authselect/",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: IA-5(1)\n\\fs20\\fsmilli10080 Page 698\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs27\\fsmilli13920 \\cf3 5.3.3 Configure PAM Arguments\\\n\n\\f2\\b0\\fs24 \\cf2 Pluggable Authentication Modules (PAM) uses arguments to pass information to a\\\npluggable module during authentication",
      "type": "FileContent",
      "file_path": "/etc/pam.d/\\{password,system\\}-auth\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.2.5 | Level1"
    },
    {
      "id": "5.3.3",
      "title": "Ensure password reuse is limited",
      "section": "5.3 PAM",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.3",
      "description": "Users should not be able to reuse recent passwords",
      "remediation": "Add remember=5 to pam_pwhistory.so in /etc/pam.d/system-auth"
    },
    {
      "id": "5.3.3.1.1",
      "title": "Ensure password failed attempts lockout is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 deny=n\n\\f2 \\cf2  option will deny access if the number of consecutive authentication failures\\\nfor this user during the recent interval exceeds \n\\f3\\i n\n\\f2\\i0 .\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Locking out user IDs after \n\\f3\\i n\n\\f2\\i0  unsuccessful consecutive login attempts mitigates brute\\\nforce password attacks against your systems.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that Number of failed logon attempts before the\\\naccount is locked is no greater than \n\\f0 \\cf4 5\n\\f2 \\cf2  and meets local site policy:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Pi --\\\n'^\\\\h*deny\\\\h*=\\\\h*[1-5]\\\\b' /etc/security/faillock.conf\\\ndeny = 5\\\n\n\\f2\\fs24 Run the following command to verify that the \n\\f0 \\cf4 deny\n\\f2 \\cf2  argument has not been set, or is set\\\nto 5 or less and meets local site policy:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Pi --\\\n'^\\\\h*auth\\",
      "remediation": "\\\n\n\\f2\\b0 Create or edit the following line in \n\\f0 \\cf4 /etc/security/faillock.conf\n\\f2 \\cf2  setting the \n\\f0 \\cf4 deny\\\n\n\\f2 \\cf2 option to \n\\f0 \\cf4 5\n\\f2 \\cf2  or less:\\\n\n\\f4\\fs20\\fsmilli10080 deny = 5\\\n\n\\f2\\fs24 Run the following script to remove the \n\\f0 \\cf4 deny\n\\f2 \\cf2  argument from the \n\\f0 \\cf4 pam_faillock.so\\\n\n\\f2 \\cf2 module in the PAM files:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nfor l_pam_file in system-auth password-auth; do\\\nl_authselect_file=\"/etc/authselect/$(head -1\\\n/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file\"\\\nsed -ri\\\n's/(^\\\\s*auth\\\\s+(requisite|required|sufficient)\\\\s+pam_faillock\\\\.so.*)(\\\\s+deny\\\\\\\ns*=\\\\s*\\\\S+)(.*$)/\\\\1\\\\4/' \"$l_authselect_file\"\\\ndone\\\nauthselect apply-changes\\\n\\}\\\n\n\\f1\\b\\fs24",
      "references": "",
      "type": "FileContent",
      "file_path": "/etc/security/faillock.conf\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.3.1.1 | Level1"
    },
    {
      "id": "5.3.3.1.2",
      "title": "Ensure password unlock time is configured",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f0\\b0 \\cf4 unlock_time=n\n\\f2 \\cf2  - The access will be re-enabled after \n\\f3\\i n\n\\f2\\i0  seconds after the lock out. The\\\nvalue \n\\f0 \\cf4 0\n\\f2 \\cf2  has the same meaning as value never - the access will not be re-enabled\\\nwithout resetting the faillock entries by the faillock(8) command.\\\n\n\\f1\\b Notes:\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 The default directory that pam_faillock uses is usually cleared on system boot so\\\nthe access will be also re-enabled after system reboot. If that",
      "rationale": "\\\n\n\\f2\\b0 Locking out user IDs after \n\\f3\\i n\n\\f2\\i0  unsuccessful consecutive login attempts mitigates brute\\\nforce password attacks against your systems.\\\n\n\\f1\\b",
      "impact": "\\\n\n\\f2\\b0 Use of \n\\f0 \\cf4 unlock_time=0\n\\f2 \\cf2  may allow an attacker to cause denial of service to legitimate\\\nusers. This will also require a systems administrator with elevated privileges to unlock\\\nthe account.\n\\fs20\\fsmilli10080 Page 704\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that the time in seconds before the account is\\\nunlocked is either \n\\f0 \\cf4 0\n\\f2 \\cf2  (never) or \n\\f0 \\cf4 900\n\\f2 \\cf2  (15 minutes) or more and meets local site policy:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Pi --\\\n'^\\\\h*unlock_time\\\\h*=\\\\h*(0|9[0-9][0-9]|[1-9][0-9]\\{3,\\})\\\\b'\\\n/etc/security/faillock.conf\\\nunlock_time = 900\\\n\n\\f2\\fs24 Run the following command to verify that the \n\\f0 \\cf4 unlock_time\n\\f2 \\cf2  argument has not been set,\\\nor is either \n",
      "remediation": "\\\n\n\\f2\\b0 Set password unlock time to conform to site policy. \n\\f0 \\cf4 unlock_time\n\\f2 \\cf2  should be \n\\f0 \\cf4 0\n\\f2 \\cf2  (never),\\\nor \n\\f0 \\cf4 900\n\\f2 \\cf2  seconds or greater.\\\nEdit \n\\f0 \\cf4 /etc/security/faillock.conf\n\\f2 \\cf2  and update or add the following line:\\\n\n\\f4\\fs20\\fsmilli10080 unlock_time = 900\\\n\n\\f2\\fs24 Run the following script to remove the \n\\f0 \\cf4 unlock_time\n\\f2 \\cf2  argument from the\\\n\n\\f0 \\cf4 pam_faillock.so\n\\f2 \\cf2  module in the PAM files:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nfor l_pam_file in system-auth password-auth; do\\\nl_authselect_file=\"/etc/authselect/$(head -1\\\n/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file\"\\\nsed -ri\\\n's/(^\\\\s*auth\\\\s+(requisite|required|sufficient)\\\\s+pam_faillock\\\\.so.*)(\\\\s+unloc\\\nk_time\\\\s*=\\\\s*\\\\S+)",
      "references": "",
      "type": "FileContent",
      "file_path": "/etc/security/faillock.conf\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.3.1.2 | Level1"
    },
    {
      "id": "5.3.3.2.2",
      "title": "Ensure password length is configured",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f0\\b0 \\cf4 minlen\n\\f2 \\cf2  - Minimum acceptable size for the new password (plus one if credits are not\\\ndisabled which is the default). Cannot be set to lower value than 6.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Strong passwords protect systems from being hacked through brute force methods.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that password length is \n\\f0 \\cf4 14\n\\f2 \\cf2  or more characters, and\\\nconforms to local site policy:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Psi --\\\n'^\\\\h*minlen\\\\h*=\\\\h*(1[4-9]|[2-9][0-9]|[1-9][0-9]\\{2,\\})\\\\b'\\\n/etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 /etc/security/pwquality.conf.d/50-pwlength.conf:minlen = 14\\\n\n\\f2\\fs24 Verify returned value(s) are no less than \n\\f0 \\cf4 14",
      "remediation": "\\\n\n\\f2\\b0 Create or modify a file ending in \n\\f0 \\cf4 .conf\n\\f2 \\cf2  in the \n\\f0 \\cf4 /etc/security/pwquality.conf.d/\\\n\n\\f2 \\cf2 directory or the file \n\\f0 \\cf4 /etc/security/pwquality.conf\n\\f2 \\cf2  and add or modify the following\\\nline to set password length of \n\\f0 \\cf4 14\n\\f2 \\cf2  or more characters. Ensure that password length\\\nconforms to local site policy:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # sed -ri 's/^\\\\s*minlen\\\\s*=/# &/' /etc/security/pwquality.conf\\\n# printf '%s\\\\n' \"\" \"minlen = 14\" >> /etc/security/pwquality.conf.d/50-\\\npwlength.conf\\\n\n\\f2\\fs24 Run the following script to remove setting \n\\f0 \\cf4 minlen\n\\f2 \\cf2  on the \n\\f0 \\cf4 pam_pwquality.so\n\\f2 \\cf2  module in\\\nthe PAM files:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nfor l_pam_file in system-auth passw",
      "references": "\\\n\n\\f2\\b0 1. pam_pwquality(8)\\\n2. NIST SP 800-53 Rev. 5: IA-5\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/security/pwquality.conf",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.3.2.2 | Level1"
    },
    {
      "id": "5.3.3.2.3",
      "title": "Ensure password complexity is configured",
      "automated": false,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 Password complexity can be set through:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 minclass\n\\f2 \\cf2  - The minimum number of classes of characters required in a new\\\npassword. (digits, uppercase, lowercase, others). e.g. \n\\f0 \\cf4 minclass = 4\n\\f2 \\cf2  requires\\\ndigits, uppercase, lower case, and special characters.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 dcredit\n\\f2 \\cf2  - The maximum credit for having digits in the new password. If less than\\\n\n\\f0 \\cf4 0\n\\f2 \\cf2  i",
      "rationale": "\\\n\n\\f2\\b0 Strong passwords protect systems from being hacked through brute force methods.\n\\fs20\\fsmilli10080 Page 718\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that complexity conforms to local site policy:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Psi --\\\n'^\\\\h*(minclass|[dulo]credit)\\\\b' /etc/security/pwquality.conf\\\n/etc/security/pwquality.conf.d/*.conf\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 /etc/security/pwquality.conf.d/50-pwcomplexity.conf:minclass = 4\\\n-- AND/OR --\\\n/etc/security/pwquality.conf.d/50-pwcomplexity.conf:dcredit = -1\\\n/etc/security/pwquality.conf.d/50-pwcomplexity.conf:ucredit = -",
      "remediation": "\\\n\n\\f2\\b0 Create or modify a file ending in \n\\f0 \\cf4 .conf\n\\f2 \\cf2  in the \n\\f0 \\cf4 /etc/security/pwquality.conf.d/\\\n\n\\f2 \\cf2 directory or the file \n\\f0 \\cf4 /etc/security/pwquality.conf\n\\f2 \\cf2  and add or modify the following\\\nline to set:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 minclass = 4\\\n\n\\f1\\b \\cf2 --AND/OR--\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 dcredit = -_N_\\\n\n\\fs20\\fsmilli10080 \\cf2 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 ucredit = -_N_\\\n\n\\fs20\\fsmilli10080 \\cf2 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 ocredit = -_N_\\\n\n\\fs20\\fsmilli10080 \\cf2 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 lcredit = -_N_\\\n\n\\f3\\i \\cf2 Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # sed -ri 's/^\\\\s*minclass\\\\s*=/# &/' /etc/security/pwquality.conf\\\n# printf '\\\\n%s' \"minclass = 4\" >> /etc/security/pwquality.conf.d/50-\\\npwcomplexity.c",
      "references": "\\\n\n\\f2\\b0 1. pam_pwquality(8)\\\n2. PWQUALITY.CONF(5)\\\n3. NIST SP 800-53 Rev. 5: IA-5\\\n\n\\f1\\b",
      "type": "Manual",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.3.2.3 | Level1"
    },
    {
      "id": "5.3.3.2.6",
      "title": "Ensure password dictionary check is enabled\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 pwquality\n\\f2 \\cf2  \n\\f0 \\cf4 dictcheck\n\\f2 \\cf2  option sets whether to check for the words from the\\\n\n\\f0 \\cf4 cracklib\n\\f2 \\cf2  dictionary.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 If the operating system allows the user to select passwords based on dictionary words,\\\nthis increases the chances of password compromise by increasing the opportunity for\\\nsuccessful guesses, and brute-force attacks.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that the \n\\f0 \\cf4 dictcheck\n\\f2 \\cf2  option is not set to \n\\f0 \\cf4 0\n\\f2 \\cf2  (disabled)\\\nin a pwquality configuration file:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Psi --\\\n'^\\\\h*dictcheck\\\\h*=\\\\h*0\\\\b' /etc/security/pwquality.conf\\\n/etc/security/pwquality.conf.d/*.conf\\\n\n\\f2\\fs24 Nothing should be returned.\\\nRun the following command to verify that the \n\\f0 \\cf4 dictcheck\n\\f2 \\cf2  option is not set to \n\\f0 \\cf4 0\n\\f2 \\cf2  (disabled)\\\nas a module argum",
      "remediation": "\\\n\n\\f2\\b0 Edit any file ending in \n\\f0 \\cf4 .conf\n\\f2 \\cf2  in the \n\\f0 \\cf4 /etc/security/pwquality.conf.d/\n\\f2 \\cf2  directory\\\nand/or the file \n\\f0 \\cf4 /etc/security/pwquality.conf\n\\f2 \\cf2  and comment out or remove any\\\ninstance of \n\\f0 \\cf4 dictcheck = 0\n\\f2 \\cf2 :\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # sed -ri 's/^\\\\s*dictcheck\\\\s*=/# &/' /etc/security/pwquality.conf\\\n/etc/security/pwquality.conf.d/*.conf\\\n\n\\f2\\fs24 Run the following script to remove setting \n\\f0 \\cf4 dictcheck\n\\f2 \\cf2  on the \n\\f0 \\cf4 pam_pwquality.so\\\n\n\\f2 \\cf2 module in the PAM files:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nfor l_pam_file in system-auth password-auth; do\\\nl_authselect_file=\"/etc/authselect/$(head -1\\\n/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file\"\\\nsed -ri\\\n's/(^",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: IA-5\n\\fs20\\fsmilli10080 Page 729\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/security/pwquality.conf\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.3.2.6 | Level1"
    },
    {
      "id": "5.3.3.2.7",
      "title": "Ensure password quality is enforced for the root user\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 If the \n\\f0 \\cf4 pwquality\n\\f2 \\cf2  \n\\f0 \\cf4 enforce_for_root\n\\f2 \\cf2  option is enabled, the module will return error on\\\nfailed check even if the user changing the password is root.\\\nThis option is off by default which means that just the message about the failed check is\\\nprinted but root can change the password anyway.\\\n\n\\f1\\b Note:\n\\f2\\b0  The root is not asked for an old password so the checks that compare the old and\\\nnew password are not performed.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Use of a complex password helps to increase the time and resources required to\\\ncompromise the password. Password complexity, or strength, is a measure of the\\\neffectiveness of a password in resisting attempts at guessing and brute-force attacks.\\\nPassword complexity is one factor of several that determines how long it takes to crack\\\na password. The more complex the password, the greater the number of possible\\\ncombinations that need to be tested before the password is compromised.\\\n\n",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that the \n\\f0 \\cf4 enforce_for_root\n\\f2 \\cf2  option is enabled in a\\\npwquality configuration file:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Psi --\\\n'^\\\\h*enforce_for_root\\\\b' /etc/security/pwquality.conf\\\n/etc/security/pwquality.conf.d/*.conf\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 /etc/security/pwquality.conf.d/50-pwroot.conf:enforce_for_root\n\\f2 Page 731\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 Notes:\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  ",
      "remediation": "\\\n\n\\f2\\b0 Edit or add the following line in a \n\\f0 \\cf4 *.conf\n\\f2 \\cf2  file in \n\\f0 \\cf4 /etc/security/pwquality.conf.d\n\\f2 \\cf2  or\\\nin \n\\f0 \\cf4 /etc/security/pwquality.conf\n\\f2 \\cf2 :\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # printf '%s\\\\n' \"\" \"enforce_for_root\" >> /etc/security/pwquality.conf.d/50-\\\npwroot.conf\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: IA-5\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/security/pwquality.conf\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.3.2.7 | Level1"
    },
    {
      "id": "5.3.3.3.1",
      "title": "Ensure password history remember is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/security/opasswd\n\\f2 \\cf2  file stores the users' old passwords and can be checked\\\nto ensure that users are not recycling recent passwords. The number of passwords\\\nremembered is set via the remember argument value in set for the \n\\f0 \\cf4 pam_pwhistory\\\n\n\\f2 \\cf2 module.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 remember=<N> - \n\\f0 \\cf4 <N>\n\\f2 \\cf2  is the number of old passwords to remember\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Requiring users not to reuse their passwords make it less likely that an attacker will be\\\nable to guess the password or use a compromised password.\\\n\n\\f1\\b Note:\n\\f2\\b0  These change only apply to accounts configured on the local system.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command and verify that the remember option is set to \n\\f0 \\cf4 24\n\\f2 \\cf2  or more\\\nand meets local site policy in \n\\f0 \\cf4 /etc/security/pwhistory.conf\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Pi --\\\n'^\\\\h*remember\\\\h*=\\\\h*(2[4-9]|[3-9][0-9]|[1-9][0-9]\\{2,\\})\\\\b'\\\n/etc/security/pwhistory.conf\\\nremember = 24\\\n\n\\f2\\fs24 Run the following command to verify that the remember option is not set to less than \n\\f0 \\cf4 24\\\n\n\\f2 \\cf2 on the \n\\f0 \\cf4 pam_pwhistory.so\n\\f2",
      "remediation": "\\\n\n\\f2\\b0 Edit or add the following line in \n\\f0 \\cf4 /etc/security/pwhistory.conf\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 remember = 24\\\n\n\\f2\\fs24 Run the following script to remove the \n\\f0 \\cf4 remember\n\\f2 \\cf2  argument from the \n\\f0 \\cf4 pam_pwhistory.so\\\n\n\\f2 \\cf2 module in \n\\f0 \\cf4 /etc/pam.d/system-auth\n\\f2 \\cf2  and \n\\f0 \\cf4 /etc/pam.d/password-auth\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nfor l_pam_file in system-auth password-auth; do\\\nl_authselect_file=\"/etc/authselect/$(head -1\\\n/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file\"\\\nsed -ri\\\n's/(^\\\\s*password\\\\s+(requisite|required|sufficient)\\\\s+pam_pwhistory\\\\.so.*)(\\\\s+\\\nremember\\\\s*=\\\\s*\\\\S+)(.*$)/\\\\1\\\\4/' \"$l_authselect_file\"\\\ndone\\\nauthselect apply-changes\\\n\\}\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: IA-5(1)\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/security/pwhistory.conf",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.3.3.1 | Level1"
    },
    {
      "id": "5.3.3.3.2",
      "title": "Ensure password history is enforced for the root user\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 If the \n\\f0 \\cf4 pwhistory\n\\f2 \\cf2  \n\\f0 \\cf4 enforce_for_root\n\\f2 \\cf2  option is enabled, the module will enforce\\\npassword history for the root user as well\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Requiring users not to reuse their passwords make it less likely that an attacker will be\\\nable to guess the password or use a compromised password\\\n\n\\f1\\b Note:\n\\f2\\b0  These change only apply to accounts configured on the local system.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that the \n\\f0 \\cf4 enforce_for_root\n\\f2 \\cf2  option is enabled in\\\n\n\\f0 \\cf4 /etc/security/pwhistory.conf\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Pi --\\\n'^\\\\h*enforce_for_root\\\\b' /etc/security/pwhistory.conf\\\nenforce_for_root\\\n\n\\f1\\b\\fs24 Notes:\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Settings observe an order of precedence.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Module arguments override the settings in the \n\\f0 \\cf4 /etc/security/pwhisto",
      "remediation": "\\\n\n\\f2\\b0 Edit or add the following line in \n\\f0 \\cf4 /etc/security/pwhistory.conf\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 enforce_for_root\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: IA-5\n\\fs20\\fsmilli10080 Page 737\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/security/pwhistory.conf",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.3.3.2 | Level1"
    },
    {
      "id": "5.3.3.3.3",
      "title": "Ensure pam_pwhistory includes use_authtok\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f0\\b0 \\cf4 use_authtok\n\\f2 \\cf2  - When password changing enforce the module to set the new password\\\nto the one provided by a previously stacked password module\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f0\\b0 \\cf4 use_authtok\n\\f2 \\cf2  allows multiple pam modules to confirm a new password before it is\\\naccepted.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that \n\\f0 \\cf4 use_authtok\n\\f2 \\cf2  is set on the\\\n\n\\f0 \\cf4 pam_pwhistory.so\n\\f2 \\cf2  module lines in the password stack:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -P --\\\n'^\\\\h*password\\\\h+([^#\\\\n\\\\r]+)\\\\h+pam_pwhistory\\\\.so\\\\h+([^#\\\\n\\\\r]+\\\\h+)?use_authtok\\\\\\\nb' /etc/pam.d/\\{password,system\\}-auth\\\n\n\\f2\\fs24 Output should be similar to:\\\n\n\\f4\\fs20\\fsmilli10080 /etc/pam.d/password-auth:password required pam_pwhistory.so use_authtok\\\n/etc/pam.d/system-auth:pa",
      "remediation": "\\\n\n\\f2\\b0 Run the following script to verify the active authselect profile includes \n\\f0 \\cf4 use_authtok\n\\f2 \\cf2  on\\\nthe password stack's \n\\f0 \\cf4 pam_pwhistory.so\n\\f2 \\cf2  module lines:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_pam_profile=\"$(head -1 /etc/authselect/authselect.conf)\"\\\nif grep -Pq -- '^custom\\\\/' <<< \"$l_pam_profile\"; then\\\nl_pam_profile_path=\"/etc/authselect/$l_pam_profile\"\\\nelse\\\nl_pam_profile_path=\"/usr/share/authselect/",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: IA-5\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/pam.d/\\{password,system\\}-auth\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.3.3.3 | Level1"
    },
    {
      "id": "5.3.3.4.1",
      "title": "Ensure pam_unix does not include nullok",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 nullok\n\\f2 \\cf2  argument overrides the default action of \n\\f0 \\cf4 pam_unix.so\n\\f2 \\cf2  to not permit the\\\nuser access to a service if their official password is blank.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Using a strong password is essential to helping protect personal and sensitive\\\ninformation from unauthorized access\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that the \n\\f0 \\cf4 nullok\n\\f2 \\cf2  argument is not set on the\\\n\n\\f0 \\cf4 pam_unix.so\n\\f2 \\cf2  module:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -P --\\\n'^\\\\h*(auth|account|password|session)\\\\h+(requisite|required|sufficient)\\\\h+pam_\\\nunix\\\\.so\\\\b' /etc/pam.d/\\{password,system\\}-auth\\\n\n\\f2\\fs24 Verify that none of the returned lines includes \n\\f0 \\cf4 nullok\n\\f2 \\cf2 . Output should be similar to:\\\n\n\\f4\\fs20\\fsmilli10080 /etc/pam.d/password-auth:auth sufficient",
      "remediation": "\\\n\n\\f2\\b0 Run the following script to verify that the active authselect profile's \n\\f0 \\cf4 system-auth\n\\f2 \\cf2  and\\\n\n\\f0 \\cf4 password-auth\n\\f2 \\cf2  files include \n\\f0 \\cf4 \\{if not \"without-nullok\":nullok\\}\n\\f2 \\cf2  \n\\f1\\b - OR -\n\\f2\\b0  don't\\\ninclude the \n\\f0 \\cf4 nullok\n\\f2 \\cf2  option on the \n\\f0 \\cf4 pam_unix.so\n\\f2 \\cf2  module:\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\nl_module_name=\"unix\"\\\nl_profile_name=\"$(head -1 /etc/authselect/authselect.conf)\"\\\nif [[ ! \"$l_profile_name\" =~ ^custom\\\\/ ]]; then\\\nprintf '%s\\\\n' \" - Follow Recommendation \\\\\"Ensure pam_unix module is\\\nenabled\\\\\"\" \\\\\\\n\" and then return to this Recommendation\"\\\nelse\\\ngrep -P --\\\n\"\\\\bpam_$l_module_name\\\\.so\\\\b\"\\\n/etc/authselect/$l_profile_name/\\{password,system\\}-auth\\\nfi\\\n\\}\\\n\n\\f3\\i\\fs24 Example output with a custom profile",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: CM-6 b\\\n2. NIST SP 800-53A :: CM-6.1 (iv)\\\n3. RHEL 8 STIG GROUP ID: V-244540\\\n4. RHEL 8 STIG RULE ID: SV-244540r743869\\\n5. RHEL 8 STIG GROUP ID: V-244541\\\n6. RHEL 8 STIG RULE ID: SV-244541r743872\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/pam.d/\\{password,system\\}-auth\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.3.4.1 | Level1"
    },
    {
      "id": "5.3.3.4.2",
      "title": "Ensure pam_unix does not include remember\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 remember=n\n\\f2 \\cf2  argument saves the last n passwords for each user in\\\n\n\\f0 \\cf4 /etc/security/opasswd\n\\f2 \\cf2  in order to force password change history and keep the user\\\nfrom alternating between the same password too frequently. The MD5 password hash\\\nalgorithm is used for storing the old passwords. Instead of this option the\\\n\n\\f0 \\cf4 pam_pwhistory\n\\f2 \\cf2  module should be used. The \n\\f0 \\cf4 pam_pwhistory\n\\f2 \\cf2  module saves the last n\\\npasswords for each ",
      "rationale": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 remember=n\n\\f2 \\cf2  argument should be removed to ensure a strong password hashing\\\nalgorithm is being used. A stronger hash provides additional protection to the system by\\\nincreasing the level of effort needed for an attacker to successfully determine local\\\nuser's old passwords stored in \n\\f0 \\cf4 /etc/security/opasswd\n\\f2 \\cf2 .\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that the \n\\f0 \\cf4 remember\n\\f2 \\cf2  argument is not set on the\\\n\n\\f0 \\cf4 pam_unix.so\n\\f2 \\cf2  module:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Pi '^\\\\h*password\\\\h+([^#\\\\n\\\\r]+\\\\h+)?pam_unix\\\\.so\\\\b'\\\n/etc/pam.d/\\{password,system\\}-auth | grep -Pv '\\\\bremember=\\\\d\\\\b'\\\n\n\\f2\\fs24 Output should be similar to:\\\n\n\\f4\\fs20\\fsmilli10080 /etc/pam.d/password-auth:password sufficient pam_unix.so sha512 shadow\\\nuse_authtok\\\n/etc/pam.d/system-auth:password sufficien",
      "remediation": "\\\n\n\\f2\\b0 Run the following script to verify the active authselect profile doesn't include the\\\n\n\\f0 \\cf4 remember\n\\f2 \\cf2  argument on the \n\\f0 \\cf4 pam_unix.so\n\\f2 \\cf2  module lines:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_pam_profile=\"$(head -1 /etc/authselect/authselect.conf)\"\\\nif grep -Pq -- '^custom\\\\/' <<< \"$l_pam_profile\"; then\\\nl_pam_profile_path=\"/etc/authselect/$l_pam_profile\"\\\nelse\\\nl_pam_profile_path=\"/usr/share/authselect/",
      "references": "",
      "type": "FileContent",
      "file_path": "/etc/pam.d/\\{password,system\\}-auth",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.3.4.2 | Level1"
    },
    {
      "id": "5.3.3.4.4",
      "title": "Ensure pam_unix includes use_authtok",
      "automated": true,
      "profile": "Level1",
      "section": "5.3",
      "description": "\\\n\n\\f0\\b0 \\cf4 use_authtok\n\\f2 \\cf2  - When password changing enforce the module to set the new password\\\nto the one provided by a previously stacked password module\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f0\\b0 \\cf4 use_authtok\n\\f2 \\cf2  allows multiple pam modules to confirm a new password before it is\\\naccepted.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that \n\\f0 \\cf4 use_authtok\n\\f2 \\cf2  is set on the \n\\f0 \\cf4 pam_unix.so\\\n\n\\f2 \\cf2 module lines in the password stack:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -P --\\\n'^\\\\h*password\\\\h+([^#\\\\n\\\\r]+)\\\\h+pam_unix\\\\.so\\\\h+([^#\\\\n\\\\r]+\\\\h+)?use_authtok\\\\b'\\\n/etc/pam.d/\\{password,system\\}-auth\\\n\n\\f2\\fs24 Output should be similar to:\\\n\n\\f4\\fs20\\fsmilli10080 /etc/pam.d/password-auth:password sufficient pam_unix.so sha512 shadow\\\nuse_authtok\\\n/etc/pam.d/system-auth:p",
      "remediation": "\\\n\n\\f2\\b0 Run the following script to verify the active authselect profile includes \n\\f0 \\cf4 use_authtok\n\\f2 \\cf2  on\\\nthe password stack's \n\\f0 \\cf4 pam_unix.so\n\\f2 \\cf2  module lines:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_pam_profile=\"$(head -1 /etc/authselect/authselect.conf)\"\\\nif grep -Pq -- '^custom\\\\/' <<< \"$l_pam_profile\"; then\\\nl_pam_profile_path=\"/etc/authselect/$l_pam_profile\"\\\nelse\\\nl_pam_profile_path=\"/usr/share/authselect/",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: IA-5\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/pam.d/\\{password,system\\}-auth\\",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.3.4.4 | Level1"
    },
    {
      "id": "5.3.4",
      "title": "Ensure password hashing algorithm is SHA-512",
      "section": "5.3 PAM",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.3.4",
      "description": "SHA-512 provides strong password hashing",
      "remediation": "Verify pam_unix.so uses sha512 in /etc/pam.d/password-auth"
    }
  ]
}