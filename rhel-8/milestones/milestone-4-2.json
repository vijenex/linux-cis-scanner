{
  "milestone": "4-2",
  "section": "4.2 Configure Logging",
  "description": "Configure rsyslog and journald",
  "controls": [
    {
      "id": "4.2.1.1",
      "title": "Ensure rsyslog is installed",
      "section": "4.2 Logging",
      "type": "PackageInstalled",
      "profile": "Level1",
      "package_name": "rsyslog",
      "expected_status": "installed",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 4.2.1.1",
      "description": "rsyslog is the default syslog daemon on RHEL 8",
      "remediation": "Run: dnf install rsyslog"
    },
    {
      "id": "4.2.1.2",
      "title": "Ensure rsyslog service is enabled and active",
      "section": "4.2 Logging",
      "type": "ServiceStatus",
      "profile": "Level1",
      "service_name": "rsyslog",
      "expected_status": "enabled",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 4.2.1.2",
      "description": "Enable rsyslog service to collect system logs",
      "remediation": "Run: systemctl --now enable rsyslog"
    },
    {
      "id": "4.2.1.3",
      "title": "Ensure journald is configured to send logs to rsyslog",
      "section": "4.2 Logging",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 4.2.1.3",
      "description": "Data from journald may be stored in volatile memory or persisted locally",
      "remediation": "Edit /etc/systemd/journald.conf and set ForwardToSyslog=yes"
    },
    {
      "id": "4.2.1.4",
      "title": "Ensure rsyslog default file permissions are configured",
      "section": "4.2 Logging",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 4.2.1.4",
      "description": "rsyslog will create logfiles that do not already exist on the system",
      "remediation": "Edit /etc/rsyslog.conf and set $FileCreateMode 0640"
    },
    {
      "id": "4.2.1.5",
      "title": "Ensure logging is configured",
      "section": "4.2 Logging",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 4.2.1.5",
      "description": "The /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files specify rules for logging",
      "remediation": "Review and configure rsyslog rules per site policy"
    },
    {
      "id": "4.2.1.6",
      "title": "Ensure rsyslog is not configured to receive logs from a remote client",
      "section": "4.2 Logging",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 4.2.1.6",
      "description": "Unless the server is designated as a log server, do not accept remote logs",
      "remediation": "Remove or comment out $ModLoad imtcp and $InputTCPServerRun in rsyslog.conf"
    }
  ]
}
