{
  "milestone": "5.7",
  "title": "User and Group Settings",
  "controls": [
    {
      "title": "Ensure password expiration is 365 days or less",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The PASS_MAX_DAYS parameter in /etc/login.defs allows an administrator to force passwords to expire once they reach a defined age.",
      "rationale": "The window of opportunity for an attacker to leverage compromised credentials or successfully compromise credentials via an online brute force attack is limited by the age of the password. Therefore, reducing the maximum age of a password also reduces an attacker's window of opportunity.",
      "audit": "Run the following command and verify PASS_MAX_DAYS conforms to site policy (no more than 365 days):\n# grep PASS_MAX_DAYS /etc/login.defs\nPASS_MAX_DAYS 365\nVerify all users with a password have their maximum days between password change set to 365 or less:\n# awk -F: '($2~/^\\$.+\\$/) {if($5 > 365 || $5 < 1)print \"User \" $1 \" PASS_MAX_DAYS is \" $5}' /etc/shadow",
      "remediation": "Set the PASS_MAX_DAYS parameter to conform to site policy in /etc/login.defs:\nPASS_MAX_DAYS 365\nModify user parameters for all users with a password set to match:\n# chage --maxdays 365 <user>",
      "impact": "None",
      "default_value": "99999",
      "references": "1. See the login.defs(5) and chage(1) man pages for more information.",
      "cis_controls": "v8: 5.2 Use Unique Passwords\nv7: 4.4 Use Unique Passwords",
      "check_type": "Manual",
      "check_value": "",
      "id": "5.7.1"
    },
    {
      "title": "Ensure minimum days between password changes is configured",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The PASS_MIN_DAYS parameter in /etc/login.defs allows an administrator to prevent users from changing their password until a minimum number of days have passed since the last time the user changed their password.",
      "rationale": "By restricting the frequency of password changes, an administrator can prevent users from repeatedly changing their password in an attempt to circumvent password reuse controls.",
      "audit": "Run the following command and verify PASS_MIN_DAYS conforms to site policy (no less than 1 day):\n# grep PASS_MIN_DAYS /etc/login.defs\nPASS_MIN_DAYS 1\nVerify all users with a password have their minimum days between password change set to 1 or more:\n# awk -F: '($2~/^\\$.+\\$/) {if($4 < 1)print \"User \" $1 \" PASS_MIN_DAYS is \" $4}' /etc/shadow",
      "remediation": "Set the PASS_MIN_DAYS parameter to 1 in /etc/login.defs:\nPASS_MIN_DAYS 1\nModify user parameters for all users with a password set to match:\n# chage --mindays 1 <user>",
      "impact": "None",
      "default_value": "0",
      "references": "1. See the login.defs(5) and chage(1) man pages for more information.",
      "cis_controls": "v8: 5.2 Use Unique Passwords\nv7: 4.4 Use Unique Passwords",
      "check_type": "Manual",
      "check_value": "",
      "id": "5.7.2"
    },
    {
      "title": "Ensure password expiration warning days is 7 or more",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The PASS_WARN_AGE parameter in /etc/login.defs allows an administrator to notify users that their password will expire in a defined number of days.",
      "rationale": "Providing an advance warning that a password will be expiring gives users time to think of a secure password. Users caught unaware may choose a simple password or write it down where it may be discovered.",
      "audit": "Run the following command and verify PASS_WARN_AGE conforms to site policy (no less than 7 days):\n# grep PASS_WARN_AGE /etc/login.defs\nPASS_WARN_AGE 7\nVerify all users with a password have their warning days set to 7 or more:\n# awk -F: '($2~/^\\$.+\\$/) {if($6 < 7)print \"User \" $1 \" PASS_WARN_AGE is \" $6}' /etc/shadow",
      "remediation": "Set the PASS_WARN_AGE parameter to 7 in /etc/login.defs:\nPASS_WARN_AGE 7\nModify user parameters for all users with a password set to match:\n# chage --warndays 7 <user>",
      "impact": "None",
      "default_value": "7",
      "references": "1. See the login.defs(5) and chage(1) man pages for more information.",
      "cis_controls": "v8: 5.2 Use Unique Passwords\nv7: 4.4 Use Unique Passwords",
      "check_type": "Manual",
      "check_value": "",
      "id": "5.7.3"
    },
    {
      "title": "Ensure inactive password lock is 30 days or less",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "User accounts that have been inactive for over a given period of time can be automatically disabled.",
      "rationale": "Inactive accounts pose a threat to system security since the users are not logging in to notice failed login attempts or other anomalies.",
      "audit": "Run the following command and verify INACTIVE conforms to site policy (no more than 30 days):\n# useradd -D | grep INACTIVE\nINACTIVE=30\nVerify all users with a password have their inactive days set to 30 or less:\n# awk -F: '($2~/^\\$.+\\$/) {if($7 > 30 || $7 < 1)print \"User \" $1 \" INACTIVE is \" $7}' /etc/shadow",
      "remediation": "Run the following command to set the default password inactivity period to 30 days:\n# useradd -D -f 30\nModify user parameters for all users with a password set to match:\n# chage --inactive 30 <user>",
      "impact": "None",
      "default_value": "-1",
      "references": "1. See the useradd(8) and chage(1) man pages for more information.",
      "cis_controls": "v8: 5.3 Disable Dormant Accounts\nv7: 16.9 Disable Dormant Accounts",
      "check_type": "Manual",
      "check_value": "",
      "id": "5.7.4"
    },
    {
      "title": "Ensure all users last password change date is in the past",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "All users should have a password change date in the past.",
      "rationale": "If a user has a password change date in the future, they may be able to bypass password expiration policies.",
      "audit": "Run the following command and verify nothing is returned:\n# awk -F: '/^[^:]+:[^!*]/{print $1}' /etc/shadow | while read -r usr; do change=$(chage --list \"$usr\" | grep '^Last password change' | cut -d: -f2 | grep -v 'never$' | grep -v 'password must be changed$'); if [[ \"$change\" > \"$(date)\" ]]; then echo \"User: $usr last password change was: $change\"; fi; done",
      "remediation": "Investigate any users with a password change date in the future and correct them. Locking the account, expiring the password, or resetting the password may be appropriate.",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the chage(1) man page for more information.",
      "cis_controls": "v8: 5.2 Use Unique Passwords\nv7: 4.4 Use Unique Passwords",
      "check_type": "Manual",
      "check_value": "",
      "id": "5.7.5"
    }
  ]
}