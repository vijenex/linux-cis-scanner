{
  "milestone": "2.4",
  "version": "1.0.0",
  "description": "RHEL 8 CIS Benchmark v4.0.0 - Section 2.4",
  "controls": [
    {
      "id": "2.4.1.1",
      "title": "Ensure cron daemon is enabled and active",
      "automated": true,
      "profile": "Level1",
      "section": "2.4",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 cron\n\\f2 \\cf2  daemon is used to execute batch jobs on the system.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 While there may not be user jobs that need to be run on the system, the system does\\\nhave maintenance jobs that may include security monitoring that have to run, and \n\\f0 \\cf4 cron\\\n\n\\f2 \\cf2 is used to execute them.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following command to verify \n\\f0 \\cf4 cron\n\\f2 \\cf2  is enabled:\\\n\n\\f4\\fs20\\fsmilli10080 # systemctl list-unit-files | awk '$1~/^crond?\\\\.service/\\{print $2\\}'\\\nenabled\\\n\n\\f2\\fs24 Run the following command to verify that \n\\f0 \\cf4 cron\n\\f2 \\cf2  is active:\\\n\n\\f4\\fs20\\fsmilli10080 # systemctl list-units | awk '$1~/^crond?\\\\.service/\\{print $3\\}'\\\nactive\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following commands to unmask, enable, and start \n\\f0 \\cf4 cron\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # systemctl unmask \"$(systemctl list-unit-files | awk\\\n'$1~/^crond?\\\\.service/\\{print $1\\}')\"\\\n# systemctl --now enable \"$(systemctl list-unit-files | awk\\\n'$1~/^crond?\\\\.service/\\{print $1\\}')\"\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\n\\fs20\\fsmilli10080 Page 380\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.1 | Level1"
    },
    {
      "id": "2.4.1.2",
      "title": "Ensure access to /etc/crontab is configured",
      "automated": true,
      "profile": "Level1",
      "section": "2.4",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/crontab\n\\f2 \\cf2  file is used by \n\\f0 \\cf4 cron\n\\f2 \\cf2  to control its own jobs. The commands in this\\\nitem make sure that root is the user and group owner of the file and that only the owner\\\ncan access the file.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 This file contains information on what system jobs are run by cron. Write access to\\\nthese files could provide unprivileged users with the ability to elevate their privileges.\\\nRead access to these files could provide users with the ability to gain insight on system\\\njobs that run on the system and could provide them a way to gain unauthorized\\\nprivileged access.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following command and verify \n\\f0 \\cf4 Uid\n\\f2 \\cf2  and \n\\f0 \\cf4 Gid\n\\f2 \\cf2  are both \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and \n\\f0 \\cf4 Access\n\\f2 \\cf2  does\\\nnot grant permissions to \n\\f0 \\cf4 group\n\\f2 \\cf2  or \n\\f0 \\cf4 other\n\\f2 \\cf2  :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/crontab\\\nAccess: (600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following commands to set ownership and permissions on \n\\f0 \\cf4 /etc/crontab\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # chown root:root /etc/crontab\\\n# chmod og-rwx /etc/crontab\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 382\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.2 | Level1"
    },
    {
      "id": "2.4.1.3",
      "title": "Ensure access to /etc/cron.hourly is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "2.4",
      "description": "\\\n\n\\f2\\b0 This directory contains system \n\\f0 \\cf4 cron\n\\f2 \\cf2  jobs that need to run on an hourly basis. The files\\\nin this directory cannot be manipulated by the \n\\f0 \\cf4 crontab\n\\f2 \\cf2  command, but are instead\\\nedited by system administrators using a text editor. The commands below restrict\\\nread/write and search access to user and group root, preventing regular users from\\\naccessing this directory.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Granting write access to this directory for non-privileged users could provide them the\\\nmeans for gaining unauthorized elevated privileges. Granting read access to this\\\ndirectory could give an unprivileged user insight in how to gain elevated privileges or\\\ncircumvent",
      "impact": "None",
      "audit_command": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following command and verify \n\\f0 \\cf4 Uid\n\\f2 \\cf2  and \n\\f0 \\cf4 Gid\n\\f2 \\cf2  are both \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and \n\\f0 \\cf4 Access\n\\f2 \\cf2  does\\\nnot grant permissions to \n\\f0 \\cf4 group\n\\f2 \\cf2  or \n\\f0 \\cf4 other\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.hourly/\\\nAccess: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following commands to set ownership and permissions on the\\\n\n\\f0 \\cf4 /etc/cron.hourly\n\\f2 \\cf2  directory:\\\n\n\\f4\\fs20\\fsmilli10080 # chown root:root /etc/cron.hourly/\\\n# chmod og-rwx /etc/cron.hourly/\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3. MP-2\\\n\n\\f1\\b",
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.3 | Level1"
    },
    {
      "id": "2.4.1.4",
      "title": "Ensure access to /etc/cron.daily is configured",
      "automated": true,
      "profile": "Level1",
      "section": "2.4",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/cron.daily\n\\f2 \\cf2  directory contains system cron jobs that need to run on a daily\\\nbasis. The files in this directory cannot be manipulated by the \n\\f0 \\cf4 crontab\n\\f2 \\cf2  command, but\\\nare instead edited by system administrators using a text editor. The commands below\\\nrestrict read/write and search access to user and group root, preventing regular users\\\nfrom accessing this directory.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Granting write access to this directory for non-privileged users could provide them the\\\nmeans for gaining unauthorized elevated privileges. Granting read access to this\\\ndirectory could give an unprivileged user insight in how to gain elevated privileges or\\\ncircumvent",
      "impact": "None",
      "audit_command": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following command and verify \n\\f0 \\cf4 Uid\n\\f2 \\cf2  and \n\\f0 \\cf4 Gid\n\\f2 \\cf2  are both \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and \n\\f0 \\cf4 Access\n\\f2 \\cf2  does\\\nnot grant permissions to \n\\f0 \\cf4 group\n\\f2 \\cf2  or \n\\f0 \\cf4 other\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.daily/\\\nAccess: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following commands to set ownership and permissions on the\\\n\n\\f0 \\cf4 /etc/cron.daily\n\\f2 \\cf2  directory:\\\n\n\\f4\\fs20\\fsmilli10080 # chown root:root /etc/cron.daily/\\\n# chmod og-rwx /etc/cron.daily/\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3. MP-2\n\\fs20\\fsmilli10080 Page 386\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.4 | Level1"
    },
    {
      "id": "2.4.1.5",
      "title": "Ensure access to /etc/cron.weekly is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "2.4",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/cron.weekly\n\\f2 \\cf2  directory contains system cron jobs that need to run on a\\\nweekly basis. The files in this directory cannot be manipulated by the \n\\f0 \\cf4 crontab\\\n\n\\f2 \\cf2 command but are instead edited by system administrators using a text editor. The\\\ncommands below restrict read/write and search access to user and group root,\\\npreventing regular users from accessing this directory.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Granting write access to this directory for non-privileged users could provide them the\\\nmeans for gaining unauthorized elevated privileges. Granting read access to this\\\ndirectory could give an unprivileged user insight in how to gain elevated privileges or\\\ncircumvent",
      "impact": "None",
      "audit_command": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following command and verify \n\\f0 \\cf4 Uid\n\\f2 \\cf2  and \n\\f0 \\cf4 Gid\n\\f2 \\cf2  are both \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and \n\\f0 \\cf4 Access\n\\f2 \\cf2  does\\\nnot grant permissions to \n\\f0 \\cf4 group\n\\f2 \\cf2  or \n\\f0 \\cf4 other\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.weekly/\\\nAccess: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following commands to set ownership and permissions on the\\\n\n\\f0 \\cf4 /etc/cron.weekly\n\\f2 \\cf2  directory:\\\n\n\\f4\\fs20\\fsmilli10080 # chown root:root /etc/cron.weekly/\\\n# chmod og-rwx /etc/cron.weekly/\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3. MP-2\\\n\n\\f1\\b",
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.5 | Level1"
    },
    {
      "id": "2.4.1.6",
      "title": "Ensure access to /etc/cron.monthly is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "2.4",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/cron.monthly\n\\f2 \\cf2  directory contains system cron jobs that need to run on a\\\nmonthly basis. The files in this directory cannot be manipulated by the \n\\f0 \\cf4 crontab\\\n\n\\f2 \\cf2 command but are instead edited by system administrators using a text editor. The\\\ncommands below restrict read/write and search access to user and group root,\\\npreventing regular users from accessing this directory.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Granting write access to this directory for non-privileged users could provide them the\\\nmeans for gaining unauthorized elevated privileges. Granting read access to this\\\ndirectory could give an unprivileged user insight in how to gain elevated privileges or\\\ncircumvent",
      "impact": "None",
      "audit_command": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following command and verify \n\\f0 \\cf4 Uid\n\\f2 \\cf2  and \n\\f0 \\cf4 Gid\n\\f2 \\cf2  are both \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and \n\\f0 \\cf4 Access\n\\f2 \\cf2  does\\\nnot grant permissions to \n\\f0 \\cf4 group\n\\f2 \\cf2  or \n\\f0 \\cf4 other\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.monthly/\\\nAccess: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following commands to set ownership and permissions on the\\\n\n\\f0 \\cf4 /etc/cron.monthly\n\\f2 \\cf2  directory:\\\n\n\\f4\\fs20\\fsmilli10080 # chown root:root /etc/cron.monthly/\\\n# chmod og-rwx /etc/cron.monthly/\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3. MP-2\\\n\n\\f1\\b",
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.6 | Level1"
    },
    {
      "id": "2.4.1.7",
      "title": "Ensure access to /etc/cron.yearly is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "2.4",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/cron.yearly\n\\f2 \\cf2  directory contains system cron jobs that need to run on an\\\nannual basis. The files in this directory cannot be manipulated by the crontab command\\\nbut are instead edited by system administrators using a text editor. The commands\\\nbelow restrict read/write and search access to user and group root, preventing regular\\\nusers from accessing this directory.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Granting write access to this directory for non-privileged users could provide them the\\\nmeans for gaining unauthorized elevated privileges. Granting read access to this\\\ndirectory could give an unprivileged user insight in how to gain elevated privileges or\\\ncircumvent",
      "impact": "None",
      "audit_command": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following command and verify \n\\f0 \\cf4 Uid\n\\f2 \\cf2  and \n\\f0 \\cf4 Gid\n\\f2 \\cf2  are both \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and \n\\f0 \\cf4 Access\n\\f2 \\cf2  does\\\nnot grant permissions to \n\\f0 \\cf4 group\n\\f2 \\cf2  or \n\\f0 \\cf4 other\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.yearly/\\\nAccess: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following commands to set ownership and permissions on the\\\n\n\\f0 \\cf4 /etc/cron.yearly\n\\f2 \\cf2  directory:\\\n\n\\f4\\fs20\\fsmilli10080 # chown root:root /etc/cron.yearly/\\\n# chmod og-rwx /etc/cron.yearly/\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3. MP-2\n\\fs20\\fsmilli10080 Page 393\\\n\n\\f0 Internal Only - General\\\n\n\\f3\\i\\fs32\\fsmilli16080 \\cf3",
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.7 | Level1"
    },
    {
      "id": "2.4.1.8",
      "title": "Ensure access to /etc/cron.d is configured",
      "automated": true,
      "profile": "Level1",
      "section": "2.4",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/cron.d\n\\f2 \\cf2  directory contains system \n\\f0 \\cf4 cron\n\\f2 \\cf2  jobs that need to run in a similar\\\nmanner to the hourly, daily weekly and monthly jobs from \n\\f0 \\cf4 /etc/crontab\n\\f2 \\cf2 , but require\\\nmore granular control as to when they run. The files in this directory cannot be\\\nmanipulated by the \n\\f0 \\cf4 crontab\n\\f2 \\cf2  command but are instead edited by system administrators\\\nusing a text editor. The commands below restrict read/write and search access",
      "rationale": "\\\n\n\\f2\\b0 Granting write access to this directory for non-privileged users could provide them the\\\nmeans for gaining unauthorized elevated privileges. Granting read access to this\\\ndirectory could give an unprivileged user insight in how to gain elevated privileges or\\\ncircumvent",
      "impact": "None",
      "audit_command": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following command and verify \n\\f0 \\cf4 Uid\n\\f2 \\cf2  and \n\\f0 \\cf4 Gid\n\\f2 \\cf2  are both \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and \n\\f0 \\cf4 Access\n\\f2 \\cf2  does\\\nnot grant permissions to \n\\f0 \\cf4 group\n\\f2 \\cf2  or \n\\f0 \\cf4 other\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.d/\\\nAccess: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following commands to set ownership and permissions on the \n\\f0 \\cf4 /etc/cron.d\\\n\n\\f2 \\cf2 directory:\\\n\n\\f4\\fs20\\fsmilli10080 # chown root:root /etc/cron.d/\\\n# chmod og-rwx /etc/cron.d/\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3. MP-2\n\\fs20\\fsmilli10080 Page 394\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FilePermissions",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.8 | Level1"
    },
    {
      "id": "2.4.1.9",
      "title": "Ensure access to crontab is configured",
      "automated": true,
      "profile": "Level1",
      "section": "2.4",
      "description": "\\\n\n\\f0\\b0 \\cf4 crontab\n\\f2 \\cf2  is the program used to install, deinstall, or list the tables used to drive the cron\\\ndaemon. Each user can have their own crontab, and though files are created, they are\\\nnot intended to be edited directly.\\\nIf the \n\\f0 \\cf4 /etc/cron.allow\n\\f2 \\cf2  file exists, then you must be listed (one user per line) therein in\\\norder to be allowed to use this command. If the \n\\f0 \\cf4 /etc/cron.allow\n\\f2 \\cf2  file does not exist but\\\nthe \n\\f0 \\cf4 /etc/cron.deny\n\\f2 \\cf2",
      "rationale": "\\\n\n\\f2\\b0 On many systems, only the system administrator is authorized to schedule \n\\f0 \\cf4 cron\n\\f2 \\cf2  jobs.\\\nUsing the \n\\f0 \\cf4 cron.allow\n\\f2 \\cf2  file to control who can run \n\\f0 \\cf4 cron\n\\f2 \\cf2  jobs enforces this policy. It is\\\neasier to manage an allow list than a deny list. In a deny list, you could potentially add a\\\nuser ID to the system and forget to add it to the deny files.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following command to verify \n\\f0 \\cf4 /etc/cron.allow\n\\f2 \\cf2 :\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Exists\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Is mode \n\\f0 \\cf4 0640\n\\f2 \\cf2  or more restrictive\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Is owned by the user \n\\f0 \\cf4 root\\\n\n\\fs20\\fsmilli10080 \\cf2 \\'95\n\\f2  \n\\fs24 Is group owned by the group \n\\f0 \\cf4 root\n\\f2 \\cf2  \n\\f1\\b - OR -\n\\f2\\b0  the group \n\\f0 \\cf4 crontab\\\n\n\\f4\\fs20\\",
      "remediation": "\\\n- IF -\n\\f2\\b0  cron is installed on the system:\\\nRun the following script to:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Create \n\\f0 \\cf4 /etc/cron.allow\n\\f2 \\cf2  if it doesn't exist\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Change owner to user \n\\f0 \\cf4 root\\\n\n\\fs20\\fsmilli10080 \\cf2 \\'95\n\\f2  \n\\fs24 Change group owner to group \n\\f0 \\cf4 root\n\\f2 \\cf2  \n\\f1\\b - OR -\n\\f2\\b0  group \n\\f0 \\cf4 crontab\n\\f2 \\cf2  if it exists\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Change mode to \n\\f0 \\cf4 640\n\\f2 \\cf2  or more restrictive\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\n[ ! -e \"/etc/cron.allow\" ] && touch /etc/cron.allow\\\nchmod u-x,g-wx,o-rwx /etc/cron.allow\\\nif grep -Pq --\\\n'^\\\\h*crontab\\\\:' /etc/group; then\\\nchown root:crontab /etc/cron.allow\\\nelse\\\nchown root:root /etc/cron.allow\\\nfi\\\n\\}\\",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3. MP-2\n\\fs20\\fsmilli10080 Page 398\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/cron.allow",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.9 | Level1"
    },
    {
      "id": "2.4.2.1",
      "title": "Ensure access to at is configured",
      "automated": true,
      "profile": "Level1",
      "section": "2.4",
      "description": "\\\n\n\\f0\\b0 \\cf4 at\n\\f2 \\cf2  allows fairly complex time specifications, extending the POSIX.2 standard. It accepts\\\ntimes of the form HH:MM to run a job at a specific time of day. (If that time is already\\\npast, the next day is assumed.) You may also specify midnight, noon, or teatime (4pm)\\\nand you can have a time-of-day suffixed with AM or PM for running in the morning or\\\nthe evening. You can also say what day the job will be run, by giving a date in the form\\\nmonth-name day with an optional y",
      "rationale": "\\\n\n\\f2\\b0 On many systems, only the system administrator is authorized to schedule \n\\f0 \\cf4 at\n\\f2 \\cf2  jobs.\\\nUsing the \n\\f0 \\cf4 at.allow\n\\f2 \\cf2  file to control who can run \n\\f0 \\cf4 at\n\\f2 \\cf2  jobs enforces this policy. It is easier\\\nto manage an allow list than a deny list. In a deny list, you could potentially add a user\\\nID to the system and forget to add it to the deny files.\n\\fs20\\fsmilli10080 Page 401\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n- IF -\n\\f2\\b0  at is installed on the system:\\\nRun the following command to verify \n\\f0 \\cf4 /etc/at.allow\n\\f2 \\cf2 :\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Exists\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Is mode \n\\f0 \\cf4 0640\n\\f2 \\cf2  or more restrictive\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Is owned by the user \n\\f0 \\cf4 root\\\n\n\\fs20\\fsmilli10080 \\cf2 \\'95\n\\f2  \n\\fs24 Is group owned by the group \n\\f0 \\cf4 daemon\n\\f2 \\cf2  or group \n\\f0 \\cf4 root\\\n\n\\f4\\fs20\\fsmilli10080 \\cf2 # stat -Lc",
      "remediation": "\\\n- IF -\n\\f2\\b0  at is installed on the system:\\\nRun the following script to:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 /etc/at.allow\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 Create the file if it doesn't exist\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 Change owner or user \n\\f0 \\cf4 root\\\n\n\\f4\\fs20\\fsmilli10080 \\cf2 o\n\\f2  \n\\fs24 If group \n\\f0 \\cf4 daemon\n\\f2 \\cf2  exists, change to group \n\\f0 \\cf4 daemon\n\\f2 \\cf2 , else change group to\\\n\n\\f0 \\cf4 root\\\n\n\\f4\\fs20\\fsmilli10080 \\cf2 o\n\\f2  \n\\fs24 Change mode to \n\\f0 \\cf4 640\n\\f2 \\cf2  or more restrictive\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f1\\b\\fs24 - IF -\n\\f2\\b0  \n\\f0 \\cf4 /etc/at.deny\n\\f2 \\cf2  exists:\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 Change owner or user \n\\f0 \\cf4 root\\\n\n\\f4\\fs20\\fsmilli10080 \\cf2 o\n\\f2  \n\\fs24 If group \n\\",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3. MP-2\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/at.allow",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.2.1 | Level1"
    }
  ]
}