{
  "milestone": "6-1",
  "section": "6.1 System File Permissions",
  "description": "Ensure system files have correct permissions",
  "controls": [
    {
      "id": "6.1.1",
      "title": "Ensure permissions on /etc/passwd are configured",
      "section": "6.1 System File Permissions",
      "type": "FilePermissions",
      "profile": "Level1",
      "file_path": "/etc/passwd",
      "expected_permissions": "0644",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.1",
      "description": "The /etc/passwd file contains user account information",
      "remediation": "Run: chmod 644 /etc/passwd && chown root:root /etc/passwd"
    },
    {
      "id": "6.1.2",
      "title": "Ensure permissions on /etc/passwd- are configured",
      "section": "6.1 System File Permissions",
      "type": "FilePermissions",
      "profile": "Level1",
      "file_path": "/etc/passwd-",
      "expected_permissions": "0644",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.2",
      "description": "The /etc/passwd- file is a backup of /etc/passwd",
      "remediation": "Run: chmod 644 /etc/passwd- && chown root:root /etc/passwd-"
    },
    {
      "id": "6.1.3",
      "title": "Ensure permissions on /etc/group are configured",
      "section": "6.1 System File Permissions",
      "type": "FilePermissions",
      "profile": "Level1",
      "file_path": "/etc/group",
      "expected_permissions": "0644",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.3",
      "description": "The /etc/group file contains group information",
      "remediation": "Run: chmod 644 /etc/group && chown root:root /etc/group"
    },
    {
      "id": "6.1.4",
      "title": "Ensure permissions on /etc/group- are configured",
      "section": "6.1 System File Permissions",
      "type": "FilePermissions",
      "profile": "Level1",
      "file_path": "/etc/group-",
      "expected_permissions": "0644",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.4",
      "description": "The /etc/group- file is a backup of /etc/group",
      "remediation": "Run: chmod 644 /etc/group- && chown root:root /etc/group-"
    },
    {
      "id": "6.1.5",
      "title": "Ensure permissions on /etc/shadow are configured",
      "section": "6.1 System File Permissions",
      "type": "FilePermissions",
      "profile": "Level1",
      "file_path": "/etc/shadow",
      "expected_permissions": "0000",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.5",
      "description": "The /etc/shadow file contains encrypted password information",
      "remediation": "Run: chmod 0000 /etc/shadow && chown root:root /etc/shadow"
    },
    {
      "id": "6.1.6",
      "title": "Ensure permissions on /etc/shadow- are configured",
      "section": "6.1 System File Permissions",
      "type": "FilePermissions",
      "profile": "Level1",
      "file_path": "/etc/shadow-",
      "expected_permissions": "0000",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.6",
      "description": "The /etc/shadow- file is a backup of /etc/shadow",
      "remediation": "Run: chmod 0000 /etc/shadow- && chown root:root /etc/shadow-"
    },
    {
      "id": "6.1.7",
      "title": "Ensure permissions on /etc/gshadow are configured",
      "section": "6.1 System File Permissions",
      "type": "FilePermissions",
      "profile": "Level1",
      "file_path": "/etc/gshadow",
      "expected_permissions": "0000",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.7",
      "description": "The /etc/gshadow file contains encrypted group password information",
      "remediation": "Run: chmod 0000 /etc/gshadow && chown root:root /etc/gshadow"
    },
    {
      "id": "6.1.8",
      "title": "Ensure permissions on /etc/gshadow- are configured",
      "section": "6.1 System File Permissions",
      "type": "FilePermissions",
      "profile": "Level1",
      "file_path": "/etc/gshadow-",
      "expected_permissions": "0000",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.8",
      "description": "The /etc/gshadow- file is a backup of /etc/gshadow",
      "remediation": "Run: chmod 0000 /etc/gshadow- && chown root:root /etc/gshadow-"
    },
    {
      "id": "6.1.9",
      "title": "Ensure no world writable files exist",
      "section": "6.1 System File Permissions",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.9",
      "description": "World writable files can be modified by any user",
      "remediation": "Run: find / -xdev -type f -perm -0002 -exec chmod o-w {} \\;"
    },
    {
      "id": "6.1.10",
      "title": "Ensure no unowned files or directories exist",
      "section": "6.1 System File Permissions",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.10",
      "description": "Files not owned by a valid user can be modified by anyone",
      "remediation": "Run: find / -xdev -nouser -exec chown root {} \\;"
    },
    {
      "id": "6.1.11",
      "title": "Ensure no ungrouped files or directories exist",
      "section": "6.1 System File Permissions",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.11",
      "description": "Files not owned by a valid group can be modified by anyone in that group",
      "remediation": "Run: find / -xdev -nogroup -exec chgrp root {} \\;"
    },
    {
      "id": "6.1.12",
      "title": "Ensure sticky bit is set on all world-writable directories",
      "section": "6.1 System File Permissions",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.12",
      "description": "Setting the sticky bit prevents users from deleting files they don't own",
      "remediation": "Run: find / -xdev -type d -perm -0002 -exec chmod +t {} \\;"
    }
  ]
}