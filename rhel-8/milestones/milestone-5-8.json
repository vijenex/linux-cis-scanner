{
  "milestone": "5.8",
  "title": "Additional PAM Configuration",
  "controls": [
    {
      "control_id": "5.8.1",
      "title": "Ensure password creation requirements are configured",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The pam_pwquality.so module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters and digits.",
      "rationale": "Strong passwords protect systems from being hacked through brute force methods.",
      "audit": "Run the following command and verify that the output matches:\n# grep pam_pwquality.so /etc/pam.d/system-auth /etc/pam.d/password-auth\npassword requisite pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=",
      "remediation": "Edit the /etc/security/pwquality.conf file to set password requirements.",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the pam_pwquality(8) man page for more information.",
      "cis_controls": "v8: 5.2 Use Unique Passwords\nv7: 4.4 Use Unique Passwords",
      "check_type": "Manual",
      "check_value": ""
    },
    {
      "control_id": "5.8.2",
      "title": "Ensure lockout for failed password attempts is configured",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "Lock out users after n unsuccessful consecutive login attempts.",
      "rationale": "Locking out user IDs after n unsuccessful consecutive login attempts mitigates brute force password attacks.",
      "audit": "Run the following command and verify that the output matches:\n# grep pam_faillock.so /etc/pam.d/system-auth /etc/pam.d/password-auth",
      "remediation": "Edit the /etc/pam.d/system-auth and /etc/pam.d/password-auth files.",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the pam_faillock(8) man page for more information.",
      "cis_controls": "v8: 5.2 Use Unique Passwords\nv7: 4.4 Use Unique Passwords",
      "check_type": "Manual",
      "check_value": ""
    },
    {
      "control_id": "5.8.3",
      "title": "Ensure password reuse is limited",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The /etc/security/opasswd file stores the users' old passwords and can be checked to ensure that users are not recycling recent passwords.",
      "rationale": "Forcing users not to reuse their past 5 passwords make it less likely that an attacker will be able to guess the password.",
      "audit": "Run the following command and verify that the output matches:\n# grep -E '^password\\s+sufficient\\s+pam_unix.so' /etc/pam.d/system-auth /etc/pam.d/password-auth\npassword sufficient pam_unix.so remember=5",
      "remediation": "Edit the /etc/pam.d/system-auth and /etc/pam.d/password-auth files.",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the pam_unix(8) man page for more information.",
      "cis_controls": "v8: 5.2 Use Unique Passwords\nv7: 4.4 Use Unique Passwords",
      "check_type": "Manual",
      "check_value": ""
    },
    {
      "control_id": "5.8.4",
      "title": "Ensure password hashing algorithm is SHA-512",
      "level": 1,
      "scored": true,
      "profile_applicability": "Level 1 - Server, Level 1 - Workstation",
      "description": "The commands below change password encryption from md5 to sha512.",
      "rationale": "The SHA-512 algorithm provides much stronger hashing than MD5, thus providing additional protection to the system by increasing the level of effort for an attacker to successfully determine passwords.",
      "audit": "Run the following command and verify that the output matches:\n# grep -E '^password\\s+sufficient\\s+pam_unix.so' /etc/pam.d/system-auth /etc/pam.d/password-auth\npassword sufficient pam_unix.so sha512",
      "remediation": "Edit the /etc/pam.d/system-auth and /etc/pam.d/password-auth files.",
      "impact": "None",
      "default_value": "sha512",
      "references": "1. See the pam_unix(8) man page for more information.",
      "cis_controls": "v8: 3.11 Encrypt Sensitive Data at Rest\nv7: 14.4 Encrypt All Sensitive Information in Transit",
      "check_type": "Manual",
      "check_value": ""
    }
  ]
}
