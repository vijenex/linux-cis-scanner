{
  "milestone": "7.1",
  "version": "1.0.0",
  "description": "RHEL 8 CIS Benchmark v4.0.0 - Section 7.1",
  "controls": [
    {
      "id": "7.1.1",
      "title": "Ensure access to /etc/passwd is configured",
      "automated": true,
      "profile": "Level1",
      "section": "7.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2  file contains user account information that is used by many system\\\nutilities and therefore must be readable for these utilities to operate.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 It is critical to ensure that the \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2  file is protected from unauthorized write\\\naccess. Although it is protected by default, the file permissions could be changed either\\\ninadvertently or through malicious actions.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2  is mode 644 or more restrictive, \n\\f0 \\cf4 Uid\\\n\n\\f2 \\cf2 is \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and \n\\f0 \\cf4 Gid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%#a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/passwd\\\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following commands to remove excess permissions, set owner, and set group\\\non \n\\f0 \\cf4 /etc/passwd\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # chmod u-x,go-wx /etc/passwd\\\n# chown root:root /etc/passwd\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 1004\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/passwd",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.1.1 | Level1"
    },
    {
      "id": "7.1.2",
      "title": "Ensure access to /etc/passwd- is configured",
      "automated": true,
      "profile": "Level1",
      "section": "7.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/passwd-\n\\f2 \\cf2  file contains backup user account information.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 It is critical to ensure that the \n\\f0 \\cf4 /etc/passwd-\n\\f2 \\cf2  file is protected from unauthorized access.\\\nAlthough it is protected by default, the file permissions could be changed either\\\ninadvertently or through malicious actions.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify \n\\f0 \\cf4 /etc/passwd-\n\\f2 \\cf2  is mode 644 or more restrictive,\\\n\n\\f0 \\cf4 Uid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and \n\\f0 \\cf4 Gid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%#a/%A) Uid: ( %u/ %U) Gid: \\{ %g/ %G)' /etc/passwd-\\\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: \\{ 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following commands to remove excess permissions, set owner, and set group\\\non \n\\f0 \\cf4 /etc/passwd-\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # chmod u-x,go-wx /etc/passwd-\\\n# chown root:root /etc/passwd-\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 1006\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/passwd-",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.1.2 | Level1"
    },
    {
      "id": "7.1.3",
      "title": "Ensure access to /etc/group is configured",
      "automated": true,
      "profile": "Level1",
      "section": "7.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/group\n\\f2 \\cf2  file contains a list of all the valid groups defined in the system. The\\\ncommand below allows read/write access for root and read access for everyone else.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/group\n\\f2 \\cf2  file needs to be protected from unauthorized changes by non-\\\nprivileged users, but needs to be readable as this information is used with many non-\\\nprivileged programs.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify \n\\f0 \\cf4 /etc/group\n\\f2 \\cf2  is mode 644 or more restrictive, \n\\f0 \\cf4 Uid\\\n\n\\f2 \\cf2 is \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and \n\\f0 \\cf4 Gid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%#a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/group\\\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following commands to remove excess permissions, set owner, and set group\\\non \n\\f0 \\cf4 /etc/group\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # chmod u-x,go-wx /etc/group\\\n# chown root:root /etc/group\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 1008\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/group",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.1.3 | Level1"
    },
    {
      "id": "7.1.4",
      "title": "Ensure access to /etc/group- is configured",
      "automated": true,
      "profile": "Level1",
      "section": "7.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/group-\n\\f2 \\cf2  file contains a backup list of all the valid groups defined in the\\\nsystem.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 It is critical to ensure that the \n\\f0 \\cf4 /etc/group-\n\\f2 \\cf2  file is protected from unauthorized access.\\\nAlthough it is protected by default, the file permissions could be changed either\\\ninadvertently or through malicious actions.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify \n\\f0 \\cf4 /etc/group-\n\\f2 \\cf2  is mode 644 or more restrictive, \n\\f0 \\cf4 Uid\\\n\n\\f2 \\cf2 is \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and \n\\f0 \\cf4 Gid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%#a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/group-\\\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following commands to remove excess permissions, set owner, and set group\\\non \n\\f0 \\cf4 /etc/group-\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # chmod u-x,go-wx /etc/group-\\\n# chown root:root /etc/group-\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 1010\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/group-",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.1.4 | Level1"
    },
    {
      "id": "7.1.5",
      "title": "Ensure access to /etc/shadow is configured",
      "automated": true,
      "profile": "Level1",
      "section": "7.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/shadow\n\\f2 \\cf2  file is used to store the information about user accounts that is critical\\\nto the security of those accounts, such as the hashed password and other security\\\ninformation.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 If attackers can gain read access to the \n\\f0 \\cf4 /etc/shadow\n\\f2 \\cf2  file, they can easily run a\\\npassword cracking program against the hashed password to break it. Other security\\\ninformation that is stored in the \n\\f0 \\cf4 /etc/shadow\n\\f2 \\cf2  file (such as expiration) could also be\\\nuseful to subvert the user accounts.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify \n\\f0 \\cf4 /etc/shadow\n\\f2 \\cf2  is mode 000, \n\\f0 \\cf4 Uid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and \n\\f0 \\cf4 Gid\\\n\n\\f2 \\cf2 is \n\\f0 \\cf4 0/root\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%#a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/shadow\\\nAccess: (0/----------) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following commands to set mode, owner, and group on \n\\f0 \\cf4 /etc/shadow\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # chown root:root /etc/shadow\\\n# chmod 0000 /etc/shadow\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 1012\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/shadow",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.1.5 | Level1"
    },
    {
      "id": "7.1.6",
      "title": "Ensure access to /etc/shadow- is configured",
      "automated": true,
      "profile": "Level1",
      "section": "7.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/shadow-\n\\f2 \\cf2  file is used to store backup information about user accounts that is\\\ncritical to the security of those accounts, such as the hashed password and other\\\nsecurity information.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 It is critical to ensure that the \n\\f0 \\cf4 /etc/shadow-\n\\f2 \\cf2  file is protected from unauthorized access.\\\nAlthough it is protected by default, the file permissions could be changed either\\\ninadvertently or through malicious actions.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify \n\\f0 \\cf4 /etc/shadow-\n\\f2 \\cf2  is mode 000, \n\\f0 \\cf4 Uid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and\\\n\n\\f0 \\cf4 Gid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%#a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/shadow-\\\nAccess: (0/----------) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following commands to set mode, owner, and group on \n\\f0 \\cf4 /etc/shadow-\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # chown root:root /etc/shadow-\\\n# chmod 0000 /etc/shadow-\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 1014\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/shadow-",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.1.6 | Level1"
    },
    {
      "id": "7.1.7",
      "title": "Ensure access to /etc/gshadow is configured",
      "automated": true,
      "profile": "Level1",
      "section": "7.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/gshadow\n\\f2 \\cf2  file is used to store the information about groups that is critical to\\\nthe security of those accounts, such as the hashed password and other security\\\ninformation.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 If attackers can gain read access to the \n\\f0 \\cf4 /etc/gshadow\n\\f2 \\cf2  file, they can easily run a\\\npassword cracking program against the hashed password to break it. Other security\\\ninformation that is stored in the \n\\f0 \\cf4 /etc/gshadow\n\\f2 \\cf2  file (such as group administrators) could\\\nalso be useful to subvert the group.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify \n\\f0 \\cf4 /etc/gshadow\n\\f2 \\cf2  is mode 000, \n\\f0 \\cf4 Uid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and\\\n\n\\f0 \\cf4 Gid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%#a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/gshadow\\\nAccess: (0/----------) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following commands to set mode, owner, and group on \n\\f0 \\cf4 /etc/gshadow\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # chown root:root /etc/gshadow\\\n# chmod 0000 /etc/gshadow\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 1016\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/gshadow",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.1.7 | Level1"
    },
    {
      "id": "7.1.8",
      "title": "Ensure access to /etc/gshadow- is configured",
      "automated": true,
      "profile": "Level1",
      "section": "7.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 /etc/gshadow-\n\\f2 \\cf2  file is used to store backup information about groups that is critical\\\nto the security of those accounts, such as the hashed password and other security\\\ninformation.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 It is critical to ensure that the \n\\f0 \\cf4 /etc/gshadow-\n\\f2 \\cf2  file is protected from unauthorized\\\naccess. Although it is protected by default, the file permissions could be changed either\\\ninadvertently or through malicious actions.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify \n\\f0 \\cf4 /etc/gshadow-\n\\f2 \\cf2  is mode 000, \n\\f0 \\cf4 Uid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and\\\n\n\\f0 \\cf4 Gid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%#a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/gshadow-\\\nAccess: (0/----------) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following commands to set mode, owner, and group on \n\\f0 \\cf4 /etc/gshadow-\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # chown root:root /etc/gshadow-\\\n# chmod 0000 /etc/gshadow-\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 1018\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/gshadow-",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.1.8 | Level1"
    },
    {
      "id": "7.1.9",
      "title": "Ensure access to /etc/shells is configured",
      "automated": true,
      "profile": "Level1",
      "section": "7.1",
      "description": "\\\n\n\\f0\\b0 \\cf4 /etc/shells\n\\f2 \\cf2  is a text file which contains the full pathnames of valid login shells. This\\\nfile is consulted by \n\\f0 \\cf4 chsh\n\\f2 \\cf2  and available to be queried by other programs.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 It is critical to ensure that the \n\\f0 \\cf4 /etc/shells\n\\f2 \\cf2  file is protected from unauthorized access.\\\nAlthough it is protected by default, the file permissions could be changed either\\\ninadvertently or through malicious actions.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify \n\\f0 \\cf4 /etc/shells\n\\f2 \\cf2  is mode 644 or more restrictive, \n\\f0 \\cf4 Uid\\\n\n\\f2 \\cf2 is \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and \n\\f0 \\cf4 Gid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # stat -Lc 'Access: (%#a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/shells\\\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following commands to remove excess permissions, set owner, and set group\\\non \n\\f0 \\cf4 /etc/shells\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # chmod u-x,go-wx /etc/shells\\\n# chown root:root /etc/shells\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 1020\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/shells",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.1.9 | Level1"
    },
    {
      "id": "7.1.10",
      "title": "Ensure access to /etc/security/opasswd is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "7.1",
      "description": "\\\n\n\\f0\\b0 \\cf4 /etc/security/opasswd\n\\f2 \\cf2  and it's backup \n\\f0 \\cf4 /etc/security/opasswd.old\n\\f2 \\cf2  hold user's\\\nprevious passwords if \n\\f0 \\cf4 pam_unix\n\\f2 \\cf2  or \n\\f0 \\cf4 pam_pwhistory\n\\f2 \\cf2  is in use on the system\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 It is critical to ensure that \n\\f0 \\cf4 /etc/security/opasswd\n\\f2 \\cf2  is protected from unauthorized\\\naccess. Although it is protected by default, the file permissions could be changed either\\\ninadvertently or through malicious actions.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following commands to verify \n\\f0 \\cf4 /etc/security/opasswd\n\\f2 \\cf2  and\\\n\n\\f0 \\cf4 /etc/security/opasswd.old\n\\f2 \\cf2  are mode 600 or more restrictive, \n\\f0 \\cf4 Uid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2  and\\\n\n\\f0 \\cf4 Gid\n\\f2 \\cf2  is \n\\f0 \\cf4 0/root\n\\f2 \\cf2  if they exist:\\\n\n\\f4\\fs20\\fsmilli10080 # [ -e \"/etc/security/opasswd\" ] && stat -Lc '%n Access: (%#a/%A) Uid: (\\\n%u/ %U) Gid: ( %g/ %G)' /etc/security/opasswd\\\n/etc/security/opasswd Access: (0600/-rw-------) Uid: ",
      "remediation": "\\\n\n\\f2\\b0 Run the following commands to remove excess permissions, set owner, and set group\\\non \n\\f0 \\cf4 /etc/security/opasswd\n\\f2 \\cf2  and \n\\f0 \\cf4 /etc/security/opasswd.old\n\\f2 \\cf2  is they exist:\\\n\n\\f4\\fs20\\fsmilli10080 # [ -e \"/etc/security/opasswd\" ] && chmod u-x,go-rwx /etc/security/opasswd\\\n# [ -e \"/etc/security/opasswd\" ] && chown root:root /etc/security/opasswd\\\n# [ -e \"/etc/security/opasswd.old\" ] && chmod u-x,go-rwx\\\n/etc/security/opasswd.old\\\n# [ -e \"/etc/security/opasswd.old\" ] && chown root:root\\\n/etc/security/opasswd.old\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/security/opasswd",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.1.10 | Level1"
    },
    {
      "id": "7.1.11",
      "title": "Ensure world writable files and directories are secured\\",
      "automated": true,
      "profile": "Level1",
      "section": "7.1",
      "description": "\\\n\n\\f2\\b0 World writable files are the least secure. Data in world-writable files can be modified and\\\ncompromised by any user on the system. World writable files may also indicate an\\\nincorrectly written script or program that could potentially be the cause of a larger\\\ncompromise to the system's integrity. See the \n\\f0 \\cf4 chmod(2)\n\\f2 \\cf2  man page for more\\\ninformation.\\\nSetting the sticky bit on world writable directories prevents users from deleting or\\\nrenaming files in that directory t",
      "rationale": "\\\n\n\\f2\\b0 Data in world-writable files can be modified and compromised by any user on the\\\nsystem. World writable files may also indicate an incorrectly written script or program\\\nthat could potentially be the cause of a larger compromise to the system's integrity.\\\nThis feature prevents the ability to delete or rename files in world writable directories\\\n(such as \n\\f0 \\cf4 /tmp\n\\f2 \\cf2  ) that are owned by another user.\n\\fs20\\fsmilli10080 Page 1024\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 No world writable files exist\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 No world writable directories without the sticky bit exist\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\na_output=() a_output2=() a_file=() a_dir=()\\\nl_smask='01000' l_limit=\"50\"\\\na_path=(-path \"*/containers/storage/*\" -o -path \"*/containerd/*\" -o -path\\\n\"*/kubelet/*\" -o -path \"/sys/*\" -o -path \"/snap/*\" -o -path \"/boot/efi/*\")\\\nwhile IF",
      "remediation": "\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 World Writable Files:\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 It is recommended that write access is removed from \n\\f0 \\cf4 other\n\\f2 \\cf2  with the\\\ncommand ( \n\\f0 \\cf4 chmod o-w <filename>\n\\f2 \\cf2  ), but always consult relevant vendor\\\ndocumentation to avoid breaking any application dependencies on a given\\\nfile.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 World Writable Directories:\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 Set the sticky bit on all world writable directories with the command (\\\n\n\\f0 \\cf4 chmod a+t <directory_name>\n\\f2 \\cf2  )\\\nRun the following script to:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Remove other write permission from any world writable files\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Add the sticky bit to all world writa",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: SC-4\\\n2. NIST SP 800-53A :: SC-4.1\\\n3. RHEL 8 STIG Vul ID: V-230243\\\n4. RHEL 8 STIG Rule ID: SV-230243r792857\n\\fs20\\fsmilli10080 Page 1026\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "pattern": ".*",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.1.11 | Level1",
      "file_path": "/etc/login.defs"
    },
    {
      "id": "7.1.13",
      "title": "Ensure SUID and SGID files are reviewed",
      "automated": false,
      "profile": "Level1",
      "section": "7.1",
      "description": "\\\n\n\\f2\\b0 The owner of a file can set the file's permissions to run with the owner's or group's\\\npermissions, even if the user running the program is not the owner or a member of the\\\ngroup. The most common reason for a SUID or SGID program is to enable users to\\\nperform functions (such as changing their password) that require root privileges.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 There are valid reasons for SUID and SGID programs, but it is important to identify and\\\nreview such programs to ensure they are legitimate. Review the files returned by the\\\naction in the",
      "impact": "None",
      "audit_command": "section and check to see if system binaries have a different\\\nchecksum than what from the package. This is an indication that the binary may have\\\nbeen replaced.\n\\fs20\\fsmilli10080 Page 1031\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 Audit:\\\n\n\\f2\\b0 Run the following script to generate a list of SUID and SGID files:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_output=\"\" l_output2=\"\"\\\na_suid=(); a_sgid=() # initialize arrays\\\nwhile IFS= read -r l_mount; do\\\nwhile IFS= read -r -d $'\\\\0' l_fi",
      "remediation": "\\\n\n\\f2\\b0 Ensure that no rogue SUID or SGID programs have been introduced into the system.\\\nReview the files returned by the action in the Audit section and confirm the integrity of\\\nthese binaries.\n\\fs20\\fsmilli10080 Page 1032\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5, AC-3, MP-2\\\n\n\\f1\\b",
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 7.1.13 | Level1"
    }
  ]
}