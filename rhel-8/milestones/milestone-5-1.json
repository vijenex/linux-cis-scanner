{
  "milestone": "5-1",
  "section": "5.1 Configure SSH Server",
  "description": "Secure SSH daemon configuration",
  "controls": [
    {
      "id": "5.1.1",
      "title": "Ensure permissions on /etc/ssh/sshd_config are configured",
      "section": "5.1 SSH Server",
      "type": "FilePermissions",
      "profile": "Level1",
      "file_path": "/etc/ssh/sshd_config",
      "expected_permissions": "0600",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.1",
      "description": "The sshd_config file contains configuration specifications for sshd",
      "remediation": "Run: chown root:root /etc/ssh/sshd_config && chmod 0600 /etc/ssh/sshd_config"
    },
    {
      "id": "5.1.2",
      "title": "Ensure permissions on SSH private host key files are configured",
      "section": "5.1 SSH Server",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.2",
      "description": "SSH private keys should be protected from unauthorized access",
      "remediation": "Run: find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chmod u-x,go-rwx {} \\;"
    },
    {
      "id": "5.1.3",
      "title": "Ensure permissions on SSH public host key files are configured",
      "section": "5.1 SSH Server",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.3",
      "description": "SSH public keys should be world-readable",
      "remediation": "Run: find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chmod u-x,go-wx {} \\;"
    },
    {
      "id": "5.1.4",
      "title": "Ensure sshd access is configured",
      "section": "5.1 SSH Server",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.4",
      "description": "Configure AllowUsers, AllowGroups, DenyUsers, DenyGroups in sshd_config",
      "remediation": "Edit /etc/ssh/sshd_config and configure access restrictions"
    },
    {
      "id": "5.1.5",
      "title": "Ensure sshd Banner is configured",
      "section": "5.1 SSH Server",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.5",
      "description": "Banners are used to warn connecting users of the particular site's policy",
      "remediation": "Edit /etc/ssh/sshd_config and set Banner /etc/issue.net"
    },
    {
      "id": "5.1.6",
      "title": "Ensure sshd Ciphers are configured",
      "section": "5.1 SSH Server",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.6",
      "description": "Weak ciphers should not be used",
      "remediation": "Edit /etc/ssh/sshd_config and configure strong ciphers"
    },
    {
      "id": "5.1.7",
      "title": "Ensure sshd ClientAliveInterval and ClientAliveCountMax are configured",
      "section": "5.1 SSH Server",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.7",
      "description": "Idle SSH sessions should timeout after a period of inactivity",
      "remediation": "Edit /etc/ssh/sshd_config: ClientAliveInterval 300, ClientAliveCountMax 0"
    },
    {
      "id": "5.1.8",
      "title": "Ensure sshd DisableForwarding is enabled",
      "section": "5.1 SSH Server",
      "type": "Manual",
      "profile": "Level2",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.8",
      "description": "SSH port forwarding should be disabled unless required",
      "remediation": "Edit /etc/ssh/sshd_config and set DisableForwarding yes"
    },
    {
      "id": "5.1.9",
      "title": "Ensure sshd HostbasedAuthentication is disabled",
      "section": "5.1 SSH Server",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.9",
      "description": "Host-based authentication should be disabled",
      "remediation": "Edit /etc/ssh/sshd_config and set HostbasedAuthentication no"
    },
    {
      "id": "5.1.10",
      "title": "Ensure sshd IgnoreRhosts is enabled",
      "section": "5.1 SSH Server",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.10",
      "description": "SSH should ignore .rhosts files",
      "remediation": "Edit /etc/ssh/sshd_config and set IgnoreRhosts yes"
    },
    {
      "id": "5.1.11",
      "title": "Ensure sshd GSSAPIAuthentication is disabled\\",
      "automated": true,
      "profile": "Level2",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 GSSAPIAuthentication\n\\f2 \\cf2  parameter specifies whether user authentication based on\\\nGSSAPI is allowed\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Allowing GSSAPI authentication through SSH exposes the system's GSSAPI to remote\\\nhosts, and should be disabled to reduce the attack surface of the system\n\\fs20\\fsmilli10080 Page 622\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify \n\\f0 \\cf4 GSSAPIAuthentication\n\\f2 \\cf2  is set to \n\\f0 \\cf4 no\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | grep -i gssapiauthentication\\\n\\}\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 gssapiauthentication no\\\n\n\\f1\\b\\fs24 - IF -\n\\f2\\b0  \n\\f0 \\cf4 Match\n\\f2 \\cf2  set statements are used in your environmen",
      "remediation": "\\\n\n\\f2\\b0 Edit the \n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  file to set the \n\\f0 \\cf4 GSSAPIAuthentication\n\\f2 \\cf2  parameter to\\\n\n\\f0 \\cf4 no\n\\f2 \\cf2  above any \n\\f0 \\cf4 Include\n\\f2 \\cf2  and \n\\f0 \\cf4 Match\n\\f2 \\cf2  entries as follows:\\\n\n\\f4\\fs20\\fsmilli10080 GSSAPIAuthentication no\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  First occurrence of an option takes precedence, \n\\f0 \\cf4 Match\n\\f2 \\cf2  set statements\\\nwithstanding. If \n\\f0 \\cf4 Include\n\\f2 \\cf2  locations are enabled, used, and order of precedence is\\\nunderstood in your environment, the entry may be created in a file in \n\\f0 \\cf4 Include\n\\f2 \\cf2  location.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. SSHD_CONFIG(5)\\\n2. SSHD(8)\\\n3. NIST SP 800-53 :: CM-6 b\\\n4. NIST SP 800-53A :: CM-6.1 (iv)\\\n5. RHEL 8 STIG Vul ID: V-244528\\\n6. RHEL 8 STIG Rule ID: SV-244528r952106\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.11 | Level2"
    },
    {
      "id": "5.1.12",
      "title": "Ensure sshd HostbasedAuthentication is disabled\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 HostbasedAuthentication\n\\f2 \\cf2  parameter specifies if authentication is allowed\\\nthrough trusted hosts via the use of \n\\f0 \\cf4 .rhosts\n\\f2 \\cf2 , or \n\\f0 \\cf4 /etc/hosts.equiv\n\\f2 \\cf2 , along with\\\nsuccessful public key client host authentication.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Even though the \n\\f0 \\cf4 .rhosts\n\\f2 \\cf2  files are ineffective if support is disabled in \n\\f0 \\cf4 /etc/pam.conf\n\\f2 \\cf2 ,\\\ndisabling the ability to use \n\\f0 \\cf4 .rhosts\n\\f2 \\cf2  files in SSH provides an additional layer of\\\nprotection.\n\\fs20\\fsmilli10080 Page 625\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify \n\\f0 \\cf4 HostbasedAuthentication\n\\f2 \\cf2  is set to \n\\f0 \\cf4 no\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | grep -i hostbasedauthentication\\\n\\}\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 hostbasedauthentication no\\\n\n\\f1\\b\\fs24 - IF -\n\\f2\\b0  \n\\f0 \\cf4 Match\n\\f2 \\cf2  set statements are used in your e",
      "remediation": "\\\n\n\\f2\\b0 Edit the \n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  file to set the \n\\f0 \\cf4 HostbasedAuthentication\n\\f2 \\cf2  parameter\\\nto \n\\f0 \\cf4 no\n\\f2 \\cf2  above any \n\\f0 \\cf4 Include\n\\f2 \\cf2  and \n\\f0 \\cf4 Match\n\\f2 \\cf2  entries as follows:\\\n\n\\f4\\fs20\\fsmilli10080 HostbasedAuthentication no\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  First occurrence of an option takes precedence, \n\\f0 \\cf4 Match\n\\f2 \\cf2  set statements\\\nwithstanding. If \n\\f0 \\cf4 Include\n\\f2 \\cf2  locations are enabled, used, and order of precedence is\\\nunderstood in your environment, the entry may be created in a file in \n\\f0 \\cf4 Include\n\\f2 \\cf2  location.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. SSHD_CONFIG(5)\\\n2. SSHD(8)\\\n3. NIST SP 800-53 :: CM-6 b\\\n4. NIST SP 800-53A :: CM-6.1 (iv)\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.12 | Level1"
    },
    {
      "id": "5.1.13",
      "title": "Ensure sshd IgnoreRhosts is enabled",
      "automated": true,
      "profile": "Level1",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 IgnoreRhosts\n\\f2 \\cf2  parameter specifies that \n\\f0 \\cf4 .rhosts\n\\f2 \\cf2  and \n\\f0 \\cf4 .shosts\n\\f2 \\cf2  files will not be used\\\nin \n\\f0 \\cf4 RhostsRSAAuthentication\n\\f2 \\cf2  or \n\\f0 \\cf4 HostbasedAuthentication\n\\f2 \\cf2 .\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Setting this parameter forces users to enter a password when authenticating with SSH.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify \n\\f0 \\cf4 IgnoreRhosts\n\\f2 \\cf2  is set to \n\\f0 \\cf4 yes\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | grep -i ignorerhosts\\\n\\}\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 ignorerhosts yes\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Edit the \n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  file to set the \n\\f0 \\cf4 IgnoreRhosts\n\\f2 \\cf2  parameter to \n\\f0 \\cf4 yes\n\\f2 \\cf2  above\\\nany \n\\f0 \\cf4 Include\n\\f2 \\cf2  entry as follows:\\\n\n\\f4\\fs20\\fsmilli10080 IgnoreRhosts yes\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  First occurrence of an option takes precedence. If \n\\f0 \\cf4 Include\n\\f2 \\cf2  locations are enabled,\\\nused, and order of precedence is understood in your environment, the entry may be\\\ncreated in a file in \n\\f0 \\cf4 Include\n\\f2 \\cf2  location.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. SSHD_CONFIG(5)\\\n2. SSHD(8)\\\n3. NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5\n\\fs20\\fsmilli10080 Page 628\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.13 | Level1"
    },
    {
      "id": "5.1.14",
      "title": "Ensure sshd KexAlgorithms is configured",
      "automated": true,
      "profile": "Level1",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 Key exchange is a method in cryptography by which cryptographic keys are exchanged\\\nbetween two parties, allowing use of a cryptographic algorithm. If the sender and\\\nreceiver wish to exchange encrypted messages, each must be equipped to encrypt\\\nmessages to be sent and decrypt messages received\\\n\n\\f1\\b Note:\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Kex algorithms have a higher preference the earlier they appear in the list\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Some organizations",
      "rationale": "\\\n\n\\f2\\b0 Key exchange methods that are considered weak should be removed. A key exchange\\\nmethod may be weak because too few bits are used, or the hashing algorithm is\\\nconsidered too weak. Using weak algorithms could expose connections to man-in-the-\\\nmiddle attacks\n\\fs20\\fsmilli10080 Page 630\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify none of the \"weak\" Key Exchange algorithms are being\\\nused:\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | grep -Pi --\\\n'kexalgorithms\\\\h+([^#\\\\n\\\\r]+,)?(diffie-hellman-group1-sha1|diffie-hellman-\\\ngroup14-sha1|diffie-hellman-group-exchange-sha1)\\\\b'\\\n\\}\\\n\n\\f2\\fs24 Nothing should be returned\\\nThe following are considered \"weak\" K",
      "remediation": "\\\nNote:\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 First occurrence of an option takes precedence.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Though key_exchange may be configured through the \n\\f0 \\cf4 KexAlgorithms\n\\f2 \\cf2  option in\\\nthe \n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  file, it is recommended that the key_exchange\\\navailable to openSSH server are configured through system-wide-crypto-policy\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 If the recommendations in the subsection \"Configure system wide crypto policy\"\\\nhave been followed, this Audit should be in a passing state. Please review that\\\nsection before following this Remediation Procedure\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 By",
      "references": "\\\n\n\\f2\\b0 1. \\cf7 https://ubuntu.com/server/docs/openssh-crypto-configuration\\\n\\cf2 2. NIST SP 800-53 Rev. 5: SC-8\\\n3. SSHD(8)\\\n4. SSHD_CONFIG(5)\n\\fs20\\fsmilli10080 Page 632\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.14 | Level1"
    },
    {
      "id": "5.1.15",
      "title": "Ensure sshd LoginGraceTime is configured",
      "automated": true,
      "profile": "Level1",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 LoginGraceTime\n\\f2 \\cf2  parameter specifies the time allowed for successful\\\nauthentication to the SSH server. The longer the Grace period is the more open\\\nunauthenticated connections can exist. Like other session controls in this session the\\\nGrace Period should be limited to appropriate organizational limits to ensure the service\\\nis available for needed access.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Setting the \n\\f0 \\cf4 LoginGraceTime\n\\f2 \\cf2  parameter to a low number will minimize the risk of\\\nsuccessful brute force attacks to the SSH server. It will also limit the number of\\\nconcurrent unauthenticated connections While the recommended setting is 60 seconds\\\n(1 Minute), set the number based on site policy.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script and verify that output \n\\f0 \\cf4 LoginGraceTime\n\\f2 \\cf2  is between \n\\f0 \\cf4 1\n\\f2 \\cf2  and \n\\f0 \\cf4 60\\\n\n\\f2 \\cf2 seconds:\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | grep -i logingracetime\\\n\\}\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 logingracetime 60\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Edit the \n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  file to set the \n\\f0 \\cf4 LoginGraceTime\n\\f2 \\cf2  parameter to a value\\\nbetween \n\\f0 \\cf4 1\n\\f2 \\cf2  and \n\\f0 \\cf4 60\n\\f2 \\cf2  seconds above any \n\\f0 \\cf4 Include\n\\f2 \\cf2  entry as follows:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 LoginGraceTime 60\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  First occurrence of an option takes precedence. If Include locations are enabled,\\\nused, and order of precedence is understood in your environment, the entry may be\\\ncreated in a file in Include location.\n\\fs20\\fsmilli10080 Page 634\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. SSHD_CONFIG(5)\\\n2. NIST SP 800-53 Rev. 5: CM-6\\\n3. SSHD(8)\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.15 | Level1"
    },
    {
      "id": "5.1.16",
      "title": "Ensure sshd LogLevel is configured",
      "automated": true,
      "profile": "Level1",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 SSH provides several logging levels with varying amounts of verbosity. The \n\\f0 \\cf4 DEBUG\\\n\n\\f2 \\cf2 options are specifically not recommended other than strictly for debugging SSH\\\ncommunications. These levels provide so much data that it is difficult to identify\\\nimportant security information, and may violate the privacy of users.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 INFO\n\\f2 \\cf2  level is the basic level that only records login activity of SSH users. In many\\\nsituations, such as Incident Response, it is important to determine when a particular\\\nuser was active on a system. The logout record can eliminate those users who\\\ndisconnected, which helps narrow the field.\\\nThe \n\\f0 \\cf4 VERBOSE\n\\f2 \\cf2  level specifies that login and logout activity as well as the key fingerprint\\\nfor any SSH key used for login will be logged. This informa",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script and verify that output matches \n\\f0 \\cf4 loglevel VERBOSE\n\\f2 \\cf2  or \n\\f0 \\cf4 loglevel\\\nINFO\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | grep -i loglevel\\\n\\}\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 loglevel VERBOSE\\\n- OR -\\\nloglevel INFO\\\n\n\\f1\\b\\fs24 - IF -\n\\f2\\b0  \n\\f0 \\cf4 Match\n\\f2 \\cf2  set statements a",
      "remediation": "\\\n\n\\f2\\b0 Edit the \n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  file to set the \n\\f0 \\cf4 LogLevel\n\\f2 \\cf2  parameter to \n\\f0 \\cf4 VERBOSE\n\\f2 \\cf2  or\\\n\n\\f0 \\cf4 INFO\n\\f2 \\cf2  above any \n\\f0 \\cf4 Include\n\\f2 \\cf2  and \n\\f0 \\cf4 Match\n\\f2 \\cf2  entries as follows:\\\n\n\\f4\\fs20\\fsmilli10080 LogLevel VERBOSE\\\n- OR -\\\nLogLevel INFO\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  First occurrence of an option takes precedence, \n\\f0 \\cf4 Match\n\\f2 \\cf2  set statements\\\nwithstanding. If \n\\f0 \\cf4 Include\n\\f2 \\cf2  locations are enabled, used, and order of precedence is\\\nunderstood in your environment, the entry may be created in a file in \n\\f0 \\cf4 Include\n\\f2 \\cf2  location.\n\\fs20\\fsmilli10080 Page 637\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. \\cf7 https://www.ssh.com/ssh/sshd_config/\\\n\\cf2 2. NIST SP 800-53 Rev. 5: AU-3, AU-12, SI-5\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.16 | Level1"
    },
    {
      "id": "5.1.17",
      "title": "Ensure sshd MACs are configured",
      "automated": true,
      "profile": "Level1",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 This variable limits the types of MAC algorithms that SSH can use during\\\ncommunication.\\\n\n\\f1\\b Note:\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Some organizations may have stricter requirements for approved MACs.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Ensure that MACs used are in compliance with site policy.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 The only \"strong\" MACs currently FIPS 140 approved are:\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2  \n\\fs24 HMAC-SHA1\\\n\n\\f4\\fs20\\fsmilli10080 o\n\\f2 ",
      "rationale": "\\\n\n\\f2\\b0 MD5 and 96-bit MAC algorithms are considered weak and have been shown to increase\\\nexploitability in SSH downgrade attacks. Weak algorithms continue to have a great deal\\\nof attention as a weak spot that can be exploited with expanded computing power. An\\\nattacker that breaks the algorithm could take advantage of a MiTM position to decrypt\\\nthe SSH tunnel and capture credentials and information.\n\\fs20\\fsmilli10080 Page 639\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify none of the \"weak\" MACs are being used:\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | grep -Pi -- 'macs\\\\h+([^#\\\\n\\\\r]+,)?(hmac-\\\nmd5|hmac-md5-96|hmac-ripemd160|hmac-sha1-96|umac-64@openssh\\\\.com|hmac-md5-\\\netm@openssh\\\\.com|hmac-md5-96-etm@openssh\\\\.com|hmac-ripemd160-\\\netm@openssh\\\\.com|hmac-sha1-96-etm@openssh\\\\.com|umac-64-e",
      "remediation": "\\\nNote:\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 First occurrence of an option takes precedence.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Though MACs may be configured through the \n\\f0 \\cf4 MACs\n\\f2 \\cf2  option in the\\\n\n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  file, it is recommended that the MACs available to\\\nopenSSH server are configured through system-wide-crypto-policy\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 If the recommendations in the subsection \"Configure system wide crypto policy\"\\\nhave been followed, this Audit should be in a passing state. Please review that\\\nsection before following this Remediation Procedure\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 By",
      "references": "\\\n\n\\f2\\b0 1. \\cf7 https://nvd.nist.gov/vuln/detail/CVE-2023-48795\\\n\\cf2 2. More information on SSH downgrade attacks can be found here:\\\n\\cf7 http://www.mitls.org/pages/attacks/SLOTH\\\n\\cf2 3. SSHD_CONFIG(5)\\\n4. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.17 | Level1"
    },
    {
      "id": "5.1.18",
      "title": "Ensure sshd MaxAuthTries is configured",
      "automated": true,
      "profile": "Level1",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 MaxAuthTries\n\\f2 \\cf2  parameter specifies the maximum number of authentication\\\nattempts permitted per connection. When the login failure count reaches half the\\\nnumber, error messages will be written to the \n\\f0 \\cf4 syslog\n\\f2 \\cf2  file detailing the login failure.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Setting the \n\\f0 \\cf4 MaxAuthTries\n\\f2 \\cf2  parameter to a low number will minimize the risk of\\\nsuccessful brute force attacks to the SSH server. While the recommended setting is 4,\\\nset the number based on site policy.\n\\fs20\\fsmilli10080 Page 644\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script and verify that \n\\f0 \\cf4 MaxAuthTries\n\\f2 \\cf2  is \n\\f0 \\cf4 4\n\\f2 \\cf2  or less:\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | grep -i maxauthtries\\\n\\}\\\n\n\\f2\\fs24 Verify output includes \n\\f0 \\cf4 maxauthtries\n\\f2 \\cf2  is set to a value of \n\\f0 \\cf4 4\n\\f2 \\cf2  or less\\\n\n\\f3\\i Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 maxauthtries 4\\\n\n",
      "remediation": "\\\n\n\\f2\\b0 Edit the \n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  file to set the \n\\f0 \\cf4 MaxAuthTries\n\\f2 \\cf2  parameter to \n\\f0 \\cf4 4\n\\f2 \\cf2  or less\\\nabove any \n\\f0 \\cf4 Include\n\\f2 \\cf2  and \n\\f0 \\cf4 Match\n\\f2 \\cf2  entries as follows:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 MaxAuthTries 4\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  First occurrence of an option takes precedence, \n\\f0 \\cf4 Match\n\\f2 \\cf2  set statements\\\nwithstanding. If \n\\f0 \\cf4 Include\n\\f2 \\cf2  locations are enabled, used, and order of precedence is\\\nunderstood in your environment, the entry may be created in a file in \n\\f0 \\cf4 Include\n\\f2 \\cf2  location.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. SSHD_CONFIG(5)\\\n2. NIST SP 800-53 Rev. 5: AU-3\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.18 | Level1"
    },
    {
      "id": "5.1.19",
      "title": "Ensure sshd MaxSessions is configured",
      "automated": true,
      "profile": "Level1",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 MaxSessions\n\\f2 \\cf2  parameter specifies the maximum number of open sessions\\\npermitted from a given connection.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 To protect a system from denial of service due to a large number of concurrent\\\nsessions, use the rate limiting function of MaxSessions to protect availability of sshd\\\nlogins and prevent overwhelming the daemon.\n\\fs20\\fsmilli10080 Page 647\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script and verify that \n\\f0 \\cf4 MaxSessions\n\\f2 \\cf2  is \n\\f0 \\cf4 10\n\\f2 \\cf2  or less:\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | grep -i maxsessions\\\n\\}\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 maxsessions 10\\\n\n\\f1\\b\\fs24 - IF -\n\\f2\\b0  \n\\f0 \\cf4 Match\n\\f2 \\cf2  set statements are used in your environment, specify the conne",
      "remediation": "\\\n\n\\f2\\b0 Edit the \n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  file to set the \n\\f0 \\cf4 MaxSessions\n\\f2 \\cf2  parameter to \n\\f0 \\cf4 10\n\\f2 \\cf2  or less\\\nabove any \n\\f0 \\cf4 Include\n\\f2 \\cf2  and \n\\f0 \\cf4 Match\n\\f2 \\cf2  entries:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 MaxSessions 10\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  First occurrence of an option takes precedence, \n\\f0 \\cf4 Match\n\\f2 \\cf2  set statements\\\nwithstanding. If \n\\f0 \\cf4 Include\n\\f2 \\cf2  locations are enabled, used, and order of precedence is\\\nunderstood in your environment, the entry may be created in a file in \n\\f0 \\cf4 Include\n\\f2 \\cf2  location.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. SSHD_CONFIG(5)\\\n2. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.19 | Level1"
    },
    {
      "id": "5.1.20",
      "title": "Ensure sshd MaxStartups is configured",
      "automated": true,
      "profile": "Level1",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 MaxStartups\n\\f2 \\cf2  parameter specifies the maximum number of concurrent\\\nunauthenticated connections to the SSH daemon.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 To protect a system from denial of service due to a large number of pending\\\nauthentication connection attempts, use the rate limiting function of MaxStartups to\\\nprotect availability of sshd logins and prevent overwhelming the daemon.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify \n\\f0 \\cf4 MaxStartups\n\\f2 \\cf2  is \n\\f0 \\cf4 10:30:60\n\\f2 \\cf2  or more restrictive:\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | awk '$1 ~ /^\\\\s*maxstartups/\\{split($2,\\\na, \":\");\\{if(a[1] > 10 || a[2] > 30 || a[3] > 60) print $0\\}\\}'\\\n\\}\\\n\n\\f2\\fs24 Nothing should be returned\\\n\n\\f1\\b",
      "remediation": "\\\n\n\\f2\\b0 Edit the \n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  file to set the \n\\f0 \\cf4 MaxStartups\n\\f2 \\cf2  parameter to \n\\f0 \\cf4 10:30:60\n\\f2 \\cf2  or\\\nmore restrictive above any \n\\f0 \\cf4 Include\n\\f2 \\cf2  entries:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 MaxStartups 10:30:60\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  First occurrence of an option takes precedence. If Include locations are enabled,\\\nused, and order of precedence is understood in your environment, the entry may be\\\ncreated in a file in Include location.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. SSHD_CONFIG(5)\\\n2. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.20 | Level1"
    },
    {
      "id": "5.1.21",
      "title": "Ensure sshd PermitEmptyPasswords is disabled\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 PermitEmptyPasswords\n\\f2 \\cf2  parameter specifies if the SSH server allows login to\\\naccounts with empty password strings.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Disallowing remote shell access to accounts that have an empty password reduces the\\\nprobability of unauthorized access to the system.\n\\fs20\\fsmilli10080 Page 652\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify \n\\f0 \\cf4 PermitEmptyPasswords\n\\f2 \\cf2  is set to \n\\f0 \\cf4 no\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | grep -i permitemptypasswords\\\n\\}\\\n\n\\f3\\i\\fs24 Example output\\\n\n\\f4\\i0\\fs20\\fsmilli10080 permitemptypasswords no\\\n\n\\f1\\b\\fs24 - IF -\n\\f2\\b0  \n\\f0 \\cf4 Match\n\\f2 \\cf2  set statements are used in your environment",
      "remediation": "\\\n\n\\f2\\b0 Edit \n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  and set the \n\\f0 \\cf4 PermitEmptyPasswords\n\\f2 \\cf2  parameter to \n\\f0 \\cf4 no\\\n\n\\f2 \\cf2 above any \n\\f0 \\cf4 Include\n\\f2 \\cf2  and \n\\f0 \\cf4 Match\n\\f2 \\cf2  entries:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 PermitEmptyPasswords no\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  First occurrence of an option takes precedence, \n\\f0 \\cf4 Match\n\\f2 \\cf2  set statements\\\nwithstanding. If \n\\f0 \\cf4 Include\n\\f2 \\cf2  locations are enabled, used, and order of precedence is\\\nunderstood in your environment, the entry may be created in a file in \n\\f0 \\cf4 Include\n\\f2 \\cf2  location.\\\nThe SSH daemon must be restarted for the changes to take effect. To restart the SSH\\\ndaemon, run the following command:\\\n\n\\f4\\fs20\\fsmilli10080 # systemctl reload-or-restart sshd.se",
      "references": "\\\n\n\\f2\\b0 1. SSHD_CONFIG(5)\\\n2. NIST SP 800-53 Revision 5 :: CM-6 b\\\n3. NIST SP 800-53A :: CM-6.1 (iv)\\\n4. RHEL 8 STIG Vul ID: V-230380\\\n5. RHEL 8 STIG Rule ID: SV-230380r951612\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.21 | Level1"
    },
    {
      "id": "5.1.22",
      "title": "Ensure sshd PermitRootLogin is disabled",
      "automated": true,
      "profile": "Level1",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 PermitRootLogin\n\\f2 \\cf2  parameter specifies if the root user can log in using SSH. The\\\ndefault is \n\\f0 \\cf4 prohibit-password\n\\f2 \\cf2 .\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Disallowing \n\\f0 \\cf4 root\n\\f2 \\cf2  logins over SSH requires system admins to authenticate using their\\\nown individual account, then escalating to \n\\f0 \\cf4 root\n\\f2 \\cf2 . This limits opportunity for non-\\\nrepudiation and provides a clear",
      "impact": "None",
      "audit_command": "trail in the event of a security incident.\n\\fs20\\fsmilli10080 Page 655\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 Audit:\\\n\n\\f2\\b0 Run the following script to verify \n\\f0 \\cf4 PermitRootLogin\n\\f2 \\cf2  is set to \n\\f0 \\cf4 no\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | grep -i permitrootlogin\\\n\\}\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 permitroot",
      "remediation": "\\\n\n\\f2\\b0 Edit the \n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  file to set the \n\\f0 \\cf4 PermitRootLogin\n\\f2 \\cf2  parameter to \n\\f0 \\cf4 no\\\n\n\\f2 \\cf2 above any \n\\f0 \\cf4 Include\n\\f2 \\cf2  and \n\\f0 \\cf4 Match\n\\f2 \\cf2  entries:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 PermitRootLogin no\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  First occurrence of an option takes precedence, \n\\f0 \\cf4 Match\n\\f2 \\cf2  set statements\\\nwithstanding. If \n\\f0 \\cf4 Include\n\\f2 \\cf2  locations are enabled, used, and order of precedence is\\\nunderstood in your environment, the entry may be created in a file in \n\\f0 \\cf4 Include\n\\f2 \\cf2  location.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. SSHD_CONFIG(5)\\\n2. NIST SP 800-53 Rev. 5:AC-6\\\n3. NIST SP 800-53A :: IA-2 (5).2 (ii)\\\n4. RHEL 8 STIG Vul ID: V-230296\\\n5. RHEL 8 STIG Rule ID: SV-230296r951608\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.22 | Level1"
    },
    {
      "id": "5.1.23",
      "title": "Ensure sshd PermitUserEnvironment is disabled\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 PermitUserEnvironment\n\\f2 \\cf2  option allows users to present environment options to\\\nthe SSH daemon.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Permitting users the ability to set environment variables through the SSH daemon could\\\npotentially allow users to bypass security controls (e.g. setting an execution path that\\\nhas SSH executing trojan'd programs)\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify \n\\f0 \\cf4 PermitUserEnvironment\n\\f2 \\cf2  is set to \n\\f0 \\cf4 no\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | grep -i permituserenvironment\\\n\\}\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 permituserenvironment no\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Edit the \n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  file to set the \n\\f0 \\cf4 PermitUserEnvironment\n\\f2 \\cf2  parameter to\\\n\n\\f0 \\cf4 no\n\\f2 \\cf2  above any \n\\f0 \\cf4 Include\n\\f2 \\cf2  entries:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 PermitUserEnvironment no\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  First occurrence of an option takes precedence. If Include locations are enabled,\\\nused, and order of precedence is understood in your environment, the entry may be\\\ncreated in a file in Include location.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. SSHD_CONFIG(5)\\\n2. SSHD(8)\\\n3. NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5\\\n4. NIST SP 800-53A :: CM-6.1 (iv)\\\n5. RHEL 8 STIG Vul ID: V-230330\\\n6. RHEL 8 STIG Rule ID: SV-230330r951610\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.23 | Level1"
    },
    {
      "id": "5.1.24",
      "title": "Ensure sshd UsePAM is enabled",
      "automated": true,
      "profile": "Level1",
      "section": "5.1",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 UsePAM\n\\f2 \\cf2  directive enables the Pluggable Authentication Module (PAM) interface. If\\\nset to \n\\f0 \\cf4 yes\n\\f2 \\cf2  this will enable PAM authentication using\\\n\n\\f0 \\cf4 ChallengeResponseAuthentication\n\\f2 \\cf2  and \n\\f0 \\cf4 PasswordAuthentication\n\\f2 \\cf2  directives in\\\naddition to PAM account and session module processing for all authentication types.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 When \n\\f0 \\cf4 usePAM\n\\f2 \\cf2  is set to \n\\f0 \\cf4 yes\n\\f2 \\cf2 , PAM runs through account and session types properly. This\\\nis important if you want to restrict access to services based off of IP, time or other\\\nfactors of the account. Additionally, you can make sure users inherit certain\\\nenvironment variables on login or disallow access to the server\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify \n\\f0 \\cf4 UsePAM\n\\f2 \\cf2  is set to \n\\f0 \\cf4 yes\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 \\{\\\n#!/usr/bin/env bash\\\nsource /etc/crypto-policies/back-ends/opensshserver.config\\\nsource /etc/sysconfig/sshd\\\nsshd -T $OPTIONS $CRYPTO_POLICY | grep -i usepam\\\n\\}\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 usepam yes\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Edit the \n\\f0 \\cf4 /etc/ssh/sshd_config\n\\f2 \\cf2  file to set the \n\\f0 \\cf4 UsePAM\n\\f2 \\cf2  parameter to \n\\f0 \\cf4 yes\n\\f2 \\cf2  above any\\\n\n\\f0 \\cf4 Include\n\\f2 \\cf2  entries:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 UsePAM yes\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  First occurrence of an option takes precedence. If Include locations are enabled,\\\nused, and order of precedence is understood in your environment, the entry may be\\\ncreated in a file in Include location.\n\\fs20\\fsmilli10080 Page 660\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. SSHD_CONFIG(5)\\\n2. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\\\n3. SSHD(8)\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/back-ends/opensshserver.config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.1.24 | Level1"
    }
  ]
}