{
  "milestone": "5-4",
  "section": "5.4 User Accounts and Environment",
  "description": "Configure user account settings",
  "controls": [
    {
      "id": "5.4.1",
      "title": "Ensure password expiration is 365 days or less",
      "section": "5.4 User Accounts",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.1",
      "description": "Passwords should expire to force periodic changes",
      "remediation": "Set PASS_MAX_DAYS 365 in /etc/login.defs"
    },
    {
      "id": "5.4.1.1",
      "title": "Ensure password expiration is configured",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 PASS_MAX_DAYS\n\\f2 \\cf2  parameter in \n\\f0 \\cf4 /etc/login.defs\n\\f2 \\cf2  allows an administrator to force\\\npasswords to expire once they reach a defined age.\\\n\n\\f0 \\cf4 PASS_MAX_DAYS\n\\f2 \\cf2  \n\\f3\\i <N>\n\\f2\\i0  - The maximum number of days a password may be used. If the\\\npassword is older than this, a password change will be forced. If not specified, -1 will be\\\nassumed (which disables the restriction).\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 The window of opportunity for an attacker to leverage compromised credentials or\\\nsuccessfully compromise credentials via an online brute force attack is limited by the\\\nage of the password. Therefore, reducing the maximum age of a password also reduces\\\nan attacker's window of opportunity.\\\nWe recommend a yearly password change. This is primarily because for all their good\\\nintentions users will share credentials across accounts. Therefore, even if a breach is\\\npublicly identified, th",
      "impact": "\\\n\n\\f2\\b0 The password expiration must be greater than the minimum days between password\\\nchanges or users will be unable to change their password.\\\nExcessive password expiration requirements do more harm than good, because these\\\nrequirements make users select predictable passwords, composed of seq",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command and verify \n\\f0 \\cf4 PASS_MAX_DAYS\n\\f2 \\cf2  is set to 365 days or less and\\\nconforms to local site policy:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Pi --\\\n'^\\\\h*PASS_MAX_DAYS\\\\h+\\\\d+\\\\b' /etc/login.defs\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 PASS_MAX_DAYS 365\\\n\n\\f2\\fs24 Run the following command to verify all \n\\f0 \\cf4 /etc/shadow\n\\f2 \\cf2  passwords \n\\f0 \\cf4 PASS_MAX_DAYS\n\\f2 \\cf2 :\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 is greater than \n\\f0 \\cf4 ",
      "remediation": "\\\n\n\\f2\\b0 Set the \n\\f0 \\cf4 PASS_MAX_DAYS\n\\f2 \\cf2  parameter to conform to site policy in \n\\f0 \\cf4 /etc/login.defs\n\\f2 \\cf2  :\\\n\n\\f4\\fs20\\fsmilli10080 PASS_MAX_DAYS 365\\\n\n\\f2\\fs24 Modify user parameters for all users with a password set to match:\\\n\n\\f4\\fs20\\fsmilli10080 # chage --maxdays 365 <user>\\\n\n\\f2\\fs24 Edit \n\\f0 \\cf4 /etc/login.defs\n\\f2 \\cf2  and set \n\\f0 \\cf4 PASS_MAX_DAYS\n\\f2 \\cf2  to a value greater than \n\\f0 \\cf4 0\n\\f2 \\cf2  that follows\\\nlocal site policy:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 PASS_MAX_DAYS 365\\\n\n\\f2\\fs24 Run the following command to modify user parameters for all users with a password set\\\nto a maximum age no greater than \n\\f0 \\cf4 365\n\\f2 \\cf2  or less than \n\\f0 \\cf4 1\n\\f2 \\cf2  that follows local site policy:\\\n\n\\f4\\fs20\\fsmilli10080 # chage --maxdays",
      "references": "\\\n\n\\f2\\b0 1. CIS Password Policy Guide\\\n2. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/login.defs\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.1.1 | Level1"
    },
    {
      "id": "5.4.1.2",
      "title": "Ensure minimum password days is configured",
      "automated": false,
      "profile": "Level2",
      "section": "5.4",
      "description": "\\\n\n\\f0\\b0 \\cf4 PASS_MIN_DAYS\n\\f2 \\cf2  <\n\\f3\\i N\n\\f2\\i0 > - The minimum number of days allowed between password\\\nchanges. Any password changes attempted sooner than this will be rejected. If not\\\nspecified, 0 will be assumed (which disables the restriction).\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Users may have favorite passwords that they like to use because they are easy to\\\nremember and they believe that their password choice is secure from compromise.\\\nUnfortunately, passwords are compromised and if an attacker is targeting a specific\\\nindividual user account, with foreknowledge of data about that user, reuse of old,\\\npotentially compromised passwords, may cause a security breach.\\\nBy restricting the frequency of password changes, an administrator can prevent users\\\nfrom re",
      "impact": "\\\n\n\\f2\\b0 If a users password is set by other personnel as a procedure in dealing with a lost or\\\nexpired password, the user should be forced to update this \"set\" password with their\\\nown password. e.g. force \"change at next logon\".\\\nIf it is not possible to have a user set their own password immedi",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that \n\\f0 \\cf4 PASS_MIN_DAYS\n\\f2 \\cf2  is set to a value greater than\\\n\n\\f0 \\cf4 0\n\\f2 \\cf2  and follows local site policy:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Pi --\\\n'^\\\\h*PASS_MIN_DAYS\\\\h+\\\\d+\\\\b' /etc/login.defs\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 PASS_MIN_DAYS 1\\\n\n\\f2\\fs24 Run the following command to verify all passwords have a \n\\f0 \\cf4 PASS_MIN_DAYS\n\\f2 \\cf2  greater than\\\n\n\\f0 \\cf4 0\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # awk -F",
      "remediation": "\\\n\n\\f2\\b0 Edit \n\\f0 \\cf4 /etc/login.defs\n\\f2 \\cf2  and set \n\\f0 \\cf4 PASS_MIN_DAYS\n\\f2 \\cf2  to a value greater than \n\\f0 \\cf4 0\n\\f2 \\cf2  that follows\\\nlocal site policy:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 PASS_MIN_DAYS 1\\\n\n\\f2\\fs24 Run the following command to modify user parameters for all users with a password set\\\nto a minimum days greater than zero that follows local site policy:\\\n\n\\f4\\fs20\\fsmilli10080 # chage --mindays <N> <user>\\\n\n\\f3\\i\\fs24 Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # awk -F: '($2~/^\\\\$.+\\\\$/) \\{if($4 < 1)system (\"chage --mindays 1 \" $1)\\}'\\\n/etc/shadow\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. CIS Password Policy Guide\\\n2. NIST SP 800-53 :: IA-5 (1) (d)\\\n3. NIST SP 800-53A :: IA-5 (1).1 (v)\\\n4. STIG ID: RHEL-08-020180 | Rule ID: SV-230364r627750 | CAT II\\\n5. STIG ID: RHEL-08-020190 | Rule ID: SV-230365r858727 | CAT II\\\n6. STIG ID: UBTU-20-010007 | Rule ID: SV-238202r1015140 |",
      "type": "Manual",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.1.2 | Level2"
    },
    {
      "id": "5.4.1.3",
      "title": "Ensure password expiration warning days is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 PASS_WARN_AGE\n\\f2 \\cf2  parameter in \n\\f0 \\cf4 /etc/login.defs\n\\f2 \\cf2  allows an administrator to notify\\\nusers that their password will expire in a defined number of days.\\\n\n\\f0 \\cf4 PASS_WARN_AGE\n\\f2 \\cf2  \n\\f3\\i <N>\n\\f2\\i0  - The number of days warning given before a password expires. A\\\nzero means warning is given only upon the day of expiration, a negative value means\\\nno warning is given. If not specified, no warning will be provided.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Providing an advance warning that a password will be expiring gives users time to think\\\nof a secure password. Users caught unaware may choose a simple password or write it\\\ndown where it may be discovered.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command and verify \n\\f0 \\cf4 PASS_WARN_AGE\n\\f2 \\cf2  is \n\\f0 \\cf4 7\n\\f2 \\cf2  or more and follows local\\\nsite policy:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Pi --\\\n'^\\\\h*PASS_WARN_AGE\\\\h+\\\\d+\\\\b' /etc/login.defs\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 PASS_WARN_AGE 7\\\n\n\\f2\\fs24 Run the following command to verify all passwords have a \n\\f0 \\cf4 PASS_WARN_AGE\n\\f2 \\cf2  of \n\\f0 \\cf4 7\n\\f2 \\cf2  or\\\nmore:\\\n\n\\f4\\fs20\\fsmilli10080 # awk -F: '($2~/^\\\\$.+\\\\$/) \\{if($",
      "remediation": "\\\n\n\\f2\\b0 Edit \n\\f0 \\cf4 /etc/login.defs\n\\f2 \\cf2  and set \n\\f0 \\cf4 PASS_WARN_AGE\n\\f2 \\cf2  to a value of \n\\f0 \\cf4 7\n\\f2 \\cf2  or more that follows\\\nlocal site policy:\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 PASS_WARN_AGE 7\\\n\n\\f2\\fs24 Run the following command to modify user parameters for all users with a password set\\\nto a minimum warning to \n\\f0 \\cf4 7\n\\f2 \\cf2  or more days that follows local site policy:\\\n\n\\f4\\fs20\\fsmilli10080 # chage --warndays <N> <user>\\\n\n\\f3\\i\\fs24 Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # awk -F: '($2~/^\\\\$.+\\\\$/) \\{if($6 < 7)system (\"chage --warndays 7 \" $1)\\}'\\\n/etc/shadow\\\n\n\\f1\\b\\fs24",
      "references": "",
      "type": "FileContent",
      "file_path": "/etc/login.defs\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.1.3 | Level1"
    },
    {
      "id": "5.4.1.4",
      "title": "Ensure strong password hashing algorithm is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 A cryptographic hash function converts an arbitrary-length input into a fixed length\\\noutput. Password hashing performs a one-way transformation of a password, turning\\\nthe password into another string, called the hashed password.\\\n\n\\f0 \\cf4 ENCRYPT_METHOD\n\\f2 \\cf2  (string) - This defines the system default encryption algorithm for\\\nencrypting passwords (if no algorithm are specified on the command line). It can take\\\none of these values:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\c",
      "rationale": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 SHA-512\n\\f2 \\cf2  and \n\\f0 \\cf4 yescrypt\n\\f2 \\cf2  algorithms provide a stronger hash than other algorithms\\\nused by Linux for password hash generation. A stronger hash provides additional\\\nprotection to the system by increasing the level of effort needed for an attacker to\\\nsuccessfully determine local group passwords.\n\\fs20\\fsmilli10080 Page 767\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify the hashing algorithm is \n\\f0 \\cf4 sha512\n\\f2 \\cf2  or \n\\f0 \\cf4 yescrypt\n\\f2 \\cf2  in\\\n\n\\f0 \\cf4 /etc/login.defs\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Pi --\\\n'^\\\\h*ENCRYPT_METHOD\\\\h+(SHA512|YESCRYPT)\\\\b' /etc/login.defs\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 ENCRYPT_METHOD SHA512\\\n- OR -\\\nENCRYPT_METHOD YESCRYPT\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Edit \n\\f0 \\cf4 /etc/login.defs\n\\f2 \\cf2  and set the \n\\f0 \\cf4 ENCRYPT_METHOD\n\\f2 \\cf2  to \n\\f0 \\cf4 SHA512\n\\f2 \\cf2  or \n\\f0 \\cf4 YESCRYPT\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 ENCRYPT_METHOD <HASHING_ALGORITHM>\\\n\n\\f3\\i\\fs24 Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 ENCRYPT_METHOD YESCRYPT\\\n\n\\f1\\b\\fs24 Note:\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 This only effects local groups' passwords created after updating the file to use\\\n\n\\f0 \\cf4 sha512\n\\f2 \\cf2  or \n\\f0 \\cf4 yescrypt\n\\f2 \\cf2 .\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 If it is determined that the password algorithm being used is not \n\\f0 \\cf4 sha512\n\\f2 \\cf2  or\\\n\n\\f0 \\cf4 yescrypt\n\\f2 \\cf2 , once it is changed, it is recommended that all group passwords be\\\nupdated to use the stronger hashing algorithm.\\\n\n\\f0\\fs20\\fsmilli10",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: IA-5\n\\fs20\\fsmilli10080 Page 768\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/login.defs",
      "pattern": "",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.1.4 | Level1"
    },
    {
      "id": "5.4.1.5",
      "title": "Ensure inactive password lock is configured",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 User accounts that have been inactive for over a given period of time can be\\\nautomatically disabled.\\\n\n\\f0 \\cf4 INACTIVE\n\\f2 \\cf2  - Defines the number of days after the password exceeded its maximum age\\\nwhere the user is expected to replace this password.\\\nThe value is stored in the shadow password file. An input of \n\\f0 \\cf4 0\n\\f2 \\cf2  will disable an expired\\\npassword with no delay. An input of \n\\f0 \\cf4 -1\n\\f2 \\cf2  will blank the respective field in the shadow\\\npassword file.\\\n",
      "rationale": "\\\n\n\\f2\\b0 Inactive accounts pose a threat to system security since the users are not logging in to\\\nnotice failed login attempts or other anomalies.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command and verify \n\\f0 \\cf4 INACTIVE\n\\f2 \\cf2  conforms to site policy (no more than\\\n45 days):\\\n\n\\f4\\fs20\\fsmilli10080 # useradd -D | grep INACTIVE\\\nINACTIVE=45\\\n\n\\f2\\fs24 Verify all users with a password have Password inactive no more than 45 days after\\\npassword expires\\\nVerify all users with a password have Password inactive no more than 45 days after\\\npassword expires: Run the following command and Review list of users and \n\\f0 \\cf4 INACTIVE\\\n\n\\f2 \\cf2 to verify",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to set the",
      "references": "\\\n\n\\f2\\b0 1. CIS Password Policy Guide\\\n\n\\f1\\b",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.1.5 | Level1"
    },
    {
      "id": "5.4.1.6",
      "title": "Ensure all users last password change date is in the past\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 All users should have a password change date in the past.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 If a user's recorded password change date is in the future, then they could bypass any\\\nset password expiration.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script and verify nothing is returned:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nwhile IFS= read -r l_user; do\\\nl_change=$(date -d \"$(chage --list $l_user | grep '^Last password\\\nchange' | cut -d: -f2 | grep -v 'never$')\" +%s)\\\nif [[ \"$l_change\" -gt \"$(date +%s)\" ]]; then\\\necho \"User: \\\\\"$l_user\\\\\" last password change was \\\\\"$(chage --list\\\n$l_user | grep '^Last password change' | cut -d: -f2)\\\\\"\"\\\nfi\\\ndone < <(awk -F: '$2~/^\\\\$.+\\\\$/\\{print $1\\}' /etc/shadow)",
      "remediation": "\\\n\n\\f2\\b0 Investigate any users with a password change date in the future and correct them.\\\nLocking the account, expiring the password, or resetting the password manually may be\\\nappropriate.\n\\fs20\\fsmilli10080 Page 772\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 CIS Controls:\\\nControls\\\nVersion Control IG 1 IG 2 IG 3\\\n\n\\f2\\b0 v8\\\n5.2 Use Unique Passwords\\\n\n\\fs16\\fsmilli8400 Use unique passwords for all enterprise assets. Best practice implementation\\\nincludes, at a minimum, an 8-character password for accounts using MFA and a\\\n14-character password for accounts not using MFA.\\\n\n\\fs27\\fsmilli13920 \\cf8 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf5 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf6 \\uc0\\u9679 \\\n\n\\fs24 \\cf2 v7\\\n4.4 Use Unique Passwords\\\n\n\\fs16\\fsmilli8400 Where multi-factor",
      "references": "",
      "type": "FileContent",
      "file_path": "/etc/shadow)",
      "pattern": "",
      "expected_result": "found",
      "severity": "high",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.1.6 | Level1"
    },
    {
      "id": "5.4.2",
      "title": "Ensure minimum days between password changes is configured",
      "section": "5.4 User Accounts",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.2",
      "description": "Minimum days between password changes prevents rapid password cycling",
      "remediation": "Set PASS_MIN_DAYS 1 in /etc/login.defs"
    },
    {
      "id": "5.4.2.1",
      "title": "Ensure root is the only UID 0 account",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 Any account with UID 0 has superuser privileges on the system.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 This access must be limited to only the default \n\\f0 \\cf4 root\n\\f2 \\cf2  account and only from the system\\\nconsole. Administrative access must be through an unprivileged account using an\\\napproved mechanism as noted in Item 5.6 Ensure access to the su command is\\\nrestricted.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command and verify that only \"root\" is returned:\\\n\n\\f4\\fs20\\fsmilli10080 # awk -F: '($3 == 0) \\{ print $1 \\}' /etc/passwd\\\nroot\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to change the \n\\f0 \\cf4 root\n\\f2 \\cf2  account UID to \n\\f0 \\cf4 0\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # usermod -u 0 root\\\n\n\\f2\\fs24 Modify any users other than \n\\f0 \\cf4 root\n\\f2 \\cf2  with UID \n\\f0 \\cf4 0\n\\f2 \\cf2  and assign them a new UID.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 :: CM-6 b\\\n2. NIST SP 800-53A :: CM-6.1 (iv)\\\n3. RHEL 8 STIG GROUP ID: V-230534\\\n4. RHEL 8 STIG Rule ID: SV-230534r627750\n\\fs20\\fsmilli10080 Page 775\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/passwd\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.2.1 | Level1"
    },
    {
      "id": "5.4.2.2",
      "title": "Ensure root is the only GID 0 account",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 usermod\n\\f2 \\cf2  command can be used to specify which group the \n\\f0 \\cf4 root\n\\f2 \\cf2  account belongs\\\nto. This affects permissions of files that are created by the \n\\f0 \\cf4 root\n\\f2 \\cf2  account.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Using GID 0 for the \n\\f0 \\cf4 root\n\\f2 \\cf2  account helps prevent \n\\f0 \\cf4 root\n\\f2 \\cf2  -owned files from accidentally\\\nbecoming accessible to non-privileged users.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify the \n\\f0 \\cf4 root\n\\f2 \\cf2  user's primary GID is \n\\f0 \\cf4 0\n\\f2 \\cf2 , and no other\\\nuser's have GID \n\\f0 \\cf4 0\n\\f2 \\cf2  as their primary GID:\\\n\n\\f4\\fs20\\fsmilli10080 # awk -F: '($1 !~ /^(sync|shutdown|halt|operator)/ && $4==\"0\") \\{print\\\n$1\":\"$4\\}' /etc/passwd\\\nroot:0\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  User's: sync, shutdown, halt, and operator are excluded from the check for other\\\nuser's with GID \n\\f0 \\cf4 0\\\n\n\\f1\\b \\cf2",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to set the \n\\f0 \\cf4 root\n\\f2 \\cf2  user's GID to \n\\f0 \\cf4 0\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # usermod -g 0 root\\\n\n\\f2\\fs24 Run the following command to set the \n\\f0 \\cf4 root\n\\f2 \\cf2  group's GID to \n\\f0 \\cf4 0\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # groupmod -g 0 root\\\n\n\\f2\\fs24 Remove any users other than the \n\\f0 \\cf4 root\n\\f2 \\cf2  user with GID 0 or assign them a new GID if\\\nappropriate.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\n\\fs20\\fsmilli10080 Page 777\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/passwd\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.2.2 | Level1"
    },
    {
      "id": "5.4.2.3",
      "title": "Ensure group root is the only GID 0 group",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 groupmod\n\\f2 \\cf2  command can be used to specify which group the \n\\f0 \\cf4 root\n\\f2 \\cf2  group belongs\\\nto. This affects permissions of files that are group owned by the \n\\f0 \\cf4 root\n\\f2 \\cf2  group.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Using GID 0 for the \n\\f0 \\cf4 root\n\\f2 \\cf2  group helps prevent \n\\f0 \\cf4 root\n\\f2 \\cf2  group owned files from accidentally\\\nbecoming accessible to non-privileged users.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify no group other than \n\\f0 \\cf4 root\n\\f2 \\cf2  is assigned GID \n\\f0 \\cf4 0\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # awk -F: '$3==\"0\"\\{print $1\":\"$3\\}' /etc/group\\\nroot:0\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to set the \n\\f0 \\cf4 root\n\\f2 \\cf2  group's GID to \n\\f0 \\cf4 0\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # groupmod -g 0 root\\\n\n\\f2\\fs24 Remove any groups other than the \n\\f0 \\cf4 root\n\\f2 \\cf2  group with GID 0 or assign them a new GID if\\\nappropriate.\\\n\n\\f1\\b",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\n\\fs20\\fsmilli10080 Page 779\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/group\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.2.3 | Level1"
    },
    {
      "id": "5.4.2.4",
      "title": "Ensure root account access is controlled",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 There are a number of methods to access the root account directly. Without a password\\\nset any user would be able to gain access and thus control over the entire system.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Access to \n\\f0 \\cf4 root\n\\f2 \\cf2  should be secured at all times.\\\n\n\\f1\\b",
      "impact": "\\\n\n\\f2\\b0 If there are any automated processes that relies on access to the root account without\\\nauthentication, they will fail after",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that either the root user's password is set or the\\\nroot user's account is locked:\\\n\n\\f4\\fs20\\fsmilli10080 # passwd -S root | awk '$2 ~ /^(P|L)/ \\{print \"User: \\\\\"\" $1 \"\\\\\" Password is\\\nstatus: \" $2\\}'\\\n\n\\f2\\fs24 Verify the output is either:\\\n\n\\f4\\fs20\\fsmilli10080 User: \"root\" Password is status: P\\\n- OR -\\\nUser: \"root\" Password is status: L\\\n\n\\f1\\b\\fs24 Note:\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 P\n\\f2 \\cf2  - Password is set\\\n\n\\f0\\fs",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to set a password for the \n\\f0 \\cf4 root\n\\f2 \\cf2  user:\\\n\n\\f4\\fs20\\fsmilli10080 # passwd root\\\n\n\\f1\\b\\fs24 - OR -\\\n\n\\f2\\b0 Run the following command to lock the \n\\f0 \\cf4 root\n\\f2 \\cf2  user account:\\\n\n\\f4\\fs20\\fsmilli10080 # usermod -L root\n\\f2 Page 781\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24 CIS Controls:\\\nControls\\\nVersion Control IG 1 IG 2 IG 3\\\n\n\\f2\\b0 v8\\\n3.3 Configure Data Access Control Lists\\\n\n\\fs16\\fsmilli8400 Configure data access control lists based on a user\\'92s need to know. Apply data\\\naccess control lists, also known as access permissions, to local and remote file\\\nsystems, databases, and applications.\\\n\n\\fs27\\fsmilli13920 \\cf8 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf5 \\uc0\\u9679 \n\\fs24 \\cf2  \n\\fs27\\fsmilli13920 \\cf6 \\uc0\\u967",
      "references": "",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.2.4 | Level1"
    },
    {
      "id": "5.4.2.5",
      "title": "Ensure root path integrity",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 The \n\\f0 \\cf4 root\n\\f2 \\cf2  user can execute any command on the system and could be fooled into\\\nexecuting programs unintentionally if the \n\\f0 \\cf4 PATH\n\\f2 \\cf2  is not set correctly.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Including the current working directory (.) or other writable directory in \n\\f0 \\cf4 root\n\\f2 \\cf2 's\\\nexecutable path makes it likely that an attacker can gain superuser access by forcing an\\\nadministrator operating as \n\\f0 \\cf4 root\n\\f2 \\cf2  to execute a Trojan horse program.\n\\fs20\\fsmilli10080 Page 783\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify root's path does not include:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Locations that are not directories\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 An empty directory (\n\\f0 \\cf4 ::\n\\f2 \\cf2 )\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 A trailing (\n\\f0 \\cf4 :\n\\f2 \\cf2 )\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Current working directory (\n\\f0 \\cf4 .\n\\f2 \\cf2 )\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Non \n\\f0 \\cf4 root\n\\f2 \\cf2  owned directories\\\n\n\\f0\\fs2",
      "remediation": "\\\n\n\\f2\\b0 Correct or justify any:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Locations that are not directories\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Empty directories (\n\\f0 \\cf4 ::\n\\f2 \\cf2 )\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Trailing (\n\\f0 \\cf4 :\n\\f2 \\cf2 )\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Current working directory (\n\\f0 \\cf4 .\n\\f2 \\cf2 )\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Non \n\\f0 \\cf4 root\n\\f2 \\cf2  owned directories\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 Directories that less restrictive than mode \n\\f0 \\cf4 0755\\\n\n\\f1\\b \\cf2",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\\\n\n\\f1\\b",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.2.5 | Level1"
    },
    {
      "id": "5.4.2.6",
      "title": "Ensure root user umask is configured",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 The user file-creation mode mask (\n\\f0 \\cf4 umask\n\\f2 \\cf2 ) is used to determine the file permission for\\\nnewly created directories and files. In Linux, the default permissions for any newly\\\ncreated directory is 0777 (\n\\f0 \\cf4 rwxrwxrwx\n\\f2 \\cf2 ), and for any newly created file it is 0666 (\n\\f0 \\cf4 rw-rw-\\\nrw-\n\\f2 \\cf2 ). The \n\\f0 \\cf4 umask\n\\f2 \\cf2  modifies the default Linux permissions by restricting (masking) these\\\npermissions. The \n\\f0 \\cf4 umask\n\\f2 \\cf2  is not simply sub",
      "rationale": "\\\n\n\\f2\\b0 Setting a secure value for \n\\f0 \\cf4 umask\n\\f2 \\cf2  ensures that users make a conscious choice about\\\ntheir file permissions. A permissive \n\\f0 \\cf4 umask\n\\f2 \\cf2  value could result in directories or files with\\\nexcessive permissions that can be read and/or written to by unauthorized users.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that the \n\\f0 \\cf4 root\n\\f2 \\cf2  user files, \n\\f0 \\cf4 /root/.bash_profile\\\n\n\\f2 \\cf2 and \n\\f0 \\cf4 /root/.bashrc\n\\f2 \\cf2 , do not include a \n\\f0 \\cf4 umask\n\\f2 \\cf2  that is less restrictive than \n\\f0 \\cf4 0027\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Psi --\\\n'^\\\\h*umask\\\\h+((\\\\d\\{1,2\\}(\\\\d[^7]|[^2-\\\n7]\\\\d)\\\\b)|(u=[rwx]\\{1,3\\},)?(((g=[rx]?[rx]?w[rx]?[rx]?\\\\b)(,o=[rwx]\\{1,3\\})?)|((g=[\\\nwrx]\\{1,3\\},)?o=[wrx]\\{1,3\\}\\\\b)))' /root/.bash_profile /root",
      "remediation": "\\\n\n\\f2\\b0 Edit \n\\f0 \\cf4 /root/.bash_profile\n\\f2 \\cf2  and \n\\f0 \\cf4 /root/.bashrc\n\\f2 \\cf2  and either:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 remove, comment out, or update any line with \n\\f0 \\cf4 umask\n\\f2 \\cf2 .\\\n\n\\f1\\b - OR -\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 update any line that includes \n\\f0 \\cf4 umask\n\\f2 \\cf2  to a value of \n\\f0 \\cf4 0027\n\\f2 \\cf2  or more restrictive.\\\n\n\\f3\\i Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 umask 027\\\n\n\\f1\\b\\fs24 Note:\n\\f2\\b0  the Recommendation \"Ensure",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-3, MP-2\n\\fs20\\fsmilli10080 Page 787\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.2.6 | Level1"
    },
    {
      "id": "5.4.2.7",
      "title": "Ensure system accounts do not have a valid login shell\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 There are a number of accounts provided with most distributions that are used to\\\nmanage applications and are not intended to provide an interactive shell. Furthermore,\\\na user may add special accounts that are not intended to provide an interactive shell.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 It is important to make sure that accounts that are not being used by regular users are\\\nprevented from being used to provide an interactive shell. By default, most distributions\\\nset the password field for these accounts to an invalid string, but it is also recommended\\\nthat the shell field in the password file be set to the \n\\f0 \\cf4 nologin\n\\f2 \\cf2  shell. This prevents the\\\naccount from potentially being used to run any commands.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify system accounts, except for \n\\f0 \\cf4 root\n\\f2 \\cf2 , \n\\f0 \\cf4 halt\n\\f2 \\cf2 , \n\\f0 \\cf4 sync\n\\f2 \\cf2 ,\\\n\n\\f0 \\cf4 shutdown\n\\f2 \\cf2  or \n\\f0 \\cf4 nfsnobody\n\\f2 \\cf2 , do not have a valid login shell:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_valid_shells=\"^($(awk -F\\\\/ '$NF != \"nologin\" \\{print\\}' /etc/shells | sed\\\n-rn '/^\\\\//\\{s,/,\\\\\\\\\\\\\\\\/,g;p\\}' | paste -s -d '|' - ))$\"\\\nawk -v pat=\"$l_valid_shells\" -F:\\\n'($1!~/^(root|halt|sync|shutdo",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to set the shell for any service accounts returned by the\\\naudit to \n\\f0 \\cf4 nologin\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 # usermod -s $(command -v nologin) <user>\\\n\n\\f3\\i\\fs24 Example script:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_valid_shells=\"^($( awk -F\\\\/ '$NF != \"nologin\" \\{print\\}' /etc/shells | sed\\\n-rn '/^\\\\//\\{s,/,\\\\\\\\\\\\\\\\/,g;p\\}' | paste -s -d '|' - ))$\"\\\nawk -v pat=\"$l_valid_shells\" -F:\\\n'($1!~/^(root|halt|sync|shutdown|nfsnobody)$/ && ($3<'\"$(awk\\\n'/^\\\\s*UID_MIN/\\{print $2\\}' /etc/login.defs)\"' || $3 == 65534) && $(NF) ~ pat)\\\n\\{system (\"usermod -s '\"$(command -v nologin)\"' \" $1)\\}' /etc/passwd\\\n\\}\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-2(5), AC-3, AC-11, MP-2\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/shells",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.2.7 | Level1"
    },
    {
      "id": "5.4.2.8",
      "title": "Ensure accounts without a valid login shell are locked\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 There are a number of accounts provided with most distributions that are used to\\\nmanage applications. Additionally, a administrator may add special accounts that are\\\nnot intended for interactive use.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 It is important to make sure that accounts that are not intended for interactive use are\\\nprevented from being used interactively. By default, most distributions set the password\\\nfield for these accounts to an invalid string, but it is also recommended that these\\\naccounts are locked. This prevents these accounts from potentially being used to run\\\nany commands.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify all non-root accounts without a valid login shell are\\\nlocked.\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_valid_shells=\"^($(awk -F\\\\/ '$NF != \"nologin\" \\{print\\}' /etc/shells | sed\\\n-rn '/^\\\\//\\{s,/,\\\\\\\\\\\\\\\\/,g;p\\}' | paste -s -d '|' - ))$\"\\\nwhile IFS= read -r l_user; do\\\npasswd -S \"$l_user\" | awk '$2 !~ /^L/ \\{print \"Account: \\\\\"\" $1 \"\\\\\" does\\\nnot have a valid login shell and is not locked\"\\}'\\\ndone < <(awk -v pat=\"$l_valid_shells\" -F: '($1 ",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to lock any non-root accounts without a valid login shell\\\nreturned by the audit:\\\n\n\\f4\\fs20\\fsmilli10080 # usermod -L <user>\\\n\n\\f3\\i\\fs24 Example script:\n\\f2\\i0 :\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_valid_shells=\"^($(awk -F\\\\/ '$NF != \"nologin\" \\{print\\}' /etc/shells | sed\\\n-rn '/^\\\\//\\{s,/,\\\\\\\\\\\\\\\\/,g;p\\}' | paste -s -d '|' - ))$\"\\\nwhile IFS= read -r l_user; do\\\npasswd -S \"$l_user\" | awk '$2 !~ /^L/ \\{system (\"usermod -L \" $1)\\}'\\\ndone < <(awk -v pat=\"$l_valid_shells\" -F: '($1 != \"root\" && $(NF) !~ pat)\\\n\\{print $1\\}' /etc/passwd)\\\n\\}\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: AC-2(5), AC-3, AC-11, MP-2\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/shells",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.2.8 | Level1"
    },
    {
      "id": "5.4.3",
      "title": "Ensure password expiration warning days is 7 or more",
      "section": "5.4 User Accounts",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.3",
      "description": "Users should be warned before password expires",
      "remediation": "Set PASS_WARN_AGE 7 in /etc/login.defs"
    },
    {
      "id": "5.4.3.1",
      "title": "Ensure nologin is not listed in /etc/shells",
      "automated": true,
      "profile": "Level2",
      "section": "5.4",
      "description": "\\\n\n\\f0\\b0 \\cf4 /etc/shells\n\\f2 \\cf2  is a text file which contains the full pathnames of valid login shells. This\\\nfile is consulted by \n\\f0 \\cf4 chsh\n\\f2 \\cf2  and available to be queried by other programs.\\\nBe aware that there are programs which consult this file to find out if a user is a normal\\\nuser; for example, FTP daemons traditionally disallow access to users with shells not\\\nincluded in this file.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 A user can use \n\\f0 \\cf4 chsh\n\\f2 \\cf2  to change their configured shell.\\\nIf a user has a shell configured that isn't in in \n\\f0 \\cf4 /etc/shells\n\\f2 \\cf2 , then the system assumes\\\nthat they're somehow restricted. In the case of \n\\f0 \\cf4 chsh\n\\f2 \\cf2  it means that the user cannot\\\nchange that value.\\\nOther programs might query that list and apply similar restrictions.\\\nBy putting \n\\f0 \\cf4 nologin\n\\f2 \\cf2  in \n\\f0 \\cf4 /etc/shells\n\\f2 \\cf2 , any user that has \n\\f0 \\cf4 nologin\n\\f",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that \n\\f0 \\cf4 nologin\n\\f2 \\cf2  is not listed in the \n\\f0 \\cf4 /etc/shells\n\\f2 \\cf2  file:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Ps '^\\\\h*([^#\\\\n\\\\r]+)?\\\\/nologin\\\\b' /etc/shells\\\n\n\\f2\\fs24 Nothing should be returned\\\n\n\\f1\\b",
      "remediation": "\\\n\n\\f2\\b0 Edit \n\\f0 \\cf4 /etc/shells\n\\f2 \\cf2  and remove any lines that include \n\\f0 \\cf4 nologin\\\n\n\\f1\\b \\cf2",
      "references": "\\\n\n\\f2\\b0 1. shells(5)\\\n2. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5\n\\fs20\\fsmilli10080 Page 794\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "FileContent",
      "file_path": "/etc/shells",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.3.1 | Level2"
    },
    {
      "id": "5.4.3.2",
      "title": "Ensure default user shell timeout is configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f0\\b0 \\cf4 TMOUT\n\\f2 \\cf2  is an environmental setting that determines the timeout of a shell in seconds.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 TMOUT=\n\\f3\\i n\n\\f2\\i0  - Sets the shell timeout to \n\\f3\\i n\n\\f2\\i0  seconds. A setting of \n\\f0 \\cf4 TMOUT=0\n\\f2 \\cf2  disables\\\ntimeout.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 readonly TMOUT- Sets the TMOUT environmental variable as readonly,\\\npreventing unwanted modification during run-time.\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 export TMOUT",
      "rationale": "\\\n\n\\f2\\b0 Setting a timeout value reduces the window of opportunity for unauthorized user access\\\nto another user's shell session that has been left unattended. It also ends the inactive\\\nsession and releases the resources associated with that session.\\\n\n\\f1\\b",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify that \n\\f0 \\cf4 TMOUT\n\\f2 \\cf2  is configured to: include a timeout of no\\\nmore than \n\\f0 \\cf4 900\n\\f2 \\cf2  seconds, to be \n\\f0 \\cf4 readonly\n\\f2 \\cf2 , to be \n\\f0 \\cf4 exported\n\\f2 \\cf2 , and is not being changed to\\\na longer timeout.\n\\fs20\\fsmilli10080 Page 796\\\n\n\\f0 Internal Only - General\\\n\n\\f4\\fs18\\fsmilli9120 #!/usr/bin/env bash\\\n\\{\\\na_output=(); a_output2=(); l_tmout_set=\"900\"\\\nf_tmout_read_chk()\\\n\\{\\\na_out=(); a_out2=()\\\nl_tmout_readonly=\"$(gr",
      "remediation": "\\\n\n\\f2\\b0 Review \n\\f0 \\cf4 /etc/bashrc\n\\f2 \\cf2 , \n\\f0 \\cf4 /etc/profile\n\\f2 \\cf2 , and all files ending in \n\\f0 \\cf4 *.sh\n\\f2 \\cf2  in the\\\n\n\\f0 \\cf4 /etc/profile.d/\n\\f2 \\cf2  directory and remove or edit all \n\\f0 \\cf4 TMOUT=_n_\n\\f2 \\cf2  entries to follow local site\\\npolicy. \n\\f0 \\cf4 TMOUT\n\\f2 \\cf2  should not exceed 900 or be equal to \n\\f0 \\cf4 0\n\\f2 \\cf2 .\\\nConfigure \n\\f0 \\cf4 TMOUT\n\\f2 \\cf2  in \n\\f1\\b one\n\\f2\\b0  of the following files:\\\n\n\\f0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 A file in the \n\\f0 \\cf4 /etc/profile.d/\n\\f2 \\cf2  directory ending in \n\\f0 \\cf4 .sh\\\n\n\\fs20\\fsmilli10080 \\cf2 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 /etc/profile\\\n\n\\fs20\\fsmilli10080 \\cf2 \\'95\n\\f2  \n\\f0\\fs24 \\cf4 /etc/bashrc\\\n\n\\f3\\i \\cf2 Example command to set TMOUT to \n\\f0\\i0 \\cf4 900\n\\f3\\i \\cf2  seconds in a file in \n\\f0\\i",
      "references": "",
      "type": "FileContent",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.3.2 | Level1"
    },
    {
      "id": "5.4.3.3",
      "title": "Ensure default user umask is configured",
      "automated": true,
      "profile": "Level1",
      "section": "5.4",
      "description": "\\\n\n\\f2\\b0 The user file-creation mode mask (\n\\f0 \\cf4 umask\n\\f2 \\cf2 ) is used to determine the file permission for\\\nnewly created directories and files. In Linux, the default permissions for any newly\\\ncreated directory is 0777 (\n\\f0 \\cf4 rwxrwxrwx\n\\f2 \\cf2 ), and for any newly created file it is 0666 (\n\\f0 \\cf4 rw-rw-\\\nrw-\n\\f2 \\cf2 ). The \n\\f0 \\cf4 umask\n\\f2 \\cf2  modifies the default Linux permissions by restricting (masking) these\\\npermissions. The \n\\f0 \\cf4 umask\n\\f2 \\cf2  is not simply sub",
      "rationale": "\\\n\n\\f2\\b0 Setting a secure default value for \n\\f0 \\cf4 umask\n\\f2 \\cf2  ensures that users make a conscious choice\\\nabout their file permissions. A permissive \n\\f0 \\cf4 umask\n\\f2 \\cf2  value could result in directories or files\\\nwith excessive permissions that can be read and/or written to by unauthorized users.\\\nSatisfies: SRG-OS-000480-GPOS-00228, SRG-OS-000480-GPOS-00227\n\\fs20\\fsmilli10080 Page 801\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following commands to verify the systemwide \n\\f0 \\cf4 umask\n\\f2 \\cf2  is \n\\f0 \\cf4 0027\\\n(u=rwx,g=rx,o=)\n\\f2 \\cf2  or more restrictive:\\\n1. Run the following command to verify \n\\f0 \\cf4 umask\n\\f2 \\cf2  is set to \n\\f0 \\cf4 027\n\\f2 \\cf2  or more restrictive in a\\\nfile ending in \n\\f0 \\cf4 .sh\n\\f2 \\cf2  in \n\\f0 \\cf4 /etc/profile.d/\\\n\n\\f4\\fs20\\fsmilli10080 \\cf2 grep -Psi --\\\n'^\\\\h*umask\\\\b' /etc/profile.d/*.sh\\\n\n\\f3\\i\\fs24 Example output:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 umask 027\\\n\n\\f2\\f",
      "remediation": "\\\n\n\\f2\\b0 1. Run the following script to comment out all occurrences of \n\\f0 \\cf4 umask\n\\f2 \\cf2  that are less\\\nrestrictive than \n\\f0 \\cf4 027\n\\f2 \\cf2  in files ending in \n\\f0 \\cf4 *.sh\n\\f2 \\cf2  in the \n\\f0 \\cf4 /etc/profile.d/\n\\f2 \\cf2  directory:\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nwhile IFS= read -r -d $'\\\\0' l_file; do\\\nsed -ri '/^\\\\s*umask\\\\s+0?(0[01][0-7]|0[0-7][^7]|[^0][0-7][0-\\\n7])(\\\\s*|\\\\s+.*)$/s/^/# /' \"$l_file\"\\\ndone < <(find /etc/profile.d/ -type f -name '*.sh' -print0)\\\n\\}\\\n\n\\f2\\fs24 2. Create or edit a file in \n\\f0 \\cf4 /etc/profile.d/\n\\f2 \\cf2  ending in \n\\f0 \\cf4 *.sh\n\\f2 \\cf2  and add or modify the\\\nfollowing line:\\\n\n\\f4\\fs20\\fsmilli10080 umask 0027\\\n\n\\f3\\i\\fs24 Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # printf '%s\\\\n' \"\" \"umask 027\" >> /etc/profile.d/60-",
      "references": "\\\n\n\\f2\\b0 1. CCI-000366\\\n2. NIST SP 800-53 :: CM-6 b\\\n3. NIST SP 800-53A :: CM-6.1 (iv)\\\n4. STIG ID: RHEL-08-020351 | RULE ID: SV-230383r1017192 | CAT II\\\n5. STIG ID: RHEL-08-020353 | RULE ID: SV-230385r1017194 | CAT II\\\n6. STIG ID: RHEL-09-412055 | RULE ID: SV-258072r1045155 | CAT II\\\n7. STIG ID: R",
      "type": "FileContent",
      "file_path": "/etc/profile.d/\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.3.3 | Level1"
    },
    {
      "id": "5.4.4",
      "title": "Ensure inactive password lock is 30 days or less",
      "section": "5.4 User Accounts",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.4",
      "description": "Inactive accounts should be locked",
      "remediation": "Run: useradd -D -f 30"
    },
    {
      "id": "5.4.5",
      "title": "Ensure default user shell timeout is configured",
      "section": "5.4 User Accounts",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.5",
      "description": "Shell timeout prevents unattended sessions",
      "remediation": "Set TMOUT=900 in /etc/bashrc and /etc/profile"
    },
    {
      "id": "5.4.6",
      "title": "Ensure default user umask is configured",
      "section": "5.4 User Accounts",
      "type": "Manual",
      "profile": "Level1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 5.4.6",
      "description": "Default umask should be 027 or more restrictive",
      "remediation": "Set umask 027 in /etc/bashrc and /etc/profile"
    }
  ]
}