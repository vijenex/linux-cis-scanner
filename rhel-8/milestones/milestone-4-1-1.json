{
  "milestone": "4.1.1",
  "title": "Configure System Accounting (auditd)",
  "controls": [
    {
      "id": "4.1.1",
      "title": "Ensure firewalld is installed",
      "automated": true,
      "profile": "Level1",
      "section": "4.1",
      "description": "\\\n\n\\f0\\b0 \\cf4 firewalld\n\\f2 \\cf2  is a high-level firewall rules management frontend utility. It does not directly\\\nhandle packet filtering itself but relies on the \n\\f0 \\cf4 nftables\n\\f2 \\cf2  subsystem within the Linux\\\nkernel.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f0\\b0 \\cf4 firewalld\n\\f2 \\cf2  is a dynamic, user friendly, firewall manager that can protect against threats\\\noriginating from within a corporate network to include malicious mobile code and poorly\\\nconfigured software on a host.\\\n\n\\f1\\b",
      "impact": "\\\n\n\\f2\\b0 Changing firewall settings while connected over the network can result in being locked\\\nout of the system.\\\n\n\\f1\\b",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that \n\\f0 \\cf4 firewalld\n\\f2 \\cf2  is installed:\\\n\n\\f4\\fs20\\fsmilli10080 # rpm -q firewalld\\\nfirewalld-<version>\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to install \n\\f0 \\cf4 firewalld\\\n\n\\f4\\fs20\\fsmilli10080 \\cf2 # dnf install firewalld\\\n\n\\f1\\b\\fs24",
      "references": "\\\n\n\\f2\\b0 1. NIST SP 800-53 Rev. 5: CA-9\n\\fs20\\fsmilli10080 Page 574\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "type": "PackageInstalled",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 4.1.1 | Level1",
      "package_name": "audit"
    },
    {
      "title": "Ensure auditd is installed",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "auditd is the userspace component to the Linux Auditing System. It's responsible for writing audit records to the disk.",
      "rationale": "The capturing of system events provides system administrators with information to allow them to determine if unauthorized access to their system is occurring.",
      "audit": "Run the following command to verify auditd is installed:\n# rpm -q audit audit-libs\naudit-<version>\naudit-libs-<version>",
      "remediation": "Run the following command to install auditd:\n# dnf install audit audit-libs",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the auditd(8) and auditctl(8) man pages for more information.",
      "cis_controls": "v8: 8.2 Collect Audit Logs\nv7: 6.2 Activate audit logging",
      "check_type": "PackageInstalled",
      "check_value": "audit",
      "id": "4.1.1.1"
    },
    {
      "title": "Ensure auditd service is enabled and running",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "Turn on the auditd daemon to record system events.",
      "rationale": "The capturing of system events provides system administrators with information to allow them to determine if unauthorized access to their system is occurring.",
      "audit": "Run the following command to verify auditd is enabled:\n# systemctl is-enabled auditd\nenabled\nRun the following command to verify auditd is running:\n# systemctl is-active auditd\nactive",
      "remediation": "Run the following command to enable auditd:\n# systemctl --now enable auditd",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the auditd(8) man page for more information.",
      "cis_controls": "v8: 8.2 Collect Audit Logs\nv7: 6.2 Activate audit logging",
      "check_type": "ServiceStatus",
      "check_value": "auditd:enabled",
      "id": "4.1.1.2"
    },
    {
      "title": "Ensure auditing for processes that start prior to auditd is enabled",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "Configure grub so that processes that are capable of being audited can be audited even if they start up prior to auditd startup.",
      "rationale": "Audit events need to be captured on processes that start up prior to auditd, so that potential malicious activity cannot go undetected.",
      "audit": "Run the following command and verify that each linux line has the audit=1 parameter set:\n# grubby --info=ALL | grep -Po 'audit=1'\naudit=1",
      "remediation": "Edit /etc/default/grub and add audit=1 to GRUB_CMDLINE_LINUX:\nGRUB_CMDLINE_LINUX=\"audit=1\"\nRun the following command to update the grub2 configuration:\n# grub2-mkconfig -o /boot/grub2/grub.cfg",
      "impact": "None",
      "default_value": "N/A",
      "references": "1. See the auditd(8) man page for more information.",
      "cis_controls": "v8: 8.2 Collect Audit Logs\nv7: 6.2 Activate audit logging",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.1.1.3"
    },
    {
      "title": "Ensure audit_backlog_limit is sufficient",
      "level": 2,
      "scored": true,
      "profile_applicability": "Level 2 - Server, Level 2 - Workstation",
      "description": "The backlog limit has a default setting of 64.",
      "rationale": "During boot if audit=1, then the backlog will hold 64 records. If more than 64 records are created during boot, auditd records will be lost and potential malicious activity could go undetected.",
      "audit": "Run the following command and verify the audit_backlog_limit parameter is set to 8192 or larger:\n# grubby --info=ALL | grep -Po 'audit_backlog_limit=\\d+'\naudit_backlog_limit=8192",
      "remediation": "Edit /etc/default/grub and add audit_backlog_limit=8192 to GRUB_CMDLINE_LINUX:\nGRUB_CMDLINE_LINUX=\"audit_backlog_limit=8192\"\nRun the following command to update the grub2 configuration:\n# grub2-mkconfig -o /boot/grub2/grub.cfg",
      "impact": "None",
      "default_value": "64",
      "references": "1. See the auditd(8) man page for more information.",
      "cis_controls": "v8: 8.2 Collect Audit Logs\nv7: 6.2 Activate audit logging",
      "check_type": "Manual",
      "check_value": "",
      "id": "4.1.1.4"
    }
  ]
}