{
  "milestone": "missing-28",
  "version": "1.0.0", 
  "description": "28 Missing Controls to Match OpenSCAP Coverage",
  "controls": [
    {
      "id": "net.ipv6.conf.all.accept_ra",
      "title": "Disable Accept Router Advertisements (all interfaces)",
      "type": "SysctlParameter",
      "automated": true,
      "profile": "Level1",
      "section": "3.3.2",
      "parameter_name": "net.ipv6.conf.all.accept_ra",
      "expected_value": "0",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.2.7",
      "description": "Disable accepting router advertisements on all IPv6 interfaces"
    },
    {
      "id": "net.ipv6.conf.all.accept_redirects", 
      "title": "Disable ICMP Redirects IPv6",
      "type": "SysctlParameter",
      "automated": true,
      "profile": "Level1",
      "section": "3.3.2",
      "parameter_name": "net.ipv6.conf.all.accept_redirects",
      "expected_value": "0",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.2.3",
      "description": "Disable accepting ICMP redirects for all IPv6 interfaces"
    },
    {
      "id": "net.ipv6.conf.all.accept_source_route",
      "title": "Disable Source-Routed Packets IPv6 (all)",
      "type": "SysctlParameter", 
      "automated": true,
      "profile": "Level1",
      "section": "3.3.2",
      "parameter_name": "net.ipv6.conf.all.accept_source_route",
      "expected_value": "0",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.2.1",
      "description": "Disable accepting source-routed packets on all IPv6 interfaces"
    },
    {
      "id": "net.ipv6.conf.all.forwarding",
      "title": "Disable IPv6 forwarding",
      "type": "SysctlParameter",
      "automated": true,
      "profile": "Level1", 
      "section": "3.3.2",
      "parameter_name": "net.ipv6.conf.all.forwarding",
      "expected_value": "0",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.2.1",
      "description": "Disable IPv6 forwarding on all interfaces"
    },
    {
      "id": "net.ipv6.conf.default.accept_ra",
      "title": "Disable RA (default)",
      "type": "SysctlParameter",
      "automated": true,
      "profile": "Level1",
      "section": "3.3.2", 
      "parameter_name": "net.ipv6.conf.default.accept_ra",
      "expected_value": "0",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.2.8",
      "description": "Disable accepting router advertisements on IPv6 interfaces by default"
    },
    {
      "id": "net.ipv6.conf.default.accept_redirects",
      "title": "Disable ICMP Redirects IPv6 (default)",
      "type": "SysctlParameter",
      "automated": true,
      "profile": "Level1",
      "section": "3.3.2",
      "parameter_name": "net.ipv6.conf.default.accept_redirects", 
      "expected_value": "0",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.2.4",
      "description": "Disable accepting ICMP redirects by default on IPv6 interfaces"
    },
    {
      "id": "net.ipv6.conf.default.accept_source_route",
      "title": "Disable Source-Routed IPv6 (default)",
      "type": "SysctlParameter",
      "automated": true,
      "profile": "Level1",
      "section": "3.3.2",
      "parameter_name": "net.ipv6.conf.default.accept_source_route",
      "expected_value": "0",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.2.2", 
      "description": "Disable accepting source-routed packets on IPv6 interfaces by default"
    },
    {
      "id": "net.ipv4.conf.all.accept_redirects",
      "title": "Disable ICMP Redirects IPv4 (all)",
      "type": "SysctlParameter",
      "automated": true,
      "profile": "Level1",
      "section": "3.3.1",
      "parameter_name": "net.ipv4.conf.all.accept_redirects",
      "expected_value": "0",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.1.8",
      "description": "Disable accepting ICMP redirects for all IPv4 interfaces"
    },
    {
      "id": "net.ipv4.conf.all.log_martians",
      "title": "Log Martians", 
      "type": "SysctlParameter",
      "automated": true,
      "profile": "Level1",
      "section": "3.3.1",
      "parameter_name": "net.ipv4.conf.all.log_martians",
      "expected_value": "1",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.1.16",
      "description": "Enable kernel parameter to log martian packets on all IPv4 interfaces"
    },
    {
      "id": "net.ipv4.conf.all.secure_redirects",
      "title": "Disable Secure Redirects IPv4",
      "type": "SysctlParameter",
      "automated": true,
      "profile": "Level1",
      "section": "3.3.1",
      "parameter_name": "net.ipv4.conf.all.secure_redirects",
      "expected_value": "0",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.1.10",
      "description": "Disable kernel parameter for accepting secure ICMP redirects on all IPv4 interfaces"
    },
    {
      "id": "net.ipv4.conf.default.accept_redirects",
      "title": "Disable Redirects IPv4 (default)",
      "type": "SysctlParameter",
      "automated": true,
      "profile": "Level1", 
      "section": "3.3.1",
      "parameter_name": "net.ipv4.conf.default.accept_redirects",
      "expected_value": "0",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.1.9",
      "description": "Disable kernel parameter for accepting ICMP redirects by default on IPv4 interfaces"
    },
    {
      "id": "net.ipv4.conf.all.send_redirects",
      "title": "Disable Send Redirects IPv4 (all)",
      "type": "SysctlParameter",
      "automated": true,
      "profile": "Level1",
      "section": "3.3.1",
      "parameter_name": "net.ipv4.conf.all.send_redirects",
      "expected_value": "0",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.1.4",
      "description": "Disable kernel parameter for sending ICMP redirects on all IPv4 interfaces"
    },
    {
      "id": "net.ipv4.conf.default.send_redirects",
      "title": "Disable Send Redirects IPv4 (default)",
      "type": "SysctlParameter",
      "automated": true,
      "profile": "Level1",
      "section": "3.3.1",
      "parameter_name": "net.ipv4.conf.default.send_redirects", 
      "expected_value": "0",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.1.5",
      "description": "Disable kernel parameter for sending ICMP redirects by default on IPv4 interfaces"
    },
    {
      "id": "net.ipv4.ip_forward",
      "title": "Disable IPv4 forwarding",
      "type": "SysctlParameter",
      "automated": true,
      "profile": "Level1",
      "section": "3.3.1",
      "parameter_name": "net.ipv4.ip_forward",
      "expected_value": "0",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 3.3.1.1",
      "description": "Disable kernel parameter for IP forwarding on IPv4 interfaces"
    },
    {
      "id": "aide_installed",
      "title": "Install AIDE",
      "type": "PackageInstalled",
      "automated": true,
      "profile": "Level1",
      "section": "1.12",
      "package_name": "aide",
      "expected_status": "installed",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.12.1",
      "description": "Ensure AIDE is installed"
    },
    {
      "id": "aide_db_exists",
      "title": "Build and Test AIDE Database", 
      "type": "FileExists",
      "automated": true,
      "profile": "Level1",
      "section": "1.12",
      "file_path": "/var/lib/aide/aide.db.gz",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.12.2",
      "description": "Ensure AIDE database is built"
    },
    {
      "id": "aide_audit_tool_monitoring",
      "title": "Configure AIDE to Verify the Audit Tools",
      "type": "FileContent",
      "automated": true,
      "profile": "Level1",
      "section": "1.12",
      "file_path": "/etc/aide.conf",
      "pattern": "/sbin/audit",
      "expected_result": "found",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.12.3",
      "description": "Ensure AIDE monitors audit tools"
    },
    {
      "id": "aide_periodic_execution",
      "title": "Configure Periodic Execution of AIDE",
      "type": "FileExists",
      "automated": true,
      "profile": "Level1", 
      "section": "1.12",
      "file_path": "/etc/cron.daily/aide",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.12.4",
      "description": "Ensure periodic AIDE execution is configured"
    },
    {
      "id": "cron_d_perm",
      "title": "Verify Permissions on cron.d",
      "type": "FilePermissions",
      "automated": true,
      "profile": "Level1",
      "section": "2.4.1",
      "file_path": "/etc/cron.d",
      "expected_permissions": "0700",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.8",
      "description": "Verify permissions on /etc/cron.d are configured"
    },
    {
      "id": "cron_daily_perm",
      "title": "Verify Permissions on cron.daily",
      "type": "FilePermissions",
      "automated": true,
      "profile": "Level1",
      "section": "2.4.1",
      "file_path": "/etc/cron.daily",
      "expected_permissions": "0700",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.4",
      "description": "Verify permissions on /etc/cron.daily are configured"
    },
    {
      "id": "cron_hourly_perm",
      "title": "Verify Permissions on cron.hourly",
      "type": "FilePermissions",
      "automated": true,
      "profile": "Level1",
      "section": "2.4.1",
      "file_path": "/etc/cron.hourly",
      "expected_permissions": "0700",
      "expected_owner": "root", 
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.3",
      "description": "Verify permissions on /etc/cron.hourly are configured"
    },
    {
      "id": "cron_monthly_perm",
      "title": "Verify Permissions on cron.monthly",
      "type": "FilePermissions",
      "automated": true,
      "profile": "Level1",
      "section": "2.4.1",
      "file_path": "/etc/cron.monthly",
      "expected_permissions": "0700",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.6",
      "description": "Verify permissions on /etc/cron.monthly are configured"
    },
    {
      "id": "cron_weekly_perm",
      "title": "Verify Permissions on cron.weekly",
      "type": "FilePermissions",
      "automated": true,
      "profile": "Level1",
      "section": "2.4.1",
      "file_path": "/etc/cron.weekly",
      "expected_permissions": "0700",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.5",
      "description": "Verify permissions on /etc/cron.weekly are configured"
    },
    {
      "id": "crontab_perm",
      "title": "Verify Permissions on crontab",
      "type": "FilePermissions",
      "automated": true,
      "profile": "Level1",
      "section": "2.4.1",
      "file_path": "/etc/crontab",
      "expected_permissions": "0600",
      "expected_owner": "root",
      "expected_group": "root",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 2.4.1.2",
      "description": "Verify permissions on /etc/crontab are configured"
    },
    {
      "id": "local_login_banner",
      "title": "Ensure Local Login Warning Banner Is Configured Properly",
      "type": "FileContent",
      "automated": true,
      "profile": "Level1",
      "section": "1.10",
      "file_path": "/etc/issue",
      "pattern": "\\\\v|\\\\r|\\\\m|\\\\s",
      "expected_result": "not_found",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.10.2",
      "description": "Ensure local login warning banner is configured properly"
    },
    {
      "id": "remote_login_banner",
      "title": "Ensure Remote Login Warning Banner Is Configured Properly", 
      "type": "FileContent",
      "automated": true,
      "profile": "Level1",
      "section": "1.10",
      "file_path": "/etc/issue.net",
      "pattern": "\\\\v|\\\\r|\\\\m|\\\\s",
      "expected_result": "not_found",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.10.3",
      "description": "Ensure remote login warning banner is configured properly"
    },
    {
      "id": "sticky_bit_world_writable_dirs",
      "title": "Verify that All World-Writable Directories Have Sticky Bits Set",
      "type": "CommandOutputEmpty",
      "automated": true,
      "profile": "Level1",
      "section": "6.1",
      "audit_command": "find / -type d -perm -0002 ! -perm -1000 2>/dev/null",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.12",
      "description": "Ensure that all world-writable directories have sticky bits set"
    },
    {
      "id": "no_world_writable_files",
      "title": "Ensure No World-Writable Files Exist",
      "type": "CommandOutputEmpty",
      "automated": true,
      "profile": "Level1",
      "section": "6.1",
      "audit_command": "find / -xdev -type f -perm -0002 2>/dev/null",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 6.1.9",
      "description": "Ensure no world-writable files exist"
    }
  ]
}