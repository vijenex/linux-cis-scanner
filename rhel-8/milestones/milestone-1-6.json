{
  "milestone": "1.6",
  "version": "1.0.0",
  "description": "RHEL 8 CIS Benchmark v4.0.0 - Section 1.6",
  "controls": [
    {
      "id": "1.6.1",
      "title": "Ensure system wide crypto policy is not set to legacy\\",
      "automated": true,
      "profile": "Level1",
      "section": "1.6",
      "description": "\\\n\n\\f2\\b0 When a system-wide policy is set up, the default behavior of applications will be to\\\nfollow the policy. Applications will be unable to use algorithms and protocols that do not\\\nmeet the policy, unless you explicitly request the application to do so.\\\nThe system-wide crypto-policies followed by the crypto core components allow\\\nconsistently deprecating and disabling algorithms system-wide.\\\nThe \n\\f0 \\cf4 LEGACY\n\\f2 \\cf2  policy ensures maximum compatibility with version 5 of the operat",
      "rationale": "\\\n\n\\f2\\b0 If the \n\\f0 \\cf4 LEGACY\n\\f2 \\cf2  system-wide crypto policy is selected, it includes support for TLS 1.0, TLS\\\n1.1, and SSH2 protocols or later. The algorithms DSA, 3DES, and RC4 are allowed,\\\nwhile RSA and Diffie-Hellman parameters are accepted if larger than 1023-bits.\\\nThese legacy protocols and algorithms can make the system vulnerable to attacks,\\\nincluding those listed in RFC 7457\\\n\n\\f1\\b",
      "impact": "\\\n\n\\f2\\b0 Environments that require compatibility with older insecure protocols may require the\\\nuse of the less secure \n\\f0 \\cf4 LEGACY\n\\f2 \\cf2  policy level.\\\n\n\\f1\\b",
      "audit_command": "\\\n\n\\f2\\b0 Run the following command to verify that the system-wide crypto policy is not \n\\f0 \\cf4 LEGACY\\\n\n\\f4\\fs20\\fsmilli10080 \\cf2 # grep -Pi '^\\\\h*LEGACY\\\\b' /etc/crypto-policies/config\\\n\n\\f2\\fs24 Verify that no lines are returned\n\\fs20\\fsmilli10080 Page 223\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\n\n\\f2\\b0 Run the following command to change the system-wide crypto policy\\\n\n\\f4\\fs20\\fsmilli10080 # update-crypto-policies --set <CRYPTO POLICY>\\\n\n\\f3\\i\\fs24 Example:\\\n\n\\f4\\i0\\fs20\\fsmilli10080 # update-crypto-policies --set",
      "references": "\\\n\n\\f2\\b0 1. CRYPTO-POLICIES(7)\\\n2. \\cf7 https://access.redhat.com/articles/3642912#what-polices-are-provided-1\\\n\\cf2 3. fips-mode-setup(8)\\\n4. NIST SP 800-53 Rev. 5: SC-8\\\n\n\\f1\\b",
      "type": "FileContent",
      "file_path": "/etc/crypto-policies/config\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.6.1 | Level1"
    },
    {
      "id": "1.6.3",
      "title": "Ensure system wide crypto policy macs are configured\\",
      "automated": true,
      "profile": "Level1",
      "section": "1.6",
      "description": "\\\n\n\\f2\\b0 Message Authentication Code (MAC) algorithm is a family of cryptographic functions\\\nthat is parameterized by a symmetric key. Each of the functions can act on input data\\\n(called a \\'93message\\'94) of variable length to produce an output value of a specified length.\\\nThe output value is called the MAC of the input message.\\\nA MAC algorithm can be used to provide data-origin authentication and data-integrity\\\nprotection\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 Weak algorithms continue to have a great deal of attention as a weak spot that can be\\\nexploited with expanded computing power. An attacker that breaks the algorithm could\\\ntake advantage of a MiTM position to decrypt the tunnel and capture credentials and\\\ninformation.\\\nA MAC algorithm must be computationally infeasible to determine the MAC of a\\\nmessage without knowledge of the key, even if one has already seen the results of\\\nusing that key to compute the MAC's of other messages.\\\n\n",
      "impact": "None",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify weak MACs are disabled:\\\n\n\\f4\\fs20\\fsmilli10080 # grep -Pi --\\\n'^\\\\h*mac\\\\h*=\\\\h*([^#\\\\n\\\\r]+)?-128\\\\b' /etc/crypto-\\\npolicies/state/CURRENT.pol\\\n\n\\f2\\fs24 Nothing should be returned\n\\fs20\\fsmilli10080 Page 229\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "remediation": "\\\nNote:\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 The commands below are written for the included \n\\f0 \\cf4",
      "references": "\\\n\n\\f2\\b0 1. \\cf7 https://nvd.nist.gov/vuln/detail/CVE-2008-5161\\\n\\cf2 2. crypto-policies(7)\\\n3. update-crypto-policies(8)\\\n4. Red Hat Enterprise 8 security hardening\\\n5. \\cf7 https://www.redhat.com/en/blog/how-customize-crypto-policies-rhel-82\\\n\\cf2 6. \\cf7 https://csrc.nist.gov/glossary/term/messa",
      "type": "FileContent",
      "file_path": "/etc/crypto-\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.6.3 | Level1"
    },
    {
      "id": "1.6.4",
      "title": "Ensure system wide crypto policy disables cbc for ssh\\",
      "automated": true,
      "profile": "Level1",
      "section": "1.6",
      "description": "\\\n\n\\f2\\b0 Cypher Block Chaining (CBC) is an algorithm that uses a block cipher.\\\n\n\\f1\\b",
      "rationale": "\\\n\n\\f2\\b0 A vulnerability exists in SSH messages that employ CBC mode that may allow an\\\nattacker to recover plaintext from a block of ciphertext. If exploited, this attack can\\\npotentially allow an attacker to recover up to 32 bits of plaintext from an arbitrary block\\\nof ciphertext from a connection secured using the SSH protocol.\\\n\n\\f1\\b",
      "impact": "\\\n\n\\f2\\b0 CBC ciphers might be the only common cyphers when connecting to older SSH clients\\\nand servers\n\\fs20\\fsmilli10080 Page 232\\\n\n\\f0 Internal Only - General\\\n\n\\f1\\b\\fs24",
      "audit_command": "\\\n\n\\f2\\b0 Run the following script to verify \n\\f0 \\cf4 CBC\n\\f2 \\cf2  is disabled for \n\\f0 \\cf4 SSH\n\\f2 \\cf2 :\\\n\n\\f4\\fs20\\fsmilli10080 #!/usr/bin/env bash\\\n\\{\\\nl_output=\"\" l_output2=\"\"\\\nif grep -Piq --\\\n'^\\\\h*cipher\\\\h*=\\\\h*([^#\\\\n\\\\r]+)?-CBC\\\\b' /etc/crypto-\\\npolicies/state/CURRENT.pol; then\\\nif grep -Piq --\\\n'^\\\\h*cipher@(lib|open)ssh(-server|-client)?\\\\h*=\\\\h*'\\\n/etc/crypto-policies/state/CURRENT.pol; then\\\nif ! grep -Piq --\\\n'^\\\\h*cipher@(lib|open)ssh(-server|-\\\nclient)?\\\\h*=\\\\h*([^#\\\\n\\\\r]+)",
      "remediation": "\\\nNote:\\\n\n\\f0\\b0\\fs20\\fsmilli10080 \\'95\n\\f2  \n\\fs24 The commands below are written for the included \n\\f0 \\cf4",
      "references": "\\\n\n\\f2\\b0 1. \\cf7 https://nvd.nist.gov/vuln/detail/CVE-2008-5161\\\n\\cf2 2. crypto-policies(7)\\\n3. update-crypto-policies(8)\\\n4. Red Hat Enterprise 8 security hardening\\\n5. \\cf7 https://www.redhat.com/en/blog/how-customize-crypto-policies-rhel-82\\\n\\cf2 6. NIST SP 800-53 Rev. 5: SC-8\n\\fs20\\fsmilli10080",
      "type": "FileContent",
      "file_path": "/etc/crypto-\\",
      "pattern": "",
      "expected_result": "found",
      "severity": "medium",
      "cis_reference": "CIS RHEL 8 v4.0.0 - 1.6.4 | Level1"
    }
  ]
}