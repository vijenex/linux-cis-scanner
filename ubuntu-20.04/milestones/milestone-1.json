{
  "milestone": "1",
  "title": "Initial Setup",
  "description": "CIS Ubuntu Linux 20.04 LTS Benchmark - Section 1: Initial Setup",
  "version": "1.1.0",
  "controls": [
    {
      "id": "1.1.1.1",
      "title": "Ensure mounting of cramfs filesystems is disabled",
      "section": "1.1 Filesystem Configuration",
      "description": "The cramfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems. A cramfs image can be used without having to first decompress the image.",
      "impact": "Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf and add the following line: install cramfs /bin/true",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "cramfs",
      "expected_value": "disabled"
    },
    {
      "id": "1.1.1.2",
      "title": "Ensure mounting of freevxfs filesystems is disabled",
      "section": "1.1 Filesystem Configuration",
      "description": "The freevxfs filesystem type is a free version of the Veritas type filesystem. This is the primary filesystem type for HP-UX operating systems.",
      "impact": "Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf and add the following line: install freevxfs /bin/true",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "freevxfs",
      "expected_value": "disabled"
    },
    {
      "id": "1.1.1.3",
      "title": "Ensure mounting of jffs2 filesystems is disabled",
      "section": "1.1 Filesystem Configuration",
      "description": "The jffs2 (journaling flash filesystem 2) filesystem type is a log-structured filesystem used in flash memory devices.",
      "impact": "Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf and add the following line: install jffs2 /bin/true",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "jffs2",
      "expected_value": "disabled"
    },
    {
      "id": "1.1.1.4",
      "title": "Ensure mounting of hfs filesystems is disabled",
      "section": "1.1 Filesystem Configuration",
      "description": "The hfs filesystem type is a hierarchical filesystem that allows you to mount Mac OS filesystems.",
      "impact": "Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf and add the following line: install hfs /bin/true",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "hfs",
      "expected_value": "disabled"
    },
    {
      "id": "1.1.1.5",
      "title": "Ensure mounting of hfsplus filesystems is disabled",
      "section": "1.1 Filesystem Configuration",
      "description": "The hfsplus filesystem type is a hierarchical filesystem designed to replace hfs that allows you to mount Mac OS filesystems.",
      "impact": "Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "remediation": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf and add the following line: install hfsplus /bin/true",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "hfsplus",
      "expected_value": "disabled"
    },
    {
      "id": "1.1.2",
      "title": "Ensure /tmp is configured",
      "section": "1.1 Filesystem Configuration",
      "description": "The /tmp directory is a world-writable directory used for temporary storage by all users and some applications.",
      "impact": "Making /tmp its own file system allows an administrator to set the noexec option on the mount, making /tmp useless for an attacker to install executable code.",
      "remediation": "Configure /tmp as a separate partition or logical volume. Edit /etc/fstab and add or edit the /tmp entry.",
      "profile": "Level2",
      "type": "Manual",
      "expected": "Separate /tmp filesystem configured"
    },
    {
      "id": "1.1.3",
      "title": "Ensure nodev option set on /tmp partition",
      "section": "1.1 Filesystem Configuration",
      "description": "The nodev mount option specifies that the filesystem cannot contain special devices.",
      "impact": "Since the /tmp filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /tmp.",
      "remediation": "Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /tmp partition.",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/fstab",
      "pattern": "^[^#]*\\s+/tmp\\s+.*nodev.*",
      "expected_match": true
    },
    {
      "id": "1.1.4",
      "title": "Ensure nosuid option set on /tmp partition",
      "section": "1.1 Filesystem Configuration",
      "description": "The nosuid mount option specifies that the filesystem cannot contain setuid files.",
      "impact": "Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /tmp.",
      "remediation": "Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /tmp partition.",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/fstab",
      "pattern": "^[^#]*\\s+/tmp\\s+.*nosuid.*",
      "expected_match": true
    },
    {
      "id": "1.1.5",
      "title": "Ensure noexec option set on /tmp partition",
      "section": "1.1 Filesystem Configuration",
      "description": "The noexec mount option specifies that the filesystem cannot contain executable binaries.",
      "impact": "Since the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /tmp.",
      "remediation": "Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /tmp partition.",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/fstab",
      "pattern": "^[^#]*\\s+/tmp\\s+.*noexec.*",
      "expected_match": true
    },
    {
      "id": "1.2.1",
      "title": "Ensure package manager repositories are configured",
      "section": "1.2 Software Updates",
      "description": "Systems need to have package manager repositories configured to ensure they receive the latest patches and updates.",
      "impact": "If a system's package repositories are misconfigured important patches may not be identified or a rogue repository could introduce compromised software.",
      "remediation": "Configure your package manager repositories according to site policy.",
      "profile": "Level1",
      "type": "Manual",
      "expected": "Package repositories properly configured"
    },
    {
      "id": "1.2.2",
      "title": "Ensure GPG keys are configured",
      "section": "1.2 Software Updates",
      "description": "Most packages managers implement GPG key signing to verify package integrity during installation.",
      "impact": "It is important to ensure that updates are obtained from a valid source to protect against spoofing that could lead to the inadvertent installation of malware on the system.",
      "remediation": "Update your package manager GPG keys in accordance with site policy.",
      "profile": "Level1",
      "type": "Manual",
      "expected": "GPG keys properly configured"
    },
    {
      "id": "1.3.1",
      "title": "Ensure AIDE is installed",
      "section": "1.3 Filesystem Integrity Checking",
      "description": "AIDE takes a snapshot of filesystem state including modification times, permissions, and file hashes which can then be used to compare against the current state of the filesystem to detect modifications to the system.",
      "impact": "By monitoring the filesystem state compromised files can be detected to prevent or limit the exposure of accidental or malicious misconfigurations or modified binaries.",
      "remediation": "Install AIDE using the appropriate package manager or compile from source.",
      "profile": "Level1",
      "type": "Package",
      "package_name": "aide",
      "should_be_installed": true
    },
    {
      "id": "1.3.2",
      "title": "Ensure filesystem integrity is regularly checked",
      "section": "1.3 Filesystem Integrity Checking",
      "description": "Periodic checking of the filesystem integrity is needed to detect changes to the filesystem.",
      "impact": "Periodic file checking allows the system administrator to determine on a regular basis if critical files have been changed in an unauthorized fashion.",
      "remediation": "Run the following command: crontab -u root -e. Add the following line to the crontab: 0 5 * * * /usr/bin/aide.wrapper --config /etc/aide/aide.conf --check",
      "profile": "Level1",
      "type": "Manual",
      "expected": "Regular AIDE checks configured in crontab"
    },
    {
      "id": "1.4.1",
      "title": "Ensure permissions on bootloader config are configured",
      "section": "1.4 Secure Boot Settings",
      "description": "The grub configuration file contains information on boot settings and passwords for unlocking boot options.",
      "impact": "Setting the permissions to read and write for root only prevents non-root users from seeing the boot parameters or changing them.",
      "remediation": "Run the following commands to set permissions on your grub configuration files.",
      "profile": "Level1",
      "type": "FilePermission",
      "file_path": "/boot/grub/grub.cfg",
      "expected_mode": "600",
      "expected_owner": "root",
      "expected_group": "root"
    },
    {
      "id": "1.4.2",
      "title": "Ensure bootloader password is set",
      "section": "1.4 Secure Boot Settings",
      "description": "Setting the boot loader password will require that anyone rebooting with modified boot parameters will require the boot loader password to do so.",
      "impact": "Requiring a boot password upon execution of the boot loader will prevent an unauthorized user from entering user single mode or changing the boot parameters during the boot process.",
      "remediation": "Create an encrypted password with grub-mkpasswd-pbkdf2 and configure GRUB to use it.",
      "profile": "Level1",
      "type": "Manual",
      "expected": "Bootloader password configured"
    },
    {
      "id": "1.4.3",
      "title": "Ensure authentication required for single user mode",
      "section": "1.4 Secure Boot Settings",
      "description": "Single user mode is used for recovery when the system detects an issue during boot or by manual selection from the bootloader.",
      "impact": "Requiring authentication in single user mode prevents an unauthorized user from rebooting the system into single user to gain root privileges without credentials.",
      "remediation": "Run the following command and follow the prompts to set a password for the root user: passwd root",
      "profile": "Level1",
      "type": "Manual",
      "expected": "Root password set for single user mode"
    },
    {
      "id": "1.5.1",
      "title": "Ensure core dumps are restricted",
      "section": "1.5 Additional Process Hardening",
      "description": "A core dump is the memory of an executable program. It is generally used to determine why a program aborted.",
      "impact": "Setting a hard limit of 0 prevents users from overriding the soft variable. If core dumps are required, consider setting limits for user groups (see limits.conf(5)).",
      "remediation": "Add the following line to /etc/security/limits.conf or a /etc/security/limits.d/* file: * hard core 0",
      "profile": "Level1",
      "type": "ConfigFile",
      "file_path": "/etc/security/limits.conf",
      "pattern": "^\\s*\\*\\s+hard\\s+core\\s+0",
      "expected_match": true
    },
    {
      "id": "1.5.2",
      "title": "Ensure XD/NX support is enabled",
      "section": "1.5 Additional Process Hardening",
      "description": "Recent processors in the x86 family support the ability to prevent code execution on a per memory page basis.",
      "impact": "Enabling any feature that can protect against buffer overflow attacks enhances the security of the system.",
      "remediation": "On 32 bit systems install a kernel with PAE support, no installation is required on 64 bit systems.",
      "profile": "Level1",
      "type": "Manual",
      "expected": "XD/NX support enabled in kernel"
    },
    {
      "id": "1.5.3",
      "title": "Ensure address space layout randomization (ASLR) is enabled",
      "section": "1.5 Additional Process Hardening",
      "description": "Address space layout randomization (ASLR) is an exploit mitigation technique which randomly arranges the address space of key data areas of a process.",
      "impact": "Randomly placing virtual memory regions will make it difficult to write memory page exploits as the memory placement will be consistently shifting.",
      "remediation": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: kernel.randomize_va_space = 2",
      "profile": "Level1",
      "type": "KernelParameter",
      "parameter": "kernel.randomize_va_space",
      "expected_value": "2"
    },
    {
      "id": "1.5.4",
      "title": "Ensure prelink is disabled",
      "section": "1.5 Additional Process Hardening",
      "description": "prelink is a program that modifies ELF shared libraries and ELF dynamically linked binaries in such a way that the time needed for the dynamic linker to perform relocations at startup significantly decreases.",
      "impact": "The prelinking feature can interfere with the operation of AIDE, because it changes binaries. Prelinking can also increase the vulnerability of the system if a malicious user is able to compromise a common library such as libc.",
      "remediation": "Run the following commands to restore binaries to normal and uninstall prelink: prelink -ua && apt purge prelink",
      "profile": "Level1",
      "type": "Package",
      "package_name": "prelink",
      "should_be_installed": false
    }
  ]
}